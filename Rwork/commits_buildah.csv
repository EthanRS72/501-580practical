"name_with_owner","sha","author","date","verified","message","num_issues","commit_month","has_ci","is_core"
"containers/buildah","953950e0ef4e428b9db833ab8aa34045d0f9b7fe","jmguzik","2021-03-08 19:09:17","false","Remove duplicated code in addcopy

Signed-off-by: Jakub Guzik <jakubmguzik@gmail.com>",57,49,0,0
"containers/buildah","5b7aa1add5567b64bcaf4a247d732acaec55077d","nalind","2017-02-13 22:46:37","false","Drop supplemental groups for ""run""

Drop supplemental group resolution for the ""run"" command.  The necessary
functions weren't in go 1.5, and the runtime spec doesn't give us a
place to put supplemental group information anyway.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","9fafd493a024d2c7d394fcf09fb9b7c038d77caa","rhatdan","2018-05-25 09:44:17","false","buildah bud should require a context directory or URL

Also vendor in latest golang.org/x to attempt to fix issue with testing.
The latest tests were blowing up because of errors in the golang.org/x/sys
code.  Updating the vendoring and switching the validate Checkout are being
done to make the tests pass.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #723
Approved by: TomSweeneyRedHat",61,16,0,1
"containers/buildah","b16a1eac077a20c6f345f8e4747aab56701f182b","TomSweeneyRedHat","2018-04-17 20:00:12","false","Add /bin/sh -c to entrypoint in config

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #596
Approved by: rhatdan",32,15,0,1
"containers/buildah","214e4c93350563cef06aa713a4bd6fa6ed35c636","openshift-merge-robot","2020-11-13 08:35:42","true","Merge pull request #2778 from nalind/copier-no-lsxattrs

copier.Get(): ignore ENOTSUP/ENOSYS when listing xattrs",72,45,0,1
"containers/buildah","e92e71e8266ae1b1e3c4ecc084ca51d63d2c86a2","flouthoc","2022-03-08 09:25:49","true","vendor: bump c/storage to main/93ce26691863

Signed-off-by: Aditya R <arajan@redhat.com>",30,61,1,1
"containers/buildah","03d782c011f18e4062afa2312ce0d43659f6b7f7","rhatdan","2020-07-24 15:20:32","true","Merge pull request #2490 from nalind/imagemap-race

Fix a race we hit during conformance tests",148,42,0,1
"containers/buildah","4a150f671a5c503a4600aa9a78beff9755cd25ad","rhatdan","2020-03-02 17:16:43","true","Merge pull request #2196 from containers/dependabot/go_modules/github.com/containers/common-0.4.2

Bump github.com/containers/common from 0.4.1 to 0.4.2",101,37,0,1
"containers/buildah","f2d53d35ce185127401a9ce15ed63dd49ab22246","TomSweeneyRedHat","2020-02-27 18:29:08","false","Bump back to v1.15.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",97,37,0,1
"containers/buildah","1d19db33f030cbfcf20cfeed4dc3fa464bb8757c","ypu","2018-11-12 08:58:36","false","Print command in SystemExec as debug information

Also print command line in SystemExec like docker and buildah
functions.

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #1172
Approved by: rhatdan",62,21,0,0
"containers/buildah","c09834bb70470bf16af2da8f6592bebb0ba5d3b0","vrothberg","2020-06-17 07:21:21","false","vendor github.com/containers/common v0.14.0

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",143,41,0,1
"containers/buildah","29ddd4b3466688b5cc310122c8f4570651b3920a","rhatdan","2021-08-27 12:15:56","false","Add support for libsubid

This will enable remote access to /etc/subuid and /etc/subgid
information from ldap services, if shadow-utils ships with a libsubid.

[NO TESTS NEEDED] Since we have no way to test this.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",37,55,1,1
"containers/buildah","db162629c9a87502768a98b194711283b75a88c9","openshift-merge-robot","2021-06-18 09:01:01","true","Merge pull request #3316 from mtrmac/unused-StartsWithValidTransport

Remove unused util.StartsWithValidTransport",41,53,1,1
"containers/buildah","d419737759e2d8fecca1d60489e7cdd99cfc036f","rhatdan","2019-07-13 12:27:24","true","Merge pull request #1716 from rhatdan/version

Bump to Version v1.9.1",50,30,0,1
"containers/buildah","fd2d05c0a7ada9592e30a2eba941444b1d959ecf","rhatdan","2022-11-13 11:55:56","true","Merge pull request #4414 from rhatdan/VENDOR

Vendor in latest containers/(common,image,storage)",22,69,1,1
"containers/buildah","74c4694251427e03276639c13d4bd031fa95576a","nalind","2019-02-19 16:11:43","false","imagebuildah.ReposToMap: move to cmd

imagebuildah.ReposToMap is only used by the CLI, so move it there.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1406
Approved by: TomSweeneyRedHat",59,25,0,1
"containers/buildah","b24449990455eedc64bda7375def4bed786c0f7e","flouthoc","2022-10-27 19:02:58","true","test: fix prune logic for cache-from after adding content summary

Don't use `run_buildah rmi --all -f` since on podman-remote
test this will remove prefetched alpine and it will try to pull
alpine from docker.io with completely different digest (ruining
our cache logic) need for this test.

Fixes: https://github.com/containers/buildah/pull/4326#issuecomment-1291707569

Signed-off-by: Aditya R <arajan@redhat.com>",24,69,1,1
"containers/buildah","811cf927d733c0bb72bacf28570d932331d20613","umohnani8","2018-02-06 22:00:01","false","Change default certs directory to /etc/containers/certs.dir

Made changes to the man pages to reflect this.

Signed-off-by: umohnani8 <umohnani@redhat.com>",35,12,0,1
"containers/buildah","622bc3a652b074e417a0471eeb265ba0a361b666","openshift-merge-robot","2022-02-03 01:03:26","true","Merge pull request #3765 from rhatdan/VENDOR

Update vendor of openshift/imagebuilder",34,60,1,1
"containers/buildah","752f5138ae985366aa79bdd589703ffa1d27ea24","openshift-merge-robot","2023-04-05 10:54:06","true","Merge pull request #4696 from containers/renovate/github.com-containers-common-0.x

fix(deps): update module github.com/containers/common to v0.51.2",10,74,1,1
"containers/buildah","031e72c5e5d67e290a560aad1918b82e373b4d18","openshift-merge-robot","2022-01-12 06:28:18","true","Merge pull request #3704 from abergmeier/nso

Allow processing of network options from FlagSet",28,59,1,1
"containers/buildah","7513301882a51b6fae34d9f1722c0e3e0653c378","openshift-merge-robot","2021-07-14 18:52:00","true","Merge pull request #3379 from alvistack/master-linux-amd64

Update nix pin with `make nixpkgs`",41,54,1,1
"containers/buildah","8d89b8000e3af6fe0c424a7c376d60b67ff37cf8","openshift-merge-robot","2021-01-10 10:01:38","true","Merge pull request #2877 from alvistack/master-linux-amd64

Update nix pin with `make nixpkgs`",91,47,0,1
"containers/buildah","172277d00763d5b4ac5a17c6ba8587e5d04a88a4","hswong3i","2021-04-14 01:25:21","true","Update nix pin with `make nixpkgs`

Signed-off-by: Wong Hoi Sing Edison <hswong3i@pantarei-design.com>",52,51,0,0
"containers/buildah","4243d7b8ba9a9343a45566445a0ad9a541dd3f2b","nalind","2018-11-17 03:23:01","false","Add --disable-compression to 'build-using-dockerfile'

Add a --disable-compression flag to the 'build-using-dockerfile'
command, and set OCIAcceptUncompressedLayers and DirForceCompress in the
SystemContext during Commit() and Push() based on whether or not the
flag is set.

For other transports, we still end up going with the receiver's
preference, so update the man page to mention that this controls a
default.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1149
Approved by: rhatdan",64,22,0,1
"containers/buildah","44a129f58603d6ca95e16cc1de8b80f589bb9066","nalind","2021-08-24 14:41:16","false","copier.Get(): try to avoid descending into directories

When processing a directory tree, only descend into a directory that is
marked for exclusion if its path is literally a prefix of an exception
pattern.

Subtly, but in a way that's compatible with docker, this means that if
we exclude directory ""subdir"", but we've been told to also include
""**/file"" (with an exclusion pattern of ""!**/file""), we won't descend
into ""subdir"" and find a file named ""subdir/file"", because ""**/file""
doesn't start with ""subdir/"".

More generally, exclusion patterns that start with ""!"" which include any
wildcards before their final component technically won't be treated
correctly.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",39,55,1,1
"containers/buildah","3f21c7d77a54add7bfbde5f6285a9147e507a1c3","openshift-merge-robot","2022-12-07 08:34:03","true","Merge pull request #4450 from AndASM/fix/contributing-libera.chat-not-freenode

[CI:DOCS] CONTRIBUTING.md: Update contact information",18,70,1,1
"containers/buildah","8ca903bc88ed51e909790527e144cc9461610e71","openshift-merge-robot","2023-01-10 04:09:32","true","Merge pull request #4511 from nalind/multiple-label

bud: Consolidate multiple synthetic LABEL instructions",20,71,1,1
"containers/buildah","07732c3eab25d1285157e418814b951de6916730","rhatdan","2020-04-30 21:32:57","false","Fix errors found in coverity scan

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",135,39,0,1
"containers/buildah","82ff48a06647e1c6ac4d24a23cf4a9dabd3e8f93","TomSweeneyRedHat","2020-01-21 16:09:59","false","Touch up os/arch doc

Touching up the OS, ARCH and PLATFORM options
doc just a bit from #2907.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2101
Approved by: rhatdan",105,36,0,1
"containers/buildah","7c2467ca715455034d31c7e6b429563c7966c78c","TomSweeneyRedHat","2018-11-28 18:57:26","false","Enable -q when --filter is used for images command

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1207
Approved by: rhatdan",43,22,0,1
"containers/buildah","468b1309132c2aa67e16018677648f61b0dd40fe","openshift-merge-robot","2022-05-25 16:59:18","true","Merge pull request #4008 from rhatdan/slice

 Remove util.StringInSlice because it is defined in containers/common",25,64,1,1
"containers/buildah","0d53dcff3802f7bf18d6973107ec66fdf8221f30","rhatdan","2022-03-31 10:38:57","false","Vendor in latest opencontainers/selinux v1.10.1

[NO NEW TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",26,62,1,1
"containers/buildah","0485ffbe7e9c937224240da1decf66f4106a73b6","rhatdan","2023-03-02 13:42:46","true","Merge pull request #4637 from flouthoc/switch-extended-agent

sshagent: use `ExtendedAgent` instead of `Agent`",16,73,1,1
"containers/buildah","9a73962f59df06ab20f5b899f412f0badb871975","rhatdan","2022-02-02 19:38:07","true","Merge pull request #3764 from rhatdan/VENDOR

Bump version of containers/image and containers/common",34,60,1,1
"containers/buildah","4c7953d46c54ff96969eccecbc3be1b6a093bd50","rhatdan","2023-06-05 20:05:42","true","Merge pull request #4843 from containers/renovate/github.com-sirupsen-logrus-1.x

fix(deps): update module github.com/sirupsen/logrus to v1.9.3",16,76,1,1
"containers/buildah","2015cde90c7f6582070343f01d3d2b940b560581","rhatdan","2018-04-16 20:37:53","false","Clarify the use of buildah config options

Make it clearer to the user which options can be executed
multiple times, versus those that can only used once.

Cleanup some documentation issues

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #592
Approved by: rhatdan",31,15,0,1
"containers/buildah","9f266335571906a12b3422b2a81f3bd4c1aded80","rhatdan","2020-12-16 11:01:48","false","Turn off PRIOR_UBUNTU Test until vm is updated

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",80,47,0,1
"containers/buildah","ccac7ca0bff04e8d35b6ace06ced441a1b20b9fb","rhatdan","2023-09-14 10:05:57","false","Run codespell on code

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",5,80,1,1
"containers/buildah","a314d2a6caf2b3f36f4cd13851905af8eb0fd2be","nalind","2021-09-14 13:43:42","false","Makefile: turn on race detection whenever it's available

Check if `go test` supports the -race flag on the build platform, and if
so, use it for unit tests instead of just assuming that it's always
available.

Use sync/atomic to safely use a uint32 instead of a bool to keep track
of whether or not the process we started for RUN has stopped.

[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",39,56,1,1
"containers/buildah","7631600e7264b46c8861f1c9afff3277d2a97233","nalind","2021-11-30 15:10:42","false","copier.Put: check for is-not-a-directory using lstat, not stat

When checking if something that we want to overwrite with a directory is
already a directory or not, use lstat instead of stat.  If it's a
symbolic link, it's not a directory.

This is a subtle behavior change, but it's in line with docker build.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",30,58,1,1
"containers/buildah","b7a598ca214105d22d169d59fd4f5beaee8bad7a","nalind","2017-04-03 21:44:23","false","Fixup metalinter errors

Fix a number of issues flagged by gometalinter.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #62
Approved by: rhatdan",14,2,0,1
"containers/buildah","06b927513bd1693ac089fff76b31ec22997bb256","nalind","2017-04-27 17:50:32","false","Bump golang.org/x/sys

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #87
Approved by: nalind",9,3,0,1
"containers/buildah","6bfbed6bea533ea44f6e02177a81c9564e4c04cc","nalind","2022-01-11 16:00:05","false","bud.bats: use a local git daemon for the git protocol test

When testing that we can handle contexts that are described using the
git:// protocol, launch a local git-daemon with a minimal repository to
point the binary at instead of github, which doesn't do that any more.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",28,59,1,1
"containers/buildah","b7c1c3de21003322414d580901ec1818587e0959","nalind","2020-10-19 16:53:15","false","copier.copierHandlerPut: don't check length when there are errors

When attempting to create a file as part of extracting a tar stream,
don't check if the number of bytes written that our helper function
(createFile) reports back to us matches our expectations if it also
reported an error, in which case the byte count is irrelevant.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",62,45,0,1
"containers/buildah","7a5342be8d6404b0444aa91334f39ed477d34be8","nalind","2017-05-17 20:56:14","false","Add more detail to errors returned from Commit()

Add some context to errors returned from the Commit() method.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #115
Approved by: rhatdan",10,4,0,1
"containers/buildah","ff1f9a3ee004daef250580401594c45bd7845924","nalind","2021-05-25 20:34:36","false","containerImageRef/containerImageSource: don't buffer uncompressed layers

Instead of extracting layer content to a temporary file when we're
committing to transports that aren't containers-storage, record the ID
of a layer and the uncompressed size it has recorded for its contents.

When later asked for a blob, if we cached a layer ID and size, generate
the layer diff on the fly, otherwise check for a file named after the
digest of the requested blob in our cache directory location (usually
used for new layers that we're adding) and the supplemental location
(which can be supplied by a caller).

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",35,52,1,1
"containers/buildah","bbbf6b20908c6020173bea9016007a2bd2680724","nalind","2018-09-10 18:23:26","false","Don't build btrfs if it is not installed

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1016
Approved by: TomSweeneyRedHat",36,19,0,1
"containers/buildah","8c255bc1cc261017fe6a0b4bb58130411870e1df","nalind","2020-01-08 16:04:13","false","copy: don't digest files that we ignore

Don't start digesting the contents of any file that we end up skipping.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #2072
Approved by: giuseppe",101,35,0,1
"containers/buildah","68ee943fac06f6814628f2e81d8a11289892a4c1","giuseppe","2018-11-05 15:13:55","false","rootless: use slirp4netns to setup the network namespace

If slirp4netns is available, use it to configure the network for the
rootless isolation mode.

Closes: https://github.com/containers/buildah/issues/1139

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1156
Approved by: rhatdan",57,21,0,1
"containers/buildah","47deb80069fb74c2a8bdb328cac96c7d12f6bca8","giuseppe","2018-10-09 13:55:55","false","buildah: use the same logic for XDG_RUNTIME_DIR as podman

if XDG_RUNTIME_DIR is not set, try in the order:

- /var/run/user/$UID/run
- $HOME/rundir

also set the XDG_RUNTIME_DIR so that the OCI runtime will
use the same settings.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1077
Approved by: rhatdan",51,20,0,1
"containers/buildah","981abe39d3d4200ca7a731820e78a56c8ed60c48","vrothberg","2019-05-29 14:38:54","false","imagebuildah: check errors in deferred calls

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1624
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","07950be5c79e2b751e77db8a7027917cd00c0ef1","umohnani8","2019-04-15 20:32:43","false","Don't fail bud --layers on dangling symlink

If there is a dangling symlink when building with --layers,
don't fail and continue the build process.
It would fail because it would try to stat the file to check
whether it has been modified since the previous build. And since
it would be a dangling symlink, the stat would fail hence causing
the build to fail.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>

Closes: #1519
Approved by: rhatdan",54,27,0,1
"containers/buildah","47332ce108671f96dd4b54ddcab0c23dd5962413","rhatdan","2023-05-27 17:51:52","true","Merge pull request #4818 from flouthoc/bump-store

vendor: bump c/storage to `55ee2d19292f`",16,76,1,1
"containers/buildah","0cd255485892ba069e4f08677a134d497311bb0e","rhatdan","2020-12-02 15:03:07","false","Throw errors when using bogus --network flags

Currently if you give a bogus --network flag,
buildah just ignores it and continues on.

This change will throw proper errors.

Add tests to make sure it works correctly.

Also remove some stuttering to clean up error messages.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",79,46,0,1
"containers/buildah","9bf5a5e52a4157e2382b97575ced5f9127957df5","rhatdan","2018-02-26 23:43:36","false","Breaking change on CommonBuildOpts

Just have to refuse to use previous created containers when doing a run.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #500
Approved by: rhatdan",18,13,0,1
"containers/buildah","0f5e51b039a037f965966c3b1273930bca01c677","rhatdan","2019-07-19 11:24:03","false","Bump to v1.9.3-dev

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",49,30,0,1
"containers/buildah","04c61a7b7277e44ea69ea93ebbded92fdecac036","rhatdan","2023-09-28 18:57:20","true","Merge pull request #5065 from containers/renovate/github.com-onsi-gomega-1.x

fix(deps): update module github.com/onsi/gomega to v1.28.0",8,80,1,1
"containers/buildah","7b316f3d6909c43d753fc1f47a2a97000c13727d","rhatdan","2019-07-19 07:33:41","true","Merge pull request #1727 from nalind/no-mount-z

run.bats: skip the ""z"" flag when testing --mount",49,30,0,1
"containers/buildah","53ed0c97052d46ef94514afbbb3040e9e77664e4","rhatdan","2022-11-11 20:30:53","true","Merge pull request #4398 from cevich/upd_cirrus_cron_check

[CI:DOCS] GHA: Simplify Cirrus-Cron check slightly",22,69,1,1
"containers/buildah","7490dfc1b525b19f8d7aa748769b70c06397994a","nalind","2020-10-01 16:13:13","false","Remove configuration for bors

Remove the configuration for the bors bot from this branch.  We're
moving to something else.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",88,44,0,1
"containers/buildah","99488b06f622b3eda9c31d5795b655d7f4b93cc1","nalind","2022-08-02 21:33:29","false","build: clean up git repos correctly when using subdirs

When the build context is specified as a subdirectory in a Git
repository, we were cloning the repository to start, but only removing
the subdirectory when we were finished with it.  We should be removing
the whole clone.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",18,66,1,1
"containers/buildah","1033abccb7f742e6a2b6c53dea4a48123ef66887","nalind","2020-01-17 15:45:56","false","chroot: handle slightly broken seccomp defaults

When a seccomp rule includes multiple equality checks for the same
argument for a syscall, they can never ALL be satisfied.  Because that's
how they're supposed to be treated, libseccomp returns an error when we
try to add them as part of the same conditional rule.  Try to detect
this exact case, and if we detect it, treat each condition as its own
rule.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #2105
Approved by: rhatdan",101,36,0,1
"containers/buildah","d86b0b915ff64d152830cd294c3ede77589ba19f","nalind","2018-06-22 15:33:37","false","Tweaks for commit tests

When testing --quiet, turn off debugging, have the image ID written to a
file, and verify that we get no output.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",29,17,0,1
"containers/buildah","b8740e386ec9c84249525b9ec3a45507236b2db7","TomSweeneyRedHat","2018-01-04 23:09:34","false","Add --all to remove containers

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #382
Approved by: rhatdan",29,11,0,1
"containers/buildah","c9c735e20de41f20e712e3839b18ef103f6ec538","TomSweeneyRedHat","2017-08-24 21:44:32","false","Add authentication to commit and push

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #250
Approved by: rhatdan",28,7,0,1
"containers/buildah","cb42905a7f5e91a4407b090947cd0ea0d375ada0","TomSweeneyRedHat","2018-02-27 00:16:57","false","Add selinux test from #486

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #501
Approved by: rhatdan",18,13,0,1
"containers/buildah","003a2d21559c349249acc70c29288c41eabf150e","mtrmac","2019-02-21 22:10:35","false","Simplify ExpandNames

No need to hard-code the :tag / @digest syntax when there
already is an API returning the string representation.

Should not change behavior.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","e87907966fc9962d14b2f0b207b0b4aa0b66c55e","edsantiago","2019-04-11 18:34:02","false","Travis CI: fail fast, upon error in any step

Use 'set -e' to exit immediately upon any failure: there is,
e.g., no reason to run BATS tests if the compile fails.

Background: in my brief experience here, the Go:tip jobs
inevitably fail. Although these are marked as allowed to
fail, I tried looking at the results anyway to see if the
failure was my fault; it took me a while to figure out
that the go build was failing, yet the CI job was plodding
on regardless. This seems wrong on infinite levels, and
a number of other people agree:

   https://github.com/travis-ci/travis-ci/issues/1066

In addition, remove the entire 'after_script' section.
It contained a step that (a) doesn't actually work,
and (b) probably belongs in a separate CI job on its own.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1494
Approved by: rhatdan",59,26,0,1
"containers/buildah","a61d90313cdbf2755d42bc0047824f85e444afd5","rhatdan","2018-11-05 11:54:55","true","Merge pull request #1155 from rhatdan/validate

Change validation EPOCH",57,21,0,1
"containers/buildah","9903fa6fcfe76a275dcd840db9519d74e6cb7e1e","rhatdan","2018-08-01 13:34:32","false","Update to latest urvave/cli

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #896
Approved by: TomSweeneyRedHat",32,18,0,1
"containers/buildah","0635dec171055bdeb3cb19ff22348a37e7bd0b20","rhatdan","2018-06-27 12:26:36","true","Merge pull request #809 from nalind/commit-alternate

commit: recognize committing to second storage locations",28,17,0,1
"containers/buildah","d8348d77dfff95f16caa5640dcc20f7c74e594c4","rhatdan","2018-09-28 03:52:11","true","Merge pull request #1030 from lsm5/travis-conformance

tests: run conformance test suite in Travis",39,20,0,1
"containers/buildah","97ec4563b49c6e9120d9d9f9fffba95fbf4baef8","rhatdan","2017-09-22 09:38:31","false","Cleanup buildah-containers code

1. Sort options so they are in alphabet order
2. Remove extra lines of code for options parsing that really do not accomplish anything.
3. Remove variables when they are not necessary, I.E. Don't create a variable to hold an
option that is only used once, use the option instead.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #267
Approved by: <username_without_leading_@>",34,8,0,1
"containers/buildah","a24d24e929e9914c768131822fa43ad2d160fabf","nalind","2017-04-19 19:28:28","false","Bump golang.org/x/crypto

Update the version of golang.org/x/crypto that we vendor.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",11,3,0,1
"containers/buildah","545ea4d0b5c1803af2a411498f90351efe10cceb","Luap99","2022-02-21 13:20:59","true","speed up combination-namespaces test

Commit d05957a6f6de added the private value for namespace flags and kept
container as alias for backwards compat. Commit b480ce832f3e added the
cgroup falg so the test has 3^6 combinations to test. This takes way to
long. Since container is the same as private we only test private. The
container value is already covered in the other namespace tests, see
general_namespace() function.

With this commit the test time went down from 23 min to 3 min on my
laptop.

Fixes #3768

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",28,61,1,0
"containers/buildah","2ddc22c2dd8d90c285794fd91223cf010d05f5c6","QiWang19","2020-10-13 14:10:44","false","Skip tlsVerify insecure BUILD_REGISTRY_SOURCES

If the registry is set to insecure allowd using BUILD_REGISTRY_SOURCES, hardcode to skip the tls verify to avoid the errors.
Returns error if set insecureRegistries but force to use tls-verify.

Signed-off-by: Qi Wang <qiwan@redhat.com>",62,44,0,1
"containers/buildah","bc9c27675a51e5a96ec7dff94ec27174f4a20d9a","EricHripko","2019-05-10 22:20:58","false","Check in new Dockerfiles

Signed-off-by: Eric Hripko <ehripko@bloomberg.net>

Closes: #1588
Approved by: TomSweeneyRedHat",56,27,0,0
"containers/buildah","368c41b8ed0458eac6a30b43b223d4d7db781c07","TomSweeneyRedHat","2020-06-17 17:05:19","false","Bump to v1.15.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",144,41,0,1
"containers/buildah","8c56a15dfe573e514d8dd484a727f7d044a5239a","openshift-merge-robot","2021-07-21 14:28:11","true","Merge pull request #3359 from cevich/ghw_comment

[CI:DOCS] Update cirrus-cron notification GH workflow",41,54,1,1
"containers/buildah","33f61f667d5944d25575e0d7cdbd1281574c81df","Luap99","2022-03-22 17:06:23","true","network setup: increase timeout to 4 minutes

Podman waits for 4 minutes to wait for conmon/oci runtime to create the
container[1]. Since this value seems to work we should use the same one
here.

[1] https://github.com/containers/podman/blob/b4b8b8b5374967f9a98aef6c9793c51342d54b9d/libpod/define/runtime.go#L27

[NO NEW TESTS NEEDED]

Fixes containers/podman#13327

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",33,62,1,0
"containers/buildah","7098e0e21f01d59a64b9746c84decb8e88ca2864","TomSweeneyRedHat","2020-10-29 22:36:52","false","Bump to v1.18.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",67,45,0,1
"containers/buildah","ac66d785d40811522c1fa422b7f48a2e6ffe8ae1","giuseppe","2019-04-04 08:26:58","false","unshare: move to pkg/

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1475
Approved by: rhatdan",52,26,0,1
"containers/buildah","b25187f33ee0babe68cffa1a547bedb85e1c4c9f","ypu","2018-11-12 08:47:55","false","Update regex for multi stage base test

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #1172
Approved by: rhatdan",62,21,0,0
"containers/buildah","27773078cd09bba8e2f04f758d161d397439a690","edsantiago","2020-01-29 17:59:19","false","sign test: fix gpg failure on Rawhide

Rawhide gating tests are failing with:

    gpg: keysize invalid; using 2048 bits
    gpg: agent_genkey failed: Inappropriate ioctl for device
    gpg: key generation failed: Inappropriate ioctl for device

The first is just a warning; easily fixed by s/512/2048/

The next two are actual errors caused by gpg trying to read
a passphrase using pinentry. Solution copied from skopeo
gating tests (systemtest/050-signing.bats)

Also: refactored duplicate code.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2121
Approved by: cevich",107,36,0,1
"containers/buildah","2637df51e9f58dcd0f2eb65ae0cf80aa76ea61dc","edsantiago","2022-03-23 15:42:51","false","Don't pollute

Several tests were doing '--iidfile x', where 'x' is a filename
with no path. This is super bad: if running as root, it leaves
litter in the current directory. If rootless, it may throw EPERM.
Clean those up, using $TESTDIR for each one.

Tested by running the test suite on my laptop and confirming
there are no more droppings.

And, refactor one particularly hairy set of duplicated build
incantations: make them a series of simple clean loops.

Signed-off-by: Ed Santiago <santiago@redhat.com>",33,62,1,1
"containers/buildah","9bf7586a1e0f51cdcfd8c9411c1f3c062cafbfa7","vrothberg","2019-06-18 11:29:58","false","chroot/run_test.go: export funcs to actually be executed

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","71dfb9035f9258b4582d21723e807c96e5912d42","vrothberg","2022-03-02 08:11:48","false","vendor c/image/v5@v5.20.0

Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",29,61,1,1
"containers/buildah","dc733f1d2701c7a06d51295b0e7742ef7a4dce77","dfr","2022-10-28 14:17:55","false","Don't set allow.mount in the vnet jail on Freebsd

This was needed early in development but is no longer necessary since
the OCI runtime handles container mounts in the host namespace.
Something like it could be used with some other options to allow nested
containers but that is not high on the priority list.

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",24,69,1,0
"containers/buildah","0bc545994ba473d1c312e47f8a7c3ac177909452","openshift-merge-robot","2023-06-29 08:40:04","true","Merge pull request #4895 from TomSweeneyRedHat/dev/tsweeney/bumpimage_common

Bump c/image to 5.26.0 and c/common to 0.54.0",13,77,1,1
"containers/buildah","b6f6306231884c2ac70ac2984f35fcc5b4b90efe","openshift-merge-robot","2022-01-21 12:37:26","true","Merge pull request #3715 from flouthoc/overlay-extend-api

overlay, mount: add support for non-volatile `upperdir`, `workdir` for overlay volumes",35,60,1,1
"containers/buildah","9fced965ee9397e253941a038cc7a48ec5bdeeda","flouthoc","2023-01-06 03:06:12","true","build, secret: allow realtive mountpoints wrt to work dir

When working with `--mount=type=secret` allow `target`/`dst` to accept relative paths w.r.t to the configured work dir.

See detailed use-case here: https://github.com/containers/buildah/issues/4491

Closes: https://github.com/containers/buildah/issues/4491

**Steps to reproduce the issue from #4491:**

1. Create Dockerfile and Makefile:

Dockerfile:
```
FROM docker.io/ubuntu:22.04

WORKDIR /somedir

RUN --mount=type=secret,id=secret-foo,dst=secret1.txt --mount=type=secret,id=secret-bar,dst=secret2.txt \
     printf ""PWD=%s\n"" ""$(pwd)"" && ls -la && ls -la / && stat secret1.txt && stat secret2.txt && \
     cp secret1.txt /root/secret-foo.txt && \
     cp secret2.txt /root/secret-bar.txt
```

Makefile:
```
DOCKER ?= docker

.PHONY: build-container

build-container:
	rm -rf build
	mkdir build
	echo ""secret:foo"" >build/secret1.txt
	echo ""secret:bar"" >build/secret2.txt
	buildah --no-cache --secret id=secret-foo,src=build/secret1.txt --secret id=secret-bar,src=build/secret2.txt -t defanator/example:tag1 .
	podman run --rm -t -i defanator/example:tag1 cat /root/secret-foo.txt
	podman run --rm -t -i defanator/example:tag1 cat /root/secret-bar.txt
	podman rmi defanator/example:tag1
```
```
make
```

Signed-off-by: Aditya R <arajan@redhat.com>",20,71,1,1
"containers/buildah","95bb025059238d3e3737faa76869d785fad20217","flouthoc","2022-09-29 12:46:39","true","vendor: bump c/common to v0.49.2-0.20220929111928-2d1b45ae2423

Signed-off-by: Aditya R <arajan@redhat.com>",20,68,1,1
"containers/buildah","d22a5293bee0ee3a158165814a59700597cd2130","testwill","2023-06-26 08:40:39","false","chore: pkg imported more than once

Signed-off-by: guoguangwu <guoguangwu@magic-shield.com>",13,77,1,0
"containers/buildah","bf40000e72b351067ebae7b77d212a200f9ce051","rhatdan","2017-11-22 16:35:41","false","Bump to v0.8",30,10,0,1
"containers/buildah","3a5f084652e628d69b1d033cd959da02c144de2c","rhatdan","2018-10-26 19:35:04","false","Add support for building buildah staticly

Add new Makefile options

SECURITYTAGS for passing options to setup security flags
Examples:  seccomp, apparmor, selinux ...

STORAGETAGS for passing in alternate storage options
Examples: btrfs_noversion, libdm_no_deferred_remove, ostree, containers_image_ostree_stub

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1130
Approved by: rhatdan

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #917
Approved by: rhatdan",50,21,0,1
"containers/buildah","c71b655cfc8b4bea8589d2d775d6f9f6f9c1dd64","rhatdan","2017-11-08 00:49:31","false","Bump to v0.5

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",30,9,0,1
"containers/buildah","fa2962a17289cbcb1d6e596c5a70d1bf09eed4d5","rhatdan","2020-11-06 01:59:43","false","Move declaration of decryption-keys to common cli

We currently don't have this for Podman, so moving
it to here so it will get into podman build.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",65,45,0,1
"containers/buildah","d83657c3ca220f0b7475ba3d8bb88b2dfb4992bf","vrothberg","2020-09-07 07:40:55","true","Merge pull request #2582 from nalind/cross

CI: expand cross-compile checks",85,43,0,1
"containers/buildah","1a79fbede18413595d5799cf59bee50ea8a21042","lsm5","2022-05-27 14:54:04","true","Cirrus: use Ubuntu 22.04 LTS

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",24,64,1,1
"containers/buildah","347478cccd02bffc715cf2c9db4c9268cd9e97dd","nalind","2018-08-30 15:36:52","false","chroot isolation: chroot() before setting up seccomp

Make the chroot() call before applying a seccomp filter, which might not
allow us to do it.  Add more debugging messages.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #979
Approved by: rhatdan",33,19,0,1
"containers/buildah","fab0d644f658c1c0b152e8e1e624cb094d7a2aed","nalind","2021-09-21 19:06:58","false","conformance: allow test cases to specify dockerUseBuildKit

The API flag that we'd need to set to in a build request to get dockerd
use BuildKit instead of the classic docker builder isn't available in
go-dockerclient, so add a second docker-based path that uses the API
types and client library, which the conformance tests were already
pulling in as indirect dependencies, but skip tests that set the flag if
we're not on the current client version.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",39,56,1,1
"containers/buildah","57e6a500d688719208d96ce7df0a05d6db6cee54","nalind","2017-05-22 18:23:36","false","Make sure maps in config blobs are always created

When we decode map elements, either from our own data, or when importing
from elsewhere, maps that don't contain any keys aren't created
automatically, so we need to check, and potentially create, maps when we
want to add something to them.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #114
Approved by: rhatdan",15,4,0,1
"containers/buildah","70b101ffc7a43a6d42e45b84b034d6741e6930b0","TomSweeneyRedHat","2019-12-11 15:51:53","false","Bump to c/storage v.1.15.3

Bump to c/storage v1.15.3

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2015
Approved by: rhatdan",85,34,0,1
"containers/buildah","7386ec63c83e62641f8f1eea55335c36a46c6656","TomSweeneyRedHat","2019-04-26 11:43:47","false","Bump to 1.9-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1553
Approved by: rhatdan",51,27,0,1
"containers/buildah","c4bbfbd49865933ea30a9a3fa39b2393ecda0ba8","TomSweeneyRedHat","2019-05-18 18:01:25","false","Bump baseline test to F30

Use Fedora 30 when used by baseline tests.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1601
Approved by: vrothberg",57,28,0,1
"containers/buildah","7be55eb21955cfbaad68468c8d8edfa855800c0b","openshift-merge-robot","2022-12-16 12:28:01","true","Merge pull request #4469 from Luap99/network-error

buildah: wrap network setup errors",17,71,1,1
"containers/buildah","005447be07eec196915cd62c7fb8b121a1cdc8e5","openshift-merge-robot","2022-06-07 18:26:34","true","Merge pull request #4042 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.8.1

build(deps): bump github.com/fsouza/go-dockerclient from 1.8.0 to 1.8.1",22,64,1,1
"containers/buildah","281577c9bd015ea61b84b425335414d71500fdcb","openshift-merge-robot","2022-04-06 13:51:26","true","Merge pull request #3829 from flouthoc/remove-identity-label

build, commit: allow removing default identity labels using `--identity-labels=false`",25,62,1,1
"containers/buildah","ddcbb30e8f3d6dc9be4e3f00c2db487f1eb20a7b","openshift-merge-robot","2021-01-08 13:31:02","true","Merge pull request #2894 from rhatdan/inspect

Buildah inspect should be able to inspect manifests",91,47,0,1
"containers/buildah","d93a4eb31393110a2fb5423355c9a9835fbaaa68","openshift-merge-robot","2022-04-21 19:01:12","true","Merge pull request #3917 from Luap99/hosts

use etchosts package from c/common",24,63,1,1
"containers/buildah","1d67d26f0afb5653699ed6fc2938c494ffba4a73","openshift-merge-robot","2020-12-07 22:06:47","true","Merge pull request #2839 from vrothberg/short-names

enable short-name aliasing",79,46,0,1
"containers/buildah","77d5d57836f573ec5f6da79ef835b017ba5dd94f","openshift-merge-robot","2021-04-06 13:10:45","true","Merge pull request #3129 from vrothberg/fix-podman-9915

fix local image lookup for custom platform",51,50,0,1
"containers/buildah","062445509bbc0fe4ede2d4c5d0b918e85616abf2","flouthoc","2021-11-01 10:47:36","true","build: history should not contain ARG values

It seems docker never writes ARG values to build history and only writes
values with RUN statements. As a result it can utilize caching better if
assgnment of an ARG value is never used.

Instance
```Dockerfile
FROM alpine
ARG FOO
ENV FOO=bat
RUN echo $FOO
```

In above example --build-arg FOO=value has no significance as value
is always overriden by ENV.

Following PR makes sure buildah mimics a similar behaviour.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",31,57,1,1
"containers/buildah","bdbedfdde59e9abf0c4cbeb403f737c1afe4e753","umohnani8","2019-04-16 02:20:24","false","Keep track of any build-args used during buildah bud --layers

Add any build-args used in the build process to the layers history
for future comparison when building with --layers.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>

Closes: #1521
Approved by: TomSweeneyRedHat",54,27,0,1
"containers/buildah","d0917fa7e6c6e12b60cc998d2873e07e6e36a00b","jmguzik","2021-02-24 07:40:04","false","buildah add/copy --chmod dockerfile implementation

Signed-off-by: Jakub Guzik <jakubmguzik@gmail.com>",62,49,0,0
"containers/buildah","7366e7fb50d1c0c3832648c27969b08c48154a72","rhatdan","2023-05-20 11:20:40","true","Merge pull request #4737 from containers/renovate/quay.io-libpod-testimage-20221018.x

chore(deps): update quay.io/libpod/testimage docker tag to v20221018",14,76,1,1
"containers/buildah","159bf35270da5080a68137bb8101656d780e2b2a","rhatdan","2023-06-29 13:31:43","true","Merge pull request #4889 from Luap99/def-rootless-network

rootless: use default_rootless_network_cmd config",13,77,1,1
"containers/buildah","375b16a3e9c032c276a4f94ff56a07d310d0abd0","rhatdan","2018-06-06 19:36:03","true","Merge pull request #747 from TomSweeneyRedHat/dev/tsweeney/pullfix2

Add registry errors for pull",37,16,0,1
"containers/buildah","3902b704b196af57ec0013e48e51e7cab0556f90","rhatdan","2020-11-12 15:50:47","false","Stop overwrapping and stuttering

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",70,45,0,1
"containers/buildah","154417fe74a3be9c8cf82ed4b076384d208df678","rhatdan","2020-11-06 10:52:05","false","Fix buildah config --cmd to handle array

buildah config --cmd '[ ""/a"", ""b"". ""c"" ]' is supposed to add
an array of commands.  This PR fixes this.

This PR also returns errors rather then just logging them so
command will fail with bad data.

Added lots of tests for failure situations, and to make sure
--cmd works correctly.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",66,45,0,1
"containers/buildah","49abf8264e4751870a7de6f5cb14a99706c79868","baude","2018-04-18 19:00:15","false","Refactor buildah bud for vendoring

Projects like libpod would benefit greatly if we could vendor in buildah
rather than execing it.  This refactor moves some of the key parsing
functions that buds uses to pkg/parse so that the project vendoring
buildah can also benefit from them.

Signed-off-by: baude <bbaude@redhat.com>

Closes: #608
Approved by: rhatdan",36,15,0,0
"containers/buildah","4ae0e14ea8a9ed47fb07351fe7ab23ca0554fc01","nalind","2019-07-08 21:50:33","false","image: make sure we don't try to use zstd compression

Don't try to use zstd to compress layers until we know what MIME type to
use to describe layers that are compressed with zstd.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1723
Approved by: TomSweeneyRedHat",48,29,0,1
"containers/buildah","e467bea0aa9bce06e9d97d57bcda74804b6328bc","nalind","2017-03-06 20:39:22","false","Add ""add"" and ""copy"" commands

Add ""add"" and ""copy"" CLI commands, which end up calling the same buildah
method, differing only in whether or not they tell it to attempt to
extract local sources when those sources appear to be archive files
(""add"" does, ""copy"" does not).

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","bdc7aa9235fa01aaa8e3e309d2e988e8b46a2153","nalind","2017-03-22 20:32:04","false","Merge pull request #24 from nalind/errors

Correctly report errors returned by commands",12,2,0,1
"containers/buildah","dbd22863797bb97fbcf62bad2d3600d024bb79a0","flouthoc","2022-07-26 10:21:51","true","stage_executor: generate output for cases with no commit

In certain cases build are entierly cached and we will never perform
commit for last or final stage. In such cases where we don't get
opportunity to perform commit we must manually process `--output` if it
was specified. Following commit ensures that.

For example a scenario below must produce `output` even though
everything was cached.

Example
```Dockerfile
FROM alpine
RUN echo hello
RUN touch hello
```
```console
buildah build --layers -t test .
buildah build --layers -t test --output build .
```

Closes: https://github.com/containers/buildah/issues/4132

Signed-off-by: Aditya R <arajan@redhat.com>",19,66,1,1
"containers/buildah","6056797f88f4c506eca657bac4b8d6fa6ba1d7f2","openshift-merge-robot","2020-10-21 12:20:09","true","Merge pull request #2711 from containers/badges

Remove docs that refer to bors, since we're not using it",64,45,0,1
"containers/buildah","3a0b52f008fd73be99088e2f965cc0f80cd37f9a","openshift-merge-robot","2021-06-23 18:25:27","true","Merge pull request #3335 from rhatdan/main

Change references from master to main",36,53,1,1
"containers/buildah","b3084b5f44e2ccffd80706e4830da96929b7ebab","rahilarious","2023-09-18 17:55:59","true","Removing selinux_tag.sh as no longer needed after 580356f
[NO NEW TESTS NEEDED]

Signed-off-by: Rahil Bhimjiani <rahil3108@gmail.com>",6,80,1,0
"containers/buildah","36afa3530e5b2f290455968e89a5a4c82261773b","AndASM","2022-09-29 00:13:48","false","Combine buildahimage Containerfiles

A single `Containerfile` should be easier to maintain and more reliable
than having three nearly identical files. The new file uses an argument
named `RELEASE` with the value `stable`, `testing`, or `upstream`.

Signed-off-by: Andrew Meadows <andrew@befuddled.ca>",20,68,1,0
"containers/buildah","6f4bd94b955b51d422250ad8d743cdb3c08fd27a","nalind","2017-05-18 15:23:17","false","Update reference comments for docker types origins

Update comments which reference where the types in docker/types.go came
from to reflect renames of the upstream repositories.  The contents of
the types themselves, since they are encoded into images that are kept
on disk, shouldn't change often, if ever.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #102
Approved by: rhatdan",15,4,0,1
"containers/buildah","d3a93be4285b6a324007c0b5da2a266dd2536f0c","nalind","2019-04-03 21:10:20","false","imagebuildah: defer pulling images for COPY --from

When handling COPY --from instructions, defer pulling images and
instantiating containers so that we can read content from their root
filesystems until we get to the instruction.

Have the main Executor keep track of the Builders that we create for
that purpose, and have it clean them up at the end of the build, as it
did when they were treated as their own stages.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1489
Approved by: rhatdan",53,26,0,1
"containers/buildah","a9fa129609ff3660efd48e92254a3cf22bd41c05","nalind","2018-06-27 13:55:46","false","Update github.com/opencontainers/runc

Pick up github.com/opencontainers/runc/libcontainer/apparmor.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #836
Approved by: rhatdan",28,17,0,1
"containers/buildah","bc53b5d980005fe91329d47542fc2ac5769066a7","nalind","2019-04-09 02:59:52","false","commit: commit on every instruction, but not always with layers

When building an image with multiple layers, go back to committing
images for instructions for which we previously wouldn't bother
committing an image, but create them without adding a new layer.

This violates some assumptions that we currently make elsewhere, as it's
possible for an image that's derived from a base image to add no layers
relative to the base image, when previously it was always the case that
we'd add at least one whenever we committed it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1539
Approved by: rhatdan",53,26,0,1
"containers/buildah","34ae47a22629b85dad57f7fb93fb23c1ef7ea28c","nalind","2021-03-03 21:45:43","false","copier: add GetOptions.IgnoreUnreadable

Add an IgnoreUnreadable flag to copier.GetOptions to suppress errors
from copier.Get() that would pass the os.IsPermission() test, if they're
encountered while attempting to read files or descend into directories.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",59,49,0,1
"containers/buildah","9f0cafc594cbec36e5e3a44ac8e75c77ad2bd7c5","rhatdan","2023-08-29 10:38:12","true","Merge pull request #5001 from indyvanmol/indyfixbuildahcontainerbuild

Fixing the owner of the storage.conf.",7,79,1,1
"containers/buildah","780ea8c55e4f2167a9685d45daec7ff64d4672d1","rhatdan","2019-06-25 15:45:47","false","Update buildah-login.md

Fix typo in man page.

Thanks to @lukeyeager for finding this.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",42,29,0,1
"containers/buildah","de0d8cbdcfb1a24b5c934189934f4dd5dfde0edf","rhatdan","2017-09-22 10:05:03","false","Bump to version 0.4

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",34,8,0,1
"containers/buildah","c9f30d81ae37f3602be5bd51f850e22ed1109b3e","rhatdan","2022-11-22 13:50:51","true","Merge pull request #4417 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.10

build(deps): bump github.com/containerd/containerd from 1.6.9 to 1.6.10",21,70,1,1
"containers/buildah","9cac447b4a1232537e847b02663fde2b06141d15","rhatdan","2019-09-12 20:24:06","true","Merge pull request #1850 from TomSweeneyRedHat/bump-1.11.1

Bump 1.11.1",61,31,0,1
"containers/buildah","f0bee4ee3d8ded21887c79e9c60f78113f495d25","rhatdan","2022-09-19 17:47:00","true","Merge pull request #4250 from rhatdan/dns

Prevent use of --dns* options with --net=none",19,68,1,1
"containers/buildah","b37a981500df33dcbeb32325aa6ddd900c42c457","nalind","2017-07-20 17:23:09","false","Stop trying to set the Platform in runtime specs

run: The latest version of runtime-spec dropped the Platform field, so
stop trying to set it when generating a configuration for a runtime.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #201
Approved by: rhatdan",17,6,0,1
"containers/buildah","29a6c812d924d04402b87c4487ed2d2e1c55a70b","nalind","2019-03-20 18:28:28","false","imagebuildah: centralize COMMIT and image ID output

Only write the image ID file after we commit the final image, not at
every commit.

Log all COMMIT steps and image IDs from inside of Execute().

This undoes a change to step counts that previously required us to
adjust the bud-target test in 8ceda286a764e07248e3753b2a919802d5241b6f.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1487
Approved by: rhatdan",36,26,0,1
"containers/buildah","b829ee3f6bafa62f4361e75c1c314d5d4abdbfb4","mtrmac","2019-02-21 22:33:42","false","Don't try to parse image name as a transport:image

ResolveName now guarantees that the transport, if it exists,
is not a part of the image name; the semantics is no longer
ambiguous, so use the value only as expected.

This could possibly fix incorrect handling of some strings
(pull docker://dir:localpath), and the debug log will no longer
contain ""error parsing image name %q as given, trying with transport"" for every
name parsing attempt.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","a16c3cdd7dbd7588966d9e5eeabdcf8258b0e705","bertinatto","2018-02-24 10:09:25","false","Add multi-stage builds support

Signed-off-by: Fabio Bertinatto <fbertina@redhat.com>

Closes: #495
Approved by: nalind",17,13,0,0
"containers/buildah","2a82d0737c846743b35ef6933ab683c4b1f18f7f","saschagrunert","2019-12-04 10:05:22","false","Vendor containers/storage fix

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1998
Approved by: rhatdan",85,34,0,1
"containers/buildah","9c99d7ca8866d085135ae4d457eeeef3b03ec6e1","flouthoc","2023-10-11 06:44:20","true","run: use internal.GetTempDir with os.MkdirTemp

Projects which are using buildah as a library and set `TMPDIR` manually
can stumble upon a use-case where `TMPDIR` was set to a relative path.

Such as `export TMPDIR=.` in such case buildah will try to create a
temporary root using `Mkdirtemp` leading to a point where bundle is not
generated correctly since path was relative.

Following use case can be resolved by making sure that buildah always
converts relative path to absolute path and `GetTempDir` does it well.

Example reproducer with podman

```Dockerfile
FROM alpine
RUN echo hello
```

```console
export TMPDIR=.
podman build --no-cache -t test .
```

Expected failure
```console
STEP 1/2: FROM alpine
STEP 2/2: RUN echo hello
error running container: checking permissions on ""buildah2341274198"": stat buildah2341274198: no such file or directory
ERRO[0000] did not get container create message from subprocess: EOF
Error: building at STEP ""RUN echo hello"": while running runtime: exit status 1
```

Closes: RHEL-2598

Signed-off-by: Aditya R <arajan@redhat.com>",6,80,1,1
"containers/buildah","ce8c5678081b4df7949e2fac60d574c83a42985c","flouthoc","2023-03-29 15:14:41","true","test: don't allow to override io.buildah.version

buildah now does not supports overriding default version label,
hence remove the test which expects the wrong behaviour.

See discussion here: https://github.com/containers/buildah/pull/4673#discussion_r1142063367

Signed-off-by: Aditya R <arajan@redhat.com>",13,74,1,1
"containers/buildah","c5ef5c0e57ec8dc24a623b71bd73ef8577b04968","openshift-merge-robot","2021-12-20 14:28:29","true","Merge pull request #3681 from giuseppe/hack-fix-subid-test

build: fix libsubid test",29,59,1,1
"containers/buildah","f09e52c2a3d7db56b53669b05683439b34648360","openshift-merge-robot","2020-10-05 18:09:26","true","Merge pull request #2674 from containers/dependabot/go_modules/github.com/sirupsen/logrus-1.7.0

build(deps): bump github.com/sirupsen/logrus from 1.6.0 to 1.7.0",86,44,0,1
"containers/buildah","9c9a344b9874c8435bbf3ede929e238ee13602a0","openshift-merge-robot","2023-07-10 13:59:49","true","Merge pull request #4916 from rhatdan/VENDOR1

Vendor in containers/(common, image, storage)",13,77,1,1
"containers/buildah","00e5645868783121deab74824a6718ec7bc73d8c","openshift-merge-robot","2021-03-29 13:56:40","true","Merge pull request #3106 from hshiina/systemtest

Add a few system tests",52,50,0,1
"containers/buildah","e96ba381a2ce82bf19036b0bde289b78090494eb","nalind","2017-03-27 18:46:35","false","Add some more options for Run

Add options to Run() for passing in additional environment variables,
overriding the default command, user, and working directory, and a flag
for controlling whether or not we attach to the host's network.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #46
Approved by: rhatdan",14,2,0,1
"containers/buildah","3f78f33dc5564b44e56689fa1856f3183fe61f4c","nalind","2021-04-27 19:12:25","false","Run(): avoid Mkdir() into the rootfs

Replace a call to idtools.MkdirAllAndChownNew() with a call to
copier.Mkdir().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",49,51,0,1
"containers/buildah","40bb4a5b47ff94a4e949cf33bf9c1ddc37a595f9","nalind","2018-07-18 18:59:20","false","Add a value for IsolationOCIRootless

Add a new Isolation value: IsolationOCIRootless, for which we add a
global --rootless=true flag and a local --no-new-keyring flag when
creating a runtime container, and make some changes to the mounts list,
default namespacing configurations, and supplemental groups list.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #873
Approved by: rhatdan",32,18,0,1
"containers/buildah","6fa774ddc91c825773591cb80ad9d5a460d9f154","rhatdan","2022-10-17 14:18:53","false","Update vendor containers/(common,image,storage)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",27,69,1,1
"containers/buildah","c0b38746d3ba753b0c2e47984a592c85a505ba79","rhatdan","2017-03-24 16:49:22","false","Remove all --name and --root options

Also fix up buildah commit to require name and image",14,2,0,1
"containers/buildah","cf87f0947ef719872816cc5d6a5ba4db1c261365","rhatdan","2018-09-28 05:43:24","true","Merge pull request #1039 from umohnani8/bud

Copy ExposedPorts from base image into the config",39,20,0,1
"containers/buildah","cb93c14ddf7b8b602c3d1aa58fb22def97be13a4","rhatdan","2019-03-05 17:43:28","false","Errors should be printed to stderr

This seems like another bug in the conversion to cobra.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1388
Approved by: vrothberg",64,25,0,1
"containers/buildah","22a70ec8b87a0a36c88c36038fac28df51fe56e4","rhatdan","2023-08-07 18:16:11","true","Merge pull request #4955 from aaerrolla/main

Update install.md changes to reflect current Debian stable version name",11,78,1,1
"containers/buildah","30ad19a48ababa81ba5f273aabe1239c680b1291","rhatdan","2020-03-30 14:56:23","false","Bump github.com/spf13/cobra from 0.0.6 to 0.0.7

Bumps [github.com/spf13/cobra](https://github.com/spf13/cobra) from 0.0.6 to 0.0.7.
- [Release notes](https://github.com/spf13/cobra/releases)
- [Commits](https://github.com/spf13/cobra/compare/v0.0.6...0.0.7)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",111,38,0,1
"containers/buildah","dc504d944c5ce2183eda7cb64db4b5b7c2873ad9","rhatdan","2020-10-01 09:33:18","true","Merge pull request #2661 from rhatdan/man

Move --userns-uid-map/--userns-gid-map  description into buildah man page",88,44,0,1
"containers/buildah","1ba9201f38e453975743041937a35284dbf54f03","rhatdan","2019-03-15 12:31:59","false","Remove mistaken code that got merged in other PR

Miloslav had some good comments on a previous commit.

https://github.com/containers/buildah/pull/1411

These changes address his issues by removing them.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1412
Approved by: mtrmac",36,26,0,1
"containers/buildah","af05f5aa3cbd5372341a555ab3cacf68fadb183e","rhatdan","2020-01-08 14:48:59","false","Add codespell support

Check codespell on each PR in make validate.

Add fixes for issues found with codespell.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",101,35,0,1
"containers/buildah","e1dd52ef44999bb4cb60942f2e34fac0ab991c15","rhatdan","2021-11-04 10:58:05","false","Fix tutorial to specify command on buildah run line

Fixes: https://github.com/containers/buildah/issues/3564

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",29,57,1,1
"containers/buildah","e8d70e97d903324207e8b236b395aaae91f4ecd5","rhatdan","2022-03-19 11:13:54","true","Merge pull request #3824 from containers/dependabot/go_modules/github.com/stretchr/testify-1.7.1

build(deps): bump github.com/stretchr/testify from 1.7.0 to 1.7.1",33,62,1,1
"containers/buildah","4ddb1f6dfd14c92e686df5a87087878ea2be2562","mbargull","2020-11-06 09:51:20","false","Avoid overriding LDFLAGS in Makefile

Signed-off-by: Marcel Bargull <marcel.bargull@udo.edu>",66,45,0,0
"containers/buildah","aa4647db923628e98eb1a9828790833211fa7a57","vrothberg","2021-02-24 08:51:54","false","OWNERS: add @lsm5

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",62,49,0,1
"containers/buildah","d3b596095777f74529e7d2121dfcfa020e9f955d","vrothberg","2019-06-18 11:37:58","false","run_linux.go: ignore unchecked errors

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","d41719ac22b125012ec37cbdced816ceb02607b7","nalind","2019-04-02 17:26:48","false","bud.bats: test COPY --from in a Dockerfile while using the cache

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1490
Approved by: rhatdan",50,26,0,1
"containers/buildah","2d4c3083439cd934473f11f8712692786245a6e3","nalind","2017-03-07 15:41:25","false","Fix a lint error

Don't just discard an error value.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","fc880bcc861622f74abb83ff4459b6f35d3be18a","nalind","2017-05-16 15:08:52","false","Maintain multiple working container configs

Maintain the container configuration in multiple formats in the Buildah
object, initializing one based on the other, depending on which format
the source image used for its configuration.

Replace directly manipulated fields in the Buildah object (Annotations,
CreatedBy, OS, Architecture, Maintainer, User, Workdir, Env, Cmd,
Entrypoint, Expose, Labels, and Volumes) with accessor functions which
update both configurations and which read from whichever one we consider
to be authoritative.  Drop Args because we weren't using them.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #102
Approved by: rhatdan",10,4,0,1
"containers/buildah","ebf3063cf20c6b850362cac494b881d98065068c","nalind","2017-05-31 17:44:41","false","Make histories consistent when synthesizing images

Ensure that ""created"" timestamps in Images and ImageSources derived from
an image reference that we synthesize don't vary, since we want to
compute the exact same image configuration and manifest every time we
read the image using that reference.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #141
Approved by: rhatdan",13,4,0,1
"containers/buildah","36e174e779ea6f874287002bb1a7bd3578c59f59","nalind","2018-08-02 20:55:17","false","Switch to github.com/containers/image/pkg/sysregistriesv2

Switch from using github.com/containers/image/pkg/sysregistries to using
github.com/containers/image/pkg/sysregistriesv2 to complete unqualified
image names.  Keep v1 around because it'll tell us which configuration
file to name in an error message if things don't work right.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #904
Approved by: rhatdan",22,18,0,1
"containers/buildah","09e7ddf5441f1734e5d920c354b8d2f6d1ac21a9","michaelgugino","2018-02-14 22:45:16","false","Fix README link to tutorials

Current link is broken.

This commit corrects the link to point at the
correct file.

Signed-off-by: Michael Gugino <mgugino@redhat.com>

Closes: #480
Approved by: nalind",17,13,0,0
"containers/buildah","d88c26b52138582270ca1f9bb5b5d476ecc40a49","saschagrunert","2019-08-13 07:26:44","false","Add bud 'without arguments' integration tests

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1788
Approved by: rhatdan",52,30,0,1
"containers/buildah","f60d06d8177ad8d6b458071039b1dfb676ba06eb","vrothberg","2019-06-17 12:22:53","false","docker: ignore ""repeats json tag"" lint error

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",42,29,0,1
"containers/buildah","473886f81777277878ad3eef859fbbe6e54f9743","QiWang19","2019-03-18 18:40:35","false","fix bug to not separate each --label value with comma

fix #1414
Change `StringSliceVarP` to `StringArrayVarP`. Avoid to separate each flag value with comma.
After this patch

""Labels"": {
                ""exec"": ""podman run -it --mount=type=bind,bind-propagation=Z,source=,destination= /script"",
                ""maintainer"": ""Clement Verna <cverna@fedoraproject.org>""
            }

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1416
Approved by: rhatdan",37,26,0,1
"containers/buildah","5a999cfbd582e013982590b8ee8150bf9bf02379","giuseppe","2022-02-14 13:38:10","true","buildah: new global option --cgroup-manager

allow to override the cgroup manager with a global option
--cgroup-manager=MANAGER that has the same semantic as Podman.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",29,61,1,1
"containers/buildah","fa2ae6a2397d65c27af653361c6467c3bc968250","pixdrift","2018-05-11 17:05:48","false","Update buildah scratch demo to support el7

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #679
Approved by: rhatdan",56,15,0,0
"containers/buildah","8d2a9401d7eef47d275681b473d19491a45005fe","jacobwgillespie","2021-06-22 20:45:09","true","Add `--env` and `--workingdir` flags to run command

Signed-off-by: Jacob Gillespie <jacobwgillespie@gmail.com>",37,53,1,0
"containers/buildah","031fd8877c1201edcb5a06149c8ceebf890f4140","TomSweeneyRedHat","2019-04-26 15:25:40","false","Touch up 1.9-dev to 1.9.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1555
Approved by: rhatdan",52,27,0,1
"containers/buildah","ab8678ad84958c79a7f321602b1b6467522c8d21","TomSweeneyRedHat","2019-05-09 21:07:10","false","Get CHANGELOG.md updates

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1585
Approved by: rhatdan",58,27,0,1
"containers/buildah","db59421d527abc49bfbca531aacedbb2b907ef36","TomSweeneyRedHat","2019-12-12 19:08:20","false","Allow ADD to use http src

In #1977 we disallowed the use of a URL for both the
COPY and ADD commands in a Dockerfile.  Upon further
reflection we should have done that only for the COPY
command.

Addresses: https://github.com/containers/libpod/issues/4686

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2019
Approved by: rhatdan",88,34,0,1
"containers/buildah","3a351f60326e3cc0a099042c130d04b6b988cf02","flouthoc","2023-06-05 07:04:17","true","parse: use GetTempDir from internal utils

Use a common code for `GetTempDir`

[NO NEW TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",17,76,1,1
"containers/buildah","d7e0993090466ffb89bfaf19e08ce6edf228eafd","QiWang19","2018-11-10 19:38:35","false","Add Tag column in images output

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1170
Approved by: rhatdan",62,21,0,1
"containers/buildah","4d514422d18dd8c3880bfeae265b966ecbf9dc7f","openshift-merge-robot","2021-11-05 18:27:55","true","Merge pull request #3615 from nalind/docker-variant

config: support the variant field",29,57,1,1
"containers/buildah","f847463ed66de9aa1e6512a3b883f89d353201da","rhatdan","2023-04-05 13:14:38","false","vendor in latest containers/(storage, image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",10,74,1,1
"containers/buildah","5b281d7cf44110c6cb172254f348be1e035374e3","nalind","2017-06-01 16:05:17","false","Makefile: add source deps for the CLI tool

The commit logic incorporates routines from the 'util' subdirectory, so
add it as a build-time dependency to check.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #141
Approved by: rhatdan",13,4,0,1
"containers/buildah","499f1301f858ebae6443d338fde49ddf78974a0c","nalind","2023-03-15 20:50:51","false","Re-enable conformance tests

Just ignore the new moby.buildkit.buildinfo.v1 field in the Docker
format.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",15,74,1,1
"containers/buildah","c8002d97394eeecbccf48e1e4cc5238ea4e27a67","ashley-cui","2021-04-16 22:21:31","false","Add support for secret mounts

Add support for secrets. Secrets is a two-part flag that allows secret files to
be accessed for a certain RUN instruction, but not any other
instructions, as well as now showing up in the final image.

Signed-off-by: Ashley Cui <acui@redhat.com>",53,51,0,0
"containers/buildah","d4ddf5740346b6ce49fc86ec3836eda74f30a519","TomSweeneyRedHat","2019-02-02 23:31:44","false","Add --target to bud command

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Add the --target option to the bud command.  This allows the
user to specify the last stage to build in a multi stage
Dockerfile.

Addresses #632

Tests:
```
cat ./bud/target/Dockerfile
FROM ubuntu:latest
RUN touch /1

FROM alpine:latest AS mytarget
RUN touch /2

FROM busybox:latest AS mytarget2
RUN touch /3

buildah bud --debug=false -t tom --target mytarget ./bud/target .
STEP 1: FROM ubuntu:latest
STEP 2: RUN touch /1
STEP 3: FROM alpine:latest AS mytarget
STEP 4: RUN touch /2
STEP 5: COMMIT containers-storage:[overlay@/var/lib/containers/storage+/var/run/containers/storage]localhost/tom:latest
Getting image source signatures
Skipping blob 503e53e365f3 (already present): 5.52 MiB / 5.52 MiB [=========] 0s
Copying blob 66e5f29a7649: 3.50 KiB / 3.50 KiB [============================] 0s
Copying config e72f1fa3d72d: 704 B / 704 B [================================] 0s
Writing manifest to image destination
Storing signatures
--> e72f1fa3d72ddd3f23acb22a059ecce33dad571433223389e3ce92a5fd9ebae5
STEP 6: COMMIT containers-storage:[overlay@/var/lib/containers/storage+/var/run/containers/storage]localhost/tom:latest
Getting image source signatures
Skipping blob 503e53e365f3 (already present): 5.52 MiB / 5.52 MiB [=========] 0s
Skipping blob 66e5f29a7649 (already present): 3.50 KiB / 3.50 KiB [=========] 0s
Copying config e72620d8efe7: 704 B / 704 B [================================] 0s
Writing manifest to image destination
Storing signatures
--> e72620d8efe764178d1352dfb3a9a773794309ee9e879e17d3803b18553f5025

buildah images
IMAGE NAME                                               IMAGE TAG            IMAGE ID             CREATED AT             SIZE
docker.io/library/ubuntu                                 latest               20bb25d32758         Jan 22, 2019 17:41     90 MB
docker.io/library/alpine                                 latest               caf27325b298         Jan 30, 2019 17:19     5.8 MB
localhost/tom                                            latest               993ee7ded616         Feb 5, 2019 13:49      5.8 MB
```

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1321
Approved by: vrothberg",57,24,0,1
"containers/buildah","c2dc46a478193af662f428db709c9466d7f6b512","TomSweeneyRedHat","2019-10-28 16:05:48","false","Bump back to v1.12.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1946
Approved by: rhatdan",80,33,0,1
"containers/buildah","97b84029a9e4700cd88d7465afd9da3c7730fb4f","flouthoc","2023-07-03 06:22:59","true","contrib/buildahimage: set config correctly for rootless build user

For image published at `quay.io/containers/buildah` buildah should
correctly use `fuseoverlay` for rootless `build` user `fuse-overlayfs`.

Closes: https://github.com/containers/buildah/issues/4669

[NO NEW TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",14,77,1,1
"containers/buildah","0c8bb1d1cee3049f6ff95298fe58c86896a3078d","vrothberg","2019-06-26 08:00:37","true","Merge pull request #1691 from rhatdan/master

Update buildah-login.md",43,29,0,1
"containers/buildah","be0c8d263bc407342e3d86abebb198769d86d333","dougsland","2019-03-20 20:34:30","false","golint: make golint happy

should omit type ... from declaration of var ...; it will be
inferred from the right-hand side

Signed-off-by: Douglas Schilling Landgraf <dougsland@redhat.com>

Closes: #1426
Approved by: nalind",36,26,0,0
"containers/buildah","6124673bbc03df173670daa5bfcfe2d58751cfa0","TomSweeneyRedHat","2017-10-02 13:01:45","false","Add further tty verbiage to buildah run

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #276
Approved by: rhatdan",31,8,0,1
"containers/buildah","1485238f2765ac476ee99cd7e6e9fdf61c69b56c","TomSweeneyRedHat","2023-07-05 18:01:03","true","Merge branch 'main' into image-set-config-build",13,77,1,1
"containers/buildah","ddbd8053fd0a8451588bf5c01667d483adf8e8e1","TomSweeneyRedHat","2019-04-26 23:39:16","false","Handle WORKDIRs that are symlinks

When a Dockerfile specified a WORKDIR that was
a symlink, the EnsureContainerPath() function
did not resolve the link to it's target and
caused failures.

Fixes: #1537

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1558
Approved by: rhatdan",53,27,0,1
"containers/buildah","dc49c3cb4d77a2fd1866c16e8d7ef52cf23174ed","dfr","2022-08-05 16:58:53","false","chroot: Move parseRLimits and setRlimits to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",18,66,1,0
"containers/buildah","60b625ceed173dcec816fd897bf2b2e07edb74cb","flouthoc","2022-06-02 19:04:24","true","cli remove stutter

Signed-off-by: Aditya R <arajan@redhat.com>",25,64,1,1
"containers/buildah","bc9d574c1071052393463787049c879ed394ca2d","umohnani8","2018-02-01 17:46:23","false","Add new line after executing template for buildah inspect

No new line was returned when using the --format flag for buildah
inspect.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #442
Approved by: rhatdan",44,12,0,1
"containers/buildah","798fd3117bff0922516ad9893d4fe4899f7fa2d0","rhatdan","2023-09-14 00:55:51","true","Merge pull request #5039 from Luap99/libimage-remote

Move code around to not require libimage",5,80,1,1
"containers/buildah","9f7a94f34a7461b173d4288a1a43bc172f6f3b4d","rhatdan","2022-10-28 09:10:10","true","Merge pull request #4386 from flouthoc/fix-arg-test-for-remote

test: fix prune logic for cache-from after adding content summary",24,69,1,1
"containers/buildah","b75bf0a5b3fbda9eae85a15e2ad4cb317d6f3326","rhatdan","2018-02-23 15:54:23","false","Currently buildah run is not handling command options correctly

This patch will allow commands like

buildah run $ctr ls -lZ /

To work correctly.

Need to update vendor of urfave cli.

Also changed all commands to no longer accept global options after the COMMAND.
Single boolean options can now be passed together.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #493
Approved by: rhatdan",17,13,0,1
"containers/buildah","0687e192d7c4b3bc0906e7394153b957a824f171","rhatdan","2018-03-30 22:20:50","false","Vendor in latest containers/image

Some more features.
docker-archive generates docker legacy compatible images
Do not create $DiffID subdirectories for layers with no configs
Ensure the layer IDs in legacy docker/tarfile metadata are unique
docker-archive: repeated layers are symlinked in the tar file
sysregistries: remove all trailing slashes
Improve docker/* error messages
Fix failure to make auth directory
Create a new slice in Schema1.UpdateLayerInfos
Drop unused storageImageDestination.{image,systemContext}
Load a *storage.Image only once in storageImageSource
Support gzip for docker-archive files
Remove .tar extension from blob and config file names
ostree, src: support copy of compressed layers
ostree: re-pull layer if it misses uncompressed_digest|uncompressed_size
image: fix docker schema v1 -> OCI conversion
Add /etc/containers/certs.d as default certs directory

Signed-off-by: Daniel J Walsh dwalsh@redhat.com
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #546
Approved by: rhatdan",23,14,0,1
"containers/buildah","4d9a035e789852869212aa8578f3fc9cfc7607a5","dfr","2022-06-15 10:28:13","false","Move setupTerminal to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","b574b806e4a3207dfe1f2fc12c7c43931ad3083c","danishprakash","2023-09-05 11:13:44","true","imagebuildah: consider ignorefile with --build-context

Signed-off-by: danishprakash <danish.prakash@suse.com>",6,79,1,0
"containers/buildah","a15607b862109d3eb0dd767848962231986dbf0d","TomSweeneyRedHat","2019-12-26 16:12:17","false","Bump to c/storage v1.15.5

Bumping c/storage to v1.15.5.  Once merged I'll spin up
a Buildah v1.13.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2050
Approved by: rhatdan",97,35,0,1
"containers/buildah","5e3515c5b09fe706d32bd4443800a996138516b2","TomSweeneyRedHat","2021-05-19 21:36:09","false","Bump to v1.21.0 - [NO TESTS NEEDED]

[NO TESTS NEEDED] As the title says

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",55,52,1,1
"containers/buildah","d0de60bbf34d7e97d08f8652abf794c3b66e47a1","TomSweeneyRedHat","2023-06-30 14:39:53","false","Bump 1.31.0

As the title says.  In preparation of RHEL 8.9/9.3

[NO NEW TESTS NEEDED]

Signed-off-by: Tom Sweeney <tsweeney@redhat.com>",13,77,1,1
"containers/buildah","aeac8e964776f973c759c8458f51f9b0c9a797eb","TomSweeneyRedHat","2018-10-16 23:57:59","false","Check for empty buildTime in version

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1107
Approved by: rhatdan",55,21,0,1
"containers/buildah","14eb2f1a1cb5c0431d453d8d54000dd1f71e8339","rhatdan","2023-04-16 11:09:05","true","Merge branch 'main' into bind-mount-relabel",12,75,1,1
"containers/buildah","e224ff808774737d1523320b849124c1d2f5141e","nalind","2019-02-18 21:56:20","false","imagebuildah: move some fields around

Move around some of the fields in the imagebuilder.Executor structure.
Initialize the imageMap map when we initialize the structure that
contains it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1420
Approved by: rhatdan",58,25,0,1
"containers/buildah","2994914aba0fc44ff7b37f87ce4cea0bbb6ccd1a","nalind","2018-06-12 01:50:01","false","bind: factor out UnmountMountpoints

Factor out logic for unmounting our bind mounts, and make use of the
parent/child relationship between mountpoints to decide which order to
use, rather than sorting based on their mountpoint paths.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #800
Approved by: rhatdan",33,16,0,1
"containers/buildah","f51e520e99c8d958c7538acdeabd9e50e65d1522","nalind","2017-03-15 20:44:52","false","Add a library function for listing all builders

Add OpenAllBuilders(), for listing all open builders.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,2,0,1
"containers/buildah","76342e2eb3a3c893e5bb525653883bcdc98d8c7f","mtrmac","2018-08-04 00:54:39","false","In resolveImage, return immediately on success

... instead of breaking out of the loop and returning.

This will eventually allow us to differentiate between finding
an image and exhausting all options.

Should not change behavior.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #909
Approved by: rhatdan",22,18,0,1
"containers/buildah","54bd795809d7dceeb70b56c43b1b6f61abd6031d","openshift-merge-robot","2021-03-08 13:36:53","true","Merge pull request #3067 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.7.2

build(deps): bump github.com/fsouza/go-dockerclient from 1.7.1 to 1.7.2",57,49,0,1
"containers/buildah","be69fca34353fc3cb989774f8b75405a2a21d6bb","openshift-merge-robot","2023-03-29 22:03:41","true","Merge pull request #4673 from flouthoc/label-only-image

imagebuildah: only apply label on the final image instead of intermediate images",13,74,1,1
"containers/buildah","fc4c2635373e5b504b4a280cd7089f67482e671a","openshift-merge-robot","2021-11-30 09:24:21","true","Merge pull request #3657 from nalind/mediaType

image: set MediaType in OCI manifests",30,58,1,1
"containers/buildah","dc3a381fe2a33717b8942ec4fe1f248bcc583a95","nalind","2022-04-27 20:56:14","false","copier.PutOptions: add StripSetuidBit/StripSetgidBit/StripStickyBit

Add StripSetuidBit/StripSetgidBit/StripStickyBit flags to
copier.PutOptions, that are interpreted similarly to their counterparts
in copier.GetOptions.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",25,63,1,1
"containers/buildah","c654b18cad1fa1dc6a5d9b05c31ae09b4036ddda","nalind","2019-05-08 19:53:05","false","commit/push: use an everything-allowed policy

Ignore the global signature policy, which is used to control whether or
not we can trust an image, when we're attempting to commit an image from
a container, or pushing an image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1579
Approved by: rhatdan",55,27,0,1
"containers/buildah","ff8cfe7c3f0e5061585b993344ace1266f77c503","nalind","2020-09-16 14:52:01","false","Add(): fix handling of relative paths with no ContextDir

Add() is supposed to handle relative paths when the ContextDir value
passed to it is not set, but it hasn't been doing that correctly since
it was overhauled.  Correct it to recognize relative paths at the
function start, when ContextDir is not set, by combining them with the
current directory to convert them to absolute paths.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",92,44,0,1
"containers/buildah","6e6827b2703e74c96dfffdbfde914a5098b20d9b","Luap99","2023-09-12 12:23:29","true","Move most of internal/parse to internal/volumes

internal/parse does not need to depend on libimage.
This allows for a smaller podman remote client.

Based on Miloslav's work: https://github.com/containers/podman/pull/19718

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",5,79,1,0
"containers/buildah","b55f151fb8d73c69b4a0f3012c52e416fc828dd3","openshift-merge-robot","2022-07-21 12:24:31","true","Merge pull request #4127 from containers/dependabot/go_modules/github.com/onsi/gomega-1.20.0

build(deps): bump github.com/onsi/gomega from 1.19.0 to 1.20.0",19,66,1,1
"containers/buildah","c933fe4bc608676d308ffcb276b7d8561a18e94d","nalind","2019-03-18 15:20:24","false","imagebuildah.Build: consolidate cleanup logic

Consolidate all of the logic related to cleaning up after a build into a
helper function in Build().  This lets us ensure that we always clean up
images after cleaning up containers, so that we don't have to worry
about ordering when some images may be in use by containers because we
wanted access to a root filesystem for a stage whose image was reused.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1446
Approved by: vrothberg",37,26,0,1
"containers/buildah","abf01462b0856adc26df4adfa64a295cbe458d47","nalind","2017-04-19 12:56:37","false","Pin gopkg.in/yaml.v2

Update and pin the version of gopkg.in/yaml.v2 that we vendor.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",13,3,0,1
"containers/buildah","e3cd4d7904366e2e240b7b4911c465f73d87bbdc","nalind","2023-08-12 00:25:21","false","Clear CommonBuildOpts when loading Builder status

When creating or loading a builder, ensure that its CommonBuildOpts
struct is not nil, to comply with an assumption that we keep making.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",9,78,1,1
"containers/buildah","6d85cd3f7d3925c68b89f7a13eddcdae2722eff0","14rcole","2017-06-21 14:54:43","false","update 'buildah images' and 'buildah rmi' commands

add more flags to `buildah images` and `buildah rmi`, and write tests

Signed-off-by: Ryan Cole <rcyoalne@gmail.com>

Closes: #155
Approved by: rhatdan",14,5,0,0
"containers/buildah","fa71977101a67fffd20b0854d9834393389e91b2","rhatdan","2019-02-19 21:59:59","false","Support oci layout format

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1319
Approved by: rhatdan",59,25,0,1
"containers/buildah","15114d97a1e93debb2a3c76620bd522127dc190a","rhatdan","2023-03-02 13:40:03","true","Merge pull request #4634 from flouthoc/dont-warn-multi-arch

executor: don't warn about unused `TARGETARCH`,`TARGETOS`,`TARGETPLATFORM`",18,73,1,1
"containers/buildah","80870d50bd8390e766a08453122ad593dc31b153","rhatdan","2022-07-15 16:47:14","false","Vendor in latest containers/(storage, common, image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",25,66,1,1
"containers/buildah","ac2aad63436e5eabdd8d49d712bee5cf637dd59a","rhatdan","2017-07-18 20:07:48","false","Update the version number we identify as to 0.2.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #199
Approved by: nalind",18,6,0,1
"containers/buildah","8e48a65d5b22366c2e4946d6e41788365acc7ae2","rhatdan","2019-05-21 15:01:18","false","Rework buildahimamges

mv images to contrib subdir
Remove code to setup link between /root/container->/var/lib/container
This is no longer needed.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1605
Approved by: TomSweeneyRedHat",56,28,0,1
"containers/buildah","873ecd8791ba0085c0258426d6e8bd4be5759218","rhatdan","2018-02-26 00:03:03","false","If commonOpts do not exist, we should return rather then segfault

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #498
Approved by: TomSweeneyRedHat",18,13,0,1
"containers/buildah","724ef7c710eca2a5829c4a323101ec8d2dc7bd37","rhatdan","2022-08-22 11:42:15","true","Merge pull request #4194 from Juneezee/test/t.TempDir

test: use `T.TempDir` to create temporary test directory",18,67,1,1
"containers/buildah","3a849c02a6f1c4ff2bd862f12261e17cdde8bdfb","rhatdan","2018-06-12 21:21:08","false","Add environment variable BUILDAH_RUNTIME

Allow user to setup alternate runtimes to use rather then
runc.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #786
Approved by: rhatdan",34,17,0,1
"containers/buildah","326d07e17798dd1c7e95d2bd4be7e7d7d776dd72","rhatdan","2018-10-05 15:35:37","false","Vendor in latest containers/storage and containers/image

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1070
Approved by: nalind",51,20,0,1
"containers/buildah","f4424ca9e841b6c12a5f6587050e0dbd7e896121","rhatdan","2021-01-21 13:29:21","false","Pick default OCI Runtime from containers.conf

Currently we have a weird situation where the user sets the default
runtime in his containers.conf for podman but Buildah is still falling
back to use runc because it was hard coded as the default for Buildah.

I would like to remove this default, but that would theoretically break
the API promise of Buildah.

This should fix https://github.com/containers/podman/issues/8893

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",96,48,0,1
"containers/buildah","2f113ca2ef4cbf8f8f76c83297b4aaca7d774dd4","nalind","2018-07-31 22:06:15","false",".travis.yml: run integration tests with BUILDAH_ISOLATION=chroot

Run integration tests with both BUILDAH_ISOLATION=rootless, in addition
to previously-enabled tests for ""oci"" and ""chroot"".

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #873
Approved by: rhatdan",31,18,0,1
"containers/buildah","52b13eec59aa8e876a193ccc7fa7105e04aa3235","nalind","2017-04-11 21:12:27","false","Pin github.com/opencontainers/{go-digest,selinux}

Pin the versions of github.com/opencontainers/go-digest and
github.com/opencontainers/selinux that we vendor.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",13,3,0,1
"containers/buildah","52e273746076cf44f37286a953a44c046b5a0956","nalind","2017-11-03 17:04:43","false","Rework how we do UID resolution in images

* Use chroot() instead of trying to read the right file ourselves.

This should resolve #66.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #313
Approved by: rhatdan",32,9,0,1
"containers/buildah","5f8011d5fdf38c60a66c828853b888b96912cfda","rhatdan","2022-09-29 09:59:59","true","Merge pull request #4299 from rhatdan/VENDOR

Vendor in latest containers/storage",20,68,1,1
"containers/buildah","04a9fceaae876708653444e19cf5810f74f699fd","rhatdan","2017-06-07 21:03:26","false","Vendor in latest container/storage

container/storage now supports remote shares and having a configuration
file.  We need to merge this to demonstrate using buildah with nfs shares.

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #145
Approved by: nalind",13,4,0,1
"containers/buildah","360add7d95da330de68060b148c3a4fa5cc374e5","rhatdan","2022-03-11 09:59:58","true","Merge pull request #3817 from containers/dependabot/go_modules/github.com/docker/docker-20.10.13incompatible

build(deps): bump github.com/docker/docker from 20.10.12+incompatible to 20.10.13+incompatible",31,62,1,1
"containers/buildah","d2a3249ab6efd4508e2fe4229871f4b1bb5cf810","rhatdan","2019-07-19 11:24:02","false","Bump to v1.9.2

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",49,30,0,1
"containers/buildah","a60ba7df6de2b5610b70ffb195f0387bc37b2d9e","rhatdan","2023-08-25 19:16:55","true","Merge pull request #4991 from cevich/lock_closed_issues_prs

[skip-ci] GHA: Closed issue/PR comment-lock test",8,79,1,1
"containers/buildah","811822eb546f3519ecc70abb4a11927a1010d62a","rhatdan","2021-02-12 15:24:33","false","Revert patch to allow COPY/ADD of empty dirs.

This Patch breaks conformance with Docker.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",61,49,0,1
"containers/buildah","7a22c40edcd47c71c51b07e5ac680fb7b3d592f2","flouthoc","2022-07-01 10:21:11","true","add: fail on bad http response instead of writing to container

Adding sources from URL using `ADD` instruction adds reponse to build
container even if it receives bad HTTP response, following behaviour is
not in parity with `docker` or `buildkit`.

Following commit ensures that `ADD` where source is external URL fails
on build step if we get bad HTTP response.

Example: Following containerfile should fail while building

```Dockerfile
FROM registry.fedoraproject.org/fedora:36
ADD https://mirror.init7.net/fedora/fedora/linux/releases/36/Server/x86_64/iso/Fedora-Server-netinst-x86_64-36-1.5.foo /
```

**Fixes: BZ#2102140**

Signed-off-by: Aditya R <arajan@redhat.com>",21,65,1,1
"containers/buildah","5fcaff63b042a7ac2edc7d55802974de4cff0127","flouthoc","2022-03-08 20:53:20","true","test: unshare mount/umount if test is_rootless

Mount and umount can must be unshared for rootless environment.

Co-authored-by: Ed Santiago <santiago@redhat.com>
Signed-off-by: Aditya R <arajan@redhat.com>",30,61,1,1
"containers/buildah","120edb6ac6ea2f0481c3f59a2850552e0caf632c","cevich","2021-01-05 15:29:58","true","Cirrus: Clarify task names / improve readability

This change mirrors a similar change made in early 2020 for the
containers/podman repository.  Primarily, it alters the appearance of
the task names in the Github WebUI to be more readable by humans.
Also, the former ""gate"" task is renamed to ""smoke"".  This prevents
confusion with downstream Fedora/RHEL post-packaging testing which
is(also referred to as the ""gate"" tests.

Finally, task-dependencies are altered to support a cleaner flow which
will be implemented in a future commit.

Signed-off-by: Chris Evich <cevich@redhat.com>",90,47,0,1
"containers/buildah","01ba9332c8a9ab22aba4d579778ddce9cba80c0d","rhatdan","2023-02-24 18:03:29","true","Merge pull request #4624 from containers/dependabot/go_modules/github.com/containers/storage-1.45.4

build(deps): bump github.com/containers/storage from 1.45.3 to 1.45.4",16,73,1,1
"containers/buildah","66c752bc54b5e8f03376e5a31bd61185ce1363e7","boaz0","2018-03-20 11:31:51","false","Add unit tests to run.go

* Changed addHostsToFile to make it easy to test
* Changed .travis.yml and Makefile to run all unit tests except ./tests/
* Added unit-tests to addHosts, addHostsToFile and addRlimits

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>

Closes: #529
Approved by: rhatdan",19,14,0,0
"containers/buildah","e8c123cc033e39079de9b04e352fbd0800210c28","rhatdan","2018-08-14 12:39:18","false","Change references to projectatomic/libpod to containers/libpod

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #928
Approved by: umohnani8",23,19,0,1
"containers/buildah","87e379d5b7d50ac9da567affd91d7346de7b4302","mwq","2022-10-25 08:15:53","true","Fix word missing in Container Tools Guide

Signed-off-by: Mattias Warnqvist <mwq@users.noreply.github.com>",25,69,1,0
"containers/buildah","98526091348ce29d689c7cd7fb42c8be9a703545","giuseppe","2022-03-30 12:49:42","true","copier: attempt to open the dir before adding it

it is needed to fix a failing test.

commit 985eec53912a5afaabe3a4abdfa054231f03ce38 changed the behavior
since the directory is not opened first before adding it.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",28,62,1,1
"containers/buildah","4547ae025ca1d7afce853974a42b55e95d981ab8","dfr","2022-04-28 09:58:10","false","Fix docs build on FreeBSD

The sed implementation has a strict interpretation of posix 'basic'
regular expressions. It would be better to re-implement this using
'extended' regular expressions but for now, just use GNU sed.

Signed-off-by: Doug Rabson <dfr@rabson.org>",25,63,1,0
"containers/buildah","216aeec8ab3759a7393685c2f281e1182b44ccb4","TomSweeneyRedHat","2019-08-02 15:31:21","false","Bump to v1.11.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",49,30,0,1
"containers/buildah","fbab7d4705e52b076af7e1c1e9cc4aedac2664b1","TomSweeneyRedHat","2020-02-06 00:37:14","false","Bump to v1.15.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",110,36,0,1
"containers/buildah","2191ba6d3f3740f44ba99aa0eae165612e68d64c","TomSweeneyRedHat","2019-06-11 20:24:16","false","remove --> before imgageID on build

Remove the `-->` from in front of the imageID that's printed in
the last line of output from a `buildah bud` command.

Fixes: https://github.com/containers/libpod/issues/3191

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1667
Approved by: @rhatdan",43,28,0,1
"containers/buildah","a8ed3bb58ae8f5d1a2702e34b75bee4de8d0220f","cevich","2023-02-15 22:20:33","true","Skip subject-length validation for renovate PRs

Renovate opens PRs with subject-lines which can easily exceed the
72-character limit imposed (for stylistic reasons) on PRs.  However, in
the context of a dependency update, the extra detail is helpful to
human reviewers.  Add a conditional in the workflow to bypass this check
when it appears to be coming from a 'renovate/*' branch.

Signed-off-by: Chris Evich <cevich@redhat.com>",19,73,1,1
"containers/buildah","dc5c30c289f8d628c7b17191be18ddb37296806c","nalind","2022-05-03 17:24:33","false","buildah.BuilderOptions.DefaultEnv is ignored, so mark it as deprecated

Any `buildah.BuilderOptions.DefaultEnv` values have been ignored since
the libary was changed to read them from the server-side configuration,
for the sake of podman remote builds.  Update its godoc to note that and
stop setting it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",24,63,1,1
"containers/buildah","1bfac2b3c648bafcac7bb601fe73dd5ee65d8d7f","nalind","2019-05-29 23:56:28","false","add: use fileutils.PatternMatcher for .dockerignore

Use a fileutiles.PatternMatcher, which works better for this case than
filepath.Match, to check if an item that we're copying is marked for
exclusion by .dockerignore.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1626
Approved by: TomSweeneyRedHat",57,28,0,1
"containers/buildah","3e1e5d4a3e4fb24a9e83f624e43554eba8062777","nalind","2019-07-16 14:23:18","false","bump github.com/opencontainers/runtime-tools to v0.9.0

Update runtime-tools to v0.9.0.  This requires a newer version of
runtime-spec, so pull one in, too.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1720
Approved by: vrothberg",48,30,0,1
"containers/buildah","0a8bdef96c56bc74fcd2f68bb0a15d177c89450a","nalind","2018-06-15 02:03:55","false","Allow --userns-uid-map/--userns-gid-map to be global options

Allow --userns-uid-map and --userns-gid-map to be specified as global
options, which can be overridden by options specified to commands which
know them as non-global options.

This will mainly benefit tools that want to set ID mappings for buildah
to use, but which don't want to have to figure out whether or not
they're invoking it with a subcommand that recognizes these options.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #803
Approved by: rhatdan",30,17,0,1
"containers/buildah","a12f1854545c645d882fb240474449ccdb98248a","nalind","2020-10-26 21:00:09","false","tests/testreport: adjust for API break in storage v1.23.6

The containers/storage update incorporates a change to a module that it
vendors (github.com/moby/sys/mountinfo) which changes renames a few of
the fields in the structure returned by
github.com/containers/storage/pkg/mount.GetMounts():

  Opts -> Options
  Fstype -> FSType
  VfsOpts -> VFSOptions

Adjust one of the test helpers so that it continues to build.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",64,45,0,1
"containers/buildah","c83cd3fba9e08f6e3c675b22a36050d967cba6d2","nalind","2017-11-02 17:39:56","false","Accept numeric USER values with no group ID

Change our behavior when we're given USER with a numeric UID and no GID,
so that we no longer error out if the UID doesn't correspond to a known
user so that we can use that user's primary GID.  Instead, use GID 0.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #313
Approved by: rhatdan",30,9,0,1
"containers/buildah","9cb2e7b62b92e45790c5640827f0b7c58ab4dea9","nalind","2017-03-22 14:09:55","false","Merge pull request #16 from nalind/cli-parsing

Changes to the CLI parsing and --help output",11,2,0,1
"containers/buildah","0a61e4b2803c24f64422a12d1ec64a206eb1b60a","dfr","2022-08-05 13:46:15","false","chroot: Factor out Linux-specific unshare options from runUsingChroot

Signed-off-by: Doug Rabson <dfr@rabson.org>",18,66,1,0
"containers/buildah","2249ba3a8b88c4023fc029da56af952023604ffd","QiWang19","2019-07-15 18:33:06","false","fix push check image name is not empty

Close #1708

This PR check the input image name is not a nil string if both image name and registry are provided. Avoid triggering go segmentation violation later in the code.

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1717
Approved by: vrothberg",49,30,0,1
"containers/buildah","7b15d262481b9499bd68b5ddd6a53d43a90cf5db","leighmcculloch","2021-09-06 07:09:57","false","Fix build with .git url with branch

The build with git URL recognizes git URLs by either a git:// scheme prefix, or
any other URL with other schemes such as https:// and a .git suffix.

The build with git URL and branch recognizes the branch name as the fragment
part of the URL, the part after the #.

The .git suffix check is performed by checking that the suffix of the full URL
is .git, however this causes URLs that begin with scheme https://, and have a
.git path suffix, to not be recognized as git URLs when a branch name is
appended.

The logic for checking if the URL path is suffixed with .git should parse the
URL first and consider only the path when looking for the suffix. This change
is implemented in this commit.

This commit also removes the guard within the cloneToDirectory function because
it is unnecessary since every location the function is called the check has
already been carried out.

Signed-off-by: Leigh McCulloch <351529+leighmcculloch@users.noreply.github.com>",36,55,1,0
"containers/buildah","25b7c1164a262934a6526ded1115dfacfc51f8ec","edsantiago","2019-04-05 15:59:54","false","oops, missed some tests in commit.bats

...also, update from rebase

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1472
Approved by: TomSweeneyRedHat",52,26,0,1
"containers/buildah","50be5719e09243b4d30a248a72eb6fd2b217b45a","openshift-merge-robot","2020-10-12 16:50:53","true","Merge pull request #2687 from containers/dependabot/go_modules/github.com/containers/common-0.25.0

build(deps): bump github.com/containers/common from 0.24.0 to 0.25.0",63,44,0,1
"containers/buildah","0160a7757b5555e7c8a0a71cd11da8e11d362315","nalind","2019-04-23 19:09:01","false","run: check if SELinux is enabled

When we're built with support for SELinux, refrain from setting process
and mount labels if SELinux isn't detected as enabled at runtime.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1542
Approved by: rhatdan",52,27,0,1
"containers/buildah","69b0a82b77e85783c1508e54836eb489df4c3117","nalind","2018-06-01 20:59:27","false","runCollectOutput(): just read until the pipes are closed on us

runCollectOutput() tries to read error messages that may have been
written to pipes by the container runtime.  Instead of setting them to
non-blocking and producing an error when we fail to read data, leave
them blocking so that we wait until the write end of a pipe is closed
before we give up on reading from it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #754
Approved by: rhatdan",38,16,0,1
"containers/buildah","826733af7feb41df082468dbedc96a0f31626c98","nalind","2018-07-19 18:32:47","false","Avoid a stall in runCollectOutput()

Before calling runCollectOutput() to read error information from pipes,
make sure we've closed our handles to the writing ends of the pipes.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #872
Approved by: rhatdan",32,18,0,1
"containers/buildah","60b9159485a28438083aa1723db7e7403e93865c","nalind","2017-05-03 18:50:55","false","Add a ""go vet"" validation step

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #91
Approved by: rhatdan",9,3,0,1
"containers/buildah","75ae804029acaea58c3a35e393d21bc409fa980f","dfr","2022-06-15 11:08:07","false","Move DefaultNamespaceOptions to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","ac4b39a220cee20d7404700022803b48061a9322","dfr","2022-07-20 10:31:25","false","Rename chroot/run.go to chroot/run_linux.go

This is a precursor to adding isolation=chroot support for
FreeBSD.

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",20,66,1,0
"containers/buildah","2749191a5f47abf2fa10775b94071968e3de33b8","umohnani8","2018-05-16 16:38:11","false","buildah push/from can push and pull images with no reference

pushing with format <transport>:<path> is valid now.
Add support to pull images from oci-archive that have no image ref name.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #697
Approved by: rhatdan",61,16,0,1
"containers/buildah","77c6c2e9a9bcdf0a0c66bb904c426d98767f6e74","giuseppe","2018-10-31 15:21:52","false","vendor: update libpod

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1148
Approved by: rhatdan",56,21,0,1
"containers/buildah","b798e6a21ad92f1ed38f339e4f7e9edd8e82fbd5","giuseppe","2021-11-04 12:45:40","true","rootless: do not bind mount /sys if not needed

if the container is using a private network namespace, we can mount a
fresh /sys.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",29,57,1,1
"containers/buildah","962406aa36bf02557d626fa3f1e07345092746ee","nalind","2020-11-05 18:44:55","false","util: digging UID/GID out of os.FileInfo should work on Unix

Digging the UID and GID out of an os.FileInfo should work on all Unixy
systems, so move it from Linux-specific implementation file to a file
that we also build for Darwin.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",67,45,0,1
"containers/buildah","3b38b8ebbc17c238d89884dc780366f7eaf7bd87","nalind","2018-07-06 20:23:00","false","Don't pass a nil error to errors.Wrapf()

Don't pass a nil error value to errors.Wrapf() when we want to report an
error, since it's documented as returning nil for that case.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #856
Approved by: rhatdan",30,17,0,1
"containers/buildah","9d43eb95e5a30d54135519db5f1921e2b8ab8f87","flouthoc","2022-10-10 07:42:20","true","imagebuildah: warnOnUnsetBuildArgs while processing stages from executor

Before this commit buildah produces warning for UnsetBuildArgs at the
top level while preparing the build in `imagebuildah/build` hence it
makes it hard to honor certain logic like `do not produce warning for
stages which are not used` therefore move `warnOnUnsetBuildArgs` to
`imagebuldah/executor` so we can warn while processing each stage.

Following commit will prevent warning unnecessarily for stages which are
completely skipped.

Closes: https://github.com/containers/buildah/issues/4303

Signed-off-by: Aditya R <arajan@redhat.com>",28,68,1,1
"containers/buildah","a1ab16f4a38ff7fca29847d06d2fef8b65a1a88c","openshift-merge-robot","2023-03-15 23:44:56","true","Merge pull request #4665 from nalind/conformance-updates

Re-enable conformance tests",15,74,1,1
"containers/buildah","b74d71d5741cb71311ff69b59138041c8ccca089","flouthoc","2021-11-17 09:03:47","true","ssh-agent: Increase timeout before we explicitly close connection

There are cases where remote will close connection by itself with a message
make sure we give connection enough time instead of closing explictly
early.

Future improvement: Relay output and perform close instead of relying on  `ServeAgent` to flush
buffer by closing connection.

[NO NEW TESTS NEEDED]

Signed-off-by: Aditya Rajan <arajan@redhat.com>",27,58,1,1
"containers/buildah","46ffaf935474f685adf83fd62abe556b2a5f62c7","flouthoc","2023-03-02 09:03:47","true","executor,copy: honor default ARG value while eval stage

COPY must honor processing any argument if any configured while
evaulating `--from=` statement.

Makes below Containerfile functional without any external `--build-arg`
value from CLI

```Dockerfile
ARG my_env=a

FROM alpine as stage_a
RUN /bin/true

FROM alpine
COPY --from=stage_${my_env} /bin/true true
```

Closes: https://github.com/containers/buildah/issues/4573

Signed-off-by: Aditya R <arajan@redhat.com>",19,73,1,1
"containers/buildah","dfc9bb20e462f647e58541d462e5b6c1fccb6ddb","flouthoc","2023-03-20 08:31:55","true","executor: only apply label on the final stage

Buildah currently applies labels to each intermediate image which is not
the right thing to do since others builds uses these intermediate image
and they can inherit the label even though they never had this
intention.

Only apply labels to the final build i.e last instruction of last stage
which will make sure that labels are only applied to final image and not
to the intermediate images.

Closes: https://github.com/containers/buildah/issues/4632

Signed-off-by: Aditya R <arajan@redhat.com>",14,74,1,1
"containers/buildah","4782f85b1e8ccc944bcc588a9b5d30c5fe76a969","openshift-merge-robot","2022-04-05 02:27:51","true","Merge pull request #3897 from nalind/noise

Remove a stray `\` from .containerenv",26,62,1,1
"containers/buildah","dc6c82e2cbb1880263f8006826647a6f93a160c8","openshift-merge-robot","2022-04-02 03:32:03","true","Merge pull request #3893 from nalind/truncated-image-id-name

Create shorter names for containers based on image IDs",27,62,1,1
"containers/buildah","40317d62371b0a9b62cf9a7c9bc0a041bf7d5e1d","nalind","2021-10-04 21:27:02","false","docs/tutorials: update

Update tutorials to not expect `buildah run` to do anything if it isn't
given a command to run.  In some cases (including when we need to listen
for incoming connections when we might well not be root) this means we
use `podman run` instead.

Try to avoid using the terms container and image as though they're
interchangeable, which just creates confusion.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",44,56,1,1
"containers/buildah","00fafcf9cb0a588bff562768c222281228c94de7","nalind","2018-04-13 22:20:25","false","Use CNI to configure container networks

Use CNI to configure networks for containers for which we create new
network namespaces.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",32,15,0,1
"containers/buildah","a0710ffd715321f23d23dbaf5982c6a137e0eea9","nalind","2022-03-30 19:30:09","false","copier test: use correct UID/GID in test archives

Handing Put() an archive which uses host IDs while also including ID
maps for mapping from container IDs to host IDs is a mistake, and the
tests have been failing when run by non-root users since storage v1.38
started flagging it as such.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",27,62,1,1
"containers/buildah","1475aab7963e509a294976a845d9f24297425d06","nalind","2017-02-02 23:30:26","false","First pass at converting docker image configs

First pass at converting configuration information from docker images to
the OCIv1 format.  Fix time zones for dates.  Take a guess at fixing the
order of history items.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,0,0,1
"containers/buildah","43cc44ac8a9c59ea76b681321c57bea5c1c57158","nalind","2017-04-05 13:58:38","false","Turn off Travis builds against 1.6.

Some of our dependencies expect 1.7's ""context"" package and fields of
http.Transport which aren't in 1.6.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #65
Approved by: rhatdan",14,2,0,1
"containers/buildah","d3d9cecbf07cd1f78092354fecaa9acf1fcd6be1","rhatdan","2019-10-01 08:51:16","true","Merge pull request #1886 from containers/dependabot/go_modules/github.com/onsi/gomega-1.7.0

Bump github.com/onsi/gomega from 1.5.0 to 1.7.0",66,32,0,1
"containers/buildah","48c888a6b3298f5c16aabd683f021f896d7fdbba","vrothberg","2022-07-07 14:29:43","false","[CI:DOCS] improve pull-policy documentation

Going through containers/podman/issues/14846 let me improve the
code documentation in containers/common/pull/1085 which is now
copied over to Buildah and will eventually into Podman.

Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",23,65,1,1
"containers/buildah","37001d67e6fcc25eac0ed10215416e5cc02981e8","vrothberg","2019-06-18 11:24:04","false","rm chroot/util.go

The last remaining function is not being used anymore.

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","8badcc2d0229fde5ef3597c1066576fe8a638e7d","rhatdan","2018-02-12 16:48:48","false","Bump version to 0.12

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",16,13,0,1
"containers/buildah","6c1494c530e1aef965dbbffc89c9e9faa4f9e6e6","edsantiago","2020-09-21 14:51:19","false","New CI check: xref --help vs man pages

Run 'buildah --help', recursively against all subcommands,
then cross-reference the results against docs/buildah*.md.
Report differences in subcommands and/or flags.

The majority of the changes in this PR are trivial (see
below) but a handful may be controversial and require
careful review:

  * Making 'bud' the default output of 'buildah help',
    with 'build-using-dockerfile' as an alias. This is
    the inverse of the situation until now: buildah
    would list build-using-dockerfile as the primary
    name. The man page, OTOH, lists 'bud'. The source
    file name is 'bud'. I suspect that most people
    type 'bud'. So, for consistency, I choose to make
    'bud' the default visible command.

  * add --encryption-key and --encrypt-layer documentation
    to buildah-commit.md, and --encrypt-layer to -push.md.
    Please double-check the wording here.

  * remove --notruncate from buildah-images.md. The option
    does not exist (although there is a TODO comment in
    the code). If it should exist, it is left to the
    reader to implement. I would humbly suggest that this
    is a good idea, for consistency with buildah containers.

  * remove --shm-size from buildah-pull.md. The option
    does not exist, and I suspect this was a copy-paste error.

  * remove --security-opt from run.go. It was unimplemented
    and undocumented.

  * remove --userns-[gu]id-map from buildah-bud.md. These
    are global options, not bud options, and are documented
    well enough in buildah.bud.

Trivial (IMO) changes:

  * split options in man pages, from '**--foo, -f**'
    to '**--foo**, **-f**'. This conforms with the style
    used in podman man pages.

  * add missing one-letter aliases (usually ""-q"", ""-a"")

  * add missing man page entries for some easy options

  * sort out-of-order subcommand listings in man pages

Finally, do note that this is a copy-and-alter duplicate of the
original script in podman, and that is horrible. In an ideal
world I would've been able to refactor the podman version into
something usable on both repos (and then more). It turns out the
differences in man page format and in special-case handling are
too broad to let me do a clean refactor.

Signed-off-by: Ed Santiago <santiago@redhat.com>",91,44,0,1
"containers/buildah","dd02e709d6b7265d6d360c3d0284af0dd5f25668","pixdrift","2018-05-05 14:37:54","false","Add buildah bud ENTRYPOINT,CMD,RUN tests

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #656
Approved by: rhatdan",52,15,0,0
"containers/buildah","021d6072825ff94ce7fe0bd40e8414af62fac33d","edsantiago","2019-04-05 15:59:54","false","rename 'is' to 'expect_output'

...and make the ""$output"" argument implicit, as well as the
description text. This greatly simplifies its invocation.

Also: make it test for exact matches unless --substring
option is passed; this eases my mind about a few potentially
ambiguous situations such as the one in #1464.

Also: add comments to two truth-table check functions

Also: reorder some config checks alphabetically, for ease
of reading.

Thanks to Tom Sweeney for the suggestions and encouragement.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1492
Approved by: rhatdan",52,26,0,1
"containers/buildah","6cb7048d901213f0abe73b7d3e9669b274ccaad3","mtrmac","2018-06-11 22:41:11","false","Consolidate loading manifest and config in initConfig

Both callers of initConfig contain exactly the same code
to load the manifest and config; move it inside initConfig
now that initConfig has the necessary types.Image available.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #776
Approved by: rhatdan",33,16,0,1
"containers/buildah","8a6d84031c417f5f5feef6809611b87719a04239","openshift-merge-robot","2021-05-28 09:51:41","true","Merge pull request #3263 from rhatdan/contrib

Add volumes to make running buildah within a container easier",36,52,1,1
"containers/buildah","de9e71dda70930708f798e1f13767aa3f9e9013a","rhatdan","2018-01-18 19:19:45","false","Drop support for 1.7

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #400
Approved by: rhatdan",30,12,0,1
"containers/buildah","1edd64fb50454ac406f8c4f536c5f6c6aad67c9f","openshift-merge-robot","2022-06-03 15:28:57","true","Merge pull request #4031 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.8.0

build(deps): bump github.com/fsouza/go-dockerclient from 1.7.11 to 1.8.0",23,64,1,1
"containers/buildah","f1667f4a2e2c3ec335aa07a22c55483c7b62a77d","openshift-merge-robot","2022-03-30 20:19:20","true","Merge pull request #3837 from nalind/forward-signals

run: set parent-death signals and forward SIGHUP/SIGINT/SIGTERM",27,62,1,1
"containers/buildah","adbd7ef50d9f01cfcec9c98c2430e394db7139f1","flouthoc","2022-07-26 09:52:44","true","stage_executor, commit: output only if last stage in build

* Refactor: decouple commit and generateBuildOutput

* When processing multi-stage builds and `--output` is specified we tend to
generate `output` for every stage that is being built and getting
committed however we should not do that and we should only commit the
last or the target stage when performing a `mult-stage` builds so
following commit ensures that we only generate output from the `rootfs`
of the last/target stage.

Closes: https://github.com/containers/buildah/issues/4131

Signed-off-by: Aditya R <arajan@redhat.com>",19,66,1,1
"containers/buildah","3c243e8ea643da28a594cf0d101f9b1116c442e8","rhatdan","2018-04-24 12:04:45","false","Vendor in latest imagebuilder code to fix multiple stage builds

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #615
Approved by: TomSweeneyRedHat",38,15,0,1
"containers/buildah","a72aaa22689e1225c0072ca9c9cc34a972b86c6a","rhatdan","2017-09-22 13:06:18","false","Update buildah spec file to match new version

Match the version 0.4 in the spec file and add the
comments that went into Fedora release

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #269
Approved by: rhatdan",34,8,0,1
"containers/buildah","ef532adb2fa9cfcd6b2477b455f495426109fe1e","rhatdan","2017-08-15 15:38:46","false","Add build information for Ubuntu

We should document requied packages for installing on Ubuntu and Debian
to match up with the use on Fedora.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",27,7,0,1
"containers/buildah","2cf093c24bbbcd5883edd4ba3fe22e7eb389bb23","rhatdan","2022-10-29 15:16:51","true","Merge pull request #4389 from rhatdan/quiet

Remove quiet flag, so that it works in podman-remote",24,69,1,1
"containers/buildah","049cba908e983c3d7fb715994d7e7ed7ba6365a8","rhatdan","2021-01-27 21:25:17","false","Bump to containers/image v5.10.1

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",93,48,0,1
"containers/buildah","357e896619fcf75ecb04d66fd2955e95cc3ff64e","giuseppe","2018-10-23 10:09:03","false","common: honor the rootless configuration file

Closes: https://github.com/containers/buildah/issues/1113

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1124
Approved by: rhatdan",52,21,0,1
"containers/buildah","755f0f4411d9fd57e92206f3f6cf29854b5ff925","giuseppe","2018-12-12 10:03:24","false","mount: allow mount only when using vfs

when using a driver different than vfs, the mount is probably in a
different mount namespace thus not accessible from the host.  Avoid
the confusion by not allowing mount when a different driver is used.

Closes: https://github.com/containers/buildah/issues/1225

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1233
Approved by: rhatdan",49,22,0,1
"containers/buildah","26bc8fb769c0356d9daebd17886b9a6eaf0df028","nalind","2019-02-20 14:22:28","false","bud.bats: use the per-test temp directory

Use the per-test temporary directory for tests where we previously wrote
to the source tree and later tried to clean up after ourselves, so that
we don't leave files around if the tests fail.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1408
Approved by: rhatdan",60,25,0,1
"containers/buildah","d0719eef961982986ff553e3a8e5ff4c830170f8","nalind","2017-04-27 17:50:03","false","Bump golang.org/x/text

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #87
Approved by: nalind",9,3,0,1
"containers/buildah","59cfb7b16c37fc32abdecff36032c8b5a22f2758","rhatdan","2021-02-02 21:03:34","false","buildah manifest add localimage should work

Currently if you attempt to build create a manifest
and add a local image, the command blows up.

The current code always looks for a remote image.
This PR fixes the code to use the local image if it
exists.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",93,48,0,1
"containers/buildah","60d548032685924d56e520cc00cf17d6ea629c43","rhatdan","2019-08-09 20:51:18","true","Merge pull request #1777 from cevich/newer_images

Cirrus: Update VM images",53,30,0,1
"containers/buildah","f87df33111148405d2f8753eaedd2c528d7ecba1","rhatdan","2021-03-01 23:21:57","false","Check local image to match system context

Currently if you pull one image and then pullifmissing with
a different --arch, Buildah does not pull the different arch,
even though the arch is missing.

This PR checks the existing image to see if it matches the arch, os
and variant of the specified image, before using the local image.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",58,49,0,1
"containers/buildah","ddd83bc800f6a5384587d1707bd2e4a5a572f055","rhatdan","2023-08-11 08:41:23","true","Merge pull request #4965 from containers/renovate/ubuntu-22.x

chore(deps): update dependency ubuntu to v22",10,78,1,1
"containers/buildah","f13abea3c51434fb0580d0408f79ea449fc6e22a","rhatdan","2021-11-23 12:46:55","false","UPdate vendor of container/storage

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",29,58,1,1
"containers/buildah","b4f712fa756aeb10169d4b43eee83edc894d1604","giuseppe","2018-12-18 09:39:12","false","docs: mention how to mount in rootless mode

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1233
Approved by: rhatdan",53,23,0,1
"containers/buildah","7a5afdb452d6c58154dcfa02df2e9aeeb7102e9e","giuseppe","2019-06-12 10:19:28","false","run: fix hang when using run

make the stdin pipe not blocking, so that it won't hang if the other
end is not reading from it.

Closes: https://github.com/containers/buildah/issues/1664

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1668
Approved by: rhatdan",42,28,0,1
"containers/buildah","f9814601dd8ed2ba0972950b9ad167966b5a9c10","dfr","2022-07-25 10:19:27","false","chroot: Add FreeBSD support for run with chroot isolation

This copies a large amount of code from run_linux.go. Later diffs in
this stack will factor out duplicate code where possible.

Terminal handling is implemented using the posix_openpt API. We could
use the Linux implementation which uses the /dev/ptmx but that is not
present on standard FreeBSD installs - its supplied by an optional
kernel module. Conversely, posix_openpt could be used for both platforms
but has a downside of requiring cgo so its probably better to use this
only on FreeBSD.

Signed-off-by: Doug Rabson <dfr@rabson.org>",21,66,1,0
"containers/buildah","ed75e662d3ed7710df690a092e4cdccc692e7424","openshift-merge-robot","2020-10-08 18:46:00","true","Merge pull request #2678 from alvistack/master-linux-amd64

Update nix pin with `make nixpkgs`",61,44,0,1
"containers/buildah","bcaa18089b814c97c9da35780f76ab5f8309faba","openshift-merge-robot","2021-05-26 12:17:53","true","Merge pull request #3257 from containers/dependabot/go_modules/github.com/containers/common-0.39.0

Bump github.com/containers/common from 0.38.4 to 0.39.0",36,52,1,1
"containers/buildah","b82d08627f1a0d1f7970a208e670a98211135a34","rhatdan","2018-10-12 18:29:01","true","Merge pull request #1091 from rhatdan/podman

Podman  --privileged selinux is broken",54,20,0,1
"containers/buildah","e74bfd60befc398d471a807127eedf9cf9326ca5","rhatdan","2023-03-30 10:44:06","true","Merge pull request #4685 from containers/renovate/github.com-onsi-gomega-1.x

fix(deps): update module github.com/onsi/gomega to v1.27.6",12,74,1,1
"containers/buildah","3c6120cf658aa668f22100b40218e4d44eda18d1","hswong3i","2020-12-01 06:53:28","true","Update nix pin with `make nixpkgs`

This PR introduce 3 changes:

  - Upgrade Nix stable channel from 20.03 to 20.09.

    NixOS 20.09 released at 2020-10-27, see
    <https://nixos.org/manual/nixos/stable/release-notes.html#sec-release-20.09>
    for more information.

  - Replace `git` with `gitMinimal`.

    All 6 projects (i.e. crun/conmon/skopeo/buildah/podman/cri-o) are
    having `git` as dependency for failsafe during bootstrap. BTW
    <https://github.com/NixOS/nixpkgs/pull/104896> replace `asciidoc`
    with `asciidoctor` so trigger the dependency chain to `glib` and so
    failed (see below). Switching to `gitMinimal` skip this dependency
    chain to `glib`, which also speed up overall build process.

  - Adding `-pthread` for `glib`

    `conmon` couldn't skip the error by replacing `git` with
    `gitMinimal` since it do depend on `glib`. Since `glib` trigger
    error message ""undefined reference to 'pthread\_create'"", therefore
    adding `pthread` to `CFLAGS` could solve the problem.

Also see:

  - <https://github.com/containers/crun/pull/550>
  - <https://github.com/containers/conmon/pull/218>
  - <https://github.com/containers/skopeo/pull/1120>
  - <https://github.com/containers/buildah/pull/2831>
  - <https://github.com/containers/podman/pull/8526>
  - <https://github.com/cri-o/cri-o/pull/4395>

Signed-off-by: Wong Hoi Sing Edison <hswong3i@pantarei-design.com>",77,46,0,0
"containers/buildah","fb4b864d63a15cc531e9cf2b14ce4c79ac70eb3b","TristanCacqueray","2019-01-04 05:23:38","false","Properly format images JSON output

This change makes the images --json output a valid JSON list.

Closes: #1257
Signed-off-by: Tristan Cacqueray <tdecacqu@redhat.com>

Closes: #1258
Approved by: TomSweeneyRedHat",55,23,0,0
"containers/buildah","7ea97716d7b57dc54b72848e33af144baa980753","dfr","2022-06-15 10:50:21","false","Move configureUIDGID to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","078a7ff78e6df26d246d3018a119d39dbb516087","flouthoc","2023-01-25 03:59:05","true","Merge pull request #4541 from TomSweeneyRedHat/dev/tsweeney/bumpthecs

Bump c/storagev1.45.3, c/imagev5.24.0, c/commonv0.51.0",19,72,1,1
"containers/buildah","b0f74cf4a4b498d0a1e9e7f73fddeb679fe3a0ad","openshift-merge-robot","2023-09-06 14:37:57","true","Merge pull request #5029 from containers/renovate/github.com-docker-docker-24.x

fix(deps): update module github.com/docker/docker to v24.0.6+incompatible",6,79,1,1
"containers/buildah","9782105dec647f6046b1e4f26dd77a0b91d1005e","openshift-merge-robot","2020-10-05 16:55:06","true","Merge pull request #2656 from Luap99/podman-autocompletion

Shell Completion for podman build flags",86,44,0,1
"containers/buildah","c7e522a3fd62d6223a932ae1833313a00d3f8f93","openshift-merge-robot","2023-03-23 12:15:49","true","Merge pull request #4681 from lsm5/packit

[CI:BUILD] Packit: Enable Copr builds on PR and commit to main",12,74,1,1
"containers/buildah","0722ddb26bb7cd77e44e6200c28f8aec18c908d6","openshift-merge-robot","2021-07-09 18:19:11","true","Merge pull request #3367 from jluebbe/fix-bud-docs

Fix syntax for --manifest example in the documentaion",39,53,1,1
"containers/buildah","a5e80a5c758b7bc5fe8d18814b68a231f0187bcb","openshift-merge-robot","2021-02-23 18:29:26","true","Merge pull request #3034 from edsantiago/dedup_man

[CI:DOCS] buildah-from.md: remove dup arch,os",61,49,0,1
"containers/buildah","0217c41261f2bbbeef3636a8ff28c10ae873c1da","openshift-merge-robot","2021-04-12 13:21:22","true","Merge pull request #3138 from containers/dependabot/go_modules/github.com/onsi/ginkgo-1.16.1

build(deps): bump github.com/onsi/ginkgo from 1.16.0 to 1.16.1",52,51,0,1
"containers/buildah","f36d1f219147447f7590ef427c4b9734ebecf609","openshift-merge-robot","2021-10-26 16:49:53","true","Merge pull request #3600 from containers/dependabot/go_modules/github.com/docker/docker-20.10.10incompatible

build(deps): bump github.com/docker/docker from 20.10.9+incompatible to 20.10.10+incompatible",33,57,1,1
"containers/buildah","e90f9ec9ba8e8d26f00b81f8701afd882199d84f","openshift-merge-robot","2021-09-07 11:00:40","true","Merge pull request #3498 from flouthoc/auth-check-temp-auth-file

build: mirror --authfile to filesystem if pointing to FD instead of file",38,55,1,1
"containers/buildah","7bcca21a282dc42099fcc8883da386a000273d4b","openshift-merge-robot","2022-01-14 12:23:19","true","Merge pull request #3709 from abergmeier/idflag

Allow processing of id options from FlagSet",31,59,1,1
"containers/buildah","2dff5e0db4f24a63f476c42b1d25c8f857b7811b","openshift-merge-robot","2021-04-05 20:39:59","true","Merge pull request #3109 from cevich/new_get_ci_vm.sh

Cirrus: Make use of shared get_ci_vm container",51,50,0,1
"containers/buildah","cea7ae5d1e758508f8610049af801a7774848dbe","openshift-merge-robot","2022-03-07 22:44:12","true","Merge pull request #3810 from nalind/copy-network

tests/copy: initialize the network, too",30,61,1,1
"containers/buildah","5b94f283511584c3b220bda12c8bdcf78edc6879","openshift-merge-robot","2021-04-19 13:02:52","true","Merge pull request #3157 from containers/dependabot/go_modules/github.com/containers/common-0.36.0

build(deps): bump github.com/containers/common from 0.35.4 to 0.36.0",52,51,0,1
"containers/buildah","ae36f6542e1c21b9a2fa2e0f8626d2f3800d3f4e","flouthoc","2023-08-03 12:31:45","true","tests: fix layer-label tests

Some additions and corrections to layer-label tests from comment: https://github.com/containers/buildah/pull/4940#pullrequestreview-1560878587

Co-authored-by: Ed Santiago <santiago@redhat.com>
Signed-off-by: Aditya R <arajan@redhat.com>",13,78,1,1
"containers/buildah","354f96f6b6d832c67f677439f0ef5153c660f59e","flouthoc","2022-08-17 08:24:40","true","commit: use race-free RemoveNames instead of SetNames

PR https://github.com/containers/storage/pull/1153 added a dedicated API
to remove names assigned image so use `RemoveNames` instead of racy
`SetNames`.

How to verify
```console
printf 'from quay.io/jitesoft/alpine:latest\nrun for i in $(seq 0 10000); do touch /$i; done\n' >Containerfile && for i in `seq 1 25`; do ./buildah build --squash --iidfile id.$i --timestamp 0 . & done; wait; ls -al
```

* Refer to newly added integration test.

Closes: https://github.com/containers/podman/issues/15162

Signed-off-by: Aditya R <arajan@redhat.com>",17,67,1,1
"containers/buildah","0b8c6ca49f6366eaf458e8a69f74420c21b3ca30","flouthoc","2022-03-08 21:00:10","true","test: remove skips for rootless users

Signed-off-by: Aditya R <arajan@redhat.com>",30,61,1,1
"containers/buildah","d33bb6fac4272f668edd5d7cfa437a652410c8e2","hswong3i","2021-03-05 06:48:56","true","Update nix pin with `make nixpkgs`

Signed-off-by: Wong Hoi Sing Edison <hswong3i@pantarei-design.com>",57,49,0,0
"containers/buildah","da1522d13a29369711c3de811509d4cdd697ad9b","hswong3i","2021-04-02 03:51:15","true","Update nix pin with `make nixpkgs`

  - Bugfix `make nixpkgs` which pin with branch `nixos-20.09`
  - Code lint with `nixpkgs-fmt`
  - Code sync between x86\_64 and aarch64

Signed-off-by: Wong Hoi Sing Edison <hswong3i@pantarei-design.com>",49,50,0,0
"containers/buildah","6bd0551fe517959c0e31aa6fc8b091c74c3ece0c","TomSweeneyRedHat","2019-07-22 20:12:02","false","Change wait to sleep in buildahimage readme

Change wait to sleep 100000 as we've had some reports of problems
with wait.  Fixes: 1665

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1737
Approved by: rhatdan",49,30,0,1
"containers/buildah","d8b06097df71039c67e8a56a9bc0bef37e1191a2","TomSweeneyRedHat","2023-06-28 23:18:53","false","Bump c/image to 5.26.0 and c/common to 0.54.0

As the title says.  In preparation of Podman v4.6 and
eventual RHEL 8.8/9.2

[NO NEW TESTS NEEDED]

Signed-off-by: Tom Sweeney <tsweeney@redhat.com>",13,77,1,1
"containers/buildah","92e59d524966f62922589936ec894ad2117b14d1","cevich","2019-11-08 15:10:23","true","Show validation command-line

Validation problems can be difficult to debug w/o knowing what options
were passed / how it was called.

Signed-off-by: Chris Evich <cevich@redhat.com>",81,33,0,1
"containers/buildah","6a01461f793f9f6b048d251879826884405aec9f","cevich","2020-09-14 20:17:05","true","Cirrus: Fix validate commit epoch

Signed-off-by: Chris Evich <cevich@redhat.com>",89,44,0,1
"containers/buildah","73c6742ca08deed552acb475f255ff6f5985a8b3","cevich","2021-06-10 15:15:54","true","Fix docs links due to branch rename

Ref: https://github.com/containers/common/issues/549

Signed-off-by: Chris Evich <cevich@redhat.com>",34,52,1,1
"containers/buildah","c74084a21a602d4f03977b6c7043d315bfa3f67f","cevich","2021-01-07 19:40:58","true","Fix config-flags-verification test on F33

On newer versions of `time`, the error message quotes the bad value.
This leads to an erroneous failure in the test:

```
working-container
time: invalid duration ABCD'
time: invalid duration ""ABCD""'
```

The comparison used for `expect_output --substrig` supports basic
regular expressions.  Encode the expected value in the test to be
tolerant of quoting in the output value.

Signed-off-by: Chris Evich <cevich@redhat.com>",91,47,0,1
"containers/buildah","dffb148b31022435787dc393bd275b4d54af6084","pixdrift","2023-05-08 06:25:27","true","Update the demos README file to fix minor typos

Signed-off-by: pixdrift <pixdrift@users.noreply.github.com>",10,75,1,0
"containers/buildah","32c0cba0813de2310b818d879fff7b4ecb08b99d","pixdrift","2018-05-02 23:13:28","false","Update test cases for buildah run behaviour

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #656
Approved by: rhatdan",48,15,0,0
"containers/buildah","fa2a2473883721c8c1ac800309015b9867dde10e","mtrmac","2019-02-21 22:42:15","false","Don't pass image = transport:repo:tag, transport=transport to pullImage

pullImage has a dedicated transport: parameter, don't pass the transport
in the image name as well. The semantics of the imageName parameter to
pullImage is now unambiguous.

Should not change behavior, pullImage was trying
alltransports.ParseImageName(imageName) first.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","b2b70007fae8f28345ef57dbaa4816973b33700e","rhatdan","2022-05-02 21:10:01","false","Vendor in containers/(common, storage, image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",24,63,1,1
"containers/buildah","59d3331a370b19b5145ad24740ef29f906f03bfb","rhatdan","2019-09-05 12:45:06","false","Bump fedora version from 28 to 30

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",59,31,0,1
"containers/buildah","9e3e7ca8ccc8dc5887c869219c4315de4a1503dd","rhatdan","2020-09-15 13:19:22","false","Switch default log level of Buildah to Warn. Users need to see these messages

Need to turn this on in Rawhide to see if we have any issues with it.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",90,44,0,1
"containers/buildah","821f2d365266078ecaf92ddbe807238da075d253","rhatdan","2018-06-07 20:21:36","false","Drop capabilities if running container processes as non root

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #764
Approved by: umohnani8",31,16,0,1
"containers/buildah","0163d17d866ae65d4a17af96b2296bbc9a1304ed","rhatdan","2020-07-07 18:28:42","true","Merge pull request #2435 from nalind/optional-platform

Make imagebuildah.BuildOptions.Architecture/OS optional",146,41,0,1
"containers/buildah","5cde04cd18b74c6320ffc30c51eca01412e77a45","giuseppe","2022-09-20 07:15:33","true","vendor: update c/storage

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",19,68,1,1
"containers/buildah","93b0eacf85cff0089a1b55c0189eb12777b4a79d","rhatdan","2020-05-25 12:14:57","false","Vendor in new go.etcd.io/bbolt

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",136,40,0,1
"containers/buildah","934c40e737097c725eb42d10319f9e93f28793ef","nalind","2023-10-27 18:32:27","false","Log the platform for build errors during multi-platform builds

When a multi-platform build fails and we hand an error back, add the
platform to the error's context so that it's easier to tell at the end
of the log which platform the build failed for.

[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",4,81,1,1
"containers/buildah","cfc67cd743c4ddfb5e6ec14172f89d7319a9d360","rhatdan","2023-02-15 02:36:26","true","Merge pull request #4570 from containers/dependabot/go_modules/github.com/opencontainers/selinux-1.11.0

build(deps): bump github.com/opencontainers/selinux from 1.10.2 to 1.11.0",20,73,1,1
"containers/buildah","9403ce7ad5ccc8d83da171467a0aa754c9671ceb","rhatdan","2023-02-14 04:49:07","true","Merge pull request #4567 from containers/renovate/configure

[CI:DOCS] Configure Renovate",19,73,1,1
"containers/buildah","13ac660ea9f8a73706084ddd20fa0d5651eeea73","openshift-merge-robot","2023-02-14 03:02:23","true","Merge pull request #4571 from rhatdan/codespell

Run codespell on codebase",20,73,1,1
"containers/buildah","cf661299d14fcc67f86984642328cd4b0f1741fc","openshift-merge-robot","2022-11-30 13:28:10","true","Merge pull request #4440 from dfr/version

version: Bump to 1.29.0-dev",19,70,1,1
"containers/buildah","a7de9a0f14a0f9b9145a0d2d356079ff91080b59","mtrmac","2020-04-08 18:29:16","false","Run (make -C tests/tools vendor)

... now that its (go mod tidy) works.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",117,38,0,1
"containers/buildah","29487b3618bb708177a48e808303a8dbf99129ab","TomSweeneyRedHat","2020-03-25 23:07:39","false","Bump back to v1.15.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",113,38,0,1
"containers/buildah","a5fabab98f5a72d1f89c83e7d9e7ef84c8e023be","rhatdan","2020-03-25 21:15:10","true","Merge pull request #2246 from rhatdan/fips

Fips",113,38,0,1
"containers/buildah","4079f009855990efed114b512a6b8b6d523f0ef7","rhatdan","2020-03-10 12:25:40","false","Bump containers/common and opencontainers/selinux versions

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",105,37,0,1
"containers/buildah","0d307476935e00227ce81ac8232fbb6bac966432","TomSweeneyRedHat","2020-02-08 17:47:00","false","Add Code of Conduct

Create a Code of Conduct for Buildah

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",111,36,0,1
"containers/buildah","4069d6581a9636e6a0bc142e6b7a2746bc9e1622","giuseppe","2019-09-30 11:26:00","true","info: add cgroups2

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",65,32,0,1
"containers/buildah","61e32a57111eb158cfdf45a1a6d77e1c269db9e5","TomSweeneyRedHat","2019-09-23 14:45:18","false","Print build 'STEP' line to stdout, not stderr

The 'STEP' line that's printed as part of the build processing was
going to Stderr and causing some issues for OpenShift who was looking
for it.  Instead print it to Stdout.

Addresses: #1772

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1869
Approved by: rhatdan",63,32,0,1
"containers/buildah","0bafbfe9cb10a177509622010220fd1fc6027f16","TomSweeneyRedHat","2019-09-13 13:41:00","false","Bump to v1.11.2

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",61,31,0,1
"containers/buildah","0cf7f9d142e8a4d990f5c9a8309527500cef3a3e","boaz0","2018-09-04 11:52:09","false","nitpick: use tabs in tests/helpers.bash

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>

Closes: #986
Approved by: TomSweeneyRedHat",34,19,0,0
"containers/buildah","62afd6feb54ee5a43a801d27bcd7fea071eeb138","openshift-merge-robot","2022-04-26 13:02:35","true","Merge pull request #3926 from edsantiago/test_cleanup

Ed's periodic test cleanup",24,63,1,1
"containers/buildah","b8214c4cffaa3a8926784860cc837b3f788d1504","rhatdan","2017-03-27 12:40:32","false","Switch `buildah list quiet` option to only list container id's

Add `noheading` option to eliminate headings

Closes: #44
Approved by: rhatdan",14,2,0,1
"containers/buildah","a07369f50daadcb85678af5e5fa35b1e790055e0","rhatdan","2017-03-24 18:34:05","false","Merge pull request #38 from nalind/comment

Clarify a comment",14,2,0,1
"containers/buildah","3ba8822d309128f7d76599432b8d9cdf77d4032f","rhatdan","2019-03-12 19:06:23","true","Merge pull request #1395 from giuseppe/buildah-honor-net

rootless: honor --net host",36,26,0,1
"containers/buildah","aa6a281df7c54aa42a060baa9d0504040c7551a6","rhatdan","2023-06-05 20:08:26","true","Merge pull request #4834 from containers/renovate/github.com-containers-image-v5-digest

fix(deps): update github.com/containers/image/v5 digest to abe5133",16,76,1,1
"containers/buildah","80b4a5d10a013c0186b0a34523a6b208f1531945","rhatdan","2018-09-09 10:25:10","false","Vendor in latest containers/storage,image,libpod and runc

Mainly pulls in fixes for rootless containers, and keeps us in sync
with latest changes upstream.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #995
Approved by: TomSweeneyRedHat",36,19,0,1
"containers/buildah","a83d263ff83febcb21893849f8fff32d45e65032","rhatdan","2021-03-24 19:10:36","false","vendor in containers/storage v1.28.1

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",53,50,0,1
"containers/buildah","662100058d27a04e207b3a857881c04703df3c3b","rhatdan","2023-10-02 19:43:49","true","Merge pull request #5067 from BenjaminSchubert/bschubert/fix-cache-type-default

Ensure the mount type is always BindMount by default",7,80,1,1
"containers/buildah","9d42fecce073701beef7f4e91f58ba741059a53b","nalind","2017-03-17 21:31:26","false","Show defaults for global options in help output

Read the library defaults from the storage library before we parse our
command line, so that help output will correctly show the default
storage locations.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","a72aad405277a32260c5961cebad75f72b220265","openshift-merge-robot","2021-09-22 12:51:45","true","Merge pull request #3530 from containers/dependabot/go_modules/github.com/containers/common-0.45.0

build(deps): bump github.com/containers/common from 0.44.1 to 0.45.0",39,56,1,1
"containers/buildah","39bef2cdf1f1acd12b4827c7325e7ac01dc013b1","openshift-merge-robot","2021-08-27 18:06:56","true","Merge pull request #3484 from rhatdan/subid

Add support for libsubid",37,55,1,1
"containers/buildah","e6afa0cd5de96dd28194a44b08c76b1a35d32b62","r10r","2022-01-28 20:43:38","false","caps: fix buildah run --cap-add=all

Fixes #3755

[NO NEW TESTS NEEDED]

Signed-off-by: Ruben Jenster <r.jenster@drachenfels.de>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",34,60,1,0
"containers/buildah","c7c75bd89268cb99830fccdfacba9c7f04cc7f71","flouthoc","2021-12-11 09:42:25","true","tests: move buildkit mount tests files from TESTSDIR to TESTDIR before modification

In certain environments tests are conducted from `/usr` where `selinux`
blocks certain operation so move all files where modifications are
expected from `$TESTSDIR` to `$TESTDIR`

Signed-off-by: Aditya Rajan <arajan@redhat.com>",34,58,1,1
"containers/buildah","5b056ee652bb6165a462305a2ce47745265ba122","openshift-merge-robot","2021-08-25 18:24:13","true","Merge pull request #3368 from Fodoj/main

Rename bud to build, while keeping an alias for bud.",40,55,1,1
"containers/buildah","d08dbe7ed650054fe3789cda862d0291f4115405","rhatdan","2021-06-06 20:41:52","true","Merge pull request #3283 from Shanduur/patch-1

fix(docs): typo in install.md",36,52,1,1
"containers/buildah","570b43fd2893f3c0198d5b86747ef83f7c9b538f","rhatdan","2020-11-20 11:52:21","true","Merge pull request #2808 from rhatdan/rpm

Add suggests cpp to spec file",79,46,0,1
"containers/buildah","4f7c609f67cc0ff34c22b88c8cc6c58276bdd51c","TomSweeneyRedHat","2021-01-08 19:35:43","false","Bump to v1.20.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",91,47,0,1
"containers/buildah","f4553e7c09d6556a3f91dd7a041ab3bfe564a3e7","cevich","2021-01-12 14:45:49","true","Cirrus: Collect cri-o-runc version

Signed-off-by: Chris Evich <cevich@redhat.com>",93,47,0,1
"containers/buildah","da8955ce56bb1047aa0d09e39811a921f03e53c0","openshift-merge-robot","2020-12-17 11:13:18","true","Merge pull request #2842 from containers/dependabot/go_modules/github.com/containers/storage-1.24.3

build(deps): bump github.com/containers/storage from 1.24.2 to 1.24.3",81,47,0,1
"containers/buildah","c05d9ecd637ca042e47921a2b8c9a3b299c8e392","rhatdan","2020-10-21 12:17:16","true","Merge branch 'master' into badges",64,45,0,1
"containers/buildah","002dffb8d2cb7bd22d8adba9827e93c8a1d84d2b","rhatdan","2020-02-22 10:25:02","true","Merge pull request #2174 from openSUSE/remote-manifests

Improve remote manifest retrieval",99,37,0,1
"containers/buildah","c0b8292f18469508fe26aa8f2a898a7d3f447b8f","rhatdan","2020-08-13 13:31:34","false","Update vendor of containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",87,43,0,1
"containers/buildah","52615463ac29b6fb9fd7314883eab063495ba8b8","rhatdan","2019-07-19 09:34:07","false","Add support for listing read/only images

Also add image fields to json struct.
Cleanup some if then, else if then blocks.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1732
Approved by: @TomSweeneyRedHat",49,30,0,1
"containers/buildah","297bfa6b30806e039f3bf5819124588a6268124f","rhatdan","2017-11-02 15:57:17","true","Merge pull request #305 from TomSweeneyRedHat/dev/tsweeney/tip

Add go 1.9.x to .travis.yml and remove go tip build temporarily",30,9,0,1
"containers/buildah","ffc86ea75283ed94ddbd13d91ef2c9e916d3825c","rhatdan","2018-09-15 02:03:52","false","vendor in latest containers/image

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",37,20,0,1
"containers/buildah","2b7cd3d47681bf8122d12945605eb8f68a4702d9","jluebbe","2021-07-09 15:12:01","false","Fix syntax for --manifest example

Without the newlines this results in a single long line when rendered.

Signed-off-by: Jan Luebbe <jlu@pengutronix.de>",38,53,1,0
"containers/buildah","59da11d4b4df6c9b51d06fc804f7a2e46be6c700","QiWang19","2019-04-09 19:57:12","false","add buildah login/logout & fix authfile path

Fix the bug that buildah reads /var/run/containers.. as authentication file.(in readme files it should be /run/containers/uid).
Add `buildah login`, `buildah logout` to close #1329, enable to use buildah login before running buildah bud for multi-stage bud and avoiding using --creds flag.

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1501
Approved by: rhatdan",55,26,0,1
"containers/buildah","40d4d599c699b887744271b5806f5d9bc97e4feb","nalind","2019-02-13 20:11:00","false","healthcheck start-period: update documentation

A re-reading of the spec doesn't agree with our docs - the healthcheck
start period isn't a delay in the first invocation of the healthcheck
command, but is instead a grace period where failures aren't counted as
indications of problems.  Instead, during that grace period, failures
are attributed to the container not yet having finished starting.  Once
the healthcheck command succeeds, the engine should start counting
failures.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1338
Approved by: rhatdan",60,25,0,1
"containers/buildah","aa5cf3115e399213ea81a43f0a24269f97f8f8fa","nalind","2018-03-16 21:19:29","false","add/secrets/commit: Use mappings when setting permissions on added content

Use ID mapping information when setting permissions on content that we
add to the container, and on secrets that we copy in, on pipes that we
use for stdio, and when extracting the whole filesystem as a ""layer"".

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",19,14,0,1
"containers/buildah","67ab55bbb747dbc6b80cef98fbe4a48ca18f0578","nalind","2023-01-09 19:41:21","false","bud: Consolidate multiple synthetic LABEL instructions

We handle --label command line arguments by appending LABEL instructions
to the Dockerfile contents before we parse it.  Previously, we were
appending a separate line for each label-value pair.  Consolidate them
for the sake of tools that arbitrarily limit the length of histories
that they're willing to accept in images (boo!).

Add a similar implementation for --env command line arguments.
Previously, we'd set them in the initial configuration for each stage
and also set them at commit-time, and that potentially overrode any
values that were explicitly in the stage itself, and which would have
affected RUN instructions.  Remove the set-at-commit-time logic so that
the history reflects what ends up in the image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",21,71,1,1
"containers/buildah","24c3174084728fd07fc3ac9c94de2788c5cdfd4a","nalind","2019-02-18 19:26:55","false","imagebuildah: split Executor and per-stage execution

When building images using multiple stages, we were using a shallow copy
of the Executor, depending on some fields to be shared between all
instances, while replacing others fields with per-stage values.

This patch makes that easier for me to reason about by introducing a
StageExecutor which holds the stage-specific information, and which can
hold a reference to the main Executor, which now coordinates stages
using StageExecutors rather than Executors.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1420
Approved by: rhatdan",58,25,0,1
"containers/buildah","cdc880d8fd4e7544050ef071b9a51cc63954814c","nalind","2021-11-11 22:37:08","false","""config"": remove a stray bit of debug output

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",28,57,1,1
"containers/buildah","025a8df513844959e1f79dca64c090671ed311aa","nalind","2022-11-30 20:27:57","false","util.SortMounts(): make the returned order more stable

Use sort.Stable() instead of sort.Sort() to sort mounts, and have the
comparison function compare the cleaned paths directly if they have the
same number of components, so that there's a defined ordering between
""/a"" and ""/b"".

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",17,70,1,1
"containers/buildah","542d25a57377d06af9097e6f39cb05168007da20","nalind","2018-05-20 00:31:31","false","Vendor github.com/onsi/ginkgo and github.com/onsi/gomega

Add github.com/onsi/ginkgo and github.com/onsi/gomega to the set of
packages that we vendor, since 'go vet' cares about our tests importing
them.  Revendor golang.org/x/net and golang.org/x/text to add new
subpackages that they require.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #711
Approved by: rhatdan",63,16,0,1
"containers/buildah","ad53545889b7af9158281b37c814b1e124c1310c","nalind","2019-05-08 20:06:04","false","Add some symlinks to test our .dockerignore logic

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1583
Approved by: rhatdan",55,27,0,1
"containers/buildah","ce254f51fc65cdf6d45262bba13c684f9280c37d","nalind","2017-03-28 07:02:41","false","Tweak ADDing/COPYing directories to copy contents

When copying or adding a source directory, copy the directory's contents
to the destination directory, to better match Dockerfile COPY behavior.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #50
Approved by: rhatdan",14,2,0,1
"containers/buildah","ab5038c93159490f0e12de0303a4f6b8489f9409","rhatdan","2023-03-30 10:42:45","true","Merge pull request #4678 from containers/renovate/major-ci-vm-image

chore(deps): update dependency containers/automation_images to v20230320",12,74,1,1
"containers/buildah","b956493c6d2f8ebc9a26e90aaae563345949b8ae","giuseppe","2018-07-25 16:48:55","false","userns: assign additional IDs sequentially

currently, when I am running buildah as unprivileged user, I get this
mapping in the container, thus having unmapped ids [1-first additional
id]:

0            1000          1
110000     110000      65536

change the mapping so that now looks like:

0       1000          1
1     110000      65536

Closes: https://github.com/projectatomic/buildah/issues/882

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #884
Approved by: rhatdan",31,18,0,1
"containers/buildah","681e3eff987c13b4e25326583301ce8eb2434dee","baude","2020-10-09 18:34:19","false","refactor pullpolicy to avoid deps

refeactor the pullpollicy to its own package so that it can be imported on its own without deps like containers/storage, etc. this will help consuming podman's go bindings.

Signed-off-by: baude <bbaude@redhat.com>",62,44,0,0
"containers/buildah","a89293a655a7f06f9ac8f14bdd07ad9fa616a4eb","vrothberg","2019-04-05 16:42:29","false","Travis: do not use traviswait

The traviswait script has plenty of undesired side-effects, mainly but
not limited to not printing std{err,out} when hitting the time out.
This is especially painful when the tests hit a deadlock, rendering it
useless for debugging the deadlock.  Besides that, it also slows down
the tests causing frequent time outs.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1488
Approved by: rhatdan",52,26,0,1
"containers/buildah","f2238234f2578a927ec0c0aa3ab80fef97bf04d8","pixdrift","2018-05-07 22:07:06","false","Fix rpm .spec changelog formatting

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #664
Approved by: rhatdan",52,15,0,0
"containers/buildah","b6d9a2c147fb67d370d225554aea5ea9bb0ccd34","openshift-merge-robot","2020-10-20 20:32:37","true","Merge pull request #2709 from nalind/update-deps

Bump containerd, docker, and golang.org/x/sys",63,45,0,1
"containers/buildah","3066bce44c138d70b10f8a95c57adbebd9854bcb","openshift-merge-robot","2021-04-05 11:13:13","true","Merge pull request #3125 from alvistack/master-linux-amd64

Update nix pin with `make nixpkgs`",51,50,0,1
"containers/buildah","4e537a8a786ea385d2fec14bd840cb7d31de02ac","openshift-merge-robot","2021-05-24 07:53:25","true","Merge pull request #3250 from nalind/squash-no-parent

containerImageRef.createConfigsAndManifests(): squashed images have no parent images",57,52,1,1
"containers/buildah","f0b508598ae121fb9af6cf8a27aff3661dc0dabc","nalind","2017-03-21 20:38:50","false","Update implementation to match dependencies

types.ImageSource.Close() can return an error now, and ParseImageName()
moved to containers/image/transports/alltransports.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","e877d8932b8e55dd4cb7367fb8ef3811f7e2861b","nalind","2020-10-09 14:43:06","false","copier: add more context to a couple of error messages

copier: when returning an error that we didn't copy any files, wrap that
messages a syscall.ENOENT rather than just returning our own text.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",62,44,0,1
"containers/buildah","a60fd2f9b731d474e1267e98dcd5135e25f9f1b1","vrothberg","2020-02-05 08:40:45","true","Merge pull request #2141 from nalind/manifest-push-format

manifest push: add --format option",110,36,0,1
"containers/buildah","ab0286f7e3a090b04c5a5c8a0fbd67ad76861a3c","mheon","2019-08-15 14:14:27","false","Add security-related volume options to validator

Also, ensure ordering is correct on other entries. The current
code will increment *after* checking for validity in some cases,
which allows such options as '-v /tmp:/test1:ro,rw' to pass
validation when they obviously don't make much sense.

Signed-off-by: Matthew Heon <matthew.heon@pm.me>

Closes: #1794
Approved by: rhatdan",51,31,0,1
"containers/buildah","dbea38b4407886cddacbab983a78c5a9ff1369ad","ipbabble","2017-11-02 16:30:11","false","Add root prompt and some other minor changes

Signed-off-by: William Henry <whenry@redhat.com>",30,9,0,0
"containers/buildah","f17bfb937fd89ef3e4338e50ccc1e4c5436ec050","vbatts","2017-09-15 19:53:31","true","examples: adding a basic lighttpd example

Signed-off-by: Vincent Batts <vbatts@hashbangbash.com>",32,8,0,0
"containers/buildah","2ac95ea682c46351d6d78aa8f530fd12dd1731de","TomSweeneyRedHat","2018-06-19 23:33:14","false","ONBUILD tutorial

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #808
Approved by: rhatdan",30,17,0,1
"containers/buildah","e577d58cb8308da230e9966eb9de5738c7c6267e","TomSweeneyRedHat","2018-11-15 17:58:01","false","Vendor containers/storage to get layer umount fix

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1180
Approved by: rhatdan",64,22,0,1
"containers/buildah","03aa80716fd5d014be76863ca496fed578d591db","ashley-cui","2019-08-06 14:41:50","false","Bug fix for volume minus syntax

Do not check disk for existence of volume.
If volume that ends with `-` is set in config, remove it.
If not, add it into config.

Signed-off-by: Ashley Cui <ashleycui16@gmail.com>

Closes: #1767
Approved by: rhatdan",50,30,0,0
"containers/buildah","61b6ebe61a7abd8a74b4be54a2d842cbd8af5966","cevich","2020-02-04 20:40:24","true","Bors: Workaround ineffective required statuses

For whatever reason, Bors-ng has trouble interpreting multiple
status-checks as being required when their names contain wild-
cards (like `testing%`).  Instead, it will simply pick one
that happens to match the name, and fail to consider all others.
Until that issue can be debugged and fixed, use a single ""success""
task  to represent pass/fail status of all required checks.

Signed-off-by: Chris Evich <cevich@redhat.com>",110,36,0,1
"containers/buildah","5a1c733c05fae6195e3ad7792bbafd9dec58e285","saschagrunert","2019-08-21 09:17:06","false","Remove gofmt.sh in favor of golangci-lint

golangci-lint already checks via gofmt so we can safely remove the
additional linting step.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1808
Approved by: vrothberg",54,31,0,1
"containers/buildah","67b565da7bbaa4df1298b62f0e154756fdae07ca","bkircher","2018-02-09 14:18:43","false","Docs: note that buildah needs to run as root

You have to be root to run buildah. This commit adds a notice to the
buildah(1) man-page and improves the front-page README.md a bit so that
this is more obvious to the user.

Fixes issue #420.

Signed-off-by: Benjamin Kircher <benjamin.kircher@gmail.com>

Closes: #462
Approved by: rhatdan",24,12,0,0
"containers/buildah","c5051bc81624556923dc007150c572d2ae8ab850","rhatdan","2018-08-02 17:58:33","true","Merge pull request #899 from rhatdan/man

Fix the the in buildah-config man page",29,18,0,1
"containers/buildah","82e9c841473b677cc94a0b1db9d763696ae20945","rhatdan","2022-05-12 12:29:35","false","Vendor in latest containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",24,64,1,1
"containers/buildah","0b592358c3705f0fe2d2e5aa705ef758db86d50e","openshift-merge-robot","2021-07-08 10:27:10","true","Merge pull request #3363 from containers/dependabot/go_modules/github.com/onsi/gomega-1.14.0

build(deps): bump github.com/onsi/gomega from 1.13.0 to 1.14.0",37,53,1,1
"containers/buildah","41557b25916a65bb94eeeb338d888be2a8438376","flouthoc","2022-03-28 08:22:03","true","build: allow --no-cache and --layers so build cache can be overrided

Buildah should allow users to override build cache by using `--no-cache`
and `--layers` togather, this is already functional but there is a top
level check which must be removed

Signed-off-by: Aditya R <arajan@redhat.com>",29,62,1,1
"containers/buildah","91ce0571df451f9bacd2da7c23b0cc45767b80ae","flouthoc","2023-05-19 11:26:47","true","test: use debian instead of docker.io/library/debian:testing-slim

Signed-off-by: Aditya R <arajan@redhat.com>",14,76,1,1
"containers/buildah","f2e0af5c43a500445a8ca3bd0224aa886a63fe01","flouthoc","2022-10-18 10:07:36","true","mount,cache: lockfiles must not be part of users cache content

`--mount=type=cache` must not add internal lockfiles to cache directory
created by users instead store it in a different central directory with
path as `/base/buildah-cache/buildah-lockfiles`.

There are use-cases where users can wipe cache between the builds so
lockfiles will be removed in unexpected manner and also its not okay to
mix buildah's internal construct with user's cache content.

Helps in: https://github.com/containers/buildah/issues/4342

Signed-off-by: Aditya R <arajan@redhat.com>",27,69,1,1
"containers/buildah","bee0a1ff2ef91dc819d28317d7f20cf946b1dc25","flouthoc","2022-05-02 18:32:36","true","build: automatically set correct TARGETPLATFORM where expected

Automatically set correct value of TARGETPLATFORM if one or more
`--platform` are selected for the build. This ensures that behaviour
of buildah is equivalent to `buildkit` for the args `$BUILDPLATFORM` and
`$TARGETPLATFORM`, `$TARGETOS`, `$TARGETARCH` and `$TARGETVARIANT`

Where $BUILDPLATFORM is set always native to host and $TARGETPLATFORM
is foreign selected via `--platform`.

Example

```console
$ buildah build --platform linux/arm64 .
```

```Dockerfile
FROM --platform=$BUILDPLATFORM alpine
ARG TARGETPLATFORM
ARG BUILDPLATFORM
RUN echo ""I'm compiling for $TARGETPLATFORM on $BUILDPLATFORM""
```

Signed-off-by: Aditya R <arajan@redhat.com>",25,63,1,1
"containers/buildah","d9d04887e7563ce98f478b506c18b93ff3fc532b","flouthoc","2022-11-05 04:44:09","true","Merge pull request #4402 from rhatdan/security

Add no-new-privileges flag",23,69,1,1
"containers/buildah","71a5615ce5bc1e5084d9a3baee33da9780ff4f6d","openshift-merge-robot","2020-10-02 21:14:29","true","Merge pull request #2672 from cevich/remove_more_bors

Cirrus: Remove bors artifacts",87,44,0,1
"containers/buildah","d6b04349fedb39b6359c548c1fb4339474b2bed8","openshift-merge-robot","2021-10-21 17:45:42","true","Merge pull request #3593 from rhatdan/group

Rootless containers users should use additional groups",35,57,1,1
"containers/buildah","6eaa9d746bd69b9cd304e5d30db816a0387267e8","openshift-merge-robot","2022-04-28 10:35:16","true","Merge pull request #3937 from containers/dependabot/go_modules/github.com/containernetworking/cni-1.1.0

build(deps): bump github.com/containernetworking/cni from 1.0.1 to 1.1.0",25,63,1,1
"containers/buildah","c3ea1a266a5e850ee23321c2b3c6f0e8ea4df3e5","openshift-merge-robot","2021-04-19 18:17:55","true","Merge pull request #3154 from francares/fmc_fixLibTutorialDoc

Minor fixes to Buildah as a library tutorial documentation",50,51,0,1
"containers/buildah","fb28761ceb01e3e9050d3567bac721dabdb5953d","openshift-merge-robot","2022-06-02 21:28:25","true","Merge pull request #4028 from flouthoc/allow-removing-history

build, commit: add support for disabling image history with `--omit-history`",25,64,1,1
"containers/buildah","78c07f2af665f5c3009ef554e1199ec95fce572d","mtrmac","2018-08-04 00:58:29","false","Eliminate the long-running ref and img variables in resolveImage

Inspecting the code flow, img seems to end up nil nil when we exhaust
all options and exit the loop, so img and ref don't need to be long-lived.

Should not change behavior, except possibly for a theoretical
case where store.Image(image) succeeds but !strings.HasPrefix(img.ID, image);
OTOH in that case, if it could happen, we would end up with a nil ref, so
that was very likely never intended in the first place.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #909
Approved by: rhatdan",22,18,0,1
"containers/buildah","df3f19f8a455fdb431cf2845759050d95aeaec88","vrothberg","2019-06-18 11:18:03","false","imagebuildah/build.go: return <expr> instead of branching

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","0814bc19bd66185a362b7f3862b70454af5b848e","nalind","2017-10-05 19:44:09","false","Make filtering by date use the image's date

When filtering ""images"" output by the date of an image, use the creation
date recorded in the image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",32,8,0,1
"containers/buildah","41493b137193adf4e352ac1b97b87c4f1f77b822","rhatdan","2022-03-26 01:46:16","true","Merge pull request #3849 from containers/dependabot/go_modules/tests/tools/github.com/golangci/golangci-lint-1.45.2

build(deps): bump github.com/golangci/golangci-lint from 1.45.0 to 1.45.2 in /tests/tools",29,62,1,1
"containers/buildah","48b44e5c2c20249b5b3bce31ba013ace4be44264","ypu","2019-01-07 12:38:05","false","Skip empty files in file check of conformance test

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #1264
Approved by: giuseppe",50,23,0,0
"containers/buildah","a32f8dad13dc07ec003ebd0bf4006887fe726ebf","ypu","2018-11-12 11:39:36","false","Update docker build command line in conformance test

Update the docker build command line to fit the request from
container-diff

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #1172
Approved by: rhatdan",61,21,0,0
"containers/buildah","a8ba52d43a45aff964a731e2deeb8bb70a83ad72","rhatdan","2023-03-18 20:03:26","true","Merge pull request #4649 from containers/renovate/github.com-fsouza-go-dockerclient-1.x

fix(deps): update module github.com/fsouza/go-dockerclient to v1.9.6",14,74,1,1
"containers/buildah","f4e8be4379a183a19731f52b403aa6defc218c58","rhatdan","2023-06-21 12:35:08","true","Merge pull request #4869 from Luap99/hosts-host

add hostname to /etc/hosts when running with host network",13,77,1,1
"containers/buildah","fe2de4f491147e5063d12ff80431d80d42a37a0d","boaz0","2018-01-07 13:49:38","false","Handle commit error gracefully

This change gives a better error message when the commit fails
because of bad authentication.

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>

Closes: #385
Approved by: rhatdan",29,11,0,0
"containers/buildah","9073165e7c5ba11b7ae42ffeaf50bb84c1e192f0","rhatdan","2023-01-18 23:02:55","true","Merge pull request #4524 from containers/dependabot/go_modules/github.com/onsi/gomega-1.25.0

build(deps): bump github.com/onsi/gomega from 1.24.2 to 1.25.0",21,72,1,1
"containers/buildah","0bd560c3690e998569f51bc1a336b0788856c13a","rhatdan","2018-06-07 04:45:17","false","Move parsing code out of common for namespaces and into pkg/parse.go

podman needs this code to be vendored in for podman build.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #761
Approved by: rhatdan",32,16,0,1
"containers/buildah","5186253732591ea83ddcd5bbba38cb585294dc96","mgoltzsche","2020-12-31 02:29:37","true","fix: `rmi --prune` when parent image is in store.

When the `--prune` option is provided to the `rmi` command the
existance of parent images within the store does not make the
command fail (nor log anything).

Fixes #2878

Signed-off-by: Max Goltzsche <max.goltzsche@gmail.com>",89,47,0,0
"containers/buildah","57f370d9d04ea47d5d0547dcea3d3086ba33adfe","dfr","2022-10-23 10:26:51","false","Makefile: Use $(MAKE) to start sub-makes in install.tools

On FreeBSD, GNU make is called gmake.

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",25,69,1,0
"containers/buildah","94c1e6dd687466fdc39ad65aaf017835bd7d380f","TomSweeneyRedHat","2018-06-11 13:57:45","false","Change 'registries' to 'container registries' in man

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #774
Approved by: rhatdan",32,16,0,1
"containers/buildah","7016ce64182820fd928b28660d44e5ee85df5611","basilrabi","2019-05-31 07:00:11","false","fix tutorial instructions

Before, there is no $newcontainer image committed thus
`podman run $newcontainer` attempts to pull $newcontainer from the various
container registries.

Signed-off-by: basilrabi <ericbasil.rabi@gmail.com>

Closes: #1627
Approved by: TomSweeneyRedHat",57,28,0,0
"containers/buildah","1ad8dc0c2443a15c9a3991829dc29e2586862006","nalind","2018-03-06 23:13:24","false","Documentation fixes

Update some comments and a couple of man pages.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #709
Approved by: rhatdan",20,13,0,1
"containers/buildah","8b9fc6e8b62b562caf99575179fb72098d84a7fb","nalind","2018-06-19 17:58:09","false","Set BUILDAH_ISOLATION=chroot when running unprivileged

When we're run by an unprivileged user, default to BUILDAH_ISOLATION=chroot.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #836
Approved by: rhatdan",30,17,0,1
"containers/buildah","0d13621874256fee26b0da055c0ece128c63beff","nalind","2017-06-13 14:20:26","false","Add a --volume flag to ""buildah run""

Add a --volume/-v flag to ""buildah run"" to allow volume bind mounts to
be specified on the command line.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #144
Approved by: rhatdan",13,5,0,1
"containers/buildah","10d622b256d460c4de9ef972d50a2b809bedb858","openshift-merge-robot","2020-12-08 11:53:09","true","Merge pull request #2841 from containers/dependabot/go_modules/github.com/containers/common-0.31.0

build(deps): bump github.com/containers/common from 0.30.0 to 0.31.0",79,46,0,1
"containers/buildah","f5ed35fcf71c034e9c754d666ebaaff5c98a6f29","openshift-merge-robot","2022-04-11 11:26:06","true","Merge pull request #3906 from hshiina/pull-network-backend

Initialize network backend before first pull",24,62,1,1
"containers/buildah","f9b0fbeac88f2b166d908fff118f6747b96623dd","nalind","2022-03-01 15:42:56","false","add: ensure the context directory is an absolute path

When we're processing a context directory, make sure it's an absolute
path.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",30,61,1,1
"containers/buildah","7b1a87a179c21c14e356962301a887f1ba3bed36","nalind","2019-09-05 15:16:56","false","pkg/manifests: add a manifest list build/manipulation API

Rough out an API for building and manipulating the contents of manifest
lists.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1902
Approved by: rhatdan",59,31,0,1
"containers/buildah","1e3b098cb569dddef3a2e397e2882f152e2fbcdc","nalind","2018-10-04 15:38:35","false","Check /proc/sys/user/max_user_namespaces on unshare(NEWUSERNS)

If we get an error when trying to create a new user namespace, check
/proc/sys/user/max_user_namespaces to verify that user namespaces are
available.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1069
Approved by: rhatdan",51,20,0,1
"containers/buildah","f28dcb3751391dc8e5e3a18c2b35b47cc6fb0984","nalind","2017-08-28 14:39:18","false","Auto-set build tags for ostree and selinux

Try to use pkg-config to check for 'ostree-1' and 'libselinux'.

If ostree-1 is not found, use the containers_image_ostree_stub build tag
to not require it, at the cost of not being able to use or write images
to the 'ostree' transport.

If libselinux is found, build with the 'selinux' tag,

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #252
Approved by: rhatdan",29,7,0,1
"containers/buildah","7681e8dd5bfa70d9f92c7db49594ab456e592c34","nalind","2018-09-18 21:07:10","false","Get rid of dangling whitespace in markdown files

Get rid of dangling whitespace in markdown files, and add a quick
validation check to error out if we try to add any new ones.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",36,20,0,1
"containers/buildah","1135bcac5e587dc0313c07b3e7a4bca821414715","nalind","2021-10-26 19:16:06","false","Fix an error message: unlocking vs locking

Don't complain about being unable to lock a descriptor when we attempted
to unlock it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",33,57,1,1
"containers/buildah","2d5701d790e87ef1865b13d2cb2cf5907d510638","nalind","2019-11-22 19:22:26","false","chroot: Unmount with MNT_DETACH instead of UnmountMountpoints()

Unmounting the rootfs with MNT_DETACH should unmount everything below
it, so we don't need to use the more exhaustive method that our bind
package uses for its bind mounts.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1996
Approved by: rhatdan",83,34,0,1
"containers/buildah","ece76e12294bce131e6551937d224040c40fc50a","danmack","2019-05-03 17:41:16","false","Remove must be root statement from buildah doc

Signed-off-by: Dan Mack <mack@macktronics.com>

Closes: #1573
Approved by: TomSweeneyRedHat",53,27,0,0
"containers/buildah","3ad937bbf85330c369fba365cb95bcd6b3a48328","saschagrunert","2019-08-21 09:13:08","false","Remove govet.sh in favor of golangci-lint

golangci-lint already checks via vet so we can safely remove the
additional linting step.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1807
Approved by: vrothberg",54,31,0,1
"containers/buildah","e62d7d9a60e13abafb074fad8982ad57b2b3c1fa","jlebon","2017-03-24 14:44:42","false","hook up to redhat-ci

Add a YAML file to hook up this repo to redhat-ci. I ported over the
tests and environment from the .travis.yml file, though feel free to
customize it to your needs. For more information on supported YAML
fields, please see:

https://github.com/jlebon/redhat-ci/blob/master/sample.redhat-ci.yml

RHCI does also support containerized builds, though the container
environment is unprivileged, which means the tests won't be able to e.g.
mount things. Instead, I set it up so it provisions an Atomic Host on
which we run a privileged container. This is a workflow that will be
made easier in the future.

Closes: #37
Approved by: jlebon",14,2,0,0
"containers/buildah","5264108674f4bd5f5ca748295b4b27586615221e","TomSweeneyRedHat","2023-05-24 18:26:44","true","Merge branch 'main' into docfix2",18,76,1,1
"containers/buildah","54ef0073bcb583fd99bad55444f6245b73b1973c","umohnani8","2019-10-31 01:04:03","false","Add disableFips option to secrets pkg

If disableFips is set, then we don't mount the FIPS
secret even if the machine is in FIPs mode. This is
to help users run workloads that are not fips compliant
in openshift even if their machine is in FIPs mode.
This is needed in CRI-O.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>",82,33,0,1
"containers/buildah","50acd7dea6538ea033928068929e1a9efdcec5ed","openshift-merge-robot","2022-09-12 14:44:29","true","Merge pull request #4232 from containers/dependabot/go_modules/github.com/docker/docker-20.10.18incompatible

build(deps): bump github.com/docker/docker from 20.10.17+incompatible to 20.10.18+incompatible",22,67,1,1
"containers/buildah","2f2086886215cdd0e7098d143e8fa29f34e148a8","rhatdan","2021-01-25 19:45:59","true","Merge pull request #2933 from rhatdan/owners

[ci:docs] Add Ashley and Urvashi to Approvers",94,48,0,1
"containers/buildah","d57d13dfd377edeeaa254da220ba8659825d1b38","rhatdan","2023-08-22 13:13:26","true","Merge pull request #4982 from containers/renovate/major-ci-vm-image

chore(deps): update dependency containers/automation_images to v20230816",9,79,1,1
"containers/buildah","05f60f7e35a6ce29c89ca332a4ebf3cad573309e","rhatdan","2020-02-05 21:27:02","false","Bump github.com/onsi/ginkgo from 1.11.0 to 1.12.0

Bumps [github.com/onsi/ginkgo](https://github.com/onsi/ginkgo) from 1.11.0 to 1.12.0.
- [Release notes](https://github.com/onsi/ginkgo/releases)
- [Changelog](https://github.com/onsi/ginkgo/blob/master/CHANGELOG.md)
- [Commits](onsi/ginkgo@v1.11.0...v1.12.0)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",110,36,0,1
"containers/buildah","74b885b9e23f6e4d973ac7f521c16b02d7676789","Luap99","2023-06-22 16:14:50","true","buildah: add pasta(1) support

Like podman allow buildah and therefore podman build to use the network
mode pasta. The pasta integration is very simple and we do not even
need a teardown handler for that as pasta will exit on its own when the
netns path is removed.

However right now this is broken, pasta will fail to open
/proc/$pid/ns/net. I send a patch[1] to fix this upstream in pasta.
I assume this will land quickly so I like to get this in now just so we
have this included in podman v4.6. Thus the test is skipped for now.

[1] https://archives.passt.top/passt-dev/20230623082531.25947-2-pholzing@redhat.com/

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",13,77,1,0
"containers/buildah","8d5d763213bfb8be0c3129d23c850109fe051eaa","rhatdan","2022-09-18 10:36:08","false","Fix stutters

Podman adds an Error: to every error message. So starting an error
message with ""error"" ends up being reported to the user as

Error: error ...

This patch removes the stutter.

Also ioutil.ReadFile errors report the Path, so wrapping the err message
with the path causes a stutter.

Signed-off-by: Daniel J Walsh dwalsh@redhat.com

[NO NEW TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",19,68,1,1
"containers/buildah","fd7762b7e29d202e81645859e1179b9634ce1e3a","nalind","2017-07-20 17:41:51","false","Try to enable ""run"" tests in CI

Try to ensure that we have runc, so that we can test the ""run"" command
in CI.  In the absence of a compatible packaged version of runc, we may
have to build our own.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #202
Approved by: rhatdan",17,6,0,1
"containers/buildah","f88cddfb4d13723a81f9b561552584b54027abe3","nalind","2017-10-05 20:43:10","false","unit tests: always make sure we have images

In unit tests that assume that one or more images are present, make sure
we actually have pulled some images.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",32,8,0,1
"containers/buildah","f2354b1e9457a0c2eda2b08c3037e975941b5918","openshift-merge-robot","2023-08-24 13:48:56","true","Merge pull request #4994 from rhatdan/containerfile

Use buildah repo rather than podman repo",9,79,1,1
"containers/buildah","61f5dff5c8e54bef2dbe9d22d03e897f39cd2e2e","openshift-merge-robot","2021-04-16 08:10:13","true","Merge pull request #3149 from nalind/trace-level

Log the final error with %+v at logging level ""trace""",52,51,0,1
"containers/buildah","f1ef461a8438607cf3da18b28a9c250eae70fa3b","openshift-merge-robot","2022-12-06 17:26:42","true","Merge pull request #4449 from cevich/fix_job_sequence

[skip-ci] GHA/Cirrus-cron: Fix execution order",18,70,1,1
"containers/buildah","14b1e1c3f13126fa2d971d58c206482fc035b63e","openshift-merge-robot","2023-04-28 14:15:54","true","Merge pull request #4764 from containers/renovate/github.com-opencontainers-runc-1.x

fix(deps): update module github.com/opencontainers/runc to v1.1.7",13,75,1,1
"containers/buildah","b595a98aaca1896f018ce8ce7763260674158634","openshift-merge-robot","2021-01-14 12:42:20","true","Merge pull request #2908 from vrothberg/fix-2904

use local image name for pull policy checks",94,47,0,1
"containers/buildah","080d8393f0c7767a12944f560284e0d5be2631af","openshift-merge-robot","2021-12-03 14:30:47","true","Merge pull request #3654 from MaximUltimatum/patch-1

[CI:DOCS] Simple README fix",30,58,1,1
"containers/buildah","1562cd20ba738f9eaf9f4337ef73ff8ad58f716e","openshift-merge-robot","2021-05-05 15:15:11","true","Merge pull request #3204 from containers/dependabot/go_modules/github.com/containers/image/v5-5.12.0

Bump github.com/containers/image/v5 from 5.11.1 to 5.12.0",50,51,0,1
"containers/buildah","071f851da2ff473a9c45aa6d050266b225a213b4","flouthoc","2023-07-27 09:05:29","true","vendor: bump c/common to v0.55.1-0.20230727095721-647ed1d4d79a

Signed-off-by: Aditya R <arajan@redhat.com>",14,78,1,1
"containers/buildah","40dff190acadda525b83390c6649d32345af2230","openshift-merge-robot","2023-04-01 20:06:58","true","Merge pull request #4694 from containers/renovate/major-ci-vm-image

chore(deps): update dependency containers/automation_images to v20230330",12,74,1,1
"containers/buildah","54e6d7e338995494f220340c72e95a96db318657","openshift-merge-robot","2023-09-05 19:48:09","true","Merge pull request #5026 from containers/renovate/golang.org-x-crypto-0.x

fix(deps): update module golang.org/x/crypto to v0.13.0",8,79,1,1
"containers/buildah","f704a67a19e6b6828759b4b9ff03ec6b5a5c1f70","andrewgdotcom","2023-06-22 16:32:18","true","Update debian install instructions

Signed-off-by: Andrew Gallagher <andrew.gallagher@siren.io>",13,77,1,0
"containers/buildah","d0b8769fbd41c3d810fe840da16d406be5a0efd8","nalind","2018-05-01 21:34:08","false","Drop util.GetLocalTime()

util.GetLocalTime() duplicates time.Time.Local(), so drop it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #649
Approved by: rhatdan",48,15,0,1
"containers/buildah","523b1095d8609c7d9e84abdcab6101f5928036c0","nalind","2018-04-27 14:59:03","false","Add config --comment/--domainname/--history-comment/--hostname

Add options to ""buildah config"" for setting comment, domainname, and
hostname configuration bits, and the comment in history items which
describe layers that we add, and tests for them.  Add a test for the
--shell option while we're at it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #641
Approved by: rhatdan",51,15,0,1
"containers/buildah","3dc0623ac1c718e019e4ab8dd2f62669c1f113ba","nalind","2018-04-26 14:45:52","false","Add example CNI configurations

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",50,15,0,1
"containers/buildah","0de9561b02257f3480a95aa8fa47dc0836eb92ec","openshift-merge-robot","2022-05-17 15:04:20","true","Merge pull request #3999 from vrothberg/source-improvements

buildah source pull/push: show progress bar",24,64,1,1
"containers/buildah","356fd7e89b62c3d75a9c51d1415a30fda97ddd0a","openshift-merge-robot","2020-12-16 20:06:09","true","Merge pull request #2822 from bogdando/source_debug_build

Add a source debug build",80,47,0,1
"containers/buildah","da74fe7c89e6c2c03c68124ac6821cae1671cd44","openshift-merge-robot","2021-06-23 18:24:27","true","Merge pull request #3336 from cevich/master_to_main

Cirrus: Updates for master->main rename",37,53,1,1
"containers/buildah","5dc376c39979a735edd339865090d0fd043a124f","danstiner","2019-04-28 18:57:50","false","Create scratch file in TESTDIR

Avoids littering working directory with scratch files.

Signed-off-by: Daniel Stiner <danstiner@gmail.com>

Closes: #1561
Approved by: TomSweeneyRedHat",52,27,0,0
"containers/buildah","c61ecc696480dc2a20c46de8ef8db5b20f827870","flouthoc","2022-06-01 07:59:52","true","build, commit: allow disabling image history with --omit-history

As per `OCI` `image-spec` setting history is optional so buildah must
support these use-cases via `--omit-history=true` some of the use-cases
are discussed below.

* There are use-cases when image-spec contributes to the image size by
  adding build history to image-spec in certain use-cases this image
history is not required by the end-users but there is no way to remove
it. See: https://github.com/containers/buildah/issues/3513

* Certain build tools don't honor setting build history in image spec
  however buildah does not allow processing images without build history
since setting build history is still optional as per `OCI` image-spec
( https://github.com/opencontainers/image-spec/blob/main/config.md#properties)
so buildah must support such use-cases.

Closes: https://github.com/containers/buildah/issues/4025
Closes: https://github.com/containers/buildah/issues/3513

Signed-off-by: Aditya R <arajan@redhat.com>",25,64,1,1
"containers/buildah","685121b27fa0000a2181846a6748c13012800b3a","flouthoc","2022-01-20 09:21:48","true","vendor: bump c/common and others

Signed-off-by: Aditya R <arajan@redhat.com>",34,60,1,1
"containers/buildah","eb52311c237e5ceed91de01b0eccfee8c1d5100e","openshift-merge-robot","2021-04-23 00:00:28","true","Merge pull request #3178 from rhatdan/log-level

[NO TESTS NEEDED] Remove buildah bud --loglevel ...",50,51,0,1
"containers/buildah","c4492748fb6bc85573a873f2b5add9e2c0c1e0c4","openshift-merge-robot","2022-08-08 21:54:05","true","Merge pull request #4152 from flouthoc/buildah-release-1-27

release: prepare for release `v1.27.0`",17,66,1,1
"containers/buildah","67a3b1884d3edd1deba286452975411b9f1ca7fa","openshift-merge-robot","2022-03-30 20:21:21","true","Merge pull request #3872 from turrisxyz/naveen/feat/pin-deps

[CI:DOCS] Pin actions to a full length commit SHA",26,62,1,1
"containers/buildah","041ea1bf0c0d1ae2e209e97a561f0761d7b13efb","openshift-merge-robot","2021-06-10 20:48:15","true","Merge pull request #3288 from containers/dependabot/go_modules/github.com/containers/storage-1.32.2

build(deps): bump github.com/containers/storage from 1.32.1 to 1.32.2",34,52,1,1
"containers/buildah","05cba7c9074abf25c123d841d13426021070dc47","vrothberg","2019-06-18 11:04:18","false","imagebuildah/build.go: avoid redundant `os.Stat()`

Reported by golangci-lint since the first value of `dinfo` was never
used.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","c48ab4ab613d68e9d3d26943de883b1f4e89620d","edsantiago","2021-01-20 20:46:36","false","Workaround for RHEL gating test failure

One of the auth tests is failing on RHEL8.4:

   # buildah push --tls-verify=true ...
   Get ""https://localhost:5000/v2/"": x509: certificate relies on legacy Common Name field, use SANs or temporarily enable Common Name matching with GODEBUG=x509ignoreCN=0

(Expected output: ' x509: certificate signed by unknown authority')

Cause: who knows? Some internal Go change.

Solution: set magic GODEBUG envariable in the buildah invocation.
This makes that message go away, and gives us the expected one.

Indicate that this may be a temporary workaround. I vaguely
recall reading that a future version of Go would remove it.
We'll deal with that then.

Signed-off-by: Ed Santiago <santiago@redhat.com>",95,48,0,1
"containers/buildah","4853644e3c7311752a8742a618e7a3b3f0d6ba28","vrothberg","2020-09-17 13:12:30","false","tools: update golangci-lint to v1.18.0

Update golangci-lint to v1.18.0.  Purely out of neccessity to get the
tests/tools/go.mod into a working state.  The previous version had a
non-existent dependency which broke all attempts to do anything.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",92,44,0,1
"containers/buildah","2f6cc3ee21f78690b88b0bf925a49c3e59602201","nalind","2017-03-28 21:38:15","false","Use ""scratch"" for tests where we never ""run""

We can use ""scratch"" now as a source for building images, so speed
things up a bit by using it instead of pulling alpine in tests where it
isn't expected to affect the test result.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #55
Approved by: rhatdan",14,2,0,1
"containers/buildah","e92020a4dbf21958776e3648b9aee1f0f5b3a406","nalind","2017-07-21 17:18:56","false","Keep the version in the .spec file current

Add a test to compare the version we claim to be with the version
recorded in the RPM .spec file.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #202
Approved by: rhatdan",19,6,0,1
"containers/buildah","933a4a1107ea9ebbb13671b86227f3745c675cff","nalind","2017-03-28 21:08:37","false","Broaden what ""rmi"" can accept, and add tests

Teach ""rmi"" to handle arbitrary image references and incomplete
references, and add tests for both.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #61
Approved by: rhatdan",14,2,0,1
"containers/buildah","6efaa3d56ea2de0c7c9edd134c14671b2a48ad36","nalind","2017-02-06 19:58:10","false","Another stab at getting go1.6 builds working

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,0,0,1
"containers/buildah","e0d0ad3935bf90aae5687bd21dcc4bf9eb42ea0c","giuseppe","2018-11-12 20:42:55","false","vendor: update ostree-go

solves some compiler warnings with go 1.11

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1174
Approved by: vrothberg",61,21,0,1
"containers/buildah","5d9d28ba1f754deab2cb80db2c9d48916b655605","rhatdan","2018-05-15 12:03:58","false","Attempt to download file from url, if fails assume Dockerfile

If you do a
podman bud http://example.com/Dockerfile

podman currently assumes the file is an archive, if it is not an archive
we should assume it is a Dockerfile, download and create a Dockerfile in the
directory.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #687
Approved by: TomSweeneyRedHat",58,16,0,1
"containers/buildah","d23313bf1b61390f508ccb5f059a8ce286048f3f","rhatdan","2018-08-16 17:49:41","false","Update vendor for containernetworking, imagebuildah and podman

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #939
Approved by: mheon",27,19,0,1
"containers/buildah","70f09da250e53e45ad4f22fb5264876bab555cdf","rhatdan","2021-08-26 14:08:29","true","Merge pull request #3480 from containers/dependabot/go_modules/github.com/containers/image/v5-5.16.0

build(deps): bump github.com/containers/image/v5 from 5.15.2 to 5.16.0",39,55,1,1
"containers/buildah","e39610b9aba29abde464b1ef37f101f679c60f31","rhatdan","2023-02-14 04:48:23","true","Merge pull request #4569 from containers/dependabot/go_modules/golang.org/x/crypto-0.6.0

build(deps): bump golang.org/x/crypto from 0.5.0 to 0.6.0",19,73,1,1
"containers/buildah","4808f3b70c66504abb9e46f390effed16fa741de","rhatdan","2022-09-07 10:22:30","false","Don't call os.Exit(1) from manifest exist

[NO NEW TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",18,67,1,1
"containers/buildah","b643073bce845e3ebeea50110562a84e8a86b9f8","rhatdan","2019-09-04 19:11:51","true","Merge pull request #1836 from bbodiya-akamai/master

fix label and annotation for 1-line Dockerfiles",59,31,0,1
"containers/buildah","08b55f91cc949b0655813e1ca8d2298aa828812c","rhatdan","2021-10-20 18:17:31","false","Rootless containers users should use additional groups

Fixes https://github.com/containers/buildah/issues/3592

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",35,57,1,1
"containers/buildah","ce8d46762895f11a1d57231b28cbd38c070d12f2","ipbabble","2018-05-11 18:36:50","false","Added Docker compatibility demo

Signed-off-by: William Henry @ipbabble <whenry@redhat.com>

Closes: #677
Approved by: rhatdan",56,15,0,0
"containers/buildah","1af95beabad0ec957f6c3edb705fd240a0a50320","rhatdan","2023-06-13 11:38:38","true","Merge pull request #4861 from containers/renovate/github.com-opencontainers-runtime-spec-1.x

fix(deps): update module github.com/opencontainers/runtime-spec to v1.1.0-rc.3",13,77,1,1
"containers/buildah","177b271152cab1858abf1de1d7a8167a9ad36064","saschagrunert","2019-09-03 12:43:19","false","Allow mounts.conf entries for equal source and destination paths

It is now possible to simplify entries in `mounts.conf` files if the
source and destination paths are equal, like this:

```
/my/very/long/path:/my/very/long/path
```

can be now written as:

```
/my/very/long/path
```

The documentation has been adapted as well as the testing.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1832
Approved by: TomSweeneyRedHat",58,31,0,1
"containers/buildah","3b497ff16bd96684351032672f221c48751695b3","TomSweeneyRedHat","2019-03-08 20:22:24","false","Print commitID with --layers

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

When the --layers option is used, the final imageID was
not being printed in the final line.  It was printed two
lines prior.  We still have to print the one two lines up
(at least without major modifications), but now we print
it in the last line as it does for all other circumstances
so it can be grabbed by scripts.

Fixes: #1237

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1396
Approved by: vrothberg",34,25,0,1
"containers/buildah","2441ff4f9f6a5e635f85c177892f096a46503d6f","TomSweeneyRedHat","2018-06-19 15:01:43","false","Add tilde info for push to troubleshooting

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #805
Approved by: rhatdan",30,17,0,1
"containers/buildah","d55a9f8893f76f1d429412a34944c9415e6c439b","edsantiago","2019-12-03 18:18:24","false","PR takeover of #1966

PR 1966 has languished for three weeks without activity from
submitter. In the interests of getting it online, I have
taken it over and:

  - rebased
  - fixed several misunderstandings (bugs) noted in review feedback
  - fixed a few more

I also slightly rewrote two tests (tag by id, commit with name)
that were incomprehensible to me: unnecessary mount/umount and
no actual testing of anything other than checking exit status.
I believe the new code is closer to the intention of testing
but please pay closer attention to those bits.

Also: fixed the basic 'inspect' test. It looks like at some
point in the last month #1917 added a version string to
the buildah-inspect output. The test was fixed on master,
but ypu's PR did not incorporate those fixes and the
test was breaking. I took the liberty of cleaning up
the entire test for readability and maintainability.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2004
Approved by: rhatdan",85,34,0,1
"containers/buildah","ee9b8cde5a3693520bfa52b82f9fd1125ec31753","TomSweeneyRedHat","2017-12-02 21:28:30","false","Create rpm and baseline test script

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #346
Approved by: rhatdan",33,10,0,1
"containers/buildah","8355533be9598075697d557a4f048d5de73eb820","rhatdan","2018-08-01 12:04:50","false","Stop testing with golang 1.8

No one is using this any longer.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #894
Approved by: TomSweeneyRedHat",31,18,0,1
"containers/buildah","0eff8e559211e12825eb5582139d96c17579bea2","rhatdan","2021-06-17 19:41:19","false","buildah copy and buildah add should support .containerignore

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",40,53,1,1
"containers/buildah","632e2859547ce74d55e4ff335b054de1a6193726","rhatdan","2022-01-11 19:16:24","false","Update containers/image and containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",28,59,1,1
"containers/buildah","d43f9acf9e6ee781ea2c66f5a84db385a2874f9b","rhatdan","2019-12-16 21:37:47","false","Bump github.com/containers/image/v5 from 5.0.0 to 5.1.0

Bumps [github.com/containers/image/v5](https://github.com/containers/image) from 5.0.0 to 5.1.0.
- [Release notes](https://github.com/containers/image/releases)
- [Commits](https://github.com/containers/image/compare/v5.0.0...v5.1.0)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",90,35,0,1
"containers/buildah","aaa8cfd42f862e1ec8d7fcc22bc98ca0c3b1a47e","rhatdan","2022-03-30 15:54:28","true","Merge pull request #3840 from giuseppe/create-workdir-with-user

buildah: create WORKDIR with USER permissions",28,62,1,1
"containers/buildah","d1330a5c4680dd18e1d58015f94cb3530c248eb9","rhatdan","2018-02-27 12:11:04","false","Bump to v0.15

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #503
Approved by: rhatdan",19,13,0,1
"containers/buildah","4c6b09caf49582542dbd1da5ff88ee6644403f83","rhatdan","2019-05-13 19:19:56","false","Default Authfile to proper path

We should show the location of the default authfile in user help

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1591
Approved by: TomSweeneyRedHat",57,28,0,1
"containers/buildah","0143a4428b3c700bacf3ef0ee2397c61eb68e724","rhatdan","2018-06-22 16:33:33","false","Add information about the configuration files to the install docs

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #811
Approved by: TomSweeneyRedHat",30,17,0,1
"containers/buildah","2c46e1d925e56b418e365127baf48e38a3c702ef","lsm5","2021-02-05 19:38:25","false","bump containernetworking/cni to v0.8.1 - fix for CVE-2021-20206

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",94,48,0,1
"containers/buildah","c04748f3fb2c55fbb1745e07043192220f162bc0","nalind","2017-10-06 15:23:22","false","Allow specifying store locations for unit tests

Add options for specifying the root location when we're running unit
tests, so that we don't try to use the system's default location, which
we should avoid messing with if we can.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",32,8,0,1
"containers/buildah","d41ac23a039168ac3e596bd5038dbd7726c9368c","nalind","2017-04-12 17:35:48","false","Add a test for USER symlink resolution

Add a test that makes sure we catch cases where we attempt to open a
file in the container's tree that's actually a symlink that points out
of the tree.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #313
Approved by: rhatdan",14,3,0,1
"containers/buildah","88bf2ebdcf4529d6f64f1ffbd727eb73896cd739","nalind","2017-05-16 21:26:02","false","Also import configurations from V2S1 images

Since V2S1 image manifests don't include a config blob, when we
initialize a builder using an image with a V2S1 manifest, try to dig
configuration information out of the manifest's layer history, and build
a V2S2 image configuration using the results.

Leave the diffID list unpopulated, because we compute the right values
when we push the image, and to prevent us from mistakes if we ever try
to use them before that in the future.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #118
Approved by: rhatdan",10,4,0,1
"containers/buildah","ff3451a46937d6381d4d1b31ef154e911c612d00","nalind","2021-02-17 20:05:32","false","copier: fix a renaming bug

When attempting to handle renames, we'd fail to correctly handle renames
of prefixes of a given item's path because of a string handling error,
and add a unit test for the rename logic (finally).

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",60,49,0,1
"containers/buildah","b12735358aaa954c588c5b08e7b425a9c8a2df0c","nalind","2017-11-09 17:02:22","false","""run --hostname test"": print $output more

Make it easier to troubleshoot the ""run --hostname"" test.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #320
Approved by: nalind",30,9,0,1
"containers/buildah","ae7d2f354732f40e113163e8b2a214601517bae2","nalind","2018-01-04 23:07:05","false","Ignore sequential duplicate layers when reading v2s1

When a v2s1 image is stored to disk, some of the layer blobs listed in
its manifest may be discarded as.  Account for this.

Start treating a failure to decode v1compat information as a fatal error
instead of trying to fake it.

Tweak how we build the created-by field in history when generating one
from v2s1 information to better match what we see in v2s2 images.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #383
Approved by: rhatdan",29,11,0,1
"containers/buildah","8e84bb70974b692631f42c1e12ae1651d66f5178","giuseppe","2023-03-23 13:47:58","true","run_linux: Update heuristic for mounting /sys

change the heuristic to mount a fresh sysfs every time a new network
namespace is created.  This modification ensures the creation of the
sysfs when the network namespace is created, which is better than
sharing the one from the host.

Closes: https://bugzilla.redhat.com/show_bug.cgi?id=2164524

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",12,74,1,1
"containers/buildah","f9e645a461eeacad2fa2eb15795fe96e7e421b22","rhatdan","2019-02-02 12:29:05","false","Fix pulling of images within buildah

Change references to Transfer to transfer to make it internal only.
It should be determined from the image specification and only determined
in one place.

Make buildah.Pull use registries.conf

Currently buildah pull does not resolve images based on registries.conf
This does not match the behaviour of buildah from or buildah bud

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1319
Approved by: rhatdan",57,24,0,1
"containers/buildah","87d4ae88645cbd359ba5ba989852c70d616373db","rhatdan","2022-09-15 18:26:37","false","Prevent use of --dns* options with --net=none

This is blocked in Podman for run and create but not
for build, we should block it also for build.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",20,68,1,1
"containers/buildah","a086ec850a9d43669f930a794d66374604418a60","baude","2019-06-01 01:55:36","false","allow 32bit builds

on 32-bit systems, we had type mismatches when creating a
syscall.timespec.

resolves #1629

Signed-off-by: baude <bbaude@redhat.com>

Closes: #1631
Approved by: rhatdan",59,28,0,0
"containers/buildah","95d9d2294926bceaf1347dfc1946a7cd1423e52e","nalind","2017-07-24 20:57:46","false","Prefer higher-level storage APIs

Prefer higher-level storage APIs (Store) over lower-level storage APIs
(LayerStore, ImageStore, and ContainerStore objects), so that we don't
bypass synchronization and locking.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #211
Approved by: rhatdan",18,6,0,1
"containers/buildah","bef61d791d42931b3510f9882f55278ef0bf032e","nalind","2022-07-26 14:42:10","false","tests: don't try to wrap `nil` errors

In a couple of places, we'd try to wrap an error at points after we'd
have returned if they weren't `nil`.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",19,66,1,1
"containers/buildah","933c18f2adc3946b40da25b36ee200d1cf2a230d","nalind","2017-07-10 20:29:27","false","Read the image's creation date from public API

Use the storage library's new public field for retrieving an image's
creation date.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #218
Approved by: rhatdan",17,5,0,1
"containers/buildah","3bd2228516dc44a35b65f2d3f78212c0a49e7bed","nalind","2017-03-24 17:48:39","false","Clarify a comment

Clarify that we're referring to a buildah.Builder object here, and it's
not a capitalization mistake.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",14,2,0,1
"containers/buildah","8acae4b4c24dce3cd4f8922256a76b6bcde5560b","nalind","2021-06-15 18:43:00","false","tests: make it easer to override the location of the copy helper

Make it possible to override the location of the copy test helper by
setting its location in an environment variable, as we do for imgtype.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",36,53,1,1
"containers/buildah","e856d35f2ca0c2cea7162ef3f9fb0b29ec2033ca","vrothberg","2019-06-17 12:11:33","false","buildah test suite: remove unused vars/funcs

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",42,29,0,1
"containers/buildah","4664531b51f6a9904c49635324b7e01c7d4a46fe","vrothberg","2020-02-05 15:19:43","false","bump github.com/mtrmac/gpgme

This will prevent build regressions on older systems such as RHEL 7.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",110,36,0,1
"containers/buildah","d300c614749a860817fb8c443d261bdb7390f154","cevich","2022-07-11 13:59:56","true","GHA: Remove required reserved-name use

Unfortunately github-actions now blacklists `ACTIONS_STEP_DEBUG` from
the list of secrets.  Resulting in the error:

```
Invalid workflow file: .github/workflows/check_cirrus_cron.yml#L25
secret name `ACTIONS_STEP_DEBUG` within `workflow_call` can not be used
since it would collide with system reserved name
```

This is unfortunate since overriding this with a ""secret"" blocks it's
use by users seeking to modify workflows to assist in circumventing
security protections.  Fix the workflow failures by removing references
to this variable name.  The benefits of reliable operation of this
specific monitoring workflow likely outweigh any security gains of
blocking debug-mode.

Signed-off-by: Chris Evich <cevich@redhat.com>",21,65,1,1
"containers/buildah","6421399ae187a0f9cf1ba58614a1b047169cccee","TomSweeneyRedHat","2018-04-14 19:47:39","false","Add tls-verification to troubleshooting

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #586
Approved by: umohnani8",33,15,0,1
"containers/buildah","1967973f8c28573767075a9596a6ce82703b0420","TomSweeneyRedHat","2019-10-12 19:45:04","false","Add completions for Manifest commands

This adds the completions for the manifest commands
found in #1902.  This should not be merged until that
is merged, or perhaps this should be cherry-picked
into it.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1910
Approved by: rhatdan",70,32,0,1
"containers/buildah","229b18f6a8a19f6e8529bf8e40e91030dbb58b94","edsantiago","2019-12-11 19:11:08","false","BATS major cleanup, part 2: use more run_buildah

Replace this pattern:

       cid=$(buildah ...)
with:
       run_buildah ...
       cid=$output

As a special case, if the buildah command is 'from' and the
string 'scratch' does not appear in the arguments, add '--quiet'.
Otherwise we'll get Pulling messages as part of $output. This
is an overkill solution.

For ease of review, this commit was entirely machine-generated via:

   $ perl -pi -e 's{^(\s+)(\S+)=\$\(buildah (.*)\)$}{$indent=$1;$var=$2;$cmd=$3; $cmd =~ s/(\bfrom)\s(?!.*scratch)/$1 --quiet $2/; ""${indent}run_buildah $cmd\n$indent$var=\$output""}e' *.bats

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2029
Approved by: rhatdan",85,34,0,1
"containers/buildah","ae9624ab1f45a66edbafc29e78a9fd174f8f66df","umohnani8","2018-09-25 21:39:22","false","Clear intermediate container IDs after each stage

Since we delete intermediate containers at the end of the whole build
process, we keep track of the intermediate container IDs.
In the case of a multi stage build, we need to clear the container IDs
before each stage to ensure we don't have a container ID repeated.
Before this, the container IDs were repeated and when we delete them
an error would be thrown as it would try to delete a container that
was already deleted.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>",37,20,0,1
"containers/buildah","02f523577373b28d7214694f6c71f7bc71b910e6","nalind","2017-06-14 17:31:43","false","Add a quick note about state version values

Add a note that the version we record in our state file isn't
necessarily the package version, but is meant to change when we make
incompatible changes to the contents of the state file.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #147
Approved by: rhatdan",12,5,0,1
"containers/buildah","914956e83ed6e8504bcad0999dfe5bb40afbb7ad","rhatdan","2018-03-26 11:40:52","false","Make default-mounts-file a hidden option

Also add FILES section to buildah man page to describe the files used
with buildah.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #534
Approved by: @TomSweeneyRedHat",21,14,0,1
"containers/buildah","801da25a6e95b8c45c8f8c51a81f38f7174d04eb","rhatdan","2021-01-07 12:26:31","false","Buildah inspect should be able to inspect manifests

When you create a manifest or pull a manifest, it shows up
inside of the buildah images list.  When you go to inspect it
the inspect code blows up with a cryptic error message.

This patch fixes this problem and just uses the buildah manifest inspect
code.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",91,47,0,1
"containers/buildah","a1d7dca14b8903c2c6cebb674548dc3bfc5af7e2","rhatdan","2018-08-02 13:26:39","false","Fix the the in buildah-config man page

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",28,18,0,1
"containers/buildah","675a7332b73bfdb3e7dcb7f9517818e0d347520b","rhatdan","2022-09-28 19:14:00","false","Vendor in latest containers/storage

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",21,68,1,1
"containers/buildah","8a921a502cff5c47ab8e706d6080346571cbfb58","rhatdan","2023-03-09 16:05:53","true","Merge pull request #4643 from rhatdan/chroot

Add default list of capabilities required to run buildah in a container",16,73,1,1
"containers/buildah","c8a887f51213aeea1cc54d7897064641d029a449","rhatdan","2017-07-17 21:09:30","false","Add support for -- ending options parsing to buildah run

If you specify an option in a buildah run command, the command fails.
The proper syntax for this is to add --

buildah run $ctr -- ls -l /

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #197
Approved by: nalind",18,6,0,1
"containers/buildah","ff5717ab2577375b97c9af6e01b81842f7ebc218","rhatdan","2020-11-19 15:55:02","false","Add suggests cpp to spec file

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",75,46,0,1
"containers/buildah","28a64ee68c11267d7c7f401adab4066e57831ec5","rhatdan","2018-03-17 23:29:50","false","Document the mounts.conf file

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #521
Approved by: rhatdan",19,14,0,1
"containers/buildah","e7e4122e1fa1ded68e37aa165e241917ed0d7020","rhatdan","2019-02-25 15:56:36","false","Move secrets code from libpod into buildah

Starting to remove dependency on libpod from buildah.
secrets is used so that builds can access RHEL subscriptions
so this makes more sense to be in buildah then libpod.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1366
Approved by: vrothberg",59,25,0,1
"containers/buildah","480befa88feaf0fdc5f614345b266b28e94ac676","rhatdan","2017-09-28 11:55:19","false","Add CHANGELOG.md to document buildah progress.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #273
Approved by: rhatdan",31,8,0,1
"containers/buildah","531ef9159d6646b63b5b88e66c2d5a1bcb8942c5","rhatdan","2018-02-06 22:21:41","true","Merge pull request #446 from umohnani8/flags_docs

Add documentation and completions for the following flags",35,12,0,1
"containers/buildah","fd7af1a5e7a6d72559b0378c4bdef2214a93e9d3","Luap99","2021-06-14 15:31:27","false","Fix copy into workdir for a single file

When copying a single file to the workdir make sure to create the workdir
and not to overwrite it as file.

Fixes containers/podman#10671

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",35,53,1,0
"containers/buildah","c21f4bd2f4768dc55c2c4af6398d1fd6f3f96b08","dfr","2022-06-23 10:39:14","false","Make setupMounts and runSetupBuiltinVolumes work on FreeBSD

This involves handling the fact that FreeBSD containers don't have a
Linux section in the spec and that mounting filesystem directories is
done with nullfs rather than bind.

Signed-off-by: Doug Rabson <dfr@rabson.org>",21,65,1,0
"containers/buildah","60f14cf9145ab8d2cb57b51225c9afd49a3727c2","openshift-merge-robot","2022-10-20 09:04:12","true","Merge pull request #4352 from mtrmac/cache-locks

Simplify and fix cache volume locking",24,69,1,1
"containers/buildah","8ba02cde8147f500841186e666abcb9a3494e578","flouthoc","2021-10-26 08:53:20","true","networkpolicy: Should be enabled instead of default when explictly set

NetworkPolicy should be set as NetworkEnabled when expliclty specified using
`--network` instead of silently marking it as NetworkDefault.

NetworkDefault is equivalent to NetworkEnabled but we can use
NetworkEnabled to verify if user explicitly used `--network` and prevent
override from builder configs.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",32,57,1,1
"containers/buildah","32b66ef6a92726047e0065051ddb56c8436fda01","openshift-merge-robot","2021-04-21 10:01:34","true","Merge pull request #3137 from containers/dependabot/go_modules/github.com/containers/image/v5-5.11.0

build(deps): bump github.com/containers/image/v5 from 5.10.5 to 5.11.1",49,51,0,1
"containers/buildah","a5aba5ccd1702605c7f36e312ec51df8516139ad","openshift-merge-robot","2021-09-07 20:34:22","true","Merge pull request #3493 from cevich/clarify_rmi

[CI:DOCS] Clarify rmi w/ manifest/index use",37,55,1,1
"containers/buildah","ea425a2c85d0e62e5aa007877ff96316682213cc","openshift-merge-robot","2022-10-19 10:44:26","true","Merge pull request #4349 from flouthoc/fix-cache-locked

mount,cache: internal `lockfiles` must not be part of user's `cache` content",25,69,1,1
"containers/buildah","0705787a07b470b41e100eac35c40f3513235240","nalind","2017-12-15 15:03:40","false","Bump containers/image

Bump containers/image to 4fdf9c9b8a1e014705581ff77df6446e67a8318d.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #366
Approved by: nalind",35,11,0,1
"containers/buildah","2df08f07f72035fc31ce321522e5facc77e2f38c","nalind","2019-08-09 22:37:32","false","imagebuilder: fix detection of referenced stage roots

Fix detection of when we need to have an up-to-date copy of a stage's
root filesystem for later stages.  ADD and COPY instructions aren't the
first lines in their stages, so we can't stop parsing a stage's lines
after its first line.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1786
Approved by: TomSweeneyRedHat",53,30,0,1
"containers/buildah","6b5f8badc1d8a23b0c928a080d71c70b40ac87b5","nalind","2019-08-22 16:45:36","false","Correctly detect ExitError values from Run()

Correctly detect ExitError error values returned by buildah.Run().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1816
Approved by: TomSweeneyRedHat",56,31,0,1
"containers/buildah","2963474e1795355b40a886c67f2ddf0f70c401f0","nalind","2017-02-13 21:12:02","false","Add a ""run"" command, using runc

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","cf984ebdfd4487184487c59f0b3de93d7b194c65","nalind","2021-09-16 16:57:03","false","conformance: add more tests for exclusion short-circuiting

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",40,56,1,1
"containers/buildah","462df7238f74a18e64bcace82a1da661cb66930f","nalind","2017-03-15 17:55:26","false","Update the README: we actually have some CI tests

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,2,0,1
"containers/buildah","f89b081e05bc4f2d649469f03b702d9b95ddb996","edsantiago","2020-01-31 00:12:04","false","info test: deal with random key order

Looks like the order of keys in the .store map is not
guaranteed; it's causing CI failures in #2115. Keep
checking the results, but be more flexible about order.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2126
Approved by: vrothberg",106,36,0,1
"containers/buildah","759edfb8ec91f1e14574633a47eae3a88157a971","edsantiago","2020-01-30 19:19:58","false","selinux spc test: fix CI breakage

The SELinux spc test is breaking under some CI circumstances in
Fedora 30; most notably, a CI-built buildah (with type != bin_t)
is failing with:

       FAIL: container context matches our own
   expected: 'system_u:system_r:unconfined_service_t:s0'
     actual: 'system_u:system_r:spc_t:s0'

It is not clear to me what the initial purpose of this test
is, since (I believe) the container context should always
be spc_t regardless of the calling process context; likewise,
role should always be system_r.

This commit tweaks the test to check role/type/range
individually.

Needed for #2115

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2125
Approved by: rhatdan",106,36,0,1
"containers/buildah","4a1cd1bc2dfb6f547418fa161e61a1ee57aedc4e","vrothberg","2019-02-26 15:13:45","false","vendor containers/image v1.5

Fixes a race condition in the blobinfocache that can lead to a panic
when copying images.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",61,25,0,1
"containers/buildah","af6e9f375c579b10b9a11e0f3e10639921bfc3ee","naveensrinivasan","2022-04-01 18:26:00","true","Merge branch 'containers:main' into naveen/feat/set-perms-actions",27,62,1,0
"containers/buildah","f4ad4faa12dd8c857ba27f42be5ceff21c151c62","edsantiago","2022-05-17 15:39:43","false","test cleanup

 - remove a bunch of unnecessary clutter (checking $status)
 - add distinct labels to similar-looking tests
 - add check for cpp warning
 - split Containerfile.in test into two parts, one with command-line
   flag and one with envariable, so podman can skip the latter
   in -remote tests while testing the former

Signed-off-by: Ed Santiago <santiago@redhat.com>",24,64,1,1
"containers/buildah","9ff13ec9cc3d7607384852a78d2ba9083b8632bc","vrothberg","2019-06-18 11:19:35","false","StageExecutor: EnsureContainerPath: catch error from SecureJoin()

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","2ecebdd43152503a08d264de9e744128ed368816","vrothberg","2018-08-01 10:31:02","false","preprocess "".in"" suffixed Dockerfiles

Use CPP(1) on any input Dockerfile with a "".in"" suffix.  This allows to
decompose Dockerfiles and make them reusable via the `#include`
directive.  Notice that those Dockerfiles can still be used by other
tools by manually running `cpp -E` on them.

This change affects both, the `imagebuild.BuildDockerfiles(...)` API and
buildah-bud.

Signed-off-by: Valentin Rothberg <vrothberg@suse.com>

Closes: #893
Approved by: rhatdan",31,18,0,1
"containers/buildah","adb8e6f3870ac69ad8e83e399b96d6edc986e79d","umohnani8","2018-04-30 18:29:48","false","Vendor in latest containers/image

Fixes buildah from so a public image can be pulled even if
$XDG_RUNTIME_DIR does not exist. Public images don't require
authentication to be pulled.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #646
Approved by: rhatdan",52,15,0,1
"containers/buildah","5d22f3ced9e7191f0b8c277f792a6ac00b63fba8","afbjorklund","2019-01-06 12:40:23","false","Make rootless work under no_pivot_root

Previously only done for root isolation

Signed-off-by: Anders F Björklund <anders.f.bjorklund@gmail.com>

Closes: #1261
Approved by: rhatdan",51,23,0,1
"containers/buildah","38f60a31143dad0c4f15cece443b267d5fde1711","nalind","2022-01-27 23:08:53","false","imagebuildah.BuildDockerfiles(): create the jobs semaphore

Make sure that, if we're given neither a concurrent jobs count nor a
semaphore to use, we create a semaphore.  Otherwise, each platform in a
multi-platform build will run with maximum concurrency, which isn't the
desired default.  Our CLI always passes in a Jobs count, so it hasn't
been affected by this problem.

[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",34,60,1,1
"containers/buildah","7552de6f0092b55af16df9ce9fd635ef8dfd9fe1","openshift-merge-robot","2022-03-31 15:00:18","true","Merge pull request #3885 from Luap99/runtime-hang

fix hang when oci runtime fails",26,62,1,1
"containers/buildah","65047d4e0e2214fa2ebbb36cfd99197268dd142d","openshift-merge-robot","2023-06-30 14:48:25","true","Merge pull request #4876 from andrewgdotcom/fix-keyserver

[CI:DOCS] Update debian/ubuntu build instructions",13,77,1,1
"containers/buildah","4b3aaeecb69d6d8d85b300b7350eb950d1bba966","openshift-merge-robot","2022-01-19 15:51:04","true","Merge pull request #3717 from kolyshkin/lint

Update golangci-lint, its config, and fix some warnings",32,60,1,1
"containers/buildah","b10cab9963b9df45ecae057a7b4f13ab3fa4c24c","openshift-merge-robot","2022-06-15 04:45:07","true","Merge pull request #4054 from dfr/freebsd-copier-mkdirall

copier: work around freebsd bug for ""mkdir /""",22,65,1,1
"containers/buildah","5038a0dae2129d906eaa701c8f10b043b23afa56","flouthoc","2022-10-11 07:32:19","true","sshagent: LockOSThread before setting SocketLabel

As per the library instruction `sshagent` must acquire `LockOSThread`
before setting and resetting the SocketLabel to ensure that the thread
is locked before following invocation completes setting and reseting the
socket label.

Reference: https://pkg.go.dev/github.com/opencontainers/selinux/go-selinux#SetSocketLabel
Should close: https://github.com/containers/buildah/issues/4245

[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]
Existing tests must pass

Signed-off-by: Aditya R <arajan@redhat.com>",28,68,1,1
"containers/buildah","90ea8902609c83e57452b02528f25a49cdf4dfe6","vrothberg","2018-12-11 10:38:47","false","bump GITVALIDATE_EPOCH

Set it to 87cb532ab33f1f242a56e362e799f95549519d3b in order to ignore an
unsigned commit breaking CI.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1230
Approved by: rhatdan",50,22,0,1
"containers/buildah","8c18a2e628a9a2be402f076d3c45f3bf91c18efe","vrothberg","2019-05-29 13:25:42","false","chroot/run.go: check errors in deferred calls

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1624
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","6bb5172d08efee36989e6839f402a46ad5a903ab","barthy1","2021-03-04 14:58:28","false","Update multi-arch buildah build setup with new logic

- push `quay.io/buildah/stable:vX.X.X` and `quay.io/contaners/buildah:vX.X.X`
only one time for each `:v` version
- build verification is still on the table
- replace `master` to `main` tag for `quay.io/buildah/upstream:main`

Signed-off-by: Yulia Gaponenko <yulia.gaponenko1@de.ibm.com>",57,49,0,0
"containers/buildah","fe947ed9ccb9d86006fbcdc44804e717af550dad","mtrmac","2023-07-31 15:31:53","false","Add a missing .Close() call on an ImageDestination

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",14,78,1,1
"containers/buildah","a47dee2c8eda0f0f98618927734ed7f4506ada0b","cevich","2022-07-26 17:57:25","true","Cirrus: Use the latest imgts container

Contains important updates re: preserving release-branch CI VM images.
Ref: https://github.com/containers/automation_images/pull/157

Signed-off-by: Chris Evich <cevich@redhat.com>",19,66,1,1
"containers/buildah","441961215085b856cc3950167206b808dfacabe3","umohnani8","2017-11-09 17:52:50","false","Add manifest type conversion to buildah push

buildah push supports manifest type conversion when pushing using the 'dir' transport
Manifest types include oci, v2s1, and v2s2
e.g buildah push --format v2s2 alpine dir:my-directory

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>

Closes: #321
Approved by: rhatdan",30,9,0,1
"containers/buildah","08e942383b90f2f84a4597b7bebb7681def61666","vrothberg","2018-12-19 10:20:31","false","vendor parallel-copy from containers/image

Parallel copying of layers is currently supported when pulling from
a registry to the storage.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",52,23,0,1
"containers/buildah","2e485df3366ca09c44085af695f880381390ac14","vrothberg","2019-06-17 12:25:30","false","fix ""ineffectual assignment"" lint errors

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",42,29,0,1
"containers/buildah","b3e39dfd94e81fa1f90314ac3ae63c46f9ab8dbc","mtrmac","2023-04-18 19:10:27","false","Don't decrypt images by default

A non-nil but empty decryption configuration
seems to be valid enough to trigger decryption in some
configurations, per
https://github.com/containers/podman/issues/18196 .

Like in Skopeo and Podman, only decrypt when the user explicitly
instructs us to (e.g. not triggering decryption based on environment
variables).

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",12,75,1,1
"containers/buildah","a925ba6e2df9aec10f4a9a1a5c85877c66da0bd1","mtrmac","2019-02-23 01:42:57","false","Explicitly specify a directory to find(1)

On macOS, (find -name ...) fails; a starting directory
must be specified.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1365
Approved by: rhatdan",59,25,0,1
"containers/buildah","dcae0ac75c2ad29bcf9987f02f60fac297a0d0cf","mtrmac","2019-02-21 22:08:48","false","Document the semantics of transport+name returned by ResolveName

Does not change behavior.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","3afa5ca74d6a7de2a7d292019864980f3aa94efb","NotBobTheBuilder","2023-03-25 10:32:47","false","build: accept arguments from file with --build-arg-file

Allows codifying build arguments into a structured file, perhaps one
named arguments.Containerargs

The build arg file also accepts comments starting #, so automated
tooling or CI/CD workflows can monitor arguments like versions to
ensure they are up-to-date.

Signed-off-by: Jack Wearden <jack@jackwearden.co.uk>",12,74,1,0
"containers/buildah","f1f008a08669467195751a0a2941dbd3a5f86774","flouthoc","2021-10-08 07:56:48","true","docs: Fix and Update Containerfile man page with supported mount types

Signed-off-by: Aditya Rajan <arajan@redhat.com>",42,56,1,1
"containers/buildah","bc68b59aeabb58a288344874cf1561451dcfc925","openshift-merge-robot","2023-08-08 13:01:52","true","Merge pull request #4959 from martinpitt/packit-temp-copr

packit: Build PRs into default packit COPRs",11,78,1,1
"containers/buildah","0c4b19ba83d92e57a0fb5d11a981057c7fe179e2","Juneezee","2022-08-20 07:02:40","true","test: use `T.TempDir` to create temporary test directory

This commit replaces `ioutil.TempDir` with `t.TempDir` in tests. The
directory created by `t.TempDir` is automatically removed when the test
and all its subtests complete.

Prior to this commit, temporary directory created using `ioutil.TempDir`
needs to be removed manually by calling `os.RemoveAll`, which is omitted
in some tests. The error handling boilerplate e.g.
	defer func() {
		if err := os.RemoveAll(dir); err != nil {
			t.Fatal(err)
		}
	}
is also tedious, but `t.TempDir` handles this for us nicely.

Reference: https://pkg.go.dev/testing#T.TempDir
Signed-off-by: Eng Zer Jun <engzerjun@gmail.com>",17,67,1,0
"containers/buildah","ed77a92a673518907c75f7e778ddbd98d6e45c7e","giuseppe","2019-05-25 11:54:58","false","unshare: set _CONTAINERS_ROOTLESS_GID

so that rootless podman works correctly within a namespace created
with buildah unshare.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1614
Approved by: vrothberg",54,28,0,1
"containers/buildah","7180312fdf0255c83780457dfca04467eac4a5bb","giuseppe","2019-08-09 13:22:38","false","run_linux: fix mounting /sys in a userns

fix the detection code for running in a user namespace.  When buildah
is running in rootless mode, a user namespace is automatically created
even if there are no mappings configured.

Closes: https://github.com/containers/libpod/issues/2972

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1775
Approved by: rhatdan",51,30,0,1
"containers/buildah","50539b58e47143ef0741b18a8812139973b79be8","giuseppe","2019-02-05 10:39:27","false","unshare: do not set rootless mode if euid=0

when doing an unshare, do not set rootless mode unless the euid != 0.

Closes: https://github.com/containers/buildah/issues/1296

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1323
Approved by: rhatdan",57,24,0,1
"containers/buildah","3e26f9e073a1080467bdd03a16b4db95e1cd413c","ypu","2019-10-22 11:50:25","false","Tests: Add two test for buildah add

Add following tests for buildah add
1. buildah add test with --chown
2. buildah add url test

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #2004
Approved by: rhatdan",80,33,0,0
"containers/buildah","eb325d07336db9b88dbb32fc1fff0b108d079da9","TomSweeneyRedHat","2019-03-28 21:22:09","false","Bump to v1.7.2

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1457
Approved by: rhatdan",46,26,0,1
"containers/buildah","70d8ab94953ab6338de6d62517544e12e8489ad1","rhatdan","2023-09-14 09:05:47","true","Merge pull request #5042 from rhatdan/VENDOR

Bump vendor containers/(common, storage, image)",5,80,1,1
"containers/buildah","b94b2354433cba739e2a74ac9582ddf4a94cdb27","rhatdan","2020-01-29 15:11:23","false","Fix parse_unsupported.go

Also fix sort order for buildah.Options so they are easier to compare with
podman build.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #2119
Approved by: TomSweeneyRedHat",107,36,0,1
"containers/buildah","4b38cff0057503b8e1c3651e295a47f0bebbbe5e","rhatdan","2017-09-22 09:39:33","false","Cleanup buildah-push code

1. Sort options so they are in alphabet order
2. Remove extra lines of code for options parsing that really do not accomplish anything.
3. Remove variables when they are not necessary, I.E. Don't create a variable to hold an
option that is only used once, use the option instead.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #267
Approved by: <username_without_leading_@>",34,8,0,1
"containers/buildah","1ff7043e320a406f3d252942b92a0ff7297c1d73","rhatdan","2019-10-30 19:03:26","true","Merge pull request #1954 from giuseppe/drop-ostree

build: drop support for ostree",82,33,0,1
"containers/buildah","01f8c7afee0167b5e7674e8fd075b9cac02dc383","rhatdan","2018-01-03 13:26:18","false","Remove chrootuser handling and use libpod/pkg

I have made a subpackage of libpod to handle chrootuser,
using the user code from buildah.

This patch removes user handling from buildah and uses
projectatomic/libpod/pkg/chrootuser

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #377
Approved by: nalind",30,11,0,1
"containers/buildah","98f153373101498a25eda4c39e6dfacedba7df41","boaz0","2017-12-07 12:09:45","false","Small nitpick at matches(Since,Before)Image in cmd/buildah/images

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>",31,10,0,0
"containers/buildah","c8199fc161a0a394a0fe46fed045b8f40cf8d87d","rhatdan","2018-09-24 11:19:11","true","Merge pull request #985 from giuseppe/unshare-keep-initial-groups

unshare: keep the additional groups of the user",37,20,0,1
"containers/buildah","f4e43f0e81d0a9030690d967986ca47259cd25e9","dfr","2023-08-24 16:41:00","false","pkg/chrootuser: Ignore comments when parsing /etc/group on FreeBSD

Signed-off-by: Doug Rabson <dfr@rabson.org>",9,79,1,0
"containers/buildah","b4c5e93fd72d3605a1fbe399425d00543814537d","openshift-merge-robot","2021-10-14 18:55:55","true","Merge pull request #3583 from containers/dependabot/go_modules/github.com/onsi/ginkgo-1.16.5

build(deps): bump github.com/onsi/ginkgo from 1.16.4 to 1.16.5",36,57,1,1
"containers/buildah","c9cbc6d7d254abb59987e515b32307fc8b875ed3","sstosh","2023-01-25 04:15:40","false","tests: improve build-with-network-test

This test could be failed when we enable firewall.
To reduce the impact of firewall, we use ""curl"".

Signed-off-by: Toshiki Sonoda <sonoda.toshiki@fujitsu.com>",19,72,1,0
"containers/buildah","001f3d4cc52a9cfc49823503cf733ccd5a8e9673","openshift-merge-robot","2022-12-06 09:14:51","true","Merge pull request #4445 from rhatdan/VENDOR

Vendor in containers/common",18,70,1,1
"containers/buildah","6f660bde17b139aa12c1061f5b61b9ef9ae6d167","flouthoc","2022-07-18 05:47:55","true","build,cache: support pulling/pushing cache layers to/from remote sources

Following commit

* Initiates `cacheKey` or `layerKey` for intermediate images generated
  for layers.
* Allows end users to upload cached layers with `cacheKey` to remote
  sources using `--cache-to`. `--cache-to` is a optional flag to be used
with `buildah build` which publishes cached layers to remote sources.
* Allows end users to use cached layers from `remote` sources with
  `--cache-from`. `--cache-from` is a optional flag to be used with
`buildah build` and it pulls cached layers from remote sources in a step
by step manner only if is a valid cache hit.

Example
* Populate cache source or use cached layers if already present
```bash
buildah build -t test --layers --cache-to registry/myrepo/cache --cache-from registry/myrepo/cache .
```

Future:
* `cacheKey` or `layerKey` model is only being used when working with
  remote sources however local cache lookup can be also optimized if its
is altered to use `cacheKey` model instead of iterating through all the
images in local storage. As discussed here

References:
* Feature is quite similar to `kaniko`'s `--cache-repo`: https://github.com/GoogleContainerTools/kaniko#--cache-repo

Closes: issues#620

Signed-off-by: Aditya R <arajan@redhat.com>",24,66,1,1
"containers/buildah","db6943a170192f651f8d932d23183f29bed63612","flouthoc","2022-01-04 08:00:58","true","overlay: add MountWithOptions to API which extends support for advanced overlay

Expose `MountWithOptions` for overlay which allows users to pass more
verbose configuration for overlay mounts.

For instance `upperdir, workerdir` and in future `volatile`.

Signed-off-by: Aditya R <arajan@redhat.com>",26,59,1,1
"containers/buildah","c79f72723c451ea2eb8fd113ee48859b0ccc8b86","flouthoc","2022-07-21 08:15:48","true","imagebuildah: optimize cache hits for COPY and ADD instructions

While processing `COPY` and `ADD` try for cache hits in the first
iteration by adding content and populating summary with the digest
generated after adding the content and ignore processing same
instruction again if they were evaluated in the first pass to save
cycles.

Signed-off-by: Aditya R <arajan@redhat.com>",19,66,1,1
"containers/buildah","c7d828ffa169ab356c288b66889ae23b13af0153","openshift-merge-robot","2021-06-26 09:27:10","true","Merge pull request #3338 from rhatdan/block

Turn stdio back to blocking when command finishes",37,53,1,1
"containers/buildah","753716a1f7775146ee63abf1ce40bf8e4413bf84","openshift-merge-robot","2021-09-16 21:34:06","true","Merge pull request #3521 from nalind/exclusions

conformance: add more tests for exclusion short-circuiting",40,56,1,1
"containers/buildah","e17534d816c7b3ede25313ce088c1c0e635acd8e","pixdrift","2018-05-09 13:51:58","false","Add cpu-shares short flag (-c) and cpu-shares CI tests

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #670
Approved by: rhatdan",53,15,0,0
"containers/buildah","f330c77bedbd93003f59c1dee9134915ba90feaa","cevich","2023-08-25 20:53:32","true","GHA: Attempt to fix discussion_lock workflow

After initial merge, manually running this workflow resulted in the
following error:

```
Invalid workflow file: .github/workflows/discussion_lock.yml#L14
The workflow is not valid. .github/workflows/discussion_lock.yml (Line:
14, Col: 3): Error calling workflow
'containers/podman/.github/workflows/discussion_lock.yml@main'. The
workflow is requesting 'contents: read', but is only allowed 'contents:
none'.
```

Attempt to fix this by adding `contents: read` permission.  Why this
isn't the default, and exactly what the meaning of `none` is for all the
other permissions is a mystery (and it's not documented).

Ref: https://github.com/containers/buildah/pull/4991

Signed-off-by: Chris Evich <cevich@redhat.com>",8,79,1,1
"containers/buildah","822a288ba9d638dccb75b319ba82d759db03a9bd","TomSweeneyRedHat","2022-03-25 14:25:06","false","Bump to v1.26.0-dev

[NO NEW TESTS NEEDED]

As the title says.

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",29,62,1,1
"containers/buildah","f9ef51cbb1d5e2c8a5014fb5137217dffad9a455","TomSweeneyRedHat","2023-01-20 22:32:42","false","[CI:DOCS] Fix two diversity issues in a tutorial

Touch up a couple of diversity issues in one of the tutorials.

Changes the word ""master"" to ""primary"".

[NO NEW TESTS NEEDED]

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",19,72,1,1
"containers/buildah","8f05aa69330e058084c69f703d76cfd9668aa137","TomSweeneyRedHat","2018-12-14 12:08:34","false","Handle one line Dockerfile with layers

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1238
Approved by: vrothberg",51,22,0,1
"containers/buildah","3cd0fa2bf429ec2e71932bb342da4e1ce47eace9","flouthoc","2022-09-22 08:31:30","true","config,builder: process variant while populating image spec

When processing config for a builder and populating image-spec we must
process Variant along with Architecture and Operating system.

Closes: https://github.com/containers/buildah/issues/4276

Signed-off-by: Aditya R <arajan@redhat.com>",20,68,1,1
"containers/buildah","b72bda2dff2ce5af0656df07178331adb56557e3","nalind","2019-11-27 16:31:02","false","pull/from/commit/push: retry on most failures

If PullOptions/BuilderOptions/CommitOptions/PushOptions includes a
MaxRetries value other than 0, retry operations except for (currently)
connection-refused, authentication, and no-such-repository/no-such-tag
errors, at a default-but-configurable interval of 5 seconds.

Set the default for `buildah pull/from/commit/push` to 3 retries at 2
second intervals.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",83,34,0,1
"containers/buildah","ec4bbe6638d8f43f3f4ab684bee68c17ac6a1848","nalind","2020-01-17 15:48:59","false","parse: don't complain about not being able to rename something to itself

In DeviceFromPath(), don't complain about not being able to rename a
device when the previous and new names are the same.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #2106
Approved by: rhatdan",101,36,0,1
"containers/buildah","a586779353b28404c74c6259f2cb69dce0632f43","rhatdan","2018-02-12 15:17:25","false","We are copying a directory not a single file

When populating a container from a container image with a
volume directory, we need to copy the content of the source
directory into the target.  The code was mistakenly looking
for a file not a directory.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #471
Approved by: nalind",18,13,0,1
"containers/buildah","a059244207b4494452d2eaac04ae572c688da78f","rhatdan","2023-10-12 13:01:25","true","Merge pull request #5081 from flouthoc/fix-base-removal

imagebuildah,multi-stage: do not remove base-image when built without `--layers`",6,80,1,1
"containers/buildah","fa880553af287856c74f797ae70b12d1ee0c0206","rhatdan","2023-01-24 21:01:11","true","Merge pull request #4537 from edsantiago/reenable_flake

Flake 3710 has been closed. Reenable the test.",19,72,1,1
"containers/buildah","2110f053e1bbe84e5273480e01399e2109c28318","rhatdan","2019-07-19 13:40:20","true","Merge pull request #1734 from rhatdan/bump-1.9.2

Bump 1.9.2",49,30,0,1
"containers/buildah","1ca41dcbcb7e5c90bd20b0dc1f2401d7c21238aa","umohnani8","2018-03-19 02:16:47","false","Add various transport support to buildah from

buildah from now supports pulling images using the following transports:
docker-archive, oci-archive, and dir.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #524
Approved by: TomSweeneyRedHat",19,14,0,1
"containers/buildah","f5f2cb1887fc5ff655ff55bd43ba19c5f93d7919","mtrmac","2019-02-21 23:11:51","false","Move the computation of srcRef before first pullAndFindImage

This only moves the code, does not modify it at all; a separate
commit to make review easier.

pullImage eventually computes the same value anyway, so this
should not change behavior.  We will soon remove the redundant
value in pullImage.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","604fdb0de1b4fa6c57832905465a6b9393ff5a3b","rhatdan","2018-03-20 09:41:19","false","Fix man pages to format correctly

I noticed when you look at the man pages with man ./doc/buildah.1 that the
headings were not showing up.  go-md2man wanted to have a primary header
in order to format them correctly.  Removing the first # from the first line
fixes the issue.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #521
Approved by: rhatdan",19,14,0,1
"containers/buildah","9cbccf88cfc1f6e205af30f7e048eab0949468ad","rhatdan","2017-09-22 10:10:31","false","Merge pull request #268 from rhatdan/master

Bump to version 0.4",34,8,0,1
"containers/buildah","e8c9ea2b03a045073c950b2976a2dd56b2f1fc3a","QiWang19","2019-03-21 19:12:47","false","Export fields of the DokcerIgnore struct

export fields in DockerIgnore struct for implementing the dockerignore in libpod
Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1431
Approved by: rhatdan",36,26,0,1
"containers/buildah","c2c52ba5e0abc73b0134caa706d9d102bf6af275","rhatdan","2019-08-19 15:05:13","true","Merge pull request #1801 from containers/update-readme

README: mention that Podman uses Buildah's API",54,31,0,1
"containers/buildah","7468369c0bca6e335269a62824f47db3c49ee6f7","rhatdan","2023-06-08 11:13:44","true","Merge pull request #4835 from containers/renovate/github.com-containers-storage-digest

fix(deps): update github.com/containers/storage digest to 3f3fb2f",15,76,1,1
"containers/buildah","90868620d4519fa640b0d41456eb2384414431e7","cevich","2019-11-08 15:53:12","true","Cirrus: Migrate off papr + implement VM testing

Signed-off-by: Chris Evich <cevich@redhat.com>",79,33,0,1
"containers/buildah","998f98efe3eda92c1fb1d0066d1850cd1b48fc92","cevich","2020-11-13 16:14:07","true","Cirrus: Native OSX Build

These changes execute the cross-compile build naively on an OSX VM to
more thoroughly verify multi-platform support (other than on Linux). In
other words, it better confirms that any Linux-only changes do not leak
into non-Linux environments.  This change also enables greatly
simplifying automation scripts, as there is no longer any need to
support/check the `$CROSS_TARGET` variable.

Signed-off-by: Chris Evich <cevich@redhat.com>",75,45,0,1
"containers/buildah","4cf93e3edca26a623f31540d1f4c1272815aaa73","cevich","2022-05-26 16:27:06","true","Fix use generic/ambiguous DEBUG name

The use of the generic 'DEBUG' name in varialbes or flags can be very
problematic and lead to difficult to troubleshoot problems.  Update CI
VM images to those including updated automation library that uses the
`$A_DEBUG` env. var. instaed.  Also update other repository files which
make use of the generic form.

Signed-off-by: Chris Evich <cevich@redhat.com>",25,64,1,1
"containers/buildah","92582a75cc24b06993bdf41c47f6ec10671f2c27","cevich","2023-05-04 16:09:49","true","Remove use of deprecated tar.TypeRegA

Fixes golangci-lint message:

`tar.TypeRegA has been deprecated since Go 1.11 and an alternative has
been available since Go 1.1: Use TypeReg instead.`

Signed-off-by: Chris Evich <cevich@redhat.com>",9,75,1,1
"containers/buildah","2941f346db6c0773f31d7eac552fa36212518a77","TomSweeneyRedHat","2019-04-16 22:07:03","false","Bump to v1.7.3

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1524
Approved by: rhatdan",54,27,0,1
"containers/buildah","8891d05dbaffc0b6013a48a68177b4ccec281f8c","TomSweeneyRedHat","2020-10-29 22:20:32","false","Bump to v1.17.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",67,45,0,1
"containers/buildah","146a0fc49b6870a88981912d59243caf51acc399","giuseppe","2019-02-14 09:36:29","false","mount: make error clearer

Closes: https://github.com/containers/buildah/issues/1279

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1339
Approved by: rhatdan",60,25,0,1
"containers/buildah","cb20f4169dc39ff24858d1d179b908268dda4dd3","nalind","2021-03-05 20:51:14","false","overlay.bats: fix the ""overlay source permissions"" test

Fix a mismatch between ""$permissions"" being set and ""$permission"" being
read.

Don't expect changes made to an overlay mount in a working container to
persist between subsequent ""buildah run"" invocations, since they don't.

Use 'stat -c %a' rather than 'ls -l | cut -f1 -d "" ""' to read the
permissions on a mount upper directory, so that different versions of
""ls"" appending ""."" to ""drwxrwx---"" (or not) doesn't cause unexpected
mismatches.

Create a file in the lower directory before checking that our attempt to
remove it in the upper layer succeeds.

Expect error code 1 when ""buildah run $container ls"" can't find a file
which we know whouldn't exist, rather than 125.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",57,49,0,1
"containers/buildah","a925f79cc32c28643cdde607cd38be06e5a11645","nalind","2020-01-15 17:23:38","false","add --sign-by to bud/commit/push, --remove-signatures for pull/push

Add the --sign-by option to `buildah build-using-dockerfile`,
`buildah commit`, `buildah push`, and `buildah manifest push`.  Add the
`--remove-signatures` option to `buildah pull`, `buildah push`, and
`buildah manifest push`.  We just pass them to the image library, which
does all of the heavy lifting.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #2085
Approved by: rhatdan",101,36,0,1
"containers/buildah","90b3254c7404039c1c786999ac189654228f6e0e","nalind","2022-03-24 20:32:47","false","Add a test for CVE-2022-27651

Check that the inheritable capabilities are set to 0, even when we
explicitly try to add capabilities.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",31,62,1,1
"containers/buildah","5aa416e20d8b486e1d874908d37e19b9d5803021","nalind","2019-01-08 22:00:41","false","Update some comments

Descriptions of types that include the type names didn't always match
since we last renamed things.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1272
Approved by: rhatdan",51,23,0,1
"containers/buildah","f46ed32a11fa94a27c1a6cca43489073324fd2d5","nalind","2017-06-28 18:34:41","false","Build imgtype independently

Just build imgtype once, and reuse the flags we use for the main binary.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #174
Approved by: rhatdan",20,5,0,1
"containers/buildah","07ab5a5c5921b7059a5075739d0ecac72d0f34fe","lucacome","2022-09-27 02:31:20","true","Check for unset build args after TARGET args

Signed-off-by: Luca Comellini <luca.com@gmail.com>",21,68,1,0
"containers/buildah","df84d012a08be7293b3644727ce4c11d86c4c14a","cevich","2021-06-16 20:55:48","true","Workaround appearance of differing debug messages

This test was observed failing in upstream CI on all platforms due to
the contents of debug messages changing after updating runc.  Since the
system tests need to function on multiple platforms with inconsistent
runc versions (depending on testing context), match a more general
output message on success.  Specifically, the test really only cares
that debugging output appears and that runc is always used.

Signed-off-by: Chris Evich <cevich@redhat.com>",39,53,1,1
"containers/buildah","faee129628c84121479eaa7738e7e20e6098172d","Luap99","2022-04-14 14:40:17","true","update c/common to latest main

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",25,63,1,0
"containers/buildah","92ff21584fc46fc9d4a1d24577632b53cb97d892","saschagrunert","2019-10-14 11:47:18","false","Fix .dockerignore exclude regression

In #1715 we added an additional valid path for `!excludes.Exclusions()`
when considering a full copy of the source directory to the destination
via `ADD`/`COPY`. This breaks the functionality of the `.dockerignore`
file, because `PatternMatcher.Exclusions` is true if any of the defined
patterns contain an exclusion (the pattern starts with `!`). This means
if we have no Exclusions defined at all, the `.dockerignore` behavior
does not work any more.

To still have the optimization in, we now skip whole directories if the
patterns to exclude match in a pure way.

Introduced by: https://github.com/containers/buildah/pull/1715
Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1914
Approved by: rhatdan",71,33,0,1
"containers/buildah","b288b7a3d96a0c8ee2e0d580402a1a335a29f35b","saschagrunert","2019-08-20 08:13:20","false","Update shebangs to take env into consideration

Some operating systems don’t have `bash` in `/bin`, so we should take the
`$PATH` into consideration for searching it.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1804
Approved by: TomSweeneyRedHat",53,31,0,1
"containers/buildah","16e301031e1502be70728ba508e1c30595b916c3","saschagrunert","2019-07-16 08:47:48","false","Add unparam linter and apply fixes

This commit enabled the `unparam` linter and applies all reported issues.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1719
Approved by: rhatdan",48,30,0,1
"containers/buildah","1d0b48d7da4b63ab7f9e6264c3d87203b8270fb6","TomSweeneyRedHat","2017-09-09 22:33:28","false","Add default transport to push if not provided

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #260
Approved by: rhatdan",32,7,0,1
"containers/buildah","86c1cd4610e64baa05b45b1816986d79db220c5a","nalind","2021-10-01 18:55:46","false","chroot: accept an ""rw"" option

crun and runc accept a ""rw"" option, so we should expect to see it from
time to time.  Recognize ""dev"", ""suid"", and ""exec"", too.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",42,56,1,1
"containers/buildah","e9a11cdf6a1e586b08b41fb520c2bccd559abff7","nalind","2018-06-04 21:35:19","false","setupSeccomp(): refactor

Rework setupSeccomp() to use switch{} instead of multiple if{} tests
when deciding how to set the Seccomp configuration for a container.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #793
Approved by: rhatdan",37,16,0,1
"containers/buildah","515449659fccb520bc404d7892c155e463f0a7d9","nalind","2019-07-15 22:01:51","false","unshare: add a --mount flag

Add a --mount flag to `buildah unshare`, so that the command it runs can
have a container's root filesystem mounted, and the location where it's
mounted provided in its environment.

This is primarily aimed at cases where `buildah unshare` is used to run
one-liner commands, as proper scripts can simply call `buildah mount`
themselves.

Users still have to be careful about quoting references to the environment
if the command needs to be executed by a shell (for example, if it's run
as `buildah unshare --mount foo sh -c 'ls $foo'`), so that the shell
that's invoking `buildah unshare` doesn't try to expand the variable's
value first.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",49,30,0,1
"containers/buildah","084b9e4694a4e077eee268f628ea947ce434c381","nalind","2017-02-06 19:38:56","false","Fixup vendored engine-api for go 1.5

Fix builds against go 1.5.  This should be temporary, since code we
vendor which depends on engine-api should be moving to something else.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,0,0,1
"containers/buildah","4d9da85473f8b19a38b72005f10484d66ddb8af5","giuseppe","2019-06-24 10:24:33","false","rootless: add the built-in slirp DNS server

add the slirp built-in DNS server when using slirp4netns.

Closes: https://github.com/containers/buildah/issues/1660

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1688
Approved by: TomSweeneyRedHat",44,29,0,1
"containers/buildah","25e3ddf804eaf29a8ad129e349de9c44c876e97c","ypu","2018-08-28 15:35:30","false","Remove debug lines

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #965
Approved by: rhatdan",30,19,0,0
"containers/buildah","3e44ece0fe8a96329ed8dff15e22fcbce545a9aa","rhatdan","2023-06-13 11:38:03","true","Merge pull request #4746 from rhatdan/docs

Change util.EncryptConfig,DecryptConfig, GetFormat and make it public",13,77,1,1
"containers/buildah","62babae27fa61bf735df147f637036fdec9b7c6c","rhatdan","2018-09-12 13:28:38","false","Evaluate symbolic links on Add/Copy Commands

Users expect to be able to use Symbolic links in the
ADD and COPY commands in Dockerfiles.  We need to evaluate
these and pull in the correct content.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1007
Approved by: nalind",38,19,0,1
"containers/buildah","73417580148a07e2f8d6fc93ff6881a0a28e09a0","rhatdan","2018-11-05 22:04:26","false","Fix travis to not run environment variable patch

We are accidently running only one tests with the environment set, and that
ends up running separate from the main tests.

This patch should make the tests run a little faster and run all test with the
enviromnent turned on.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1159
Approved by: rhatdan",57,21,0,1
"containers/buildah","93747b1fd5124fdc64344e569b79a8ec49d5f8ae","rhatdan","2019-02-26 20:27:29","true","Merge pull request #1370 from TomSweeneyRedHat/bump-1.7.1

Bump to v1.7.1",61,25,0,1
"containers/buildah","ba012ddec690d0ad0330c89ba9f50bd06360e8f1","rhatdan","2018-09-17 19:20:16","false","Move buildah from projecatatomic/buildah to containers/buildah

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",37,20,0,1
"containers/buildah","5279dd86c54ce33ebfe51e964e79965db8b81395","rhatdan","2023-06-29 13:31:18","true","Merge pull request #4890 from Juneezee/chore/yaml

chore: replace `github.com/ghodss/yaml` with `sigs.k8s.io/yaml`",13,77,1,1
"containers/buildah","a73e108bd0899c208e2e69ae5feb9594888c08dd","rhatdan","2021-12-14 22:11:32","false","Allow callers to replace the ContainerSuffix

This idea of this PR is to allow Podman to add a Podman
prefix to containers. This would allow it to keep track
of containers created by Podman and make it easier to remove
them when it wants to remove all.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",32,58,1,1
"containers/buildah","bae9047e5ceaed234cfc0b2c82eb4d721667b71d","rhatdan","2023-03-11 11:25:51","true","Merge pull request #4650 from flouthoc/cache-to-with-mount

stage_executor,cache-to: attempt to push cache only when `cacheKey` is valid",17,74,1,1
"containers/buildah","e53fc16b9f470a137abf182b0561a16447bfd5b7","rhatdan","2019-12-17 16:01:52","false","Set the TMPDIR for pulling/pushing image to $TMPDIR

Or set it to /var/tmp if the user did not specify.

Currently certain large workloads can not be handled because users are running
out of space on pulls/ and pushes.  Containers/image stores data temporarily in
the file system.  This allows the user to overide the location of the temporary
storage.

Also update containers/image to v5.0.1

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",90,35,0,1
"containers/buildah","ad389b19434c8619818f5e6ab7117f4661b2f463","dfr","2022-06-23 10:50:56","false","Rename footypes to fooTypes for naming consistency

Signed-off-by: Doug Rabson <dfr@rabson.org>",21,65,1,0
"containers/buildah","188dcc360848cf6514572ed05165173e86eae585","dfr","2022-07-25 10:19:48","false","chroot: Factor out /dev/ptmx pty implementation

The ptmx device is fairly common and this code could be used on
platforms other than Linux.

Signed-off-by: Doug Rabson <dfr@rabson.org>",21,66,1,0
"containers/buildah","11cec852331f0c8c5b0ff9b83acb16f70fc442c9","lsm5","2023-07-13 14:18:09","true","[CI:BUILD] Packit: downstream task script needs GOPATH

[NO NEW TESTS NEEDED]

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",13,78,1,1
"containers/buildah","c74fe167ffbf47951e4f34c0c890bc1ea898f589","wking","2018-09-14 16:37:49","false","new: Return image-pulling errors from resolveImage

Instead of throwing out the upstream error message, save it and return
it if we can't come up with a more-specific suggestion.  This makes
debugging easier [1].

Using multierror gives us both pretty formatting (when we print this
for the user) and programmatic access (for any callers that need to
inspect the constituent errors).  This is our first direct dependency
on multierror, but we've been vendoring it for a while now because
opencontainers/runtime-tools uses it for config validation.

The error message for the Bats pull is now:

  error creating build container: 1 error occurred:

  * Error determining manifest MIME type for docker://non-existent-registry.com/alpine:latest: pinging docker registry returned: Get https://non-existent-registry.com/v2/: dial tcp: lookup non-existent-registry.com on 172.16.69.5:53: no such host

[1]: https://github.com/projectatomic/buildah/issues/849

Signed-off-by: W. Trevor King <wking@tremily.us>

Closes: #1014
Approved by: rhatdan",37,20,0,0
"containers/buildah","d94f238368546037c5961e8103d50336b860d4d2","saschagrunert","2019-07-08 09:43:28","false","Fix response body not closed resource leak

This enabled the `bodyclose` linter and fixes the reported response body
resource leak.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1711
Approved by: nalind",48,29,0,1
"containers/buildah","01cb91fa1d963cf910e320514e078f57df7827bb","rhatdan","2023-08-11 08:40:48","true","Merge pull request #4970 from containers/renovate/github.com-opencontainers-runc-1.x

fix(deps): update module github.com/opencontainers/runc to v1.1.9",10,78,1,1
"containers/buildah","327914f1f8ac8571b7373a108a9948aa03e06cd3","danstiner","2019-04-19 06:27:38","false","Test bud-copy-dot with --layers picks up changed file

Signed-off-by: Daniel Stiner <danstiner@gmail.com>

Closes: #1561
Approved by: TomSweeneyRedHat",53,27,0,0
"containers/buildah","404852be4ad8dc886927ee8a2ae5162aaf60e974","flouthoc","2022-06-20 09:26:28","true","demo: use unshare for rootless invocations

Use `buildah unshare` to invoke `buildah mount` when demos are invoked
from rootless environments

* buildah_mult_stage: only unshare on needed steps
* buildah-scratch-demo: unshare entire script since it uses pkg managers
  commands which don't work well in rootless session without unshare.

[NO NEW TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",23,65,1,1
"containers/buildah","e80fed065ef5970cff81e22c545da9643f8c2c6e","flouthoc","2022-06-01 10:00:56","true","docker-parity: ignore sanity check if baseImage history is null

Docker still builds image and adds history even if baseImage history is
null lets follow that

Signed-off-by: Aditya R <arajan@redhat.com>",25,64,1,1
"containers/buildah","7c1724ceca957b659b08f7472f46ef5f1d122e3f","openshift-merge-robot","2022-03-31 13:12:45","true","Merge pull request #3873 from containers/dependabot/go_modules/github.com/opencontainers/runc-1.1.1

build(deps): bump github.com/opencontainers/runc from 1.1.0 to 1.1.1",26,62,1,1
"containers/buildah","05731119ef1873ce4fe686647c53f030ed4bab5d","openshift-merge-robot","2022-10-28 06:40:09","true","Merge pull request #4387 from flouthoc/fix-mount-test-remote

test: fix preserve rootfs with `--mount=type=bind` for podman-remote",24,69,1,1
"containers/buildah","43ab0e35d02fba32d882c46a452b11ef25adc2c9","openshift-merge-robot","2022-11-09 12:50:55","true","Merge pull request #4406 from dfr/freebsd-bind

Use TypeBind consistently to name bind/nullfs mounts",23,69,1,1
"containers/buildah","91325f4baac2240e2640a03aa465f5b65b1edffc","openshift-merge-robot","2021-03-31 16:16:59","true","Merge pull request #3116 from rhatdan/platform

Export parse.Platform string to be used by podman-remote",50,50,0,1
"containers/buildah","0f5fd9821828650a1d4c215799a50043e708c891","edsantiago","2019-12-09 13:45:52","false","Flake handling: cache and prefetch images

Show of hands: who here loves submitting a PR, then coming back
hours later to find one job failed, then spending time poring
over logs and finding a network error? Anyone? Anyone?

This is a lame attempt to minimize such flakes by caching
commonly-used images and restoring them on demand. We
introduce a new helper, _prefetch(), which podman-pulls
an image the first time, podman-saves it, then on
subsequent calls (for the same image) podman-loads it:

    @test foo {
        _prefetch alpine busybox
        ...tests that run buildah-from either
    }

This is an imperfect solution: it is incomplete and will
grow more so over time as new tests are added. It is
difficult to verify its coverage. I'm really unhappy
with it but if it works, the Total Sum Of Unhappiness
might decrease overall thanks to fewer flakes. If it
doesn't work, it's trivial to remove _prefetch calls
using a sed script. Shall we give it a chance?

Signed-off-by: Ed Santiago <santiago@redhat.com>",84,34,0,1
"containers/buildah","3cfa17a69564a7a3968a5b4671f6c203c9ec1eda","openshift-merge-robot","2022-11-02 07:59:09","true","Merge pull request #4392 from flouthoc/userns-tests

userns: add arbitrary steps/stage to `--userns=auto` test",24,69,1,1
"containers/buildah","10c10eedd2034e321fe9f63068b1dcb15a2623d2","openshift-merge-robot","2021-01-08 13:44:41","true","Merge pull request #2895 from rhatdan/push

Make buildah push support pushing manifests lists and digests",91,47,0,1
"containers/buildah","d78dfd1d7b2c7d1040cdadf44b60417a637f8887","openshift-merge-robot","2021-05-06 10:20:20","true","Merge pull request #3207 from alvistack/master-linux-amd64

Update nix pin with `make nixpkgs`",52,51,0,1
"containers/buildah","9cbf6b314936d0e761235db914dc29f2407fe106","openshift-merge-robot","2023-09-05 09:50:03","true","Merge pull request #5020 from flouthoc/fix-docs

[CI:DOCS] docs: use valid github repo",7,79,1,1
"containers/buildah","d0336f214730e34b4ee9c8f6f1178bbd785371de","flouthoc","2022-04-29 13:39:42","true","buildkit: add support for custom build output with --output

Allows end-users to export final build content or rootfs to external formats.

By default, a local container image is created from the build result. The --output (or -o) flag allows you to override this behavior, and a specify a custom exporter. For example, custom exporters allow you to export the build artifacts as files on the local filesystem instead of a Container image, which can be useful for generating local binaries, code generation etc.

The value for --output is a CSV-formatted string defining the exporter type and options. Currently, local and tar exporters are supported. The local exporter writes the resulting build files to a directory on the client side. The tar exporter is similar but writes the files as a single tarball (.tar).

```console
buildah build --output type=local,dest=dir .
buildah build --output type=tar,dest=rootfs.tar .
buildah build -o dir .
```
Reference: https://docs.docker.com/engine/reference/commandline/build/#custom-build-outputs

Signed-off-by: Aditya R <arajan@redhat.com>",26,63,1,1
"containers/buildah","1c8216678a2ec91645464389a96829df2cbe79d8","afbjorklund","2018-10-07 12:04:10","false","Add man page and bash completion, for --no-pivot

Signed-off-by: Anders F Björklund <anders.f.bjorklund@gmail.com>

Closes: #1071
Approved by: rhatdan",51,20,0,1
"containers/buildah","cebd2b263c570776a7af61943b432171f532bb6b","nalind","2017-03-07 21:02:12","false","Sanitize base64 characters in pathnames in tests

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","b04e523c8d488d9dcba52bf1781afbeabcfe78c6","nalind","2017-02-13 16:04:56","false","Update vendored dependencies

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","3bdc9edd671914a40940ffdb9b85e4f69f76ee79","nalind","2019-05-30 04:22:53","false","imagebuildah: handle ID mappings for COPY --from

Fix handling of ID mapping for COPY: when copying from other containers,
use their mappings, and when copying from the host, use host mappings.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1630
Approved by: TomSweeneyRedHat",57,28,0,1
"containers/buildah","597d2ab9fa41b2db8ce0c6d8be05edb462d3b31d","nalind","2017-06-14 13:55:20","false","Update the version number we identify as to 0.1.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #146
Approved by: rhatdan",12,5,0,1
"containers/buildah","1c59b10a8c5a8c32ec02893f7acf68dbbacdafa5","openshift-merge-robot","2022-08-22 10:57:19","true","Merge pull request #4197 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.8.3

build(deps): bump github.com/fsouza/go-dockerclient from 1.8.2 to 1.8.3",18,67,1,1
"containers/buildah","899ecaaf74c5ef299ccc24bb6bb98eb9aee96ba0","edsantiago","2022-09-27 16:24:51","false","Proof of concept: nightly dependency treadmill

As discussed in f2f: this is the cleanest, simplest mechanism
I can think of to auto-test the Big Three dependencies: simply
run go mod edit immediately after git checkout, then run the
entire CI test suite.

If this approach works, we can set up a new CIRRUS_CRON=treadmill job.

Signed-off-by: Ed Santiago <santiago@redhat.com>",21,68,1,1
"containers/buildah","0b1ec142a0080b36f985c207f23c6409ca0942e5","edsantiago","2019-10-28 18:10:35","false","Actual bug fix for 'add' test: fix the expected mode

Well, yikes: fix a broken file-mode check in two 'add' tests.
They were expecting 755, but the actual mode is 644. --debug
was spitting out unrelated output, including a 755 that
the test was matching as a substring.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1935
Approved by: giuseppe",80,33,0,1
"containers/buildah","fbd99d001d4ae33d5e02e45ea454e51c7fa123ba","vrothberg","2021-07-02 12:26:20","false","vendor containers/common@main

The `IgnorePlatform` options has been removed from the
`LookupImageOptions` in libimage to properly support multi-arch images.
Buildah always set it to true.

Also temporarily remove /usr/share/containers/containers.conf.  c/common
is now throwing warnings when facing unknown keys which unfortunately is
the case with the upstream containers.conf and ultimately breaks CI
since some output checks are failing.

Once an updated containers.conf has been shipped, we can revert the
change.

[NO TESTS NEEDED]

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",38,53,1,1
"containers/buildah","c5870ff838a355268be226fab7d0866de09d4bee","openshift-merge-robot","2021-02-05 22:13:01","true","Merge pull request #2972 from lsm5/cni-bump

bump containernetworking/cni library to v0.8.1  fix for CVE-2021-20206",92,48,0,1
"containers/buildah","ee0d17b91a4d01978a518cc396b61ad60effabd3","openshift-merge-robot","2021-02-22 13:52:33","true","Merge pull request #3027 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.7.1

build(deps): bump github.com/fsouza/go-dockerclient from 1.7.0 to 1.7.1",62,49,0,1
"containers/buildah","ec05dbab535fc66fe14d7809561555f73e1f594c","openshift-merge-robot","2022-05-23 19:50:42","true","Merge pull request #4009 from rhatdan/VENDOR

Update vendor of containers/(common, storage, image)",26,64,1,1
"containers/buildah","54cafea4c9333688eebfd1fec924506aac1e93a3","openshift-merge-robot","2021-07-21 17:12:32","true","Merge pull request #3390 from vrothberg/fix-dangling

refine dangling filter",41,54,1,1
"containers/buildah","e8bca814b295b507492b207b32ff9a495f5890de","openshift-merge-robot","2021-05-12 19:16:46","true","Merge pull request #3223 from containers/dependabot/go_modules/github.com/containers/storage-1.30.3

Bump github.com/containers/storage from 1.30.1 to 1.30.3",54,52,0,1
"containers/buildah","3c092e5eddd23c9a0ad07c962bf1e66c1cf7d05b","flouthoc","2022-09-15 10:00:23","true","build: support --skip-unused-stages for multi-stage builds

In multi-stage builds buildah will skip stages which are unused (i.e
stages which don't contribute anything to target stage directly or
indirectly) however in certain cases users need to process these unused
stages hence add support for `--skip-unused-stages` which allows users
to control this behaviour.

Ref: https://github.com/GoogleContainerTools/kaniko#flag---skip-unused-stages

Closes: https://github.com/containers/buildah/issues/4243

Signed-off-by: Aditya R <arajan@redhat.com>",21,68,1,1
"containers/buildah","015060d9dc6fbcd94afaec0094145f441e4a3757","ypu","2019-10-28 08:25:42","false","Tests: Add two commit test

Add following test cases for commit:
- commit with name
- commit to docker-distribution

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #2004
Approved by: rhatdan",80,33,0,0
"containers/buildah","278dedf98e5db547056265082d24fa79922b6e5e","nalind","2018-09-17 20:39:54","false","bump(github.com/containers/{storage,image})

Update github.com/containers/storage and github.com/containers/image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1024
Approved by: nalind",35,20,0,1
"containers/buildah","2a9435428890e3970ecbc3e424fbe74fdd5bbe1f","nalind","2020-10-23 15:51:55","false","copier: put: ignore Typeflag=""g""

Ignore PAX global headers when extracting archives, like the archive
package does, instead of erroring out.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",66,45,0,1
"containers/buildah","9dd66e4cbf3a69f7971fa254ed1220127b920731","nalind","2023-09-15 20:15:24","false","add/copy: make sure we handle relative path names correctly

Make sure that `add` and `copy` handle relative paths given as input
correctly, both with and without a context directory being specified.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",6,80,1,1
"containers/buildah","fd3a1f09d64ebb9d8a263084d5158c5b6783ed80","nalind","2017-03-24 18:57:31","false","Merge pull request #27 from rhatdan/name

Remove all --name and --root options",14,2,0,1
"containers/buildah","232f7c67371b3a780f369b129406886dcbeeea2a","nalind","2019-08-05 21:07:40","false","bump github.com/containernetworking/cni to v0.7.1

Bump github.com/containernetworking/cni from v0.7.0-rc2 to v0.7.1, which
is the version that libpod master is currently using.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1765
Approved by: rhatdan",50,30,0,1
"containers/buildah","73e0ad7129f436038497db6a50c1f8d3c6c17522","vrothberg","2022-05-17 08:42:57","false","buildah source pull/push: show progress bar

Render the progress bar on stdout by default.  Add a --quiet/-q option
to re-silence if desired.

Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",25,64,1,1
"containers/buildah","be3b9c36866d2c109e779656d53af6e95db5275b","dfr","2022-04-21 13:47:47","false","Make util and copier build on FreeBSD

The mknod syscall takes a uint64 value for dev on FreeBSD.

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",25,63,1,0
"containers/buildah","20c2a545b9cebb4bf5dea021087c63ba2137eff8","vrothberg","2019-12-24 11:31:09","false","cpp: use -traditional and -undef flags

@tanzislam noted [1] that Buildah should be using the -traditional flag
to prevent CPP from removing trailing backslashes in non-directive lines
and the -undef flag to prevent built-in macros from expansion (e.g.,
""linux"" to ""1"").

[1] https://github.com/moby/moby/issues/735#issuecomment-568720297

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #2044
Approved by: TomSweeneyRedHat",93,35,0,1
"containers/buildah","af389125837adcde33de28c9a570ac946ee51758","PeterWhittaker","2023-08-21 16:28:08","false","Replace troff code with markdown in buildah-{copy,add}.1.md

Signed-off-by: Peter Whittaker <PeterWhittaker@SphyrnaSecurity.com>",8,79,1,0
"containers/buildah","7d5e57f7ffde8ba2b413eba5047f464d4a033633","rhatdan","2017-10-10 17:36:21","false","Optimize regex matching

Make lint is showing that we should compile regex before using it
in a for loop.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",32,8,0,1
"containers/buildah","4b7d3555bfa4440c3c5264ae44b93822e10deec0","rhatdan","2022-09-29 18:09:35","true","Merge pull request #4286 from flouthoc/builder-process-variant

config,builder: process `variant` while populating image spec",20,68,1,1
"containers/buildah","332a8892adf52b51b826641181660ddc33c2b46c","rhatdan","2019-10-31 16:43:27","true","Merge pull request #1908 from rhatdan/dependabot/go_modules/github.com/onsi/ginkgo-1.10.2

Bump github.com/onsi/ginkgo from 1.10.1 to 1.10.2",82,33,0,1
"containers/buildah","64df2d7bce9692b354b0d24a9a03ddc1936bb910","mtrmac","2018-06-11 22:23:48","false","Require an image ID in importBuilderDataFromImage

Both callers currently specify a non-empty image ID (because
all images have an ID, and all containers are created from
an image which has an ID); so, instead of ""supporting"" import
from non-images, fail.

This does not change behavior, but it will make future restructuring
easier.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #776
Approved by: rhatdan",33,16,0,1
"containers/buildah","bdd62ef8702743c6329f7f99c81c4514cc259d61","mtrmac","2022-10-19 00:13:41","false","Remove calls to Lockfile.Locked()

By construction it's now quite clear that the locks should
always be locked.

Don't even bother with AssertLockedForWriting(), that's
partially (checking for lock ownership, not for read-write ownership)
implied by Unlock() already.

[NO NEW TESTS NEEDED]

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",27,69,1,1
"containers/buildah","330cfc923c0ddebdd64635c827038b9dbe3dfe4f","rhatdan","2017-09-27 21:46:22","false","Only print logrus if in debug mode

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #270
Approved by: rhatdan",34,8,0,1
"containers/buildah","017dd1ffd4091d592f2c01780afaa0a1f4a6f8f4","rhatdan","2019-01-11 16:43:46","false","Revendor in latest code by release

Match the vendor information in libpod vendor.conf
This is needed in order to help us get into Debian.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1277
Approved by: giuseppe",51,23,0,1
"containers/buildah","94a34115fe59663211b898ef634e39c973c5aa4a","rhatdan","2020-09-15 18:36:36","false","Fix buildah mount to display container names not ids

Currently we are displaying containerid rather then containername,
which is unknown to users.  Users refer to the container names all
of the time, so we should show the mounted containers based on names.

This change eliminates the need for the truncate flag on buildah mount
as well, so this PR hides it.

Fix up the man page documentation to use container names and show
proper output.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>
Co-authored-by: Sascha Grunert <sgrunert@suse.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",91,44,0,1
"containers/buildah","e098ef46fd32af5e77c7c65315d454653a36d6dd","rhatdan","2018-06-27 13:22:53","true","Merge pull request #829 from q384566678/mount-err-fix

mount: output it before replacing lastError",28,17,0,1
"containers/buildah","536101cd51fa2a4ad24fe16ef710f840c38de61e","rhatdan","2023-03-08 00:43:38","true","Merge branch 'main' into ifnewer-pull-command",18,73,1,1
"containers/buildah","3c8dc0da4bcfe02035975dff2ec82935dc16c043","rhatdan","2023-08-22 13:12:17","true","Merge pull request #4985 from PeterWhittaker/main

[CI:DOCS] Replace troff code with markdown in buildah-{copy,add}.1.md",9,79,1,1
"containers/buildah","265082d8b6a6d61c6d375c1b1ab0641f1869bf20","hswong3i","2020-08-22 01:28:39","true","Update nix pin with `make nixpkgs`

Signed-off-by: Wong Hoi Sing Edison <hswong3i@gmail.com>",87,43,0,0
"containers/buildah","b218fdf3226bf9ce75f44158b30104069997fbe7","flouthoc","2022-08-01 03:51:19","true","build: support building from commit when using git repo as build context

When using URL to a git repo as build context allow specifying `commit`
to make sure specific `commit` is used as the build context.

Examples

```console
buildah build -t test myrepo.git#abcef123
buildah build -t test myrepo.git#abcef123
buildah build -t test myrepo.git#abcef123:somesubdir
```
Closes: https://github.com/containers/buildah/issues/4148

Signed-off-by: Aditya R <arajan@redhat.com>",19,66,1,1
"containers/buildah","9e1967ae9e510a12afbe28aeeb50e0921fc30ec5","rpjday","2019-03-30 11:55:03","false","docs/buildah.md: add ""containers-"" prefixes under ""SEE ALSO""

Some entries under ""SEE ALSO"" now need the ""containers-"" prefix.

Signed-off-by: Robert P. J. Day <rpjday@crashcourse.ca>

Closes: #1461
Approved by: rhatdan",48,26,0,0
"containers/buildah","3679b9f7ec466a79cfd61a1780fcac1d111aa0e6","TomSweeneyRedHat","2021-02-07 01:20:48","false","Don't fail copy to emptydir

When a COPY command was being targeted at an empty new directory,
the copy would fail.  It could be ""worked around"" by putting a dummy
file into the directory.

Addresses:  #2964
Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",92,48,0,1
"containers/buildah","febbaadfcce9694a0aa001850017e8a8c5963b6f","TomSweeneyRedHat","2019-02-13 19:16:32","false","Set --disable-compression to true as documented

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

The man pages for `--disable-compression` indicates that it is
true by default.  However the code has it set to false.  This changes
that.

Fixes: #1336
Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1337
Approved by: rhatdan",60,25,0,1
"containers/buildah","052eef00354ebea16a9578118fd5f872c6007bad","nalind","2021-04-01 13:59:33","false","Add conformance tests for COPY """"

Add a couple of conformance tests exercising """" as a source name for
COPY instructions.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",52,50,0,1
"containers/buildah","48b79cf35eca10a4098ee81db5ce86c657e6d206","nalind","2018-05-22 17:48:15","false","Add a make target for Installing CNI plugins

Add a makefile target for installing the CNI plugins, for cases where
we don't want to use --cni-config-dir pointed to an empty directory.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",62,16,0,1
"containers/buildah","810efa340ab43753034e2ed08ec290e4abab7e72","nalind","2019-04-15 14:02:05","false","commit: always set a parent ID

Always set a parent ID when we go to commit an image, whether it's as
part of build-using-dockerfile or our ""commit"" CLI.  Coerce the parent
image's ID directly into the value that we use instead of digesting it
again.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1538
Approved by: vrothberg",52,27,0,1
"containers/buildah","ebf6f518d0e8c80bd473cf7aeb1cc1062662339d","nalind","2019-08-09 20:21:24","false","Use content digests in ADD/COPY history entries

Use digests of the added content in history entries that we create for
ADD and COPY instructions, tightening up cache checking just a little
bit more.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1792
Approved by: TomSweeneyRedHat",53,30,0,1
"containers/buildah","e3fd4c8aa00e088298745d2cd3a66dcfdbfd4e89","rhatdan","2023-07-01 10:30:33","true","Merge pull request #4903 from containers/renovate/github.com-opencontainers-image-spec-1.x

fix(deps): update module github.com/opencontainers/image-spec to v1.1.0-rc4",14,77,1,1
"containers/buildah","b52fec6ad6c7a8f1787ad6896cf8a434129f86a9","boaz0","2018-08-29 12:21:07","false","Make buildah-from error message clear when flags are after arg

The error message in buildah-from can be confusing when a
flag is specified after the argument (image name).

For example, running the following:
buildah from scratch -q

will return this error message:
too many arguments specified

however only one argument was specified ""scratch"".
the reason we get this error is because anything that
comes after ""scratch"" will be considered as an argument.

To fix this - check if every argument is a flag (a flag
starts with ""-"" e.g. ""-q"", ""--ulimit""). If you find an
argument that is a flag return a much clearer
error message:

<flag-name-argument> should be set before the image name

otherwise, return the old error.

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>

Closes: #968
Approved by: rhatdan",31,19,0,0
"containers/buildah","8ec8b8a63d3549ec84012819c2bcfb44dcdfba6b","rhatdan","2023-07-01 10:29:58","true","Merge pull request #4888 from dfr/freebsd-overlay

pkg/overlay: add limited support for FreeBSD",14,77,1,1
"containers/buildah","fbb8b702bcdc008e118aa72427525f45cb435daa","boaz0","2018-01-24 11:45:15","false","Return exit code 1 when buildah-rmi fails

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>

Closes: #412
Approved by: rhatdan",34,12,0,0
"containers/buildah","61579f4c8323e8e58c6bdcd84d647e4a55eea521","rhatdan","2022-01-26 17:35:20","true","Merge pull request #3745 from eriksjolund/fix_typos_and_improve_language

[CI:DOCS] Fix typos and improve language",34,60,1,1
"containers/buildah","689f8ed3c328cfb5675ec46259a932c294177986","rhatdan","2019-08-27 20:31:34","false","add support for cgroupsV2

We need to run with crun rather then runc on cgroupsV2 platforms.

runc does not currently support cgroups V2, so if the machine is
in cgroups V2 mode we have to use crun by default.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1823
Approved by: @TomSweeneyRedHat",55,31,0,1
"containers/buildah","a9031b7d6aeebb561e2ca9cd4aa2e3fce3b9ae88","rhatdan","2023-08-30 10:10:19","true","Merge pull request #5013 from flouthoc/force-compression-true

push: `--force-compression` should be `true` with `--compression-format`",7,79,1,1
"containers/buildah","5595d4dea87960f44468fa587258a18e3edd47d1","TomSweeneyRedHat","2018-05-30 19:22:39","false","Quick fix on demo readme

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #737
Approved by: rhatdan",42,16,0,1
"containers/buildah","9af14c45406d701aaa775ce3d4f595342a1892c8","TomSweeneyRedHat","2018-07-18 23:49:56","false","Use manifest from container/image

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #870
Approved by: rhatdan",32,18,0,1
"containers/buildah","96c68db554b971825bd9c41dc0c1a09138a175f6","TomSweeneyRedHat","2018-12-13 14:30:06","false","Touch up images -q processing

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1235
Approved by: TomSweeneyRedHat",50,22,0,1
"containers/buildah","9653e2ba9aee3eaedcc1e24ce135d47c39df81f5","TomSweeneyRedHat","2017-11-02 17:34:09","false","Add go tip to build, but allow it to have failures

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",30,9,0,1
"containers/buildah","4b5437a981adc48d27b330b74263fbaf594052e6","TomSweeneyRedHat","2019-12-27 16:11:52","false","Bump to v1.14.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2053
Approved by: rhatdan",97,35,0,1
"containers/buildah","fa984d1eb415df8baba473f91d70c453cb428c70","openshift-merge-robot","2021-10-05 13:45:00","true","Merge pull request #3566 from edsantiago/smaller_images

tests: stop pulling php, composer",44,56,1,1
"containers/buildah","fb84638b2ffffc0c0bed7d60dd75f30b0c5b78ee","openshift-merge-robot","2021-09-21 07:42:39","true","Merge pull request #3527 from nalind/zstd-import

unmarshalConvertedConfig(): handle zstd compression",39,56,1,1
"containers/buildah","776e0e76dd5dacdb240cff3357cfc819af042884","openshift-merge-robot","2023-04-13 11:10:17","true","Merge pull request #4735 from containers/renovate/quay.io-centos-centos-8.x

chore(deps): update quay.io/centos/centos docker tag to v8",10,75,1,1
"containers/buildah","b58b778ef331ad34c8e0a90f81db845413b7a82b","rhatdan","2017-03-27 17:22:08","false","Move all command definitions out of main.go into implementation source

This will allow us to more easily share these source modules between
kpod and buildah as well as move keep the definition with the implementation.

Closes: #45
Approved by: rhatdan",14,2,0,1
"containers/buildah","131d899948d9dba2651c0b58574faaf43296b316","rhatdan","2021-10-05 13:45:12","true","Merge branch 'main' into dependabot/go_modules/github.com/containers/storage-1.37.0",43,56,1,1
"containers/buildah","12114812da9574341d6c3b3fbae2de3fdbbf4d28","nalind","2018-03-05 19:23:23","false","Remove shallowCopy(), which shouldn't be saving us time any more

Remove shallowCopy(), which shouldn't be saving us time any more since
containers/image's storage transport's HasBlob() implementation was last
updated.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #508
Approved by: rhatdan",20,13,0,1
"containers/buildah","af5512ab74058c38e0f73ed8c3aee38ad0a6db9b","nalind","2017-06-01 16:09:23","false","Allow building a source image from another image

Factor out logic that fakes up a source image using a container to be
able to do so using either a container or an image, by passing in names
and the starting layer ID directly, and by making the addition of a
history element for the layer optional (true for a container, since it's
going to add a new layer, false for an image that we're just exporting).

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #141
Approved by: rhatdan",13,4,0,1
"containers/buildah","ffd8d6a5de26e76f4446feadc837d55f9139dad8","nalind","2019-04-15 20:48:56","false","imagebuildah: don't leak image structs

When reading the configuration of a cache candidate, don't leak the
object reference for the Image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1520
Approved by: rhatdan",54,27,0,1
"containers/buildah","24757d395d3f66d41eaeedb7b61bb3b223a234c1","nalind","2020-11-03 21:52:33","false","copier: try to force loading of nsswitch modules before chroot()

Attempt to address CVE-2019-14271 by having the copier module attempt to
trigger loading of dynamic nsswitch modules, that it'll end up using
while chrooted, before it chroots into a target rootfs.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",69,45,0,1
"containers/buildah","0a44c7f162a75ea27021291c3cfca517a157bd19","nalind","2017-11-09 17:23:47","false","""run --hostname test"": do less setup

We don't need to mount the container for this test or add files to it,
and switching to a smaller base image that already includes a ""hostname""
command means we don't need to run a package installer in the container.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #320
Approved by: nalind",30,9,0,1
"containers/buildah","811741fe03875dea1481e5f1c339556323e243c6","nalind","2022-08-22 12:26:10","false","Makefile: always call $(GO) instead of `go`

In a couple of places, we were still calling `go` directly instead of
through the `$(GO)` variable, which was a mistake.  Drop one of them
entirely because the resulting value wasn't being used anywhere.

Update the definitions of `CNI_COMMIT` and `RUNC_COMMIT` to search
modules.txt instead of go.mod, which can be overridden and which might
therefore produce incorrect values.

[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",18,67,1,1
"containers/buildah","6b0388bf21992751d0a43539bedfa9a2df13aaf3","vrothberg","2019-02-20 13:38:50","false","vendor.conf: remove github.com/inconshreveable/mousetrap

It's dependency inherited from cobra but it only applies to Windows.
The package was also missing in ./vendor, so we can safely remove it.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1350
Approved by: TomSweeneyRedHat",60,25,0,1
"containers/buildah","467983ce9f5d6242d52e7e8db0290b7eae3839a2","vrothberg","2019-06-18 11:40:05","false","pull: check error during report write

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","b3a1c89f503ec375c11ecacfeea3decf078dbf08","QiWang19","2020-11-25 20:21:04","false","Not prefer use local image create/add manifest

Avoid first checking the image from local storage for `manifest create` and `manifest add`
since the local image does not include other entries of the list from the registry.
`--all` flag of `manifest create` and `manifest add` can not add all of the lists as expected.
So first attempt to get manifest from the registry and if not successful, fall back to use local images.

Signed-off-by: Qi Wang <qiwan@redhat.com>",77,46,0,1
"containers/buildah","e1e58584a95ae4da816a042e8961913d2b34eedf","rhatdan","2017-09-22 09:32:10","false","Cleanup buildah-bud code

1. Sort options so they are in alphabet order
2. Remove extra lines of code for options parsing that really do not accomplish anything.
3. Remove variables when they are not necessary, I.E. Don't create a variable to hold an
option that is only used once, use the option instead.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #267
Approved by: <username_without_leading_@>",34,8,0,1
"containers/buildah","bd9e9059ba0a03aefdbf49f10b635360ed235b31","rhatdan","2018-06-19 16:38:29","false","Vendor in latest go-selinux bindings

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #806
Approved by: nalind",30,17,0,1
"containers/buildah","e6262e371425a8fc6a999877a91f56d2d398c117","rhatdan","2019-03-20 20:49:29","true","Merge pull request #1425 from dougsland/docs

docs: 01-intro.md: add missing . in Dockerfile examples",36,26,0,1
"containers/buildah","c5c47124e6e991c38814d16da0d9155d7059db8b","rhatdan","2022-11-06 23:58:09","true","Merge pull request #4400 from rhatdan/codespell

Run codespell on code",23,69,1,1
"containers/buildah","98a61aee8ee9a21afd7ffab4a0d7a987386f7a89","rhatdan","2022-02-01 19:06:58","false","Update vendor of containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",35,60,1,1
"containers/buildah","efa156fe78ef3a2cdef0435329843396a7ff4a9d","rhatdan","2019-04-23 18:52:29","false","Fix buildahimages Dockerfiles to include support for additionalimages mounted from host.

These fixes will allow us to demonstrate multiple different ways of running the
container builds.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1540
Approved by: TomSweeneyRedHat",52,27,0,1
"containers/buildah","f17ccd0c11efd9899dbf3057b5963577d6028ed6","rhatdan","2021-01-14 21:50:20","true","Merge pull request #2911 from rhatdan/release-1.19

Fix version of release to v1.19.1",93,47,0,1
"containers/buildah","d7880327ae19e8fcf08d9464ff27d618bcba4ee0","rhatdan","2017-03-28 18:25:40","false","Add truncation to buildah containers|images

Closes: #52
Approved by: rhatdan",14,2,0,1
"containers/buildah","e90b3502b75dd68b25270b682528328edd377542","rhatdan","2023-09-14 00:57:12","false","GetTmpDir is not using ImageCopyTmpdir correctly

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",5,80,1,1
"containers/buildah","88bc27df792c7b5a486b955e3ce3da89f1d2406a","rhatdan","2021-02-05 19:08:00","true","Merge pull request #2955 from rhatdan/list

buildah manifest add localimage should work",94,48,0,1
"containers/buildah","316bd0a68b20324404304dfc731065a815f16593","rhatdan","2019-04-10 18:27:08","false","Add hack/build_speed.sh  test speeds on building container images

 The main goal of this script is test and time builds using Buildah or Docker.
 We hope to use it to help optimize Buildah build performance

 It takes two options
 First option tells the type of the container image
 build to do.  Valid options are:
       Docker  - docker build
       Buildah - buildah bud
       Both    - Do docker build followed by buildah bud

 Second Option specifies a directory or cleanup
 The script will 'find' files beginning with Dockerfile, for each Dockerfile
 it finds it will run a build with the Dockerfile and directory for the
 context. When it does the builds, it will call time on them to show how
 long the builds take.  The created image name will be a combination of the
 lowercased Directory name that the Dockerfile was found in plus the lower
 cased dockerfile name.

 if the second field is cleanup, the script will remove all images from the
 specified builder.

 The script does not check for conflicts on nameing.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1505
Approved by: edsantiago",58,26,0,1
"containers/buildah","b41358187c0e9d8aee17f1f754e047bc7ef03f8a","edsantiago","2022-09-19 00:57:58","false","Fix broken command completion

PR #4249 added --skip-unused-stages (cool) but also added
what seems to be an unnecessary command-completion incantation.
This incantation breaks podman unit tests when vendored in
the treadmill.

[NO NEW TESTS NEEDED]

Signed-off-by: Ed Santiago <santiago@redhat.com>",19,68,1,1
"containers/buildah","b023cde464d0abeb9c4438328bce56c78f5f2e29","edsantiago","2019-10-28 22:05:24","false","imgtype: exit with error if storage fails

'imgtype' on my system has been exiting zero regardless of
the command being run; looking at logs shows:

   error opening storage: vfs driver does not support overlay.mountopt options

(but exiting zero). Tests which rely on exit status zero have
been passing, but without actually testing anything.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1950
Approved by: rhatdan",80,33,0,1
"containers/buildah","35afa1c1f4143130668eff755187bac1866a8704","rhatdan","2017-11-08 00:51:29","true","Merge pull request #317 from rhatdan/master

Bump to v0.5",30,9,0,1
"containers/buildah","38d3cddb0cc3f4c3050963393b657b62f2da24fc","rhatdan","2017-11-28 19:22:47","false","Make sure builtin volumes have the correct label

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #339
Approved by: nalind",33,10,0,1
"containers/buildah","ec970d53096fe14091fb66f759195b0e00d6030f","edsantiago","2019-11-05 17:06:42","false","cgroups v2: tweak or skip tests

Many of the 'from' tests set up cgroup limits. Most of
these seem to have no equivalent in cgroups v2; until
we can find one, let's just skip them.

One test can be ported. It's hideous, requiring complicated
shell-script combining of /proc/self/cgroup into a file path,
but it works. (If the other tests can be made to work under
cgroups v2, we may want to refactor the horrible 'awk' mess
into a helper function; possibly only for this test module)

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1965
Approved by: rhatdan",82,33,0,1
"containers/buildah","1d35489ca07e2fb9a1e41a3785d890856dc7122d","saschagrunert","2019-07-18 08:45:52","true","Add misspell linter and apply fixes

Signed-off-by: Sascha Grunert <sgrunert@suse.com>",48,30,0,1
"containers/buildah","add81c3de47252de355e6ede5a2fbe7e2a8082e9","bparees","2018-10-10 20:04:35","false","fix missing format param

Signed-off-by: Ben Parees <bparees@redhat.com>

Closes: #1083
Approved by: rhatdan",53,20,0,0
"containers/buildah","e0ca332f1da17515f5d2bf41b18389dfd3a8f475","rhatdan","2021-02-11 15:36:11","false","Add more support for removing config

Currently we can remove configuration data in buildah config
by adding a trailing ""-"". This PR adds support for this in --port
calls.  Also added support for clearing all config for a specified
option, if the user specifies ""-"".

Currently the code blocks setting ANNOTATIONS and LABELS without a
value.  This is broken and should be allowed.

Similarly we were not expaning envioronment variables from the host when
they were not set.

podman run --env foobar
is valid,
so
buildah config --env foobar
should also be valid.

Fixes: https://github.com/containers/buildah/issues/2859

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",74,49,0,1
"containers/buildah","c72d2db65d3fc974862b0f01f5f376068db244ef","rhatdan","2017-03-28 19:20:37","false","Add installation for buildah and bash completions

Closes: #15
Approved by: rhatdan",14,2,0,1
"containers/buildah","2f3576b4e2f5899e9301fd1e204de1d6d8e451db","rhatdan","2023-01-05 18:40:52","true","Merge pull request #4505 from rhatdan/VENDOR

Vendor in latest containers/(common, image, storage)",20,71,1,1
"containers/buildah","d744ebc4b1d5306196b0fc4c552132532f192d13","openshift-merge-robot","2022-01-12 16:04:21","true","Merge pull request #3698 from Luap99/os-arch

Fix platform handling for empty os/arch values",29,59,1,1
"containers/buildah","6dacdf2457ef697cc958f7ea77517cceb6736216","flouthoc","2022-05-03 17:12:01","true","buildah: deep copy options.Args before performing concurrent build/stage

Prevent fatal concurrent read/write over options.Args by concurrent
multi-arch builds and concurrent stages

[NO TESTS NEEDED]
[NO NEW TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",24,63,1,1
"containers/buildah","db509859daedd769ae3ab28306d577b3caadbdb3","flouthoc","2023-03-09 11:29:00","true","stage_executor: attempt to push cache only when cacheKey is valid

Buildah's layer caching does not generates cache key or uses a layer
from store if `RUN --mount` is used to make sure that always freshly
mounted content is used in the `RUN` instruction, in such case there is
no use of even pushing the cache since it will be never used by buildah.

Make sure that stage executor attempts to push cache only if cacheKey is
generated.

Closes: https://github.com/containers/buildah/issues/4647

Signed-off-by: Aditya R <arajan@redhat.com>",16,73,1,1
"containers/buildah","470cf23fbd94a65f1191b16f3d04b90e1374dbf3","cevich","2021-05-07 14:37:52","true","Fix copy race while walking paths

During a copy operation which descends through a directory tree,
It's possible for a referenced file to become inaccessible (by unlink
or permission change or whatever).  During the walk of paths to copy,
an `Lstat()` is run on each item, and any error passed into the handler
function to deal with.  Subsequently, if there is no error, the file
is examined for inclusion/exclusion by the handler.

Unfortunately, this introduces a TOCTOU race condition for files which
become inaccessible even if they would otherwise be excluded.  For
example a file or directory under /proc or /sys (which frequently and
unpredictably change).  This was the original cause encountered during
podman integration testing.

It's impractical to actually fix this race at the file-level, without
introducing negative effects to any source-container operations.  It's
also questionably useful to offer a command-line option to offload the
choice to the user.  Instead, follow the behavior of the `tar` command
for this situation: Issue a warning to the user, and ignore the
problematic item (don't copy it).

Also add a test resembling the podman test which originally caught this
race.  While not reliable, it does introduce a non-zero chance of
hitting the race condition - and handling the new warning properly.

Signed-off-by: Chris Evich <cevich@redhat.com>",52,51,0,1
"containers/buildah","e6aa59853be703a5022cd2fa1b300f43149bcfd6","ypu","2018-08-28 15:34:44","false","Remove docker build image after each test

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #965
Approved by: rhatdan",30,19,0,0
"containers/buildah","1ac63a264dbafcdc691991378c39d3266fbb7b9b","giuseppe","2019-07-28 10:50:39","false","rootless, overlay: use fuse-overlayfs

when running in rootless mode, use fuse-overlayfs for mounting the
overlay file system on the host.  Then create a bind mount inside the
container.

Closes: https://github.com/containers/buildah/issues/1741

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1743
Approved by: rhatdan",48,30,0,1
"containers/buildah","a1d4afd16eb751517e50b8831da242a2e1664945","nalind","2020-11-04 22:23:25","false","ADD: handle --chown on URLs

Incorporate the value of the --chown option when digesting content added
from a URL, so that build caching will take it into account.  Add tests
to ensure that layer caching takes into account the changed ownership of
items that we're adding or copying.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",68,45,0,1
"containers/buildah","8f107a2f679ad10cab00a058ca1e10a8d78a5786","nalind","2019-03-15 23:15:53","false","from: distinguish between ADD and COPY

When executing ONBUILD instructions during `buildah from`, set the
""extract"" flag for ADD, so that it isn't treated the same as COPY.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1417
Approved by: TomSweeneyRedHat",36,26,0,1
"containers/buildah","2f6e10b196cfe9718d3599c7dca1fe69fd6015b8","openshift-merge-robot","2022-02-01 18:41:35","true","Merge pull request #3761 from edsantiago/dont_vandalize_testdir

System tests: fix accidental vandalism of source dir",35,60,1,1
"containers/buildah","b8a4ae628da277f860aa59d13fae890fe48339d0","openshift-merge-robot","2020-10-26 21:21:15","true","Merge pull request #2722 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.6.6

build(deps): bump github.com/fsouza/go-dockerclient from 1.6.5 to 1.6.6",64,45,0,1
"containers/buildah","4b2f45325df6c4daa32258b6f37ed8550e50477f","mtrmac","2018-06-11 21:36:53","false","Fix parsing of OCI images

The code apparently intended to use the OCI data to generate
a v2s2 config, instead it only generates the v2s2 config
if OCI parsing fails (from the results of the failed parsing).

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #776
Approved by: rhatdan",32,16,0,1
"containers/buildah","f2e8f65c22d8c4e89b47e83b15d887abb8846ea5","baude","2018-06-25 18:50:52","false","build without seccomp

If the seccomp build tag is disabled, build without it.

Signed-off-by: baude <bbaude@redhat.com>

Closes: #819
Approved by: rhatdan",28,17,0,0
"containers/buildah","f90481d03a4899257e7535759c34ce0958ed1b8a","Luap99","2021-08-04 10:31:13","true","Fix resolv.conf content with run --net=private

Make sure to use the correct resolv.conf in case of systemd-resolved.
Also filter out 127... nameserver when run in private netns.

Fixes #2780

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",36,54,1,0
"containers/buildah","432297d56daa62f4835822bab6774a2a4a600702","vrothberg","2020-01-09 09:51:06","false","Travis: rm go 1.12.x

Remove go 1.12.x from the testing matrix to consume less resources from
Travis and save some energy.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",101,35,0,1
"containers/buildah","dbec497140e00b3ac7271c72f55b45ce35ebba30","QiWang19","2020-01-06 13:34:12","false","fix bug Add check .dockerignore COPY file

fix bug that buildah does not check .dockerignore file if source of COPY instruction is a filepath. This patch will skip the path if the overall result of the dockerignore matcher is true.

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #2064
Approved by: rhatdan",100,35,0,1
"containers/buildah","2383e52d50c41f75e3fa24667ec57bdb2c8794a4","nalind","2022-02-04 20:41:07","false","conformance: add a few ""replace-directory-with-symlink"" tests

The test passes currently, but testing the reverse of the
replace-symlink-with-directory case seems like a good idea.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",33,60,1,1
"containers/buildah","80e6d32eb638f1644334174de7381cc669673088","nalind","2019-02-06 21:18:22","false","pull.bats: specify registry config when using registries

Use our known registry.conf file when ever we communicate with a
registry.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1326
Approved by: giuseppe",56,24,0,1
"containers/buildah","45d3e7953b1a01800b2e20622e6b9339bbe8a887","nalind","2017-06-02 16:17:27","false","Use errors.Errorf() instead of fmt.Errorf()

Use Errorf() from 'errors' rather than 'fmt' to help with stack traces.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #130
Approved by: rhatdan",12,4,0,1
"containers/buildah","737fb9183de49427f9a9b8d774dba434b13419ba","nalind","2017-03-24 16:14:19","false","Merge pull request #29 from nalind/mount-copy

Mount the container for Copy",14,2,0,1
"containers/buildah","2ea3e11d18667dcf480285d61ccf98e2d01569f7","ipbabble","2018-05-08 22:45:57","false","Added demo dir and a demo. chged distrorlease

Signed-off-by: William Henry @ipbabble <whenry@redhat.com>

Closes: #668
Approved by: TomSweeneyRedHat",53,15,0,0
"containers/buildah","ee11d75f3e9bf68d0763ffcea6d0cfc3f88146ef","rhatdan","2018-02-26 23:12:17","false","Bump to v0.14

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #499
Approved by: rhatdan",18,13,0,1
"containers/buildah","83a92cefdb326d7b88f4c570b6a2a0e6da586fec","rhatdan","2022-09-23 18:10:14","true","Merge pull request #4235 from rhatdan/VENDOR

vendor in latest containers/common",20,68,1,1
"containers/buildah","89949a11562b57b2c2cbddc45d679117c8dd74b8","rhatdan","2017-09-22 09:39:05","false","Cleanup buildah-from code

1. Sort options so they are in alphabet order
2. Remove extra lines of code for options parsing that really do not accomplish anything.
3. Remove variables when they are not necessary, I.E. Don't create a variable to hold an
option that is only used once, use the option instead.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #267
Approved by: <username_without_leading_@>",34,8,0,1
"containers/buildah","f024b84334a3dd43c5e0846e20dd87504048383e","rhatdan","2023-08-28 10:01:15","true","Merge pull request #5003 from containers/renovate/tim-actions-commit-message-checker-with-regex-0.x

[skip-ci] Update tim-actions/commit-message-checker-with-regex action to v0.3.2",8,79,1,1
"containers/buildah","0e30da6de0a367c0179c0c612e909331d0f0ec69","rhatdan","2019-04-28 10:33:09","false","Fix Transient Mounts

buildah bud is ignoring --volumes flag.

This patch parses the volumes and then passes them into the builder to be used.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1559
Approved by: vrothberg",52,27,0,1
"containers/buildah","c306342ee1390163c4f114c415a6ba27e84e3b04","rhatdan","2018-06-06 20:23:51","false","Shouldn't add insecure registries to list of search registries

The search registries and insecure registries are separate lists,
and should not be merged just because the InsecureSkipTLSVerify is
set

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #759
Approved by: mtrmac",37,16,0,1
"containers/buildah","38319b69ccf596489e746644842a1621e4c7bc76","Silvanoc","2018-10-29 10:08:37","false","ostree: fix tag for build constraint

Build tag 'ostree' is needed to match the constraint of
vendor/github.com/containers/storage/pkg/ostree/ostree.go
instead of that of
vendor/github.com/containers/storage/pkg/ostree/no_ostree.go

Signed-off-by: Silvano Cirujano Cuesta <silvano.cirujano-cuesta@siemens.com>

Closes: #1137
Approved by: giuseppe",52,21,0,0
"containers/buildah","a5c0c8acf8c31e2b3a8027ccf41dd9b003593c14","Luap99","2023-06-22 09:55:29","true","update c/common to latest

includes new packages for slirp4netns and pasta

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",13,77,1,0
"containers/buildah","a4f5707eeb5b4628dab1bb4c4f5be58fbd915fc8","mheon","2018-05-01 17:20:16","false","Do not print directly to stdout in Commit()

Buildah is being used as a library in Podman, and as such should
avoid printing directly to standard streams. Instead, return an
image ID which can be printed by the caller (if desired)

Signed-off-by: Matthew Heon <matthew.heon@gmail.com>

Closes: #647
Approved by: rhatdan",48,15,0,1
"containers/buildah","fbe36445c731e509ffb3e9ce568fd213f3485795","cevich","2021-07-01 13:56:17","true","Adjust conformance-test error-message regex

Sometime around `docker.io 20.10.2-0ubuntu1~20.04.2` several error
message strings were updated from `file not found` to `file does not
exist`.  This breaks conformance testing.  Fix this by adding in
the new error message.

Signed-off-by: Chris Evich <cevich@redhat.com>",38,53,1,1
"containers/buildah","e54c9efabacdf98847c508d981fe49a720453184","cevich","2022-06-10 14:31:38","true","Remove redundant buildahimages-are-sane validation

This has been replaced with a more comprehensive multi-arch test which
is activated by including `[CI:BUILD]` in the PR title.  It exercises
not only the images, but buildah and the entire build_push toolchain.
Further, these images are built daily by Cirrus-Cron and monitored for
any failures making testing in every PR much less useful.

Signed-off-by: Chris Evich <cevich@redhat.com>",22,64,1,1
"containers/buildah","f037ce44637051cde7a1bd656be924a97edba8a7","flouthoc","2021-09-02 10:43:12","false","manifest: rm should remove only manifests not referenced images.

Following commit makes sure that `buildah manifest rm <list>` only removes
the manifest list not referenced images.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",35,55,1,1
"containers/buildah","298e1a5e183923b0a4a1532877381766e5a39293","openshift-merge-robot","2022-08-15 12:57:36","true","Merge pull request #4186 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.8.2

build(deps): bump github.com/fsouza/go-dockerclient from 1.8.1 to 1.8.2",17,67,1,1
"containers/buildah","9c7b69d3a7cf544463f74f9033612e14116f79e5","jacobwgillespie","2021-06-20 21:15:29","true","Add --json flags to `mount` and `version` commands

[NO NEW TESTS NEEDED]

Signed-off-by: Jacob Gillespie <jacobwgillespie@gmail.com>",36,53,1,0
"containers/buildah","63ca9028bc8b05a4d4e969d0c1a6b689c7abeb61","umohnani8","2017-06-22 15:47:20","false","Add 'buildah version' command

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #157
Approved by: rhatdan",15,5,0,1
"containers/buildah","161b04beb3c4c0aea441124ef87ee2d698971d6a","openshift-merge-robot","2023-06-12 19:46:53","true","Merge pull request #4863 from cevich/revendor_test_tooling

Revendor test tooling + Lint fix.",14,77,1,1
"containers/buildah","dc7b50c9dab53cf3adc467557450819e22c6063f","giuseppe","2019-06-13 11:31:22","false","run: fix hang with run and --isolation=chroot

make the stdin pipe not blocking, so that it won't hang if the other
end is not reading from it.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1668
Approved by: rhatdan",42,29,0,1
"containers/buildah","b7a0ed07e9cb76a8468b779226ea4b78293a6cbf","giuseppe","2019-07-29 15:48:35","false","tests: enable overlay tests for rootless

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1743
Approved by: rhatdan",50,30,0,1
"containers/buildah","94ab98d60441fad5c08686ec682b3ea877b02254","giuseppe","2022-09-20 13:22:11","true","cmd: check for user UID instead of privileges

[NO NEW TESTS NEEDED]

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",19,68,1,1
"containers/buildah","02db353d2beb30a28340cb7267f10adacdca9a70","openshift-merge-robot","2023-02-23 16:19:07","true","Merge pull request #4617 from rhatdan/VENDOR

Vendor in latest containers/common",15,73,1,1
"containers/buildah","2df3dfa04de9af9ed149175c0c691127ac274b85","openshift-merge-robot","2022-09-28 08:38:58","true","Merge pull request #4297 from edsantiago/cron_treadmill

Proof of concept: nightly dependency treadmill",21,68,1,1
"containers/buildah","735e8e360fa5ecd9e8241cc2a6bc62afb0253d73","openshift-merge-robot","2022-11-22 08:42:42","true","Merge pull request #4429 from rhatdan/VENDOR

Update vendor of containers/(common, storage, image)",20,70,1,1
"containers/buildah","11964fc3d03c5a30ab7839dd3ed0efa513f38f9f","openshift-merge-robot","2020-11-13 22:10:50","true","Merge pull request #2754 from rhatdan/policy

Add --policy flag to buildah pull",75,45,0,1
"containers/buildah","0afa60eb0582bb2b4bdf395610711c60ad30b572","nalind","2018-03-12 17:53:12","false","Add CLI options for specifying namespace and cgroup setup

Add options to the CLI that specify which cgroups we execute ""run""
commands under, and controlling how we set up namespaces for them.
Pass them down to Builders that we create, and allow them to be
overridden by options passed to Builder.Run().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",20,14,0,1
"containers/buildah","ecfcde24a1222a2ba1252e82d2c37e6bce6bdb72","openshift-merge-robot","2021-06-29 16:55:06","true","Merge pull request #3292 from cevich/use_cached_packages

Cirrus: Install docker from package cache",39,53,1,1
"containers/buildah","a9c12065b39e2d68a55d6999b9a93aab11a50cee","wking","2018-06-29 19:39:36","false","docs: Follow man-pages(7) suggestions for SYNOPSIS

man-pages(7) has [1]:

> For commands, this shows the syntax of the command and its arguments
> (including options); boldface is used for as-is text and italics are
> used to indicate replaceable arguments. Brackets ([]) surround
> optional arguments, vertical bars (|) separate choices, and ellipses
> (...) can be repeated.

I've adjusted our SYNOPSIS entries to match that formatting, and
generally tried to make them more consistent with the precedent set by
the man-pages project.  Outside of the SYNOPSIS entry, I prefer using
backticks for literals, although in some places I've left the **
bolding to keep things visually similar to a nearby SYNOPSIS entry.

I've also simplified a few placeholders, e.g. ""containerID"" ->
""container"", because I didn't think the additional bit was providing
much additional context.  If there is ambiguity about the
representation, it should be addressed in the DESCRIPTION instead of
with an ""ID"" or ""Name"" suffix.

[1]: http://man7.org/linux/man-pages/man7/man-pages.7.html

Signed-off-by: W. Trevor King <wking@tremily.us>

Closes: #839
Approved by: rhatdan",28,17,0,0
"containers/buildah","fc7916d86f674e21368b608b9c5adac28fd9915f","rhatdan","2023-04-05 14:10:15","true","Merge pull request #4659 from flouthoc/run-network

stage_executor: inline `--network` add `default` string",10,74,1,1
"containers/buildah","4a02242a6a4e396b767a1afac541c648a2a7603e","rhatdan","2022-10-01 01:38:09","true","Merge pull request #4306 from mtrmac/pgzip-update

Update for https://github.com/klauspost/pgzip/pull/50",22,68,1,1
"containers/buildah","d9a7f13665b36b2928ec1c564c97de55bbf5c7d7","rhatdan","2020-11-24 00:07:50","false","Add container information to .containerenv

We have been asked to leak some container information
and image information into the container to be used
by certain tools. (Toolbox and others)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",78,46,0,1
"containers/buildah","2dc96b2276faf0847c9a38438cf1e5901e76f7fc","rhatdan","2019-02-27 15:29:09","false","fix unshare option handling and documentation

buildah unshare ls -l
was blowing up.

This is fixed by this PR.

Also added more documentation on use cases of `buildah unshare`

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1375
Approved by: TomSweeneyRedHat",62,25,0,1
"containers/buildah","3abd4b98528d7c5875d31ac6f65b534ff35ffdd9","rhatdan","2023-06-13 11:38:20","true","Merge pull request #4865 from containers/renovate/golang.org-x-term-0.x

fix(deps): update module golang.org/x/term to v0.9.0",13,77,1,1
"containers/buildah","60c008890f31569f1ef3cfe41c2e9d13ca08471c","rhatdan","2019-08-09 13:39:12","false","Fix handling of /dev/null masked devices

If a masked object is already a /dev/null device then don't mask over it.

This logic is backwords and is breaking SELinux.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1776
Approved by: @TomSweeneyRedHat",51,30,0,1
"containers/buildah","f6c4ead1bc771de71e433dc846035204d4ab68eb","aaerrolla","2023-08-05 03:52:05","true","Update install.md changes current Debian stable version name 

updated install instructions for Debian current stable version

Signed-off-by: Anjaneyulu Aerrolla <aaerrolla@gmail.com>",11,78,1,0
"containers/buildah","242678233500264c3190eb859a01e2c405af2801","vrothberg","2021-06-23 08:35:06","false","[CI:DOCS] push/pull: clarify supported transports

As pointed out in containers/podman/issues/10730, the man pages of
buildah/podman push/pull were incomplete in explaining all supported
transports.  To keep things simple, explain the defaults, refer to
containers-transports(5).

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",37,53,1,1
"containers/buildah","6e0074eeedbc903acddeb7bb04093d615de055e5","mtrmac","2018-08-04 01:29:16","false","Move the ""short name but no search registries"" error handling to resolveImage

Use the value now returned by util.ResolveImage instead of trying to
recompute it.

Then drop the no longer used getRegistries.  (It might be reasonable
to split that part of util.ResolveImage to make it shorter; but it should
not ideally have any independent second-guessing callers.  So, just
keep the inlined one instead; that way we certainly don't break it.)

Also drop the no longer used hasRegistry.

CHANGES BEHAVIOR:
- Most notably, the ""short name but no search registries"" code
  has been broken for some time; pullImage was called with
  localhost/$shortname, which was a qualified name, so the
  specialized error handling was never attempted.
- Temporarily, the error handling in the ""short name but no
  search registries"" code trigers even if there were actually
  valid values to try (in practice there is always localhost/$shortname,
  and possibly also options.Registry/$shortname).  The next commit
  will improve it again.
- We now have more legitimate access to the original short name,
  so include it in the error message (it was technically available
  before, but using it was awkward).

NOTE: registriesConfPath is computed using the sysregistries
package, but actual access happens using the sysregistriesv2 package.
That should be cleaned up eventually.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #909
Approved by: rhatdan",22,18,0,1
"containers/buildah","5f95bd9a350a2dcff776914c19192df1cf272b97","TomSweeneyRedHat","2019-01-18 15:00:08","false","Bump to v1.6-1

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Attempting to fix issue in first 1.6 kit.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1293
Approved by: rhatdan",53,24,0,1
"containers/buildah","1e4d1eb31e3d4515c6f6a4be15c5eb42735950ef","TomSweeneyRedHat","2018-10-18 17:42:51","false","Remove no longer valid todo

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1115
Approved by: rhatdan",55,21,0,1
"containers/buildah","326edb312e42274dd9e9804122f5f62b6e4884eb","ashley-cui","2021-10-21 20:14:05","false","Add support for env var secret sources

Run secrets can now be created from an environment variable. The
environment variable is read and is briefly stored as a file on /dev/shm
when it's being used, and the file is removed after the RUN command is
finished.

Fixes: #3524

Signed-off-by: Ashley Cui <acui@redhat.com>",33,57,1,0
"containers/buildah","9d50d04b9324a22bbb64df9e66b5d9d53ed3daae","TomSweeneyRedHat","2018-09-21 23:37:02","false","Fix From As in Dockerfile

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1033
Approved by: nalind",37,20,0,1
"containers/buildah","834a6c848ceae3c2e17093fce57cf1fa6fcde1f2","TomSweeneyRedHat","2018-07-27 21:51:37","false","Create buildah pull command

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #889
Approved by: rhatdan",31,18,0,1
"containers/buildah","43d1102d02fd30c491c6f67985f666d70729f13f","TomSweeneyRedHat","2018-02-17 18:50:52","false","Touchup doc in rpm spec

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #483
Approved by: rhatdan",19,13,0,1
"containers/buildah","0ae62e326a01af2f5603cdaf5307ba62f36e02f4","TomSweeneyRedHat","2018-05-10 17:54:58","false","Touchup man page short options across man pages

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #675
Approved by: rhatdan",56,15,0,1
"containers/buildah","6421c8418069626da85570ac678d5eccffd439bd","openshift-merge-robot","2021-02-12 17:39:58","true","Merge pull request #3002 from rhatdan/test1

Revert patch to allow copying of empty dirs.",60,49,0,1
"containers/buildah","97dcbbd9c651a596524850e797ce1c3e617acb29","openshift-merge-robot","2022-10-24 14:13:09","true","Merge pull request #4365 from dfr/freebsd-install

Makefile: Fix install on FreeBSD",26,69,1,1
"containers/buildah","b7f51ea3d7e8e23049e233ad680b857e80a69ded","flouthoc","2022-08-04 07:14:39","true","build: support filtering cache by duration using --cache-ttl

`build` or `bud` now supports a new flag `--cache-ttl` which accepts
duration and allows end users to ignore cache images which are not under
the specified duration.

Following flag is useful for setups/platforms which heavily relies on
`--layer` and buildah caching but want recompute certain `RUN` steps
after specified duration to make sure specific `RUN` steps are always
updated. Example `RUN dnf update` or `RUN dnf install`

Closes: https://github.com/containers/buildah/issues/4160
Somewhat similar to kaniko's: https://github.com/GoogleContainerTools/kaniko#--cache-ttl-duration

Signed-off-by: Aditya R <arajan@redhat.com>",18,66,1,1
"containers/buildah","e96df7060ca8cc18084b1ebbe38152076bcf991d","flouthoc","2021-10-07 08:37:29","true","buildkit: Add support for --mount=type=tmpfs

Following PR adds supports for buildkit like `--mount=type=tmpfs` which
allows end users to mount a chunk of volatile memory instead of a persistent storage device.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",42,56,1,1
"containers/buildah","619d9f9e16fba8a1e86106adecddec05c3f3ca0d","rhatdan","2020-11-06 01:56:22","false","Update buildah bud man page from podman build man page

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",65,45,0,1
"containers/buildah","4c66c03b3d63d6b4f7d58f00aa4e66df96a1557c","rhatdan","2017-04-24 17:23:11","false","Remove --mount from buildah-from

We don't have a good way of identifying to a user where a container
was mounted on the file system when doing a buildah from.

A user can just do a buildah mount CID /mnt, after the from line to
handle this.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #86
Approved by: nalind",9,3,0,1
"containers/buildah","244170240d8571f5508863779dd739059b894da8","rhatdan","2023-10-12 13:01:44","true","Merge pull request #5086 from containers/renovate/go-golang.org/x/net-vulnerability

chore(deps): update module golang.org/x/net to v0.17.0 [security]",6,80,1,1
"containers/buildah","2b88fd251ed8233e7d18ad10b555c348d0e28fe3","nakato","2019-09-30 22:45:13","false","Ensure bud remote context cleans up on error

During the unpacking of remote context for '-'(stdin), child commit,
the possibility for the remote context processing to leave behind a
stale context directory in the temporary directory `/var/run` was called
out.

As the context is unpacked into a temporary directory, it should be safe
to remove the directory and all files under it.  The files under the
path should only ever be the content of an unpacked tar, a checked out
git repository, or a lone ""Dockerfile"".

Signed-off-by: Sachi King <nakato@nakato.io>

Closes: #1870
Approved by: rhatdan",66,32,0,0
"containers/buildah","0ce647b4e830031e4d7963da17b15269d8ce411e","pixdrift","2018-05-05 13:36:22","false","Adding buildah bud RUN test scenarios

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #656
Approved by: rhatdan",52,15,0,0
"containers/buildah","2bc8ecae5570f7fe3829a9c4163d8dea16e46e94","krisnova","2018-10-18 18:23:07","false","Fixing broken link for container-registries.conf

The link to the container-registries.conf man page was a little off - this fixes it.

This patch was originaly submitted by Kris Nova <kris@nivenly.com>
I am signing it to get it merged.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1153
Approved by: rhatdan",55,21,0,0
"containers/buildah","d67dcf7c7dc60ccfdd4bf4dbf50bd8090a938796","cevich","2021-01-05 15:44:47","true","Cirrus: Update VM Images + Rearrange tasks

Utilize VM Images produced from the containers/automation_images repo.
Also, rearrange tasks to more closely match their runtime dependency
order.

Signed-off-by: Chris Evich <cevich@redhat.com>",89,47,0,1
"containers/buildah","57d665ee9c9a42a9ca6f55b0492343af194aad78","jayaddison","2021-10-09 14:43:09","false","docs: update buildah-build 'platform' option compatibility notes

Signed-off-by: James Addison <jay@jp-hosting.net>",40,56,1,0
"containers/buildah","b9e4e29e9073e942d27ce87ae615af153d3e3191","flouthoc","2023-03-01 10:19:45","true","executor: don't warn about unused TARGETARCH,TARGETOS,TARGETPLATFORM

Buildah warns about TARETARCH, TARGETOS, TARGETPLATFORM in a multi-arch
build however its not very useful for end-users and there are cases
where this can be left untouched so do not warn about test default build
args

Closes: https://github.com/containers/buildah/issues/4485

Signed-off-by: Aditya R <arajan@redhat.com>",18,73,1,1
"containers/buildah","fd5db96c0faff31fce77e8c9d2e974209bd46e3d","flouthoc","2023-03-02 07:18:48","true","sshagent: use ExtendedAgent instead of Agent

It seems ExtendedAgent supports signing with flags instead of ignoring
it. This commit mimics how the ExtendedAgent is configured in Buildkit
: https://github.com/moby/buildkit/blob/master/session/sshforward/sshprovider/agentprovider.go#L221

[NO NEW TESTS NEEDED]
Closes: https://github.com/containers/buildah/issues/4636

Signed-off-by: Aditya R <arajan@redhat.com>",19,73,1,1
"containers/buildah","911e6ea15cb3178052f621f2950dc8797deccee8","openshift-merge-robot","2021-01-09 12:18:42","true","Merge pull request #2897 from TomSweeneyRedHat/bump-1.19.0

Bump 1.19.0",91,47,0,1
"containers/buildah","f841ee00103f1d20d6e4e9082c474592803dfd3b","openshift-merge-robot","2022-05-03 13:57:57","true","Merge pull request #3951 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.7.11

build(deps): bump github.com/fsouza/go-dockerclient from 1.7.10 to 1.7.11",24,63,1,1
"containers/buildah","ad9c34540f250181a8126acb33cd62387f9ef027","openshift-merge-robot","2023-09-19 00:21:43","true","Merge pull request #5054 from rahilarious/main

Removing selinux_tag.sh as no longer needed after 580356f",6,80,1,1
"containers/buildah","96e1871d7502dc9e4aaca4fb12fb0093eee38702","openshift-merge-robot","2021-11-03 00:29:54","true","Merge pull request #3609 from flouthoc/fix-arg-history

build: history should not contain `ARG` values. OTOH `RUN` history should contain final values.",30,57,1,1
"containers/buildah","77192961e6d976a794880f579ba2b89b77233248","openshift-merge-robot","2020-11-05 15:16:31","true","Merge pull request #2745 from nalind/add-url-chown

ADD: handle --chown on URLs",68,45,0,1
"containers/buildah","aa35502984b6c94e355f4d042a9fbd3902ca93ef","ypu","2019-11-06 09:46:53","false","Test: Get permission in add test

The permission may different in different system. Not always a fix
value. So update the scripts to get the permission during the test.

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #2004
Approved by: rhatdan",82,33,0,0
"containers/buildah","6e5aba599d7ae3be6d9e7d10969225645c04628e","giuseppe","2018-10-11 13:37:45","false","unshare: detect when unprivileged userns are disabled

On Debian/Ubuntu it is possible to disable unprivileged userns through
the /proc/sys/kernel/unprivileged_userns_clone file.

Detect such case when unshare(CLONE_NEWUSER) fails.

Closes: https://github.com/containers/buildah/issues/1068

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1085
Approved by: rhatdan",52,20,0,1
"containers/buildah","32661c7112e990ab43ca56ac0fa54710d82f1d79","umohnani8","2021-01-22 18:05:36","false","Use build-arg ENV val from local environment if set

If a user sets the ENV to be used with the build-arg flag in
the local environment by exporting it, look it up and use the
value set there for that ENV.
Add tests to cover this use case as well.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>",95,48,0,1
"containers/buildah","5e792e97b0dbedd971ffd5d13a0f688005793422","dfr","2022-11-30 11:25:25","false","version: Bump to 1.29.0-dev

[NO TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",19,70,1,0
"containers/buildah","c01bf2bb5fba133e54a56d67a74433bd5589eccb","rhatdan","2020-02-19 12:49:58","true","Merge pull request #2172 from nalind/manifest-push-format

manifest push --format: force an image type, not a list type",97,37,0,1
"containers/buildah","cee0ea5856b08b41ad2f44a1de8d48a66cd71703","rhatdan","2018-10-12 11:24:27","false","Podman  --privileged selinux is broken

Current podman does not disable SELinux when running in privileged mode

This PR Should fix this until we get an updated version of podman out.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",53,20,0,1
"containers/buildah","9c1d27350830d9947bed0ae3037e3d2a0e5769ba","rhatdan","2018-12-05 18:50:54","false","Vendor in latest content from github.com/containers/storage

This should make running on a vfs over reflink run faster.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1222
Approved by: umohnani8",48,22,0,1
"containers/buildah","e15cb2d9f6fe5b19b2236a971bf2e7b1491d27cb","rhatdan","2018-10-22 16:57:45","true","Merge pull request #1099 from q384566678/from-isolation

run: When the value of isolation is set, use the set value instead of the default value",53,21,0,1
"containers/buildah","b5eac0b88d6d7000f351353b85a7d924db395124","rhatdan","2021-02-23 12:27:24","false","Isolation strings, should match user input

When we parse isolation we expect users to input chroot, oci, rootless.

So when we translate the constants back to strings, we should use the
same values.

These human names need to be passed over the podman-remote build
bindings, so we need to make them match.

Also docker describes an isolation of ""default"", which we should also
handle for potential scripts.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",60,49,0,1
"containers/buildah","deb2d903abc82cec2f5afcc9351cdc3bfdaabe18","edsantiago","2022-09-13 18:19:22","false","Minor test fix for podman-remote

Minor fix to test introduced in #4239. Treadmill discovered
that the test fails under podman-remote, because absolute
file paths differ. Fix test so it works under buildah,
podman, and podman-remote.

Signed-off-by: Ed Santiago <santiago@redhat.com>",19,67,1,1
"containers/buildah","4328abf3aadf033da7ebd3ce2ea921530eb4ee9e","edsantiago","2019-04-05 01:32:54","false","New tests for #1467 (string slices in cmdline opts)

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1472
Approved by: TomSweeneyRedHat",51,26,0,1
"containers/buildah","555919bb14d52abe4b16f887890b2426d17453d6","shooz","2018-03-10 11:05:00","false","Fix wrong order of parameters

Signed-off-by: SHooZ <SHooZ@ex.ua>

Closes: #513
Approved by: rhatdan",20,13,0,0
"containers/buildah","c4fc67f8fdd73cbe5c85a8ddac37694a6a5d9770","openshift-merge-robot","2021-05-03 10:14:28","true","Merge pull request #3195 from containers/dependabot/go_modules/github.com/containers/common-0.37.1

Bump github.com/containers/common from 0.37.0 to 0.37.1",49,51,0,1
"containers/buildah","e63c1a2a750a02b2a417d6abbe323bc7425b02c0","openshift-merge-robot","2022-10-04 11:42:54","true","Merge pull request #4310 from flouthoc/target-warn-test

test: warning behaviour for unset/set `TARGETOS`,`TARGETARCH`,`TARGETPLATFORM`",24,68,1,1
"containers/buildah","00fa4b1ee18761b0702769725b9a752ae24a3e4d","openshift-merge-robot","2023-07-21 00:11:11","true","Merge pull request #4930 from containers/renovate/github.com-opencontainers-runc-1.x

fix(deps): update module github.com/opencontainers/runc to v1.1.8",14,78,1,1
"containers/buildah","6d3b8d3e102a8927d6a288526795e0bb871d66cc","openshift-merge-robot","2021-01-08 11:37:20","true","Merge pull request #2893 from rhatdan/tmpdir

Fix handling of TMPDIR environment variable",91,47,0,1
"containers/buildah","d0a675edf87cf779fe1528aaa000658ac15d5ed6","dfr","2022-07-17 10:13:28","false","bump github.com/opencontainers/runtime-tools

This picks up the changes that add FreeBSD support to
runtime-tools/generate:

    go get github.com/opencontainers/runtime-tools@17b3287fafb78aee959deac9c234b7a123a242a7

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",24,66,1,0
"containers/buildah","041aeff03e14bc7a3c44ea9ee6a4781a6944cb73","nalind","2022-05-02 22:30:46","false","buildah build: --annotation and --label should remove values

Have the handling of the `--annotation` and `--label` options for
`buildah build` explicitly remove values when they're not given an ""=""
before an empty value, instead of setting them to empty values.  The
final result doesn't seem to care about the distinction.

Allow the value of the `io.buildah.version` label to be manually
specified on the `buildah build` command line if someone really wants to
override the value that we would otherwise set by default.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",24,63,1,1
"containers/buildah","d95c6be83b03befb527b88b4d4b1c585405d2b9f","nalind","2021-05-11 16:21:09","false","Add and use a ""copy"" helper instead of podman load/save

Instead of using podman to cache images during integration tests, use a
custom helper.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",54,51,0,1
"containers/buildah","c4d2a852072bdcb0011f6f90f0b5c4a087681670","nalind","2023-06-29 14:24:45","false","Run unit tests for copier and chroot without -cover

The chrooting causes testing with coverage counting enabled to output a
warning message which interferes with how they communicate with child
processes.  Disable -cover for those modules by testing them separately
without it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",13,77,1,1
"containers/buildah","2326d4929f2bd2494a26b8b42eef5f5c6029dfda","nalind","2023-09-14 17:16:16","false","Tag v1.32.0

[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",5,80,1,1
"containers/buildah","302586a1a96564ec962299a39847a7e4e3e1a50e","nalind","2018-03-21 15:19:47","false","Break Builder.Run()'s ""run runc"" bits out

Break Builder.Run()'s ""running runc"" parts into their own method, in
preparation for making that part larger.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #708
Approved by: rhatdan",18,14,0,1
"containers/buildah","19a7165783a77b2c9c1906ecd7feee0459631509","nalind","2017-03-28 07:01:59","false","Apply Last-Modified time as mtime when saving URLs

When saving the contents of a URL to a local file, attempt to set mtime
based on the response's Last-Modified header, if there is one.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #58
Approved by: nalind",14,2,0,1
"containers/buildah","422ad51afbcc1739d63cb2022b56f6ae05567dcd","nalind","2017-10-05 17:50:40","false","Fix a compile error in the unit tests

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",31,8,0,1
"containers/buildah","d0f7e88806b1c22672434f188f5dc552fbf4527d","nalind","2017-04-10 18:17:15","false","imagebuildah: Provide logging callbacks

Add a Log() callback and Out and Err io.Writers to the set of options
that imagebuildah can accept.  If Log is not specified, log to Err.  If
Err is not specified, log to os.Stderr.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #73
Approved by: rhatdan",13,2,0,1
"containers/buildah","ecd192698c7be393c2b0c716cce047ffba3fe6ac","lsm5","2022-03-24 15:20:38","true","Bump github.com/prometheus/client_golang to v1.11.1

Resolves: CVE-2022-21698

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",31,62,1,1
"containers/buildah","8d6869bccee02f73f0e26e739c9f8712578b3f32","edsantiago","2019-12-05 18:20:05","false","imgtype: reset storage opts if driver overridden

If invoked with --storage-driver=foo on command line,
reset GraphDriverOptions. Otherwise, on a default
Fedora install with default /etc/containers/storage.conf:

    # buildah-imgtype --storage-driver vfs -expected-manifest-type '*' sdf
    ERRO[0000] error opening storage: vfs driver does not support overlay.mountopt options

This is because /etc/containers/storage.conf specifies:

    [storage.options.overlay]
    ...
    mountopt = ""nodev,metacopy=on""

...and that gets read & set early, before the command-line
overriding of storage-driver.

This fixes two gating-test failures on Fedora.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2009
Approved by: TomSweeneyRedHat",87,34,0,1
"containers/buildah","cfcfc46c8a2192edb71adffaf8b65eb3f76fcc60","praiskup","2019-03-18 06:18:02","false","escape shell variables in README example

Signed-off-by: Pavel Raiskup <praiskup@redhat.com>

Closes: #1413
Approved by: TomSweeneyRedHat",36,26,0,0
"containers/buildah","e137d26ab97565ce38f6506f75e34ed6685d6d03","mtrmac","2018-06-11 21:53:45","false","Use c/image/manifest.GuessMIMEType instead of a custom heuristic

Notably this will use the manifest mediaType field, instead of the
config docker_version field, to detect Docker v2s2 images; again,
docker_version is cleared by buildah itself, so it can't be relied
to decide on the image format.

Anyway, centralizing the tricky heuristic and using a single one
everywhere seems preferable for consistency.

This also allows only searching for OCI annotations on known OCI
images, and that in turn allows us not to silently ignore errors
when parsing OCI manifests.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #776
Approved by: rhatdan",33,16,0,1
"containers/buildah","873f00141c8e23973709f6226972d5976f8eb975","TomSweeneyRedHat","2019-02-21 14:27:22","false","Bump to v1.7

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1356
Approved by: rhatdan",59,25,0,1
"containers/buildah","265d2da6cf4ad279005b1c596c8204de7ce7a444","nalind","2017-07-28 16:58:29","false","Always free signature.PolicyContexts

Whenever we create a containers/image/signature.PolicyContext, make sure
we don't forget to destroy it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #231
Approved by: rhatdan",23,6,0,1
"containers/buildah","fa8653314a5776f99a13f9f731d58bfa5b054fd9","nalind","2019-01-08 21:57:49","false","run: ignore EIO when flushing at the end, avoid double log

When reading the last of the output from a child process, ignore an EIO,
since we already got the HUP indication.

Avoid double-logging errors in our I/O loop when using isolation other
than chroot (spotted by @afbjorklund).

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1273
Approved by: rhatdan",51,23,0,1
"containers/buildah","9c6969a79e1ba211e6f2e9146d68451ff5a63a07","nalind","2020-10-05 21:43:49","false","ADD and COPY: descend into excluded directories, sometimes

When a directly-named (or globbed) source directory for ADD or COPY is
marked for exclusion by .dockerignore, check if its name is a prefix for
any exceptions in the .dockerignore file, and if it is, check the
directory for things we need to include anyway.

This will miss exceptions where the pattern uses a wildcard for anything
but the final component.

When adding items, count items that are actually passed over the tar
pipe, rather than items scanned, so that we can correctly diagnose not
having found anything that we needed to copy under a directory that
would otherwise have been excluded.

In copierHandlerGet(), just don't discount any globbed directories that
are excluded.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",86,44,0,1
"containers/buildah","ab9bbe032b401d98fc09be6571195f1a7d6422f1","j00bar","2017-05-30 19:57:52","false","Make README dnf command copy-pastable

There are EOL spaces in the README preventing the `dnf install` command from being used in copy-pasta.

Signed-off-by: Joshua ""jag"" Ginsberg <jag@flowtheory.net>

Closes: #128
Approved by: rhatdan",13,4,0,0
"containers/buildah","188cd46b08cb3fabbc75aa474d0c3520724b2b48","edsantiago","2021-07-27 13:33:42","false","runtime-flag (debug) test: handle old & new runc

Between runc-1.0.0-70.rc92 and 1.0.1-3, debug messages changed
entirely. Old runc is a short and sweet list:

   time=""..."" level=debug msg=""nsexec:601 nsexec started""
   time=""..."" level=debug msg=""child process in init()""
   time=""..."" level=debug msg=""logging has already been configured""

New runc is pages and pages of gobbledygook which I'm not going to
paste here but which, basically, is completely different. Better,
because most messages now include ""runc"", but different.

These buildah tests need to pass in environments with old and
new runc. As best I can determine, the ""child process in init""
message is the only string common to both old and new runc.
Use it as our gauge. (Note: I considered using a regex pattern
containing both ""nsexec"" and ""runc"". That's less maintainable.
If/when runc changes debug messages again, we may need to go
that route, but for now let's keep things clean).

Signed-off-by: Ed Santiago <santiago@redhat.com>",38,54,1,1
"containers/buildah","836729b57ca49b0dc92e3439f1a3e7646f759ad1","vrothberg","2019-06-18 11:35:01","false","conformance test: catch copy error

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","b4fb1c6b6024863e7938fb9d7c38726d1faeb6f8","vrothberg","2018-10-12 08:01:18","false","papr: mount source at gopath

This fixes some hiccups on recent images of fedora/28/atomic, where
we've been hitting permission errors when mounting and copying around
the source.

Signed-off-by: Valentin Rothberg <vrothberg@suse.com>

Closes: #1090
Approved by: rhatdan",53,20,0,1
"containers/buildah","597d3088010eb7c99f86b32a1fc40ae2f5f46282","lsm5","2023-07-31 17:42:21","true","CI:BUILD] RPM: define gobuild macro for rhel/centos stream

The current gobuild macro doesn't account for build tags on both c9s and
c8s. This is currently causing copr build failures for c9s.

Ref: https://copr.fedorainfracloud.org/coprs/rhcontainerbot/podman-next/build/6220412/

This commit will define gobuild for all those envs until gobuild is
fixed by default.

Refs:
c9s bz: https://bugzilla.redhat.com/show_bug.cgi?id=2227328
c8s bz: https://bugzilla.redhat.com/show_bug.cgi?id=2227331

[NO NEW TESTS NEEDED]

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",14,78,1,1
"containers/buildah","854b38c7455a7e0d305a274b994bb121c76e006b","nalind","2021-06-18 18:56:09","false","copier.Put(): set xattrs after ownership

Set extended attributes on files _after_ setting their ownership, so
that security-sensitive attributes (""security.capability"" among them)
won't get quietly cleared from under us if we set them before calling
chown().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",36,53,1,1
"containers/buildah","4e3bf9d5c8c5598bb84a5700985c419c958cd1e4","openshift-merge-robot","2021-03-24 20:03:49","true","Merge pull request #3050 from barthy1/multi_arch_doc

[ci:docs] Add information about multi-arch images to the Readme",53,50,0,1
"containers/buildah","fec18e82d29ddaa75e7cab5aaa39b780c61f330d","openshift-merge-robot","2023-05-23 00:54:50","true","Merge pull request #4805 from containers/renovate/github.com-stretchr-testify-1.x

fix(deps): update module github.com/stretchr/testify to v1.8.3",17,76,1,1
"containers/buildah","efc354f0e3d7c3310e41b5b53395112b61ad2c85","openshift-merge-robot","2023-03-01 10:39:54","true","Merge pull request #4633 from rhatdan/VENDOR

Vendor in latest containers/(common, storage, image)",18,73,1,1
"containers/buildah","55b2006a66d261834aa05ff6789b108b15b86a0f","ypu","2018-08-28 15:31:30","false","Add README for conformance test

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #965
Approved by: rhatdan",30,19,0,0
"containers/buildah","8e64ce1de65f1d5356cf87a2da838280ac78ace9","nalind","2018-08-21 20:33:36","false","Let util.ResolveName() return parsing errors

Allow util.ResolveName() to return errors from libraries that it uses.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #948
Approved by: rhatdan",28,19,0,1
"containers/buildah","7bafc3074132b97f0518e68c6414f61c55d09f82","nalind","2018-07-03 18:38:26","false","Add a --loglevel option to build-with-dockerfile

Add a --loglevel option to build-with-dockerfile and use it to add
a value from -2 to 3 to the default logrus LogError logging level.
This makes --loglevel 3 equivalent in effect to the global --debug
option.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #845
Approved by: rhatdan",27,17,0,1
"containers/buildah","711e0f420ffc0387a8e35d1c9308c8b524b0303b","nalind","2017-03-22 20:48:38","false","Merge pull request #22 from rhatdan/BUILDAHROOT

Default --root option to ENV BUILDAHROOT",12,2,0,1
"containers/buildah","b533b5bb0edbd5ca4de60089c256813a29bdb21d","nalind","2018-06-22 15:20:02","false","commit: recognize committing to second storage locations

Recognize cases when we're committing to local storage, but in a
location other than where the working container is, by checking if the
base image (by ID, in case it's tagged and the tag points to a different
image with different layers) is present in the destination's store.

In those cases, we can't just assume that we can skip exporting the base
image's layers.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",29,17,0,1
"containers/buildah","2160a9e8033b26fc25a067b7d445b28d7f274f8a","nalind","2017-03-06 23:11:40","false","Add some integration tests

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","69d31e3d3f7becbf2dc66f5fa6dd5b3e89de4d50","openshift-merge-robot","2021-06-18 12:19:48","true","Merge pull request #3312 from mtrmac/ParseImageName

Don't use alltransports.ParseImageName with known transports",40,53,1,1
"containers/buildah","db29146e71c4c03f2d6d19398fb6ab29bb294c73","openshift-merge-robot","2021-06-23 16:57:32","true","Merge pull request #3330 from jacobwgillespie/run-flags

Add `--env` and `--workingdir` flags to run command",37,53,1,1
"containers/buildah","5f5745389ade2e19eefebe45c0111e9e4f8e7302","openshift-merge-robot","2020-11-06 23:38:04","true","Merge pull request #2755 from nalind/whoops

Run: correctly call copier.Mkdir",63,45,0,1
"containers/buildah","e63629bfc603a4a62652a9f3aefb51be55ccbf7e","rhatdan","2017-03-25 16:58:08","false","Add some obvious short options

Closes: #44
Approved by: rhatdan",14,2,0,1
"containers/buildah","2ed9d50514d61b513016cb6d023dcf98db048829","rhatdan","2022-06-09 19:17:59","true","Merge pull request #4033 from TomSweeneyRedHat/dev/tsweeney/newcontainerfiles

[CI:BUILD] WIP Cleanup Image Dockerfiles",23,64,1,1
"containers/buildah","815cedfc71fff7460b683b5f9e8fe053b31a31ef","boaz0","2018-01-29 01:08:06","false","Trim the image reference to just its name before calling getImageName

When setting a container name the getImageName function goes through
all the names of the resolved image and finds the name that contains
the given name by the user.

However, if the user is specifying ""docker.io/tagged-image""
the Docker transport returns ""docker.io/library/tagged-image"" which
makes getImageName returns the original image name because it does
not find a match.

To resolve this issue before calling getImageName the image given
by the user will be trimmed to be just the name.

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>

Closes: #422
Approved by: rhatdan",37,12,0,0
"containers/buildah","df710670985dfc1dbb278617e787969befbd463c","rhatdan","2023-04-08 03:22:35","true","Merge pull request #4714 from containers/renovate/major-ci-vm-image

chore(deps): update dependency containers/automation_images to v20230405",11,74,1,1
"containers/buildah","60382209e369a9e699a565766e5be5042fdfe473","mtrmac","2022-10-19 00:31:03","false","Simplify the interface of GetCacheMount and getCacheMount

It can return at most one lock, so don't return an array.

Should not change behavior right now, but it will simplify
cleanup.

[NO NEW TESTS NEEDED]

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",27,69,1,1
"containers/buildah","71f0f9d063358344549265a2c4aea45b3627f66b","nalind","2018-05-22 16:05:18","false","build-using-dockerfile: add --annotation

Add an --annotation flag to ""buildah build-using-dockerfile"".

Refactor the logic for --label handling to use SetLabel() to set them in
the image configuration in Executor.Commit(), instead of passing them as
a field in CommitOptions for Builder.Commit() and expecting it to do so.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #716
Approved by: rhatdan",62,16,0,1
"containers/buildah","2dd03d6741d8042a5955a041c4345a614c8b6406","nalind","2017-11-30 23:31:36","false","tests/rpm.bats: use Fedora 27

Update tests/rpm.bats to use Fedora 27.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #342
Approved by: rhatdan",32,10,0,1
"containers/buildah","f0ddf5eacff8e48f6009ce230fc2bbc7277c57a5","nalind","2021-09-20 17:27:32","false","tests/copy/copy: wire up compression options

Add the --dest-compress, --dest-decompress, --dest-compress-format,
and --dest-compress-level options to the ""copy"" test helper.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",39,56,1,1
"containers/buildah","35a37f36d37bf84397d7f79f6bb8649f728c19f1","nalind","2018-08-02 18:25:40","false","chroot: handle raising process limits

When using chroot isolation, if we're configured to raise any process
limits above their current values, do so in the grandparent process,
before it transfers execution to a child that it starts in a user
namespace, which won't have the privileges to do so.

The child can still lower resource limits and set limits to the values
that it inherited, so let it continue to do so.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #891
Approved by: rhatdan",29,18,0,1
"containers/buildah","82072d214a7978759ea895b6cb23403f47d5af06","nalind","2020-10-30 17:47:23","false","imagebuildah: cache should take image format into account

When evaluating cache candidates during a build, only consider an image
if it's in the same format that we're attempting to build.  That way, we
won't mistakenly try to use an OCI format image as a cache when we're
attempting to build an image in Docker format because we're using
configuration features specific to that format, but we forgot to specify
the format during a previous attempt.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",67,45,0,1
"containers/buildah","d981536c3d84d78bee6461b2db1526588c3a13e5","nalind","2020-02-17 22:20:42","false","manifest push --format: force an image type, not a list type

The image library's image copying API expects the type of a single image
in the options structure's ForceManifestMIMEType field, and it infers
the corresponding list type when it's copying multiple images.

Previously, though, we were passing in a list type, which was also being
used as the target type for converting single images, which would fail.
Switch to passing in the single-image type instead, and infer the single
type in our internal API if a consumer passes us a list type.

This makes it easier to notice that we force v2s1 images to be converted
to v2s2 images when we push them as part of a list, even if the registry
doesn't reject v2s1 images.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",100,37,0,1
"containers/buildah","8e77a0c2f7e7806f0cd12e6257d4b77af823d8c5","pixdrift","2018-05-06 11:42:01","false","Add cache-from and no-cache noops, and fix doco

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #659
Approved by: rhatdan",52,15,0,0
"containers/buildah","5a452a064513318ed164fa59e3216aedf63fe834","lsm5","2021-10-05 13:42:10","true","Bump containerd to v1.5.7

Fixes: GHSA-c2h3-6mxw-7mvq
Vulnerable versions: >= 1.5.0, < 1.5.7
Patched version: 1.5.7

`Impact`
A bug was found in containerd where container root directories and
some plugins had insufficiently restricted permissions, allowing
otherwise unprivileged Linux users to traverse directory contents
and execute programs. When containers included executable programs
with extended permission bits (such as setuid), unprivileged Linux
users could discover and execute those programs. When the UID of
an unprivileged Linux user on the host collided with the file
owner or group inside a container, the unprivileged Linux user on
the host could discover, read, and modify those files.

`Patches`
This vulnerability has been fixed in containerd 1.4.11 and
containerd 1.5.7. Users should update to these version when they
are released and may restart containers or update directory
permissions to mitigate the vulnerability.

`Workarounds`
Limit access to the host to trusted users. Update directory
permission on container bundles directories.

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",44,56,1,1
"containers/buildah","4d943752fef667b8ce68f7ca7d144fab0da8b176","ipbabble","2017-12-07 17:57:14","false","Fixed some more Tom nits.

Signed-off-by: William Henry <whenry@redhat.com>",31,10,0,0
"containers/buildah","3117f5e7e82890a8e0149894e442232f1c71158d","vrothberg","2019-08-02 09:30:22","false","vendor github.com/containers/image@v3.0.0

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1756
Approved by: rhatdan",49,30,0,1
"containers/buildah","76e9dbf8a66c7375de0b50b2cce2f7ca02e36661","eriksjolund","2022-01-25 20:55:55","false","[CI:DOCS] Fix typos and improve language

Signed-off-by: Erik Sjölund <erik.sjolund@gmail.com>",33,60,1,0
"containers/buildah","02d4a6b5f2bebe452e17dd0e0061f06bc7f849c7","giuseppe","2022-09-20 10:05:51","true","test: run in the host cgroup namespace

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",19,68,1,1
"containers/buildah","d0f6961099586961ccaa43822cabb8c704bccfc0","giuseppe","2019-04-03 14:22:09","false","unshare: move some code from cmd/buildah/unshare

so that it can be reused by other programs.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1475
Approved by: rhatdan",53,26,0,1
"containers/buildah","a6f6a41a731d998a0d22f963106e557e9633be87","giuseppe","2022-04-01 13:28:53","true","test: skip rootless on cgroupv2 in root env

the test needs to run as rootless, skip it when running in a root
environment.

Closes: https://github.com/containers/buildah/issues/3884

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",27,62,1,1
"containers/buildah","6838cbc8120a68eabec918e6adec3084dc306d82","flouthoc","2022-10-18 10:13:08","true","run: honor lockfiles for multiple --mount instruction

Single `RUN` can contain multiple `--mount` commands so lets append into
`lockedTargets` so we collect `lockfiles` from all the `--mount`
instructions.

Helps in: https://github.com/containers/buildah/issues/4342

Signed-off-by: Aditya R <arajan@redhat.com>",27,69,1,1
"containers/buildah","ffed850367a9f88faa82a12d1df62c1a00aa937c","flouthoc","2022-12-05 06:29:19","true","remote-cache: support multiple sources and destinations

Buildah must support multiple sources for remote cache when using
`--cache-to` and `--cache-from` so users can distribute and collect
cache from various sources.

We also need for compat with buildkit api which in past broke `podman`
compat build API see: https://github.com/containers/podman/pull/16380

More discussion here: https://github.com/containers/podman/pull/16380

Signed-off-by: Aditya R <arajan@redhat.com>",17,70,1,1
"containers/buildah","12ea52c71450d303dea8dd09be1c61c05d0219c6","openshift-merge-robot","2021-02-08 18:35:15","true","Merge pull request #2979 from containers/dependabot/go_modules/github.com/onsi/gomega-1.10.5

build(deps): bump github.com/onsi/gomega from 1.10.4 to 1.10.5",94,48,0,1
"containers/buildah","762cf6f9d9284fddeb9664b3c1d8ad2cc689ac92","openshift-merge-robot","2021-10-15 16:11:57","true","Merge pull request #3576 from rhatdan/errors

Report ignorefile location when no content added",36,57,1,1
"containers/buildah","0c7eff8d54588bea15840ad2a0e2e4b0d945f6a7","openshift-merge-robot","2020-11-06 18:21:48","true","Merge pull request #2752 from mbargull/no-LDFLAGS-override

Avoid overriding LDFLAGS in Makefile",66,45,0,1
"containers/buildah","7de2bbde5bd6794d183c098720738b139e39e30e","openshift-merge-robot","2022-05-03 23:12:03","true","Merge pull request #3953 from nalind/os-version

Handle OS version and features flags",24,63,1,1
"containers/buildah","bddf46893a69f1f0a6cb5b64851c1e679efb9dc1","rhatdan","2021-04-14 18:48:57","false","Add buildah manifest rm command

Add command to actually remove the manifest list. This
uses the same basic code that buildah rmi uses, but makes
the error messages more specific to a manifest list.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",52,51,0,1
"containers/buildah","21e6e91e4afb299d985975af07c8fd26aa1cf5a7","rhatdan","2023-02-22 13:27:15","false","Vendor in latest containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",15,73,1,1
"containers/buildah","e28c43d17890a5c61ccb43300dbbe475c8e06e18","rhatdan","2019-12-13 18:48:32","true","Merge pull request #2024 from TomSweeneyRedHat/bump-1.12.0

Bump 1.12.0",88,34,0,1
"containers/buildah","f4254eef831ed385c593731c3247fbf722e83ee5","rhatdan","2021-04-02 10:45:48","false","Setup alias for --tty to --terminal

Need to properly handle the --tty hidden flag.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",49,50,0,1
"containers/buildah","75bbfdf3c0daf6383d96498d5159ae8a198c6bb2","rhatdan","2021-08-24 18:03:06","false","Fix ownership of /home/build/.local/share/containers

Fixes: https://github.com/containers/buildah/issues/3457

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",39,55,1,1
"containers/buildah","552cbd31d1f26ce7a644ee95969057a6ef098b64","rhatdan","2020-09-16 12:03:06","true","Merge pull request #2623 from rhatdan/completions

Improve buildah completions",90,44,0,1
"containers/buildah","8c8a13fdc2897eba6b4ab13644e9ee8de183cb8d","rhatdan","2017-04-14 10:09:23","false","Small cleanup on buildah rmi to make code cleaner

While adding rmi to ocid, I was asked to make this change, so want
to keep the code in buildah and ocid for these functions as close as
possible to the same.

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #69
Approved by: nalind",14,3,0,1
"containers/buildah","0ca5b8a304597368a7a2f6a0d404b3b54d94f695","rhatdan","2021-03-24 09:41:26","false","build(deps): bump github.com/containers/common from 0.35.2 to 0.35.3

Bumps [github.com/containers/common](https://github.com/containers/common) from 0.35.2 to 0.35.3.
- [Release notes](https://github.com/containers/common/releases)
- [Commits](https://github.com/containers/common/compare/v0.35.2...v0.35.3)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",53,50,0,1
"containers/buildah","6841f92e9050bca6baf98acf458b1bfe5c1772d9","cevich","2022-06-23 21:09:20","true","Cirrus: Update VM images w/ updated bats

Note: Fedora-35 is disabled due to missing golang 1.18

Ref: https://github.com/containers/automation_images/pull/140
     and
     https://github.com/containers/automation_images/pull/149
     and
     https://github.com/containers/automation_images/pull/146

Signed-off-by: Chris Evich <cevich@redhat.com>",20,65,1,1
"containers/buildah","8e26456163e834ff34b9a191cce7906f7b462234","TomSweeneyRedHat","2019-10-16 23:54:05","false","Add test for caching based on content digest

Add Tom's test for cache checking from #1929.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>
Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1955
Approved by: rhatdan",80,33,0,1
"containers/buildah","5179733c630674f367a888d8d1875ee1e9998376","TomSweeneyRedHat","2018-01-20 22:39:36","false","Update auth tests and fix bud man page

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #404
Approved by: rhatdan",33,12,0,1
"containers/buildah","68a6c0a4c057047cc538d361544ddbc6b1ebe1c5","TomSweeneyRedHat","2018-02-18 00:21:14","false","Display full error string instead of just status

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #485
Approved by: rhatdan",19,13,0,1
"containers/buildah","27fa74f1f806793e32ac10f17290c10789c778fb","TomSweeneyRedHat","2018-10-16 12:55:00","false","Update calls in e2e to addres 1101

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1103
Approved by: rhatdan",53,21,0,1
"containers/buildah","b5c86a8e055e7fd6f9b5bcdf1393ff8fa0cb5e4e","AndASM","2022-09-30 16:08:59","false","Correction - `FLAVOR` not `FLAVOUR`

This project uses the American dialect of written English. Not the
English (or Canadian) dialects as some more befuddled individuals might
do. I hope you enjoy the humour of this, I do.

Signed-off-by: Andrew Meadows <andrew@befuddled.ca>",20,68,1,0
"containers/buildah","be038099a84e3187e36f2133217b1d110a0c7f65","vrothberg","2018-07-28 06:40:06","false","rmi.storageImageID: fix Wrapf format warning

Golang tip got smarter and found the following issue:

    ""Wrapf format %v reads arg #2, but call has 1 arg""

Signed-off-by: Valentin Rothberg <vrothberg@suse.com>

Closes: #890
Approved by: TomSweeneyRedHat",31,18,0,1
"containers/buildah","d3a92dbf254503a85ea3e18b384d6d75f2a6e6e2","EricHripko","2019-06-03 21:59:40","false","Add missing continue

Signed-off-by: Eric Hripko <ehripko@bloomberg.net>

Closes: #1637
Approved by: rhatdan",59,28,0,0
"containers/buildah","f53d1dde1a6f45eaec2edabfd8f84bb174ca8d33","TomSweeneyRedHat","2018-06-25 14:53:09","false","Add info on registries.conf to from manpage

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #817
Approved by: rhatdan",28,17,0,1
"containers/buildah","08eeb621883ad83ca349051e6de7f0d0fcc57fb2","TomSweeneyRedHat","2019-12-03 17:02:01","false","Bump back to v1.12.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",85,34,0,1
"containers/buildah","5af67cbd0faf7d439c04639dc6a613aa1facfcd5","mtrmac","2018-08-04 01:02:06","false","Don't even invoke the pull loop if options.FromImage == """"

The loop will not run because util.ResolveName("""", ...) returns nil;
so, don't even invoke it.

That way, if we don't get an image from resolveImage, we know
we should have and it is an error.

Should not change behavior.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #909
Approved by: rhatdan",22,18,0,1
"containers/buildah","bd8902b6348e7da891be640f1c392e5ca341c5eb","ypu","2019-10-29 06:40:54","false","Tests: Add a test for tag by id

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #2004
Approved by: rhatdan",80,33,0,0
"containers/buildah","3a6919b5c0c0708e178eaffb4f278997210697ed","flouthoc","2022-08-01 18:17:13","false","version: bump to 1.28.0-dev

[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",18,66,1,1
"containers/buildah","31b6e7b485b4b5fff55cb4a9e34ecf98020121b8","nalind","2017-04-13 20:23:31","false","Add a man page for buildah-bud(1)

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #59
Approved by: rhatdan",14,3,0,1
"containers/buildah","4e549753aa1b990933132ce419704a0b20fe50c3","openshift-merge-robot","2021-01-18 15:50:22","true","Merge pull request #2919 from containers/dependabot/go_modules/github.com/mattn/go-shellwords-1.0.11

build(deps): bump github.com/mattn/go-shellwords from 1.0.10 to 1.0.11",94,48,0,1
"containers/buildah","9fb52f7716601f283fba55798018a7cb514eeaaa","rhatdan","2020-02-07 14:20:48","true","Merge pull request #2146 from TomSweeneyRedHat/bump-1.14.0

Bump 1.14.0",111,36,0,1
"containers/buildah","a2b018430df1e8e89b23cb5bfa49e4d3517e1c2d","rhatdan","2018-07-30 15:54:15","false","Set the default ulimits to match Docker

We want to set the maximum number of processes and number of open files
to match the Docker defaults.

nofile=1048576:1048576, nproc=1048576:1048576

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #891
Approved by: rhatdan",31,18,0,1
"containers/buildah","d41a4fd27c197b5557689eb79f000225f4b91565","openshift-merge-robot","2022-04-12 20:37:38","true","Merge pull request #3908 from rhatdan/VENDOR

Update vendor of storage,common,image",25,63,1,1
"containers/buildah","dcbf1939ebedbd0efa87972f26ac7b933dcbfb67","epruesse","2019-05-18 19:24:26","false","Avoid including linux/memfd.h

The file is not available on older distros
Define MFD constants if they are missing

Patch originally written by Elmar Pruesse github.com/epruesse
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1655
Approved by: rhatdan",57,28,0,0
"containers/buildah","7d8f4f15159b1845c3879febbedb829a33a05906","cevich","2021-04-29 15:36:19","true","Cirrus: Update F34beta -> F34

Signed-off-by: Chris Evich <cevich@redhat.com>",50,51,0,1
"containers/buildah","41d384c3bc77d1a9b2a365c057f3186742597363","chmouel","2022-02-08 15:53:33","false","Increase subuid/subgid to 65535

We have a limit of 50000 for subuid and subgid in the buildah container image
for the build user which may be too low for when running rootless

Increasing the value to 65535 skipping build own id (1000) which should be good
enough for most cases.

Signed-off-by: Chmouel Boudjnah <chmouel@redhat.com>",30,60,1,0
"containers/buildah","62845372ad62a0ba5cc0f75177b3baddecca2c90","baude","2017-06-24 12:54:19","false","cmd/buildah/images.go: Add JSON output option

The Atomic CLI will eventually need to be able to consume
structured output (in something like JSON).  This commit
adds a -j option to output to trigger JSON output of
images.

Example output:
```
[
    {
        ""id"": ""aa66247d48aedfa3e9b74e4a41d2c9e5d2529122c8f0d43417012028a66f4f3b"",
        ""names"": [
            ""docker.io/library/busybox:latest""
        ]
    },
    {
        ""id"": ""26db5ad6e82d85265d1609e6bffc04331537fdceb9740d36f576e7ee4e8d1be3"",
        ""names"": [
            ""docker.io/library/alpine:latest""
        ]
    }
]
```

Signed-off-by: Brent Baude <bbaude@redhat.com>

Closes: #161
Approved by: rhatdan",17,5,0,0
"containers/buildah","9a4e0e8a28d9ef736e47823d37bdee5ec52b3113","rhatdan","2017-10-31 12:47:07","true","Merge pull request #299 from rhatdan/logos

Add logos for buildah",30,9,0,1
"containers/buildah","58025ee1be0faf6c3d7233024ccb2f372683c082","rhatdan","2017-11-16 19:48:21","false","Ignore errors when trying to read containers buildah.json

Since containers can be created using other tools then buildah
we can not fail when they don't have buildah config.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #327
Approved by: nalind",31,10,0,1
"containers/buildah","d792c70fc99805a469f98a8839f51688ad584f45","boaz0","2020-01-03 11:01:41","false","Fix imageNamePrefix to give consistent names in buildah-from

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>

Closes: #2062
Approved by: TomSweeneyRedHat",98,35,0,0
"containers/buildah","0fc0551edd99122898e8d1a46d4a1865a1481a37","rhatdan","2017-09-25 12:26:40","false","Cleanup buildah-run code

Part of the general buildah code cleanup.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #267
Approved by: <username_without_leading_@>",34,8,0,1
"containers/buildah","319d9cc0e05c0ca15a3be50a54975089ca522629","rhatdan","2020-10-20 18:22:19","false","Buildah bud should not use stdin by default

Fixes: https://github.com/containers/podman/issues/8066
Is reporting that buildah is eating stdin.  I don't beleive
we should be using stdin when doing a buildah bud command
unless `buildah bud -` is specified.  After this PR, the
`-` Dockerfile is still handled.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",63,45,0,1
"containers/buildah","608fa843cce45e7ee58ccb71a90297b645a984d3","rhatdan","2018-10-02 10:32:06","false","Bump to v1.4

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1055
Approved by: TomSweeneyRedHat",43,20,0,1
"containers/buildah","c8f8b66bf7ef831b78716823f6ce79511aa87152","rhatdan","2021-01-06 19:47:09","false","Fix handling of TMPDIR environment variable

Fixes: https://bugzilla.redhat.com/show_bug.cgi?id=1900822

Currently we are not passing the TMPDIR to the destination context
so when copying to containers storage we always fall back to /var/tmp.

This change sets the destination to match the source, so we can better
handle the storage.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",91,47,0,1
"containers/buildah","8b1d11f52721ab062c587abc711b40a6e1a1f7dc","rhatdan","2019-02-28 13:00:06","false","Update secrets fipsmode patch to work on rootless containers

Backport fixes made to libpod, into buildah code base.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1378
Approved by: giuseppe",62,25,0,1
"containers/buildah","ae781bd4768314db163ceaf2a4b2a23c79fe44d1","rhatdan","2018-03-17 22:52:27","false","buildah.spec should require ostree-libs

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #517
Approved by: rhatdan",19,14,0,1
"containers/buildah","3fb864bb93ef18b1defee69ebb410fa0b06ebbed","rhatdan","2018-07-06 10:46:42","false","Block use of /proc/acpi and /proc/keys from inside containers

/proc/acpi allows containers to modify certain settings on the host, without
SELinux enabled.

/proc/keys allows information about keys on the host to leak into the containers.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #853
Approved by: rhatdan",31,17,0,1
"containers/buildah","7d141c863066cfe5d5848b6b70e3194ee315d8b4","nalind","2018-03-21 15:19:47","false","Manage ""Run"" containers more closely

Instead of using the runtime's ""run"" command to have it handle the
entire life cycle of a process when we need to launch one, do it
ourselves, and handle passing the data between our stdio and the
container's.

This will make it possible for us to set up networking using CNI between
the ""create"" and ""start"" phases, and head off permissions problems when
the process in the container can't read or write to the invoking user's
terminal or stdio.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #708
Approved by: rhatdan",18,14,0,1
"containers/buildah","d68d986d0f407a158ae665f395a01098b769e8c0","nalind","2017-04-13 20:28:56","false","rm/rmi: Don't exit until we've tried them all

If we're told to remove more than one container or image, actually try
to remove them all, but still return an error if we fail at any of them.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #68
Approved by: rhatdan",14,3,0,1
"containers/buildah","ae08e01e49c7e2f07fb03e6caa5d3626d0b2b10d","nalind","2021-06-22 14:52:49","false","bud: teach --platform to take a list

Add a pkg/parse.PlatformsFromOptions() which understands a ""variant""
value as an optional third value in an OS/ARCH[/VARIANT] argument value,
which accepts a comma-separated list of them, and which returns a list
of platforms.

Teach ""from"" and ""pull"" about the --platform option and add integration
tests for them, warning if --platform was given multiple values.

Add a define.BuildOptions.JobSemaphore which an imagebuildah executor
will use in preference to one that it might allocate for itself.

In main(), allocate a JobSemaphore if the number of jobs is not 0 (which
we treat as ""unlimited"", and continue to allow executors to do).

In addManifest(), take a lock on the manifest list's image ID so that we
don't overwrite changes that another thread might be making while we're
attempting to make changes to it.  In main(), create an empty list if
the list doesn't already exist before we start down this path, so that
we don't get two threads trying to create that manifest list at the same
time later on.  Two processes could still try to create the same list
twice, but it's an incremental improvement.

Finally, if we've been given multiple platforms to build for, run their
builds concurrently and gather up their results.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",36,53,1,1
"containers/buildah","054d13f062078f388e66a478515eded930d0a4c5","nalind","2021-06-09 17:23:12","false","imagebuildah: use the specified logger for logging preprocessing warnings

Remove some redundancy in preprocessContainerfileContents(), have it
search the $PATH for ""cpp"", and have it log warning messages containing
errors output by the preprocessor using the specified logrus logger.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",34,52,1,1
"containers/buildah","e160a632b7f571cd4c20d0e1240e47d02f82e9b9","saschagrunert","2019-07-04 12:36:46","false","Switch to golangci-lint

This commit vendors golangci-lint and enables all linters which do not
complain right now. CI and scripting has been adapted as well.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1706
Approved by: rhatdan",45,29,0,1
"containers/buildah","a0f9fa7b4c81da6338f52b31a067ddc8de632722","pixdrift","2018-05-02 21:00:44","false","Remove buildah run cmd and entrypoint execution

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #656
Approved by: rhatdan",48,15,0,0
"containers/buildah","0423032e9a078f57a2fc42add1519f4e350522ff","TomSweeneyRedHat","2022-02-09 19:01:43","false","Bump c/common to v0.47.4

As the title says.

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",30,60,1,1
"containers/buildah","01db0664987af666683ca8a03250c85de4d7a007","TomSweeneyRedHat","2017-10-21 20:31:21","false","Add tls-verify to bud command

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #297
Approved by: nalind",30,9,0,1
"containers/buildah","2dbb2a13ed3186f264bdbc3884995eb77740410f","TomSweeneyRedHat","2018-01-23 16:17:31","false","Make bud be really quiet

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #408
Approved by: rhatdan",34,12,0,1
"containers/buildah","3f136229558bef64d5eb6123fea8e68fa75ee2ea","ashley-cui","2021-04-20 19:59:43","false","vendor in openshift/imagebuilder

Signed-off-by: Ashley Cui <acui@redhat.com>",49,51,0,0
"containers/buildah","61249b14dbeb3f9dbcc24c54264a374166cd376e","openshift-merge-robot","2023-08-17 13:16:40","true","Merge pull request #4976 from michalbiesek/setSeccomp-arch

chroot: setSeccomp add support for `ArchPARISC(64)` and `ArchRISCV64`",9,79,1,1
"containers/buildah","9e0dd9a0b695b376b13fd06c9d9eff6125e56621","openshift-merge-robot","2022-04-04 17:31:29","true","Merge pull request #3875 from rhatdan/selinux

Vendor in opencontainers/selinux v1.10.1",26,62,1,1
"containers/buildah","6ecc6d6cb48817c03a034cae2d749c268e6d2098","edsantiago","2019-04-01 21:56:29","false","BATS tests - extensive but minor cleanup

This started off as bug fixes necessary to get BATS tests
actually working on RHEL8 (they weren't). It grew. I will
defend my actions in the first comment post.

Primary change: import some helpers from podman BATS tests,
most importantly 'run_buildah' and 'is'. The vast majority
of the changes you'll see here are of the form:

    - run buildah ...
    - [ $status = 0 ]
    - [ check $output ]
    + run_buildah ...            ! automatically checks status
    + is ""$output"" ""...""

Also: chmod'ed some files -x. Necessary because rpmbuild tries
to be oh-so-clever about requirements, and when it sees an
executable file with a shebang line like '#!env bats' it
helpfully adds 'Requires: /usr/bin/bats' to the rpm, which
then fails to install because RHEL8 does not have bats.

Also: refactored duplicate code in a few places, by writing
and invoking module-specific helper functions.

Also: changed a handful of 'buildah's to run_buildah, in
order to get error checking and debug logging.

Also: added descriptive reasons to many ""skip""s.

Also: selinux test: some tweakery to make it run on production
system (context is different if /usr/bin/buildah is chcon'ed
appropriately). I can't get this test to pass on Fedora from
a build dir, and I'm actually not convinced that this test
has ever passed, but let's see what CI shows.

Also: selinux test: skip broken test (#1465).

Also: version test: skip parts of it if running w/o sources.

Tests are now passing as root on RHEL8; rootless has numerous
failures which I don't believe are related to this PR.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1472
Approved by: TomSweeneyRedHat",48,26,0,1
"containers/buildah","8f955f8019e1b6f11fa35f4c590ead452bcfb390","mtrmac","2022-10-19 00:29:08","false","Fix cache locks with multiple mounts

Maintain a list of _all_ the locks, not just the last one.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",27,69,1,1
"containers/buildah","9f49f77c9aa4f49d88e3818c3ef39ac158907f41","openshift-merge-robot","2020-12-17 11:15:41","true","Merge pull request #2849 from nalind/copier-zero-dir

copier: Put: skip entries with zero-length names, handle directory <=> not-directory better",81,47,0,1
"containers/buildah","08d636a28be9f7d1b0a7e4a818afcfee05bb7c00","Luap99","2022-01-19 15:43:02","true","buildah bud --network add support for custom networks

The backend logic already supports specifying custom network names. This
only adds the support for the frontend parsing.

Fixes containers/podman#12282

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",32,60,1,0
"containers/buildah","a23a49b22720337f813e4f6ab6e4881c8bd18c4a","vrothberg","2021-04-30 07:16:03","false","update to latest libimage

Update Buildah to the latest libimage.  Migrating Podman over to
libimage entailed a number of fixes and changes to libimage which
we need to account for in Buildah.

Most notably:

 * `(*Runtime).LookupImage()` now returns `storage.ErrImageUnknown`
   instead of `nil` in case no matching image is found.

 * `(*Runtime).LookupImage()` now does quite a bit more work finding
   a local image and will also look at the repotags (or digests) of
   all local images if needed.

 * The signature of `(*Runtime).RemoveImages()` was changed and now
   returns a slice of reports and errors.  The reports aggregate the
   data of a removed image which allows the function to be used by
   `podman image prune` which is also interested in the size of the
   removed data.  The slice of errors is also needed in Podman which
   needs to have a closer look at _all_ rmi errors in order to determine
   the appropriate exit code (Docker compat).

 * `libimage/types` has been removed.  Pull policies have been merged
   into already existing logic in `pkg/config`.

Please refer to containers/podman/pull/10147 for a more detailed
changelog.

[NO NEW TESTS NEEDED]

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",50,51,0,1
"containers/buildah","232908181765f08b53bb534a5dbf4cffc263d2b7","vrothberg","2019-05-29 13:19:35","false","util: use strings.ContainsRune instead of index check

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1624
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","fb49b6f06ded61dc4ceb64147c1a6e231b670066","openshift-merge-robot","2022-09-13 17:16:51","true","Merge pull request #4239 from flouthoc/fix-dockerignore

build: honor `<Containerfile>.containerignore` or `<Containerfile>.dockerignore` as ignore file",20,67,1,1
"containers/buildah","25f4e8ec639044bff4ab393188d083782f07b61c","umohnani8","2018-05-24 15:54:31","false","buildah bud picks up ENV from base image

buildah bud was not picking up the ENV from the base image
as it was being cleared. Fixes buildah bud to pick up the ENV.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #720
Approved by: rhatdan",64,16,0,1
"containers/buildah","80297b7954984db21a32b188aa2925f270ad4bd8","openshift-merge-robot","2023-04-17 21:15:15","true","Merge pull request #4732 from containers/renovate/github.com-opencontainers-runc-1.x

fix(deps): update module github.com/opencontainers/runc to v1.1.6",12,75,1,1
"containers/buildah","c14697ebe4d51fa274be8f84db863fa949bf463a","umohnani8","2018-02-05 20:09:15","false","Add documentation and completions for the following flags

	--add-host
	--cgroup-parent
	--cpu-period
	--cpu-quota
	--cpu-shares
	--cpuset-mems
	--memory
	--memory-swap
	--security-opt
	--ulimit

These flags are going to be used by buildah run and bud.
The implementation will follow in another PR.

Signed-off-by: umohnani8 <umohnani@redhat.com>",34,12,0,1
"containers/buildah","4173c20dfe0bdfa2b33c00b78b03ff98159e95f1","openshift-merge-robot","2022-03-04 09:34:13","true","Merge pull request #3803 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.1

build(deps): bump github.com/containerd/containerd from 1.6.0 to 1.6.1",29,61,1,1
"containers/buildah","8f69c7d4778b3f9a7ab5afcac3d33f2a8d1f4ab9","openshift-merge-robot","2022-02-28 13:17:24","true","Merge pull request #3793 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.7.9

build(deps): bump github.com/fsouza/go-dockerclient from 1.7.8 to 1.7.9",31,61,1,1
"containers/buildah","a319ee3191490824fa33f08a0e2283bea524c92c","openshift-merge-robot","2022-02-21 18:35:37","true","Merge pull request #3786 from containers/dependabot/go_modules/tests/tools/github.com/golangci/golangci-lint-1.44.2

build(deps): bump github.com/golangci/golangci-lint from 1.44.0 to 1.44.2 in /tests/tools",31,61,1,1
"containers/buildah","f85e52332299abec18c6cc24d18df75d68b504d7","openshift-merge-robot","2022-02-22 21:52:51","true","Merge pull request #3746 from Foxboron/morten/fix-manpages

docs: Remove Containerfile and containerignore",30,61,1,1
"containers/buildah","59d44192eb631f3c678ea007bd8a5c3ac8c51310","flouthoc","2022-02-28 10:28:24","true","executor: docker builds must inherit healthconfig from base if any

If base image has a healthconfig and child does not overrides it then
docker formatted builds must inherit healthconfig from base image.

Following commit ensures that we are in parity with docker for docker
formatted builds.

Signed-off-by: Aditya R <arajan@redhat.com>",31,61,1,1
"containers/buildah","6c0f8ddb5e1f619e3f0733eaa9ba2a9c95383f79","openshift-merge-robot","2022-02-15 16:22:42","true","Merge pull request #3780 from giuseppe/use-systemd-cgroup-manager

run_linux: use --systemd-cgroup",30,61,1,1
"containers/buildah","0b6c65bffa02571626c85e960a00e0586171c22a","rhatdan","2022-01-27 00:16:39","true","Merge pull request #3752 from TomSweeneyRedHat/bump-1.24.0

Bump 1.24.0",34,60,1,1
"containers/buildah","7fc46fca025ea522db765a6cce7b27508deb38c1","openshift-merge-robot","2022-01-26 17:36:15","true","Merge pull request #3713 from abergmeier/systemflag

Allow processing of SystemContext from FlagSet",34,60,1,1
"containers/buildah","7ba1386ee8a02d3882f5d6b087c7ede50d403614","openshift-merge-robot","2022-01-26 16:12:17","true","Merge pull request #3744 from cevich/notify_on_error

[CI:DOCS] Github-workflow: Report both failures and errors.",34,60,1,1
"containers/buildah","1d6348bc098ba30ee65f6f784d9c3889f38652bd","openshift-merge-robot","2022-01-26 18:32:13","true","Merge pull request #3749 from containers/dependabot/go_modules/tests/tools/github.com/golangci/golangci-lint-1.44.0

build(deps): bump github.com/golangci/golangci-lint from 1.43.0 to 1.44.0 in /tests/tools",34,60,1,1
"containers/buildah","bc1e524773791f08f0b9bba8ea73540610cc1119","rhatdan","2022-01-28 22:03:59","true","Merge pull request #3753 from nalind/semaphores

imagebuildah.BuildDockerfiles(): create the jobs semaphore",34,60,1,1
"containers/buildah","40b4d937ce3bb4002be24a1c77dec54967e36a41","flouthoc","2022-01-09 12:29:26","true","executor: Share selinux label of first stage with other stages in a build

Buildah `builds` are composed of various `stages`. That is each `stage` in a build is a `container`.

As of now buildah does not provides any `processLabel` and `mountLabel` to the stage containers which
results in `c/storage` assigning random generated `selinux` labels to each stage.

If each stage has its own unqiue `processLabel` and `mountLabel` stages cannot be mounted across each other
in the same build as `selinux` prevents that.

We get the `processLabel` and `mountLabel` of the first stage created by the executor ( label assigned by `c/stoage` )
and share it with all the other subsequent stages of the same build.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",26,59,1,1
"containers/buildah","58a7d42e2888052e04c496f055290c53b8ef6c0c","openshift-merge-robot","2022-01-10 08:28:51","true","Merge pull request #3693 from flouthoc/share-selinux-label-across-stage

executor: Share `selinux` (`process and mount`) `label` of first stage with other stages in same build",27,59,1,1
"containers/buildah","8de75fd901f07ccf0abe624bf24402aa46a61f52","flouthoc","2021-12-15 15:05:57","true",".cirrus: remove static_build from ci

Remove `static_build` from ci as it is becoming hard to keep up with
`nix` hiccups in CI.

------
Before Deciding to remove static_build from CI we tried things below :
Things decided below worked but in order to keep maintaince simple
consensus was made to remove static_build. Read more here:
https://github.com/containers/buildah/pull/3679

It seems nixos/nix:latest expects nixbld user to be added and specified in
build-users-group but this should be only needed for multi-user
mode.

Hence I suspect latest push has a regression. Lock the nix to last working
image.

[NO NEW TESTS NEEDED]

Signed-off-by: Aditya Rajan <arajan@redhat.com>",32,59,1,1
"containers/buildah","b71ccf361062a81b0069143e4c88a9949a31a33e","openshift-merge-robot","2021-11-18 23:23:10","true","Merge pull request #3599 from cevich/update_to_f35

Cirrus: Bump up to Fedora 35 & Ubuntu 21.10",28,58,1,1
"containers/buildah","4c40e8e34addcdcace6b1e9c12bc360ee017ea48","openshift-merge-robot","2021-11-18 12:40:25","true","Merge pull request #3635 from containers/dependabot/go_modules/github.com/containerd/containerd-1.5.8

build(deps): bump github.com/containerd/containerd from 1.5.7 to 1.5.8",28,58,1,1
"containers/buildah","e4a4f2c0d43baf87d4d811571448f8a14ef3dc6b","openshift-merge-robot","2021-10-14 23:08:56","true","Merge pull request #3586 from rhatdan/docs

Add support for host.containers.internal in the /etc/hosts",36,57,1,1
"containers/buildah","a62fcb96e0e3fbd61cffdef19d8873d58d420aef","openshift-merge-robot","2021-09-28 06:22:21","true","Merge pull request #3545 from nalind/strconv

Replace fmt.Sprintf(""%d"", x) with strconv.Itoa(x)",38,56,1,1
"containers/buildah","e2c952f8f2759f2a143ef65c0774b42fa11eee66","openshift-merge-robot","2021-10-21 13:37:28","true","Merge pull request #3581 from chenk008/support_colon_in_overlay_path

Support overlayfs path contains colon",35,57,1,1
"containers/buildah","56422a9dbd2a7ed27e7c2014986f4f55eade4e4f","openshift-merge-robot","2021-10-14 17:21:56","true","Merge pull request #3574 from flouthoc/buildkit-cache-support

buildkit: add support for persistent caching across builds with `--mount=type=cache`",37,57,1,1
"containers/buildah","33df3e8a9d8037abc9109d565604497daafd61e1","currybullen","2021-10-24 10:23:04","false","fix: another non-portable shebang

Signed-off-by: Mikael Karlsson <mikaelhakarlsson@gmail.com>",33,57,1,0
"containers/buildah","7807a0e1d33caff9399abc02d6939c223f3e8966","openshift-merge-robot","2021-10-05 16:51:04","true","Merge pull request #3567 from containers/dependabot/go_modules/github.com/docker/docker-20.10.9incompatible

build(deps): bump github.com/docker/docker from 20.10.8+incompatible to 20.10.9+incompatible",43,56,1,1
"containers/buildah","73b9f078b3767a25f1be0e1e47a787ed4bd53147","cevich","2021-10-11 20:58:50","true","[CI:DOCS] Include manifest example usage

This duplicates https://github.com/containers/podman/pull/11889 which is
annoying, but there seems no easy way to avoid it.  The
commands/examples have been 'translated' for Buildah.

Signed-off-by: Chris Evich <cevich@redhat.com>",40,56,1,1
"containers/buildah","a86677266d2ee2b6082d037a1981b0e4620ac6d6","openshift-merge-robot","2021-10-06 18:48:03","true","Merge pull request #3571 from benelliott/main

Fix command doc links in README.md",42,56,1,1
"containers/buildah","d2ef199e77ea586a7e2b1f50b359ff4f3a534e00","openshift-merge-robot","2021-09-29 19:27:01","true","Merge pull request #3549 from rhatdan/containerfile

[ci:docs] Add man page for Containerfile and .containerignore",41,56,1,1
"containers/buildah","5a24cd02b754b151e7879c487ab542b0b64c452f","flouthoc","2021-09-06 10:30:09","false","build: mirror --authfile to filesystem if pointing to FD instead of file

Following PR makes sure that buildah mirrors --authfile to a temporary
file in filesystem if arg is pointing to an FD instead of actual file
as FD can be only consumed once.

Fixes: https://github.com/containers/buildah/issues/3070

Signed-off-by: Aditya Rajan <arajan@redhat.com>",36,55,1,1
"containers/buildah","bfd3f696f13de56b59545882ec50ea0b110dcafa","openshift-merge-robot","2021-08-31 08:16:58","true","Merge pull request #3486 from nalind/subdirectory-exclusions

copier.Get(): try to avoid descending into directories",36,55,1,1
"containers/buildah","58a16f97689cc96b1a69a03d773c4399413f8854","openshift-merge-robot","2021-09-06 10:03:33","true","Merge pull request #3499 from leighmcculloch/fix-build-git-with-branch

Fix build with .git url with branch",36,55,1,1
"containers/buildah","9faf9463547686643b5745339b9e3d0604971939","rhatdan","2021-08-17 21:28:42","false","Move DiscoverContainerfile to pkg/util directory

Then podman can use it

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",39,55,1,1
"containers/buildah","da2b428c56ce0e11638ac9e48bdab7eeaee6df85","openshift-merge-robot","2021-08-23 17:32:21","true","Merge pull request #3470 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.7.4

build(deps): bump github.com/fsouza/go-dockerclient from 1.7.3 to 1.7.4",39,55,1,1
"containers/buildah","0306d9a186927b72fa338ae0b8a4d72622a1a371","rhatdan","2021-08-17 19:38:49","false","Remove some references to Docker

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",39,55,1,1
"containers/buildah","6064a95baa16ab1b51a4ff49687e5eb4896c350e","rhatdan","2021-08-11 14:15:40","false","Run codespell to fix spelling

[NO TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",36,54,1,1
"containers/buildah","56ff12f09373a8f77b365d6b4cc71a4519f72e60","openshift-merge-robot","2021-07-30 11:46:12","true","Merge pull request #3228 from edsantiago/bats_assert

tests: new assert()",36,54,1,1
"containers/buildah","53616f7491ae9de18925451575900a2f28a616a8","openshift-merge-robot","2021-06-10 20:45:16","true","Merge pull request #3290 from containers/dependabot/go_modules/github.com/opencontainers/selinux-1.8.2

build(deps): bump github.com/opencontainers/selinux from 1.8.1 to 1.8.2",34,52,1,1
"containers/buildah","d97694b013a2b369c10e4233087b1f19c4f144f1","vrothberg","2021-08-03 08:39:06","false","set base-image annotations

Since opencontainers/image-spec/pull/822/ the OCI spec supports two new
annotations to set the fully-qualified name and the digest of the base
image.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",36,54,1,1
"containers/buildah","e6ea308d6de1724a0ead3e08517a5e365461b275","TomSweeneyRedHat","2021-08-02 17:26:35","false","Bump to v1.22.0 [NO TESTS NEEDED]

[NO TESTS NEEDED]

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",36,54,1,1
"containers/buildah","6aa4acee2bae113d3ac3cccb9b25b9689de9d105","openshift-merge-robot","2021-07-27 16:53:43","true","Merge pull request #3404 from edsantiago/runc_debug_test

runtime-flag (debug) test: handle old & new runc",39,54,1,1
"containers/buildah","4535bc534229f5ea69d4a1a41f5eae7bc53a0dbf","openshift-merge-robot","2021-07-27 17:00:46","true","Merge pull request #3381 from cevich/continuous_multi_arch

[CI:DOCS] Multi-arch: Always push updated version-tagged image",39,54,1,1
"containers/buildah","3821391ea6fa0d2a5360bfc6da9fcf9e29133c72","openshift-merge-robot","2021-07-22 20:27:39","true","Merge pull request #3398 from rhatdan/secrets

Allow dst and destination for target in secret mounts",41,54,1,1
"containers/buildah","abf6ea0e4f7b9696eab39dba0330218c19750132","rhatdan","2021-07-22 19:18:24","false","Fix handling of --restore shadow-utils

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",41,54,1,1
"containers/buildah","f517d857b638ceeecd2c5f2431d55624194270b1","openshift-merge-robot","2021-07-28 09:51:27","true","Merge pull request #3401 from containers/dependabot/go_modules/github.com/containers/image/v5-5.14.0

build(deps): bump github.com/containers/image/v5 from 5.13.2 to 5.14.0",37,54,1,1
"containers/buildah","ed2340189d168c88879a341b8384ce76c110c592","umohnani8","2018-11-07 08:23:58","false","Exclude --force-rm from common bud cli flags

Need this so we can override it to true by default in podman.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>

Closes: #1163
Approved by: TomSweeneyRedHat",61,21,0,1
"containers/buildah","ba23b7f106fcbca59ec124c39f704e1563a79749","nalind","2018-08-09 20:21:59","false","chroot: bind mount an empty directory for masking

In chroot isolation, when we attempt to mask a directory, use a
read-only bind mount of an empty directory instead of a read-only mount
of a fresh tmpfs with size=0, which is more likely to be be denied by
mandatory access controls.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #923
Approved by: rhatdan",23,18,0,1
"containers/buildah","9ffd47edcafecd81ea9d8291253158060cfe5653","umohnani8","2018-04-12 14:20:36","false","Vendor in latest containers/image and containers/storage

Changes to paramters in functions.
Change to the error returned by the oci and oci-archive transport.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #578
Approved by: rhatdan",32,15,0,1
"containers/buildah","ebf41403a6bcfe550eb02a78fafe45704067021e","openshift-merge-robot","2023-05-25 11:13:00","true","Merge pull request #4815 from andrm/docfix2

Fix auth.json path (validated on Fedora 38)",18,76,1,1
"containers/buildah","0a971ebeecc939796aa07d8893cdc7c0696c1969","nalind","2018-10-04 21:56:31","false","chroot: set up seccomp and capabilities after supplemental groups

Move the setting of capabilites and the seccomp filter to after we've
set the supplemental groups list and set our primary GID.

Set capabilities after we set the seccomp filter, because we won't be
able to set a filter if we're dropping CAP_SYS_ADMIN.  Set them as the
very last thing before dropping to the runtime UID.  Leave CAP_SETUID in
if we're going to become an unprivileged user, so that we'll be allowed
to switch UIDs -- the capability will be dropped then anyway.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1069
Approved by: rhatdan",51,20,0,1
"containers/buildah","83fe25ca4eec871775e74f388067ef707d1957bf","nalind","2017-07-26 16:49:01","false","Turn on --enable-gc when running gometalinter

It looks like the metalinter is running out of memory while running
tests under PAPR, so give this a try.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #221
Approved by: rhatdan",19,6,0,1
"containers/buildah","fa68ed66ccd33296c45916b3d510a56dcc1adaf7","bmwiedemann","2019-08-20 13:45:48","false","Allow to override build date with SOURCE_DATE_EPOCH

in order to make builds reproducible.
See https://reproducible-builds.org/ for why this is good
and https://reproducible-builds.org/specs/source-date-epoch/
for the definition of this variable.

This renames BUILD_INFO to the standard name
so that distributions do not have to discover the BUILD_INFO variable,
similar to https://github.com/cri-o/cri-o/pull/2643

Signed-off-by: Bernhard M. Wiedemann <bwiedemann@suse.de>

Closes: #1805
Approved by: rhatdan",53,31,0,0
"containers/buildah","d0f8515470e8683fc15d33a8a20e62a784d3c635","QiWang19","2019-03-18 17:16:31","false","add sample registries.conf to docs

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1415
Approved by: rhatdan",37,26,0,1
"containers/buildah","8fd314870c630de4f4485583f4df3c96f6e9b264","rhatdan","2019-11-20 14:33:06","false","Bump github.com/onsi/gomega from 1.7.0 to 1.7.1

Bumps [github.com/onsi/gomega](https://github.com/onsi/gomega) from 1.7.0 to 1.7.1.
- [Release notes](https://github.com/onsi/gomega/releases)
- [Changelog](https://github.com/onsi/gomega/blob/master/CHANGELOG.md)
- [Commits](https://github.com/onsi/gomega/compare/v1.7.0...v1.7.1)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1976
Approved by: rhatdan",82,34,0,1
"containers/buildah","b532bc019c445dc8f6ec06c48930dd3a3b521102","rhatdan","2018-07-05 10:55:53","false","Contributors need to find the CONTRIBUTOR.md file easier

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #848
Approved by: TomSweeneyRedHat",28,17,0,1
"containers/buildah","3351617bce7f45d8341dc3d510613c2bc0fc739d","Luap99","2022-04-06 08:58:45","true","buildah build should accept at most one arg

Right now buildah just ignores it when you set more than one argument for
build. Only the first argument is used as context dir. This looks wrong
to me and can lead to users errors.

Fixes test failure in https://github.com/containers/podman/pull/13687

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",25,62,1,0
"containers/buildah","d8165d034fda644764ae45c94bde634b2e905bd9","edigaryev","2020-11-10 16:43:41","false","test: ensure non-directory in a Dockerfile path is handled correctly

Signed-off-by: Nikolay Edigaryev <edigaryev@gmail.com>",67,45,0,0
"containers/buildah","af394a83d2b7baec3d1404176d80d8d387b14187","nalind","2023-11-07 22:39:52","false","pkg/parse.Platform(): minor simplification

Simplify the logic of Platform() a bit.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,81,1,1
"containers/buildah","9f1c9a8eec05d186caed30c6c64d05e516cca713","nalind","2023-11-07 22:27:39","false","Use a constant definition instead of ""scratch""

Use a definition of ""scratch"" that's exported by imagebuilder instead of
hard-coding it ourselves like it's just some magic value we came up
with, in the multiple places where we refer to it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,81,1,1
"containers/buildah","48a9c43718ea3cf34d5fdb7f64cb05c03812aad2","rhatdan","2023-10-24 23:43:56","false","Add --no-hostname option to buildah containers

Fixes: https://github.com/containers/buildah/issues/5093

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",5,81,1,1
"containers/buildah","1cfd59ab6591e70a7274c41e527471a5429bc44c","naveensrinivasan","2022-03-30 20:27:49","false","Set permissions for GitHub actions

- Included permissions for the action. https://github.com/ossf/scorecard/blob/main/docs/checks.md#token-permissions

https://docs.github.com/en/actions/using-jobs/assigning-permissions-to-jobs

Signed-off-by: naveensrinivasan <172697+naveensrinivasan@users.noreply.github.com>",26,62,1,0
"containers/buildah","07d955f277853627aa7c3f60b3824877cab163b9","flouthoc","2023-10-09 08:29:52","true","imagebuildah,multi-stage: do not remove base images

When building a multi-stage image ( without `--layers` ) and a
stage contains only a base-image buildah removes the base-image
itself as part of cleanup process. This is a bug and following commit
fixes that.

Reproducer

```Dockerfile
FROM parent
FROM another-base
COPY --from=0 somefile .
```

`buildah build -t multi-stage .`

Closes: https://github.com/containers/podman/issues/20291

Signed-off-by: Aditya R <arajan@redhat.com>",6,80,1,1
"containers/buildah","3c8a3a229a660feb2d4fefa7aa94279ac41c0e1d","flouthoc","2023-10-12 06:25:32","true","Merge pull request #5084 from flouthoc/run-use-gettempdir

run: use `internal.GetTempDir` with `os.MkdirTemp` for root and bundle path",6,80,1,1
"containers/buildah","7c8b51068e7e74fc7e5f45b408215f862840ca00","umohnani8","2023-10-11 15:30:49","false","Vendor containers/common

Pick up changes to move the platform code to its own directory.

[NO NEW TESTS NEEDED]

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>",6,80,1,1
"containers/buildah","5bfc7d9a40d722084218630a19b3de1343dc1d9c","nalind","2023-10-04 20:58:32","false","Update some comments related to confidential workload

Add siena and turin to the list of generations in a comment.
Drop a double-whitespace in the middle of a comment sentence.

[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",6,80,1,1
"containers/buildah","249e30c981fa836954a9fb5681092836f83f85e3","BenjaminSchubert","2023-09-30 14:52:08","true","bug: Ensure the mount type is always BindMount by default

Previously, when mounting multiple mounts, if any mount had a `type`
specified, it would override the default type for subsequent mounts.

This meant, for example, that having a RUN step like:

```
RUN --mount=type=cache,target=/cache --mount=source=.,target=/src
```

would incorrectly mount the second source as a cache, instead of a
bind-mount.

This fix ensures the default is reset between each iteration of the
loop, ensuring we get the right mount type.

Signed-off-by: Benjamin Schubert <contact@benschubert.me>",7,80,1,0
"containers/buildah","1392eae36450555bb0b4f119bdc21a99e929e2b4","rhatdan","2023-08-29 10:36:01","true","Merge pull request #5000 from rhatdan/limit

Support passing of ULimits as -1 to mean max",7,79,1,1
"containers/buildah","0058602e5088d04ab5617bbe325aaa989b298db2","openshift-merge-robot","2023-08-21 05:30:36","true","Merge pull request #4978 from containers/renovate/github.com-containers-ocicrypt-1.x

fix(deps): update module github.com/containers/ocicrypt to v1.1.8",8,79,1,1
"containers/buildah","a3f2aa3c74fed523cc856cf7ad540c791f962acd","flouthoc","2023-08-18 10:55:59","true","executor: build-arg warnings must honor global args

build-arg warnings must honor globally defined arguments and must not
produce warnings if an arguments is already defined globally.

Closes: https://github.com/containers/buildah/issues/4981

Signed-off-by: Aditya R <arajan@redhat.com>",8,79,1,1
"containers/buildah","795c15532d8e6cce50f9c4995fae1f88725e8103","openshift-merge-robot","2023-08-15 19:35:46","true","Merge pull request #4973 from flouthoc/force-compression

buildah/push/manifest-push: add support for `--force-compression` to prevent reusing other blobs",9,79,1,1
"containers/buildah","b9ac8d5e0140ce9cd66d792b16fef69816b8d708","flouthoc","2023-07-27 15:05:12","true","manifest/push: add support for --add-compression

Adds support for `--add-compression` which accepts multiple compression
formats and when used it will add all instances in a manifest list with
requested compression formats.

Signed-off-by: Aditya R <arajan@redhat.com>",14,78,1,1
"containers/buildah","70cb4c7e066359346d6cd9acb26032d6614e3eb6","rhatdan","2023-07-09 11:35:05","false","Vendor in containers/(common, image, storage)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",13,77,1,1
"containers/buildah","dbc71b7ccf0876b5a8e98c279f37c709aec749ad","rhatdan","2023-07-21 18:30:14","false","Update vendor of containers/(storage,image,common)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",14,78,1,1
"containers/buildah","c5a2dd610959bc10535b15f42c35bd630d61ead6","ashley-cui","2023-06-30 21:00:46","true","Merge pull request #4902 from TomSweeneyRedHat/dev/tsweeney/bumpimage_common

Bump c/image to 5.26.1, c/common to 0.55.1, Buildah to 1.31.0, and then to 1.32.0-dev",13,77,1,0
"containers/buildah","d6e8072e0912fc0f22d533673c974dbbbe6296ec","openshift-merge-robot","2023-06-20 20:33:09","true","Merge pull request #4870 from lsm5/packit-downstream

[CI:BUILD] Packit: add jobs for downstream Fedora package builds",13,77,1,1
"containers/buildah","895c22a1c07fecd51417365e08a8bd260325ee87","TomSweeneyRedHat","2023-06-07 19:17:21","true","Merge branch 'main' into dont_mess_with_test_files",15,76,1,1
"containers/buildah","c4af80e98e4a2b9f1a51d16bd321eff5dcc94067","openshift-merge-robot","2023-06-05 19:23:37","true","Merge pull request #4828 from cevich/fix_ci_using_docker_hub

Explicitly ref. quay images for CI",17,76,1,1
"containers/buildah","8156abfebf2a33784bfef73bc8ec40b2989a9a6a","openshift-merge-robot","2023-06-01 19:20:59","true","Merge pull request #4833 from containers/renovate/github.com-containers-common-digest

fix(deps): update github.com/containers/common digest to 462ccdd",16,76,1,1
"containers/buildah","7e327cf1836394963b07b86ef6a707c927a2fd4e","rijenkii","2023-05-29 10:51:26","false","Add a warning to `--secret` docs

[NO NEW TESTS NEEDED]

Signed-off-by: rijenkii <me@rijenkii.tk>",17,76,1,0
"containers/buildah","8ca9e72f2c47d93e3fb46bf53ee3be7ee14363fd","openshift-merge-robot","2023-05-16 20:29:29","true","Merge pull request #4789 from containers/renovate/github.com-docker-distribution-2.x

fix(deps): update module github.com/docker/distribution to v2.8.2+incompatible",13,76,1,1
"containers/buildah","51c03212eb7fd252c319f58ce2ec935f2ef2d07d","flouthoc","2023-05-16 05:14:47","true","tests: add a case for required=false

Signed-off-by: Aditya R <arajan@redhat.com>",13,76,1,1
"containers/buildah","ee3e6d3789c93c7d90fa1c8e3dc533d8d4283b7d","rhatdan","2023-04-27 13:24:52","true","Merge pull request #4762 from containers/renovate/github.com-containers-common-0.x

fix(deps): update module github.com/containers/common to v0.53.0",13,75,1,1
"containers/buildah","6b82d622a7ad62ba8ce42eb4b6fc594918a63d05","rhatdan","2023-05-08 13:01:34","true","Merge pull request #4774 from containers/renovate/golang.org-x-sync-0.x

fix(deps): update module golang.org/x/sync to v0.2.0",10,75,1,1
"containers/buildah","e9884fc41cf9cdaad0ddce436b806c9d9ea37127","TomSweeneyRedHat","2023-04-07 00:55:58","false","Bump to v1.31.0-dev

As the title says

[NO NEW TESTS NEEDED]

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",11,74,1,1
"containers/buildah","4775b247b340025f8cd70c65b216d095769510b1","mtrmac","2023-04-22 00:28:36","false","Cap suffixDigitsModulo to a 9-digits suffix.

Because Go integers silently overflow, and 10 is multiple of 2,
repeatedly multiplying by 2 eventually turns suffixDigitsModulo
into all-bits-zero, triggering a division by zero.

So, cap the suffix to a 9-digit one. That is very likely to be sufficient.

(But don't actually limit the number of retries. We could do that as well,
for extra robustness. OTOH that would be another bit of code that we don't
test...)

[NO NEW TESTS NEEDED]
We could plausibly unit-test the loop just to see that it doesn't crash
on 100 conflicts in a row, but that's an awfully specific test that would
require moving the loop to a separate function with a closure parameter,
a complex test that makes the code less readable for a very specific crash.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",13,75,1,1
"containers/buildah","4e2dba271b7436521d57e94b856baa7740804c14","openshift-merge-robot","2023-04-13 18:08:36","true","Merge pull request #4738 from rhatdan/docs

[CI:DOCS] Clarify the need for qemu-user-static package",11,75,1,1
"containers/buildah","f14abc8fc1be8abc24fdf59a15d627255e9c0826","rhatdan","2023-03-30 10:44:28","true","Merge pull request #4689 from containers/renovate/github.com-docker-docker-23.x

fix(deps): update module github.com/docker/docker to v23.0.2+incompatible",12,74,1,1
"containers/buildah","c8c37c78fe8bbe4c0b13c0f1a8a63aa776bd2eae","danishprakash","2023-04-04 08:25:57","true","parse: add support for relabel bind mount option

Signed-off-by: danishprakash <danish.prakash@suse.com>",10,74,1,0
"containers/buildah","c1b82d195ae6cc91f8d772bdb192f725f917dcf3","flouthoc","2023-03-06 05:48:23","true","build: document behaviour of buildah's distributed cache

Buildah's `--cache-to` and `--cache-from` is different from
docker/buildkit so lets document that and mention how is it different.

Closes: https://github.com/containers/buildah/issues/4612

Signed-off-by: Aditya R <arajan@redhat.com>",17,73,1,1
"containers/buildah","bc2423ebcb7fe1f34ed741fa5ce6ffe0e05e613f","cevich","2023-02-20 18:45:27","true","Cirrus: Replace Ubuntu -> Debian SID

Signed-off-by: Chris Evich <cevich@redhat.com>",13,73,1,1
"containers/buildah","0ed9b4c8cdd396abcb7468f527458ca836fc4d02","Steffen1989","2023-02-27 20:28:09","false","Fix tutorial for rootless mode

Before executing `buildah unshare` for mounting a container from scratch
as a non-root user, we need to export the variable `newcontainer` so
that it is known inside the modified user namespace.

Signed-off-by: Steffen Straub <22006250+Steffen1989@users.noreply.github.com>",17,73,1,0
"containers/buildah","826dc723b1044734dec061a9443dc1065f994bbc","openshift-merge-robot","2021-07-12 17:12:55","true","Merge pull request #3374 from cevich/freshen_vm_images

Cirrus: Freshen VM images",39,53,1,1
"containers/buildah","248471ce24427db37e42f922ee3e8931f4071c20","cevich","2021-07-01 16:52:05","true","Cirrus: Drop dependence on fedora-minimal

This image is no-longer maintained and unnecessarily large for
essentially a ""no-op"" task.  Use alpine instead, which is likely
cached from heavy use anyway, and don't even bother running
commands through a shell.

Signed-off-by: Chris Evich <cevich@redhat.com>",38,53,1,1
"containers/buildah","adc60f201dc68e516ec98a873e543a3fa2fe4efc","cevich","2021-07-12 15:32:31","true","Cirrus: Freshen VM images

Signed-off-by: Chris Evich <cevich@redhat.com>",39,53,1,1
"containers/buildah","cbaf84eaf3a07ed211820c50c17c8d13c322ed55","openshift-merge-robot","2021-06-23 14:19:57","true","Merge pull request #3327 from containers/dependabot/go_modules/github.com/opencontainers/runc-1.0.0

build(deps): bump github.com/opencontainers/runc from 1.0.0-rc95 to 1.0.0",37,53,1,1
"containers/buildah","d9773cbb96384f82d362dceac1c42af3e4063de0","openshift-merge-robot","2021-06-22 09:59:07","true","Merge pull request #3324 from containers/dependabot/go_modules/github.com/containers/storage-1.32.3

build(deps): bump github.com/containers/storage from 1.32.2 to 1.32.3",36,53,1,1
"containers/buildah","3a6cb98c2aa266c244eb5fe9a9f3575fce06bd39","jacobwgillespie","2021-06-21 13:16:59","true","Remove unused function arguments

Signed-off-by: Jacob Gillespie <jacobwgillespie@gmail.com>",36,53,1,0
"containers/buildah","d7bdac79c3d84cc12f5047f84fca4c99de9be077","jacobwgillespie","2021-06-21 13:09:29","true","Create mountOptions for mount command flags

Signed-off-by: Jacob Gillespie <jacobwgillespie@gmail.com>",36,53,1,0
"containers/buildah","f9e51e744486b5fa6e00d998aca7f6c4b95ea2d7","lsm5","2023-02-16 11:17:46","true","[CI:BUILD] copr: fix el8 builds

Bump containers-common dependency to match with that in
podman.spec.rpkg.

qemu-user-static dependency is now handled in containers-common-extra
itself.

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",18,73,1,1
"containers/buildah","dbf1d43b349893903edf00300bfc9a283b3cc996","flouthoc","2023-01-30 11:51:38","true","docs: specify order preference for FROM

When multiple files are specified buildah considers `FROM` instruction
from the last file specified and so does `buildkit` and `docker` so lets
specify that in docs.

[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]

Closes: https://github.com/containers/buildah/issues/4544

Signed-off-by: Aditya R <arajan@redhat.com>",19,72,1,1
"containers/buildah","123ef1693b8087ff346da5e98699b534fa403064","flouthoc","2023-02-01 10:48:38","true","conformance: use scratch for minimal test

Following test is just copying files it should not depend upon
`ubuntu:18.04` lets change that so CI never gets blocked.

Signed-off-by: Aditya R <arajan@redhat.com>",20,72,1,1
"containers/buildah","2008a5302d711995cff3efca79ad911723b59a6c","TomSweeneyRedHat","2023-01-25 23:24:47","false","Bump to v1.30.0-dev

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",19,72,1,1
"containers/buildah","0a2445ea6cf25aa8cab48f9ccbf1e31e9a0b2e4a","openshift-merge-robot","2023-02-06 18:50:09","true","Merge pull request #4558 from flouthoc/interspersed-login-args

login: support interspersed args for password from `stdin`",19,72,1,1
"containers/buildah","13187f276fc0b0eea5f967fca5fe1bb60609e89d","tuananh","2020-11-20 17:52:02","false","fix: non-portable shebang #2812

Signed-off-by: Tuan Anh Tran <me@tuananh.org>",78,46,0,0
"containers/buildah","4b72f055f1c9b21cd1ba6c67628410267d046907","openshift-merge-robot","2023-01-20 22:52:01","true","Merge pull request #4535 from TomSweeneyRedHat/dev/tsweeney/fixlang2

[CI:DOCS] Fix two diversity issues in a tutorial",19,72,1,1
"containers/buildah","d5dd0de5338b153b6362941953039b2a1b6c59d9","rhatdan","2023-01-24 18:59:36","true","Merge pull request #4534 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.9.3

build(deps): bump github.com/fsouza/go-dockerclient from 1.9.2 to 1.9.3",19,72,1,1
"containers/buildah","6dd783f22aa8e2637c619635f9021a1295bb601a","openshift-merge-robot","2023-01-20 14:40:59","true","Merge pull request #4530 from rhatdan/VENDOR

vendor in latests containers/(storage, common, image)",20,72,1,1
"containers/buildah","68d3b0ab76e093980439a738e0e6e6e094201011","rhatdan","2023-01-25 13:24:05","true","Merge pull request #4531 from sstosh/test-proxy

tests: improve build-with-network-test",19,72,1,1
"containers/buildah","11921359a9393830b5d76e90a131895292a7b642","openshift-merge-robot","2023-01-06 19:19:47","true","Merge pull request #4510 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.15

build(deps): bump github.com/containerd/containerd from 1.6.14 to 1.6.15",20,71,1,1
"containers/buildah","2f25e14b5e500c3d32cf1bd5e8f1d2ac26bc52b5","openshift-merge-robot","2023-01-05 17:01:25","true","Merge pull request #4502 from edsantiago/bats_fixes

system tests: remove unhelpful assertions",20,71,1,1
"containers/buildah","3c94e5345231eba4c6e91d843adbf1e4e956c436","openshift-merge-robot","2022-12-12 22:00:50","true","Merge pull request #4448 from containers/dependabot/go_modules/golang.org/x/term-0.3.0

build(deps): bump golang.org/x/term from 0.2.0 to 0.3.0",16,70,1,1
"containers/buildah","e42458a9066bbc65bb613c36affb1b0060e93d69","rhatdan","2022-12-09 17:06:49","true","Merge branch 'main' into dependabot/go_modules/golang.org/x/term-0.3.0",16,70,1,1
"containers/buildah","a1698cde6044933947a385d1f9aa26ce88df3ee2","mtrmac","2022-11-21 22:22:17","false","Update c/storage after https://github.com/containers/storage/pull/1436

... and update to remove the now-deprecated Locker interface.

[NO NEW TESTS NEEDED]

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",20,70,1,1
"containers/buildah","a27bd0b8f904abc36a0e09894b239a7809fa86d4","openshift-merge-robot","2022-12-03 11:18:37","true","Merge pull request #4430 from mtrmac/modified-test

Update c/storage after https://github.com/containers/storage/pull/1436",17,70,1,1
"containers/buildah","ed370776549818d2b54aacf55e2e6792068ce166","cevich","2022-11-03 17:58:36","true","GHA: Simplify Cirrus-Cron check slightly

Depends on: https://github.com/containers/podman/pull/16357

Signed-off-by: Chris Evich <cevich@redhat.com>",25,69,1,1
"containers/buildah","8edd4a7850b41231cb1b0dcc4c0f9f4477865f3d","rhatdan","2022-11-04 13:35:23","true","Merge branch 'main' into codespell",22,69,1,1
"containers/buildah","b8ec3a81282962633492bef89311aa1adbd877ae","rhatdan","2022-10-17 12:45:15","true","Merge pull request #4343 from rhatdan/VENDOR

Update vendor containers/(common,image,storage)",27,69,1,1
"containers/buildah","5c88b9972e82051dc1ee29be1661e49abb426b9c","openshift-merge-robot","2022-10-10 16:47:17","true","Merge pull request #4300 from AndASM/buildahimage-container-conf-permissions

[CI:BUILD] Combine buildahimage Containerfiles",28,68,1,1
"containers/buildah","dc81652ffa82c6a3c5ce317d3b1bb88ec6910d95","rhatdan","2022-10-12 11:18:22","false","Fix man pages to match latest cobra settings

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",28,68,1,1
"containers/buildah","9f435de84e00889e595c1566ee4e1d9967e0d2cd","flouthoc","2022-09-05 07:06:05","true","manifest: add support for buildah manifest exists

Adds support for `buildah manifest exists <name>` which tells user if
requested manifest is present in local storage or not, if manifest is
present in local-storage command exits with exit code 0 otherwise 1.

Similar to: https://docs.podman.io/en/latest/markdown/podman-manifest-exists.1.html

Closes: https://github.com/containers/buildah/issues/4217

Signed-off-by: Aditya R <arajan@redhat.com>",19,67,1,1
"containers/buildah","5f34c5e2faafcbde4769f275be6ef47023d3443c","nalind","2022-08-01 18:31:27","false","Fix a copy/paste error

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",18,66,1,1
"containers/buildah","64534a889aa3484dd84411be0b187cf6364eabd6","nalind","2022-08-30 17:37:34","false","Replace k8s.gcr.io/pause in tests with registry.k8s.io/pause

In kubernetes 1.25, the default source for the pause image is now
registry.k8s.io instead of k8s.gcr.io.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",16,67,1,1
"containers/buildah","f46ef3b2d755fb07d50aa3327b9606413a935ed0","flouthoc","2022-08-22 06:46:39","true","buildah: support for --retry and --retry-delay for push/pull failures

Allows users to configure `--retry` attempts and `--retry-delay`
duration using two additional flags for commands

* buildah build
* buildah pull
* buildah push
* buildah from
* buildah add
* buildah copy

Closes: https://github.com/containers/buildah/issues/4018

Not sure how we can test retry attempts in CI, but added a test in
tests/bud.bats which verfies we parse and added flag in other options
for sanity parsing checking.

Signed-off-by: Aditya R <arajan@redhat.com>",17,67,1,1
"containers/buildah","20699bf61e0004e8f32991ec71eef1972a4cf083","openshift-merge-robot","2022-09-01 11:32:57","true","Merge pull request #4215 from containers/dependabot/go_modules/github.com/docker/go-units-0.5.0

build(deps): bump github.com/docker/go-units from 0.4.0 to 0.5.0",17,67,1,1
"containers/buildah","2263dc048924312ad7e1b4ccb3d0be2b322a8fbe","openshift-merge-robot","2022-08-11 08:20:41","true","Merge pull request #4179 from flouthoc/document-build-from-repo

[CI:DOCS] docs: specify `git://` protocol is not supported for github hosted repo",17,66,1,1
"containers/buildah","491ad0270aa7aeac00b365f60728331a0ea8dabb","nalind","2022-08-17 18:44:08","false","Drop util/util.Cause()

Use errors.Is() and errors.As() instead of our own
call-errors.Unwrap()-over-and-over-again helper.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",17,67,1,1
"containers/buildah","90cf4fc00b7ae96b17c5964294d69fcb1978c799","flouthoc","2022-08-18 06:47:15","true","mount,cache: enable SElinux shared content label option by default

`--mount=type=cache` is buildah's internal construct and actual location
is not managed by user so enable `z` by default is `SELinux` is enabled
on the host machine, instead of asking users to do it.

Signed-off-by: Aditya R <arajan@redhat.com>",17,67,1,1
"containers/buildah","8bbeed70ffb97dd70e3bcbf5e9c52da0e7d4f765","nalind","2022-08-01 21:15:33","false","integration tests: quote ""?"" in shell scripts

When passing the value ? to a shell function as an argument, don't
forget to quote it, so that it doesn't get expanded as a filename
pattern by the shell.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",18,66,1,1
"containers/buildah","59be789fbb36b631295fbd5c890fa4aa36563006","openshift-merge-robot","2022-08-02 11:01:56","true","Merge pull request #4156 from nalind/test-shell-glob

integration tests: quote ""?"" in shell scripts",18,66,1,1
"containers/buildah","15b0a250b66d88241ef613e7ce6b80a2457e96e7","dfr","2022-08-05 07:03:44","false","Allow chflags operations inside the container

On FreeBSD, this is required when installing some packages from
FreeBSD-base which have files protected with the immutable flag (e.g.
/usr/bin/passwd).

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",18,66,1,0
"containers/buildah","6fb7bb4b2316184c03337fe532307aa4382642c5","rhatdan","2022-07-11 14:10:31","false","Run codespell

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",21,65,1,1
"containers/buildah","88903ac99482ec66abe7153e73e444f181ee445c","openshift-merge-robot","2022-08-01 01:18:08","true","Merge pull request #4147 from flouthoc/manifest-inspect-annotation

manifest: `inspect` should contain `OCI` annotations.",19,66,1,1
"containers/buildah","b359ffd365911510dc0de37b37e99ef9fa20dc80","rhatdan","2022-07-29 16:19:41","true","Merge pull request #4145 from containers/dependabot/go_modules/github.com/containernetworking/cni-1.1.2

build(deps): bump github.com/containernetworking/cni from 1.1.1 to 1.1.2",18,66,1,1
"containers/buildah","7b96ee9bfb2884d5ef66bdca212b5a7935969cea","rhatdan","2022-07-27 11:24:41","true","Merge pull request #4142 from edsantiago/minor_test_tweak

Minor test tweak for podman-remote compatibility",19,66,1,1
"containers/buildah","81b4edfa205723269a79d47c49845b67cef52d24","rhatdan","2022-07-27 21:10:41","false","Failure to determine a file or directory should print an error

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",17,66,1,1
"containers/buildah","ac5d37c04cb85db1d77e09bf452ff77c9d8b17dc","edsantiago","2022-07-26 18:11:41","false","Minor test tweak for podman-remote compatibility

The new #4136 added a new test (multiple-parse). Make a small
change to it so it passes under podman-remote.

(Reason: the test was checking for a full Dockerfile2 path.
podman-remote only displays basenames).

Signed-off-by: Ed Santiago <santiago@redhat.com>",19,66,1,1
"containers/buildah","d0ef62ae1f4ea116ca692e11c311bec27799492d","dfr","2022-07-14 14:11:24","false","Make the jail package build on 32bit platforms

Not terribly useful in general but the cross build targets include 32bit
architectures

Signed-off-by: Doug Rabson <dfr@rabson.org>",24,66,1,0
"containers/buildah","066b54485362ee6cfee5f3ed9029bd99cae034f2","flouthoc","2022-07-01 15:07:48","true","define.downloadToDirectory: fail early if bad HTTP response

Fail early if downloadToDirectory receives bad HTTP response from the
source URL.

Signed-off-by: Aditya R <arajan@redhat.com>",22,65,1,1
"containers/buildah","ce384684c0a778ed85ee629e784c560201c74023","saschagrunert","2022-07-06 09:14:06","true","Switch to golang native error wrapping

We now use the golang error wrapping format specifier `%w` instead of
the deprecated github.com/pkg/errors package.

Signed-off-by: Sascha Grunert <sgrunert@redhat.com>",21,65,1,1
"containers/buildah","a432d7d1010bdc032be46ef6b9b85ccab3ea4bcb","rhatdan","2022-06-30 12:53:28","true","Merge pull request #4083 from containers/dependabot/go_modules/github.com/stretchr/testify-1.8.0

build(deps): bump github.com/stretchr/testify from 1.7.5 to 1.8.0",21,65,1,1
"containers/buildah","9445aa12add31e74304d4283a95240f66c19e4b1","giuseppe","2022-07-07 14:41:17","true","chroot: honor DefaultErrnoRet

honor the default errno ret value specified for the seccomp profile.

[NO NEW TESTS NEEDED]

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",23,65,1,1
"containers/buildah","252bf17b5e8745939dca552a781fbde7916ffac0","flouthoc","2022-06-23 05:28:56","true","lint: inspectable is never nil

Make linter happy by dropping check which is always true.

Signed-off-by: Aditya R <arajan@redhat.com>",21,65,1,1
"containers/buildah","263f5adc3fc2e4b119535145f701e020bd834d57","cevich","2022-06-29 15:39:58","true","[CI:DOCS] Update buildahimage comment

Drop a reference as to why the rpm --setcaps... line is needed, along
with a TODO reminder to check if it's still needed.

Signed-off-by: Chris Evich <cevich@redhat.com>",21,65,1,1
"containers/buildah","08bc5d91411d8fe40d70d5a05c3b1f939fd493b0","flouthoc","2022-05-24 16:28:49","true","stage_executor: dont rely on stage while looking for additional-context

* Since there are scenarios where we can skip building stages which are
not used so when looking for additional contexts don't use stage objects
from executor for various tasks cause there can be scenario when stage
is skipped since it was not being used.

* Also while looking for additional contexts context index to name
  wherever needed earlier we passed some checks as we relied on stage
existance but now we also skip stages so don't rely on stage when lookup
for additional contexts.

Signed-off-by: Aditya R <arajan@redhat.com>",25,64,1,1
"containers/buildah","ca3d6f8c0c42ad62908729080b3bdcf36d706752","openshift-merge-robot","2022-06-09 18:45:34","true","Merge pull request #4048 from slp/macos-support

Implement limited support for macOS (darwin)",23,64,1,1
"containers/buildah","431779113e662bb6abce2ba6933a63102387999a","openshift-merge-robot","2022-06-09 18:41:22","true","Merge pull request #4046 from containers/dependabot/go_modules/github.com/opencontainers/runc-1.1.3

build(deps): bump github.com/opencontainers/runc from 1.1.2 to 1.1.3",23,64,1,1
"containers/buildah","6225b23d68b1592f5756cb0c37bfea16785e3f39","rhatdan","2022-06-06 18:58:38","false","Move options parsing out of build.go and into pkg/cli

Attempting to share common code for CLI parsing between
buildah build and podman build

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",22,64,1,1
"containers/buildah","7cc5f1987adaa25228d00b38483cf87bbf9cc78b","vrothberg","2022-06-07 10:54:07","false","copier: add `NoOverwriteNonDirDir` option

Similar to the `NoOverwriteDirNonDir` one, add an option that disables
non-directories from being overwritten by directories.

Required-for: containers/podman/issues/14420
Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",22,64,1,1
"containers/buildah","085611fa09d26b1c02f3a824b8fcef724ffc551e","openshift-merge-robot","2022-05-16 16:27:17","true","Merge pull request #3990 from flouthoc/process-git-subdir

build: accept branch and subdirectory when context is `git` repo",27,64,1,1
"containers/buildah","cf2bb5a12442d07dc0373ceb81dd6d03f27cfd38","giuseppe","2022-05-05 09:11:52","true","copier: move NSS load to new process

do not attempt to load NSS modules at init() time but do it only when
it is needed before a chroot.

[NO NEW TESTS NEEDED]

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",24,63,1,1
"containers/buildah","9d35a5bf9d80196d5c5f20a64e2b008f4f50ada8","openshift-merge-robot","2021-06-15 17:29:37","true","Merge pull request #3296 from Luap99/workdir-copy

Fix copy into workdir for a single file",35,53,1,1
"containers/buildah","99aa24bf1c67b2b04f24df362287efe3abcc5c0e","openshift-merge-robot","2021-06-10 20:49:16","true","Merge pull request #3289 from containers/dependabot/go_modules/go.etcd.io/bbolt-1.3.6

build(deps): bump go.etcd.io/bbolt from 1.3.5 to 1.3.6",34,52,1,1
"containers/buildah","4fa566ead27e2a4fafd17f3dec28cc912e983060","openshift-merge-robot","2021-06-01 17:48:48","true","Merge pull request #3265 from nalind/redo-step-logging

imagebuildah: redo step logging",38,52,1,1
"containers/buildah","c99b7bd8f83587f8ca4fb229f68a9f790ef6d373","openshift-merge-robot","2021-06-01 17:36:47","true","Merge pull request #3269 from containers/dependabot/go_modules/github.com/onsi/ginkgo-1.16.3

build(deps): bump github.com/onsi/ginkgo from 1.16.2 to 1.16.3",38,52,1,1
"containers/buildah","c5a6950b50ca848429b556f5b87bff67b041cc4c","rhatdan","2021-06-02 14:19:42","false","Fix handling of auth.json file while in a user namespace

If you are running buildah within a user namespace, without
XDG_RUNTIME_DIR being set, we need to make sure buildah login, logout
handle XDG_RUNTIME_DIR the same was as buildah push.

Running buildah within a container is triggering failures, where buildah
login puts the auth.json file in /run/containers/0/auth.json but buildah
push looks for it in
/tmp/container-user-0/containers/containers/auth.json

Fixes: https://github.com/containers/buildah/issues/3259

[NO TESTS NEEDED] The existing tests should see if this causes any
problems.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",37,52,1,1
"containers/buildah","a6b3b6f672a3ad6e7d047b5d9ff771000694bc8b","dcermak","2021-05-28 15:09:27","true","Add rusage-logfile flag to optionally send rusage to a file

Currently the rusage is reported to stdout and rather cumbersome to parse. The
new flag rusage-logfile can be used to specify a file to which the log will be
written instead.

Signed-off-by: Dan Čermák <dcermak@suse.com>",36,52,1,0
"containers/buildah","106e843a7d7d6f3a7e85a2159b77357d606e10a9","openshift-merge-robot","2021-06-02 19:18:53","true","Merge pull request #3274 from rhatdan/login

Fix handling of auth.json file while in a user namespace",37,52,1,1
"containers/buildah","eca0c9cda411457e762cb8ef546d759eb6ca7098","rhatdan","2021-05-11 19:05:48","false","Check earlier for bad image tags name

Fixes: https://github.com/containers/buildah/issues/3134

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",54,51,0,1
"containers/buildah","d677bf054d509370e8ccae61fc20f8162617496b","openshift-merge-robot","2021-05-26 15:30:23","true","Merge pull request #3220 from nalind/loadsave

Add and use a ""copy"" helper instead of podman load/save",37,52,1,1
"containers/buildah","df14b1c77078d10eb3a9e0c8c649a59d13c609e4","openshift-merge-robot","2021-05-24 20:59:58","true","Merge pull request #3249 from cevich/sync_multi-arch

Sync. workflow across skopeo, buildah, and podman",54,52,1,1
"containers/buildah","d7d078561cc1dffca215bff918d3331061599041","rhatdan","2021-05-07 17:38:44","false","Send logrus messages back to caller when building

We want Info, Warning and Debug logrus messages to be writen to the
buildah stderr. this way when podman-remote is using build, it will
get the messages back on the client side.

[NO TESTS NEEDED] Since this will be tested in Podman.

Fixes: https://github.com/containers/buildah/issues/3214

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",52,51,0,1
"containers/buildah","f30b420d6f3da8b61fd8b664c919691826063bef","openshift-merge-robot","2021-05-18 15:54:58","true","Merge pull request #3235 from rhatdan/default

Fix handling of --default-mounts-file",55,52,1,1
"containers/buildah","d87c623741c9748641388fbcf65aebc388648cbc","openshift-merge-robot","2021-05-05 19:41:11","true","Merge pull request #3201 from nalind/tag-signatures

imagebuildah: ignore signatures when tagging images",51,51,0,1
"containers/buildah","151eb7bcce932d7d5c295f96f04099bf72ba66c8","openshift-merge-robot","2021-05-01 10:44:29","true","Merge pull request #3192 from edsantiago/fix_run_uid_flake

fix run uid flake",50,51,0,1
"containers/buildah","73f2f845958f11f7f8647b0e721b10045115503e","rhatdan","2021-04-19 19:26:05","false","Output names of multiple tags in buildah bud

Buildah currently handles multiple tags when building, but does not
report it to the user by default. This reports the tags back to the
user.

Removed some unused code from commit.go, that would blow up if a user
specified AdditionalTags to the commit command, even though this is not
exposed to the user currently.  In a previous try to fix this, the
removed code was causing breakage, and I did not see a real purpose in
the code.

Fixes: https://github.com/containers/buildah/issues/3084

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",50,51,0,1
"containers/buildah","47d4d103657d1cd07d2db7ff87c44ed970ed1ab6","openshift-merge-robot","2021-04-19 14:48:56","true","Merge pull request #3159 from containers/dependabot/go_modules/github.com/containers/ocicrypt-1.1.1

build(deps): bump github.com/containers/ocicrypt from 1.1.0 to 1.1.1",52,51,0,1
"containers/buildah","592745b27022341734b5cb32a4102f1d4e3e36f3","francares","2021-04-16 18:02:06","false","Minor fixes to Buildah as a library tutorial documentation

Details:
1. CommitOptions struct does not belong to `define` package anymore.
2. Formatting fixes threw by MD lint.

Signed-off-by: Francisco M. Casares <francares@gmail.com>",53,51,0,0
"containers/buildah","8315438e729dfe1c005a6f3aab130a05cfc5c4ce","openshift-merge-robot","2021-04-13 13:50:08","true","Merge pull request #3141 from hshiina/from-isolation

Run container with isolation type set at 'from'",52,51,0,1
"containers/buildah","53219903c55e262d5c4c24e403837c9f6f2ceafd","openshift-merge-robot","2021-04-05 20:38:59","true","Merge pull request #3108 from rhatdan/error

Remove some stuttering on returns errors",51,50,0,1
"containers/buildah","88f5d49b1cd102abcd9ca78dcf4e5bd0fb21b7b3","openshift-merge-robot","2021-03-30 18:27:57","true","Merge pull request #2962 from nalind/blobcache-compress

blobcache: fix sequencing error",50,50,0,1
"containers/buildah","5dcec0b583647acb9d9289878fc775cfe0f6a027","openshift-merge-robot","2021-03-23 18:07:23","true","Merge pull request #3097 from barthy1/skopeo_usage_github_action

Use faster way to check image tag existence during multi-arch build",55,50,0,1
"containers/buildah","a41d8972d8d86a4b51631738e3557231403de82d","TomSweeneyRedHat","2021-03-22 16:07:07","false","[CI:DOCS] Fix rootful typo in docs

@giuseppe spotted a typo in rootlful instead of rootful in
https://github.com/containers/podman/pull/9774.

As I'd cut/pasted from Buildah, I thought I should clean up
here too.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",53,50,0,1
"containers/buildah","13590f8d18543ae43b6ad615dd5fb883a89e2b3e","openshift-merge-robot","2021-03-16 10:44:33","true","Merge pull request #3076 from idleyoungman/idleyoungman/add-image-tag-format-template-docs

Add Tag format placeholder to docs",58,50,0,1
"containers/buildah","915de2e2b50af1ef30808d87e4e715142385b780","openshift-merge-robot","2021-03-17 09:26:57","true","Merge pull request #3080 from containers/dependabot/go_modules/github.com/hashicorp/go-multierror-1.1.1

build(deps): bump github.com/hashicorp/go-multierror from 1.1.0 to 1.1.1",58,50,0,1
"containers/buildah","35300f3ba8191e57bbdc77b3b7e923d72acb29a0","openshift-merge-robot","2021-03-03 20:19:52","true","Merge pull request #3054 from nilesj/clarify_image_name_error

Clarify image name match failure message",60,49,0,1
"containers/buildah","0b84bda3ed78897e304e590c3f0790fc14858338","jmguzik","2021-02-24 12:31:44","false","chmod/chown added/fixed in bash completions

Signed-off-by: Jakub Guzik <jakubmguzik@gmail.com>",60,49,0,0
"containers/buildah","cba952725ebd22d18d76b7572aa7822242668d65","openshift-merge-robot","2021-02-24 11:17:18","true","Merge pull request #3038 from vrothberg/owners

OWNERS: add @lsm5",62,49,0,1
"containers/buildah","b51f63a3b6f6c380faf27035958bd6d5a41e096c","openshift-merge-robot","2021-02-24 14:28:21","true","Merge pull request #3036 from rhatdan/version

Make sure we set the buildah version label",59,49,0,1
"containers/buildah","b1cd538d7785db928cb5dcf1f5cf64339aabe2ca","edsantiago","2021-02-22 19:15:23","false","pr-should-include-tests: recognized ""renamed"" tests

git tries to recognize renamed files. This isn't always
as helpful as intended. Turn it off, so we'll always see
files as 'A'dded.

This is a simple copy of podman PR 9468, but without a
test case because I can find no instances of a .bats
file being renamed in the buildah git history.

Signed-off-by: Ed Santiago <santiago@redhat.com>",61,49,0,1
"containers/buildah","5e17fa887c7a57b284b3b23e68d6195a4c6aa507","vrothberg","2021-02-12 12:27:15","false","add stale bot

By popular demand, add the stale bot which we'are already using at
Podman.  The bot will remind us every 30 days of inactivity on specific
issues or pull requests and has turned into a useful tool to keep things
on the radar.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",62,49,0,1
"containers/buildah","6f554d8f34f0ae71823b6f6fa35a838da1d25561","openshift-merge-robot","2021-01-18 12:48:16","true","Merge pull request #2918 from TomSweeneyRedHat/dev/tsweeney/bumpback

Reset upstream branch to dev version",94,48,0,1
"containers/buildah","024d0091dbb01c09af52b1be10a61a3f22e7b380","cevich","2021-01-12 21:18:16","true","Fix conformance test false-failures

Prior to Docker 20.10, failed COPY/ADD instructions result in error
messages containing the string `no such file or directory`.  This was
changed in docker to a string containing `file not found`.  Since
the conformance tests potentially need to work with multiple docker
versions, they need to be sensitive to both errors.

Signed-off-by: Chris Evich <cevich@redhat.com>",93,47,0,1
"containers/buildah","80181e8f335eafe319ebf400442d5edacaf78cd2","openshift-merge-robot","2021-01-13 20:20:50","true","Merge pull request #2906 from ashley-cui/common331

Vendor in common 0.33.1",94,47,0,1
"containers/buildah","474febf0dcb3c76c23a88f3b83834c81f20a7e5c","TomSweeneyRedHat","2021-01-08 19:05:28","false","Bump to v1.19.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",91,47,0,1
"containers/buildah","69d4542b7e9dd04fc5abc8ccce428d3b027d4903","cevich","2020-12-03 15:43:54","true","Cirrus: Track libseccomp and golang version

The versions of these packages on Fedora/Ubuntu are important/relevant
for testing, make them easy to observe.

Signed-off-by: Chris Evich <cevich@redhat.com>",78,46,0,1
"containers/buildah","d69f76ab1741c834303b9dfc8d03813fe3a59577","rhatdan","2020-12-15 20:44:57","true","Merge pull request #2854 from giuseppe/rootless-isolation-default

pkg, cli: rootless uses correct isolation",80,47,0,1
"containers/buildah","8c01c1788a05943241eb5113c5f63408f17b18a7","openshift-merge-robot","2020-12-16 19:31:13","true","Merge pull request #2856 from rhatdan/master

Turn off PRIOR_UBUNTU Test until vm is updated",80,47,0,1
"containers/buildah","c50e236918279b74fde60f905f20b1ccaf0c13ae","openshift-merge-robot","2020-12-07 13:17:07","true","Merge pull request #2840 from containers/dependabot/go_modules/github.com/containers/storage-1.24.2

build(deps): bump github.com/containers/storage from 1.24.1 to 1.24.2",79,46,0,1
"containers/buildah","595720d69574782eee6a700a25cc9fe791ad10ed","openshift-merge-robot","2020-11-16 16:24:16","true","Merge pull request #2792 from TomSweeneyRedHat/bump-1.18.0-try2

Bump 1.18.0 try2",77,46,0,1
"containers/buildah","c7ed3ca7906be7b18d7ed012479b8ad7944f51ae","openshift-merge-robot","2020-11-06 23:48:02","true","Merge pull request #2751 from mbargull/check-scripts-env-cc

Use CPP, CC and flags in dep check scripts",63,45,0,1
"containers/buildah","6327fb3dc999ac1e9e24cf437aae42c707ac55db","nalind","2020-11-05 22:54:33","false","imagebuildah.getImageTypeAndHistoryAndDiffIDs: cache results

Cache the information we look up about images when evaluating them as
potential build cache matches, in an effort to reduce the number of
NewImage() calls we make, because they can be expensive.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",66,45,0,1
"containers/buildah","bdc109e4d2fddc1dfac51f1247ac505565c31f70","openshift-merge-robot","2020-10-29 14:27:00","true","Merge pull request #2730 from rhatdan/mount

Handle cases where other tools mount/unmount containers",67,45,0,1
"containers/buildah","00b511e4d4271c90fc56e67c693448aecdd2d351","rhatdan","2020-09-30 14:15:21","false","Move --userns-uid-map/--userns-gid-map  description into buildah man page

Currently we are describing a root global option --userns-uid-map and --userns-gid-map
options in the buildah-bud man page, These global flags can be used in lots of buildah
commands, and should have complete description in the buildah man page.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",88,44,0,1
"containers/buildah","71ba2e4ef0a762abf83035dedd35dbccbdcd983c","Luap99","2020-09-24 11:56:59","false","Shell Completion for podman build flags

The PR containers/podman#6442 enables a new way to create
shell completions scripts. The shell completion is handled
by cobra and since the build flags are defined here
the completion functions for this should be defined here
as well. For Reference see:
https://github.com/spf13/cobra/blob/master/shell_completions.md

I added a unit test to ensure that the flags have a
completion function set.

These completions could also be used by buildah if someone
wants to implements this cobra completion logic for buildah.

Signed-off-by: Paul Holzinger <paul.holzinger@web.de>",90,44,0,0
"containers/buildah","bbd82c03c7c89b3fc3f45bf29079e1d929e47631","TomSweeneyRedHat","2020-09-23 22:09:01","false","Change call to Split() to safer SplitN()

Change calls to Split to SplitN when we are splitting on an ""="" sign to make sure
we're not over chopping what the caller requested.

I started this search after seeing https://github.com/containers/podman/pull/7759.
I'll do similar for Podman, but initial results on my search is order of
magnitudes bigger there.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",89,44,0,1
"containers/buildah","cca4cb73f2fda4c217c57dcf8730be594857a0c2","Luap99","2020-09-24 12:13:21","false","Bump containers/common to v0.23.0

Signed-off-by: Paul Holzinger <paul.holzinger@web.de>",90,44,0,0
"containers/buildah","72e0721b2b1a28e895c2a1b1b1dd55993e3182e4","nalind","2020-08-27 15:33:35","false","Run(): ignore containers.conf's environment configuration

The hardwired default for containers.conf now includes a TERM variable,
and passing it through to commands that we ""RUN"" during a build can
subtly cause the resulting image to be different from one that `docker
build` would create, so stop using it there.

When a runtime runs the image we eventually produce, it'll consult the
configuration file, so the variable will still be set, even when it
isn't set in the image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",83,43,0,1
"containers/buildah","0d9e6aa31671da76c75bdd16676971eb0b5e36c2","nalind","2020-09-18 14:15:36","false","integration tests: make sure tests run in ${topdir}/tests

Add a pushd/popd to setup()/teardown() to ensure that tests run in our
tests directory, even if they're not invoked by test_runner.sh, so that
we can reliably use relative paths in tests without having to ensure our
location on a per-test or per-test-file basis.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",91,44,0,1
"containers/buildah","98e021ef324ed248616fe3fbc8ea59b1381e2231","TomSweeneyRedHat","2020-09-17 22:59:43","false","Add In Progress section to contributing

Add an ""In Progress"" section to the CONTRIBUTING.md
page of Buildah.  Once this is approved, I will open
a similar PR for Podman.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",90,44,0,1
"containers/buildah","4961747e5eb5fe15efabc6bf4f02a8e65e086682","cevich","2020-09-15 21:04:51","true","Validate: reference HEAD

Signed-off-by: Chris Evich <cevich@redhat.com>",91,44,0,1
"containers/buildah","3ef2c57f3ccddefe7f6b82bebea807431816a8d9","TomSweeneyRedHat","2020-09-03 18:59:06","false","Update Buildah Tutorial to address BZ1867426

A bugzilla was created due to a misunderstaning gleened from the
Buildah tutorial.  The person runing the tutorial followed it exactly,
but the example blew up on RHEL for them.  The reason being is the
`--releasever` option has to use a valid version for the host's OS
when it's working on a scratch container or dnf will fail.

This adds clarifiction to the document to make that clear.

https://bugzilla.redhat.com/show_bug.cgi?id=1867426

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",82,43,0,1
"containers/buildah","3a9ac75e40e7e3ba4472b47ae55ce4dbe59f7ab8","TomSweeneyRedHat","2020-08-25 22:20:19","false","Add fuse module warning to image readme

We've recently had a number of issues reported against our
pre-fabricated images on quay.io and a couple of rhel repositories
throwing a fuse error when run:
```
fuse: device not found, try 'modprobe fuse' first
```

The tip on modprobe fuse is not always seen by or displayed to
the end user.  Adding a couple of doc pointers to hopefully help.
Arises from this BZ: https://bugzilla.redhat.com/show_bug.cgi?id=1867892
and several others.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",83,43,0,1
"containers/buildah","3635b5b741960273d512f866052374d9730a9e1b","edsantiago","2020-09-08 16:53:47","false","bud.bats: use absolute paths in newly-added tests

Gating tests run in a temp directory; relative paths (bud/foo/bar)
will pass in CI but cause gating-test failures.

Solution is trivial: always use ${TESTSDIR}/bud/etc

Signed-off-by: Ed Santiago <santiago@redhat.com>",84,43,0,1
"containers/buildah","240b3bfc5cec3b91872e1d37f991251e0c6c93cb","flavio","2020-09-07 12:54:47","true","Extend flags of `manifest add`

Extend the flags of `buildah manifest add` to include also:

  * cert-dir
  * auth-file
  * creds
  * tls-verify

These options are useful when adding to a manifest an image that is not
part of the local image store. The image resides on a remote registry
that falls into one of these cases: it's not using tls termination, it requires
authentication or it's secured with an unknown tls certificate.

Consider the following scenario: a multi architecture manifest is created as
part of a multi-step CI pipeline running in a containerized way.
All the images referenced by the manifest live inside of a registry
secured with a self-signed tls certificate.

Without this patch the manifest creation step would have to pull all the
multi-architecture images locally via `buildah pull`.

With this patch the usage of `buildah pull` would not be needed because the
images' digests can be requested straight to the registry. That means the
execution of manifest creation step would be faster and result in less disk
space and network bandwidth being used.

Signed-off-by: Flavio Castelli <fcastelli@suse.com>",85,43,0,0
"containers/buildah","785a75088675406a5e2497fe8f41b5281a5b6444","TomSweeneyRedHat","2020-09-03 21:18:29","false","Bump to v1.17.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",81,43,0,1
"containers/buildah","01acb21a4d3e0b0e3ca011c3f3a662e76f909220","ypu","2020-08-24 08:48:58","false","tests: Add some tests

Add following tests:
1. bud capabilities test
2. from with non buildah container
3. pull image into a full storage

Signed-off-by: Yiqiao Pu <ypu@redhat.com>",85,43,0,0
"containers/buildah","27bed706882e0cacca93e32584a160abb4415fcb","nalind","2020-08-31 21:09:10","false","containerImageRef.NewImageSource(): don't always force timestamps

Avoid forcing the timestamps on content in new layers to the current
time when a timestamp is not specified.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",84,43,0,1
"containers/buildah","d2ed7bc155a5b8f923e5ee24920b53dc917dc19f","saschagrunert","2020-08-28 09:38:44","true","Switch to containers/common for seccomp

seccomp/containers-golang is deprecated and we should switch to
containers/common/pkg/seccomp instead.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>",83,43,0,1
"containers/buildah","c515e406bd9f0fbc5130d5b4cf06b28e2fe83a9d","rhatdan","2020-08-25 11:19:49","false","build(deps): bump github.com/containers/image/v5 from 5.5.1 to 5.5.2

Bumps [github.com/containers/image/v5](https://github.com/containers/image) from 5.5.1 to 5.5.2.
- [Release notes](https://github.com/containers/image/releases)
- [Commits](https://github.com/containers/image/compare/v5.5.1...v5.5.2)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",83,43,0,1
"containers/buildah","8c3d8ea6eed597dd3513a7b068ff15cd661fdc72","awerlang","2020-08-25 17:41:22","true","docs: remove outdated notice

Signed-off-by: André Werlang <beppe85@gmail.com>",83,43,0,0
"containers/buildah","ee6973ecfe99d66ebc1a4a0ce2a01179d5ed8c66","rhatdan","2020-08-26 09:01:10","true","Merge pull request #2569 from awerlang/overlay-docs

Overlay mounts are supported in rootless mode",83,43,0,1
"containers/buildah","b69a582e0a38d29c998954409030a0369b4291d9","rhatdan","2020-08-24 13:14:17","false","Discard ReportWriter if user sets options.Quiet

I can not seem to get this to happen locally, but if this
happens, I believe this should fix the problem.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",83,43,0,1
"containers/buildah","02921ee3abeecf9c73ef93db773dd6084f563f22","nalind","2020-08-21 15:42:49","false","Fix ownership of content copied using COPY --from

COPY --from was incorrectly discarding ownership information on files
copied from other layers, which unlike content copied from the build
context, should not default to being owned by 0:0.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",87,43,0,1
"containers/buildah","0bfbd3edb709ec468989469f93d7570ca8ed5410","nalind","2020-07-14 20:31:00","false","newTarDigester: zero out timestamps in tar headers

When digesting tar streams, zero out timestamps in headers before
digesting them.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",147,42,0,1
"containers/buildah","ac05e3aa2b470ca003eacd99cb8e0065fecbebb0","nalind","2020-07-29 14:45:17","false","docs/buildah-commit.md: tweak some wording, add a --rm example

Tweak wording to avoid suggesting that we add the actual text
""<none>:<none>"" as a name for images when a name isn't specified to
`buildah commit`.

Add an example that uses `--rm` to the list of examples.

Co-authored-by: Tom Sweeney <tsweeney@redhat.com>
Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",151,42,0,1
"containers/buildah","cea59d97c91bb7cf8841dad7bfc64be71a4fad43","QiWang19","2020-08-13 19:19:38","false","Replace retry functions with common/pkg/retry

Use retry pacakge from containers/common and change the retryDelay to exponential backoff from there.

Signed-off-by: Qi Wang <qiwan@redhat.com>",87,43,0,1
"containers/buildah","4beae113e0438f5c10b424b736d822bf5c5b2db9","rhatdan","2020-08-11 18:40:36","true","Merge pull request #2527 from containers/dependabot/go_modules/github.com/containers/common-0.18.0

Bump github.com/containers/common from 0.15.2 to 0.18.0",86,42,0,1
"containers/buildah","a932e9928678216aa57d5e3ce4652abef7c4931d","hswong3i","2020-08-10 08:56:10","true","Update nix pin with `make nixpkgs`

Also sync nix `packageOverrides` across skopeo/buildah/podman/cri-o for
utilizing local build cache.

Signed-off-by: Wong Hoi Sing Edison <hswong3i@gmail.com>",85,42,0,0
"containers/buildah","f49f49ee6a5e0243ff154463ef5067ee0fe6d81a","rhatdan","2019-08-08 13:33:15","true","Merge pull request #1751 from PaulUrwin/bugfix/get-login-not-working

Fix bug whereby --get-login doesn't do anything",51,30,0,1
"containers/buildah","d708fa8cf4925a511f7b0ee5c922a85029d782f6","rhatdan","2020-08-07 08:59:27","false","Enhance the .dockerignore man pages

Use different examples then the reference page.

Signed-off-by: Tom Sweeney <tsweeney@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",81,42,0,1
"containers/buildah","d4a3f7cca963602d2e828b3e4d4636fcf08e9b6a","TomSweeneyRedHat","2020-08-05 20:46:40","false","DOC: Add quay.io/containers/buildah image to README.md

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",95,42,0,1
"containers/buildah","b033ec32e4aa4d848635d4593588cb261f0027f8","hswong3i","2020-06-29 02:40:58","true","Build static binary with `buildGoModule`

Signed-off-by: Wong Hoi Sing Edison <hswong3i@gmail.com>",146,41,0,0
"containers/buildah","aaeadb6e32f3f1cde358e1d4565f48292c45a711","nalind","2020-07-21 21:27:12","false","Fix a race we hit during conformance tests

The imagebuilder.Executor.imageMap map is written in one goroutine which
waits on StageExecutors, and is read from the goroutines that run the
StageExecutors, so we need to synchronize access to the map.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",149,42,0,1
"containers/buildah","bee80f0e3632e80e548b94a289d5893c7a4ec74f","nalind","2020-07-28 15:11:18","false","tarFilterer: handle multiple archives

When processing .dockerignore files, we produce mini-archives for each
individual item being copied as part of a directory tree, so if we pass
them through a tarFilterer, it needs to not give up when it hits the end
of the first archive that it sees.

Add a flag to the tarFilterer that it sets when it closes the writing
end of the pipe that it's reading, and if the flag isn't set when the
reader finds an EOF, have the reader gear up to read another archive
instead of just refusing to process any more data.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",150,42,0,1
"containers/buildah","6ba7c47f8199d1881b04442a3e2acde7caf17cd0","rhatdan","2019-08-08 11:33:35","false","Bump containers/image to v3.0.2 to fix keyring issue

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",51,30,0,1
"containers/buildah","289a250a2fcb0df2335d14562867668040d9f265","nalind","2020-07-30 21:30:49","false","blobcache: avoid an unnecessary NewImage()

Avoid calling NewImage() on the source reference when the ImageSource
that we already have returns nil from its LayerInfosForCopy() method.

For our container-as-image references, that causes a re-extraction of
uncached blobs, recomputing their digests, rebuilding the config blobs
and manifests.

The image library's copy.Image() function then asks the source reference
that we're wrapping for blobs that we listed in the rebuilt manifest,
and if any of those values differ, we fail to read them.

This would have only affected builds that specified a blob cache.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",151,42,0,1
"containers/buildah","c7b46b7d8557fe4da95ac95839e53d038f620e50","ashley-cui","2020-07-20 17:29:29","false","Fix & add notes regarding problematic language in codebase

The Buildah project is committed to inclusivity, a core value of open source. Historically, there have been technology terms that are problematic and divisive, and should be changed. We are currently taking time to audit our repository in order to eliminate such terminology, and replace it with more inclusive terms. We are starting where we can, with our own code, comments, and documentation. However, such terms may be used in dependencies, and must be used as-is in our repositories at the current moment for compatibility. Buildah will change these terms in our repo as soon as new and better terminology is available to us via our dependencies.

For more information: https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language?sc_cid=701600000011gf0AAA

Signed-off-by: Ashley Cui <acui@redhat.com>",150,42,0,0
"containers/buildah","87aa489eaa8efcb59fc3d05b79bff79d4acb13f9","rhatdan","2022-11-03 18:22:55","true","Merge pull request #4397 from edsantiago/excise_ubi8

Stop using ubi8",24,69,1,1
"containers/buildah","7d07c3f5c3271b998099b1ad35b6c66f7844bdcd","edsantiago","2020-07-16 20:54:34","false","BATS tests: make more robust

Add a --retry flag to run_buildah; intended for tests which
really need to pull an image, and can't rely on prefetch().
It will try a failed buildah command three times, waiting
thirty seconds between retries.

This is imperfect: there's no way to specify the number of
retries, no way to specify the timeout, and no way to
combine --retry with an expected (i.e. nonzero) exit
status. (FWIW I can't think of any possible use for that).
It is, though, quick, minimal-impact, easy to remember
and use.

Add --retry option to various tests in pull.bats and
registries.bats.

And, while I'm at it, add expect_output checks to many
of the new encryption checks in pull.bats and from.bats.
This actually caught a bug in a test, a check that was
failing (expected) but for the wrong reason (missing
file, not wrong key). Have I mentioned, lately, that
tests should check error message strings, not just
exit status?

Fixes: #2473

Signed-off-by: Ed Santiago <santiago@redhat.com>",150,42,0,1
"containers/buildah","7bcf15c1243c4f8c7ce2afee92b7219ad6f06885","rhatdan","2020-07-15 21:12:13","false","Switch golang 1.12 to golang 1.13

Tutorials have an unsuported golang version referenced.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",148,42,0,1
"containers/buildah","d81afab8dc06b3b89d98cb6e95fb0205e0374936","rhatdan","2020-07-16 12:59:39","true","Merge pull request #2472 from vrothberg/update-x/text

vendor golang.org/x/text@v0.3.3",148,42,0,1
"containers/buildah","8c807dd1450069ddde8e21bec2bd996dc7a7969a","rhatdan","2020-07-06 13:40:55","true","Merge pull request #2432 from rhatdan/containers.conf

Switch scripts to use containers.conf",145,41,0,1
"containers/buildah","49d8eb5b7788aac6c2de53bc3e263fc18339fabd","llchan","2019-06-11 03:28:12","false","Only set default network sysctls if not rootless

Signed-off-by: Lawrence Chan <element103@gmail.com>

Closes: #1663
Approved by: rhatdan",42,28,0,0
"containers/buildah","b507c62769b4b83ca1e02b5c5cdeed57d2e79d4e","QiWang19","2020-07-10 18:46:43","false","Set engine env from containers.conf

Set engine env from containers.conf. Mirror podman PR https://github.com/containers/podman/pull/6790.

Signed-off-by: Qi Wang <qiwan@redhat.com>",145,41,0,1
"containers/buildah","b2ad00c1bfe1ff8191ba1eb262f631dac24a6121","CtrlZvi","2020-07-02 16:51:04","false","Add VFS additional image store to container

For the overlay driver, the buildah container was given an additional
image store. Unfortunatley, overlay doesn't work out-of-the-box in a
Kubernetes cluster do to the lack of appropriate access to /dev/fuse.
In Minikube, it's non-trivial to provide that access, but it is trivial
to use the VFS storage driver.

Previously, the VFS storage driver would fail due to not having the
appropriate directory structure and required files in the additional
image store. This commit adds those files to the pre-built container
images to allow for easy use in Kubernetes.

Signed-off-by: Zvi ""CtrlZvi"" Effron <viz_skywalker+GitHub@outlook.com>",146,41,0,0
"containers/buildah","2b1ad123a3ffdf4633a785fe800c2552da200d7a","giuseppe","2020-07-14 21:05:46","true","chroot: do not use setgroups if it is blocked

if setgroups is blocked to set up the user namespace, do not attempt
to use it to clear the additional groups.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",147,42,0,1
"containers/buildah","abda6f3156d4683cc972f2816ae1d2a0fde190f1","nalind","2020-07-13 20:49:32","false","Deduplicate environment variables

When combining lists of environment variables, or environment variables
combined with build arguments, always deduplicate sets of values.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",147,42,0,1
"containers/buildah","e7a328cb9324c7f7f7ddcc2669f0f05a12a00cdd","rhatdan","2023-08-22 13:13:44","true","Merge pull request #4983 from flouthoc/warn-global-args

executor: build-arg warnings must honor `global args`",9,79,1,1
"containers/buildah","631ecf05622d6fd3722a8eed6aa050bb9e75ec12","giuseppe","2020-06-22 08:53:02","true","buildah, bud: support --jobs=N for parallel execution

it enables running multi stages Containerfiles in parallel.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",143,41,0,1
"containers/buildah","2f04b7d7f700f8cfd1ce923ab81e899343a00c5b","rhatdan","2020-07-02 14:25:02","true","Merge pull request #2430 from TomSweeneyRedHat/dev/tsweeney/ib_v1.1.6

Bump openshift/imagebuilder to v1.1.6",146,41,0,1
"containers/buildah","64077e1729386a4d66ff0a3f6a3255fccb76689c","giuseppe","2020-06-16 11:39:04","true","executor: refactor build code inside new function

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",143,41,0,1
"containers/buildah","56750c1d0aa239fd2723f839a13aed4b1171abf7","xiaotuanyu120","2020-06-16 08:34:35","false","add version centos7 for compatible

Signed-off-by: xiaotuanyu120 <zhaopeiwu@outlook.com>

Update contrib/buildahimage/centos7/Dockerfile

Co-authored-by: Tom Sweeney <tsweeney@redhat.com>

Update contrib/buildahimage/README.md

Co-authored-by: Tom Sweeney <tsweeney@redhat.com>

Update contrib/buildahimage/README.md

Co-authored-by: Tom Sweeney <tsweeney@redhat.com>

Update contrib/buildahimage/README.md

Co-authored-by: Tom Sweeney <tsweeney@redhat.com>

update description of the image centos7 and using containers.conf in stable instead

Signed-off-by: xiaotuanyu120 <zhaopeiwu@outlook.com>

Update contrib/buildahimage/centos7/Dockerfile

Co-authored-by: Tom Sweeney <tsweeney@redhat.com>",143,41,0,0
"containers/buildah","a9aaa0c9ef9630231346ffa2716960ab579564e8","rhatdan","2020-06-15 17:03:38","true","Merge pull request #2406 from containers/dependabot/go_modules/github.com/containers/common-0.13.1

Bump github.com/containers/common from 0.12.0 to 0.13.1",143,41,0,1
"containers/buildah","ca63d6d86e004d365800aa84680695caadc8feef","rhatdan","2020-06-17 09:49:13","true","Merge pull request #2410 from vrothberg/vendor-common

vendor github.com/containers/common v0.14.0",144,41,0,1
"containers/buildah","038a24b6a3445480a45b298b5366568410904f31","TomSweeneyRedHat","2020-06-17 17:19:59","false","Bump to v1.16.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",144,41,0,1
"containers/buildah","241a26ee9caf0ca8d313b547807586aeea6e13ce","eriksjolund","2020-06-02 12:20:32","true","Add CVE-2020-10696 to CHANGELOG.md and changelog.txt

Signed-off-by: Erik Sjölund <erik.sjolund@gmail.com>",137,40,0,0
"containers/buildah","1807921d6ef6b510b41c37166285ec12f65947d4","boaz0","2020-05-19 12:20:14","false","Warn on unset build arguments

Display a warning message when there is a building
argument without a default value in the Dockerfile (e.g. ""ARG MYVAR"")
and no value is set to it using ""--build-argument""

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>",135,40,0,0
"containers/buildah","e27a41220c097d280a4479ce859454fbdff2aaf1","QiWang19","2020-05-18 16:59:44","false","fix resolve docker image name as transport

fix #2205 Validate the supported transports to fix the corner case. Do not use docker as transport if `docker:` is Docker Official Image

Signed-off-by: Qi Wang <qiwan@redhat.com>",135,40,0,1
"containers/buildah","0f6c2a960ccc85b5e07c20be732caafe9e5dbec0","rhatdan","2020-05-11 17:04:57","true","Merge pull request #2356 from containers/dependabot/go_modules/github.com/containers/common-0.11.2

Bump github.com/containers/common from 0.10.0 to 0.11.2",138,39,0,1
"containers/buildah","57706e134d56ad19717d5713dac8c2e043146a34","lumjjb","2020-04-17 15:48:14","false","Implement commit for encryption

Signed-off-by: Brandon Lum <lumjjb@gmail.com>",122,39,0,0
"containers/buildah","6b209aa4537ad1d4bd639de768cd9d35bda73d15","rhatdan","2020-05-11 17:06:31","false","Bump github.com/containers/image/v5 from 5.4.3 to 5.4.4

Bumps [github.com/containers/image/v5](https://github.com/containers/image) from 5.4.3 to 5.4.4.
- [Release notes](https://github.com/containers/image/releases)
- [Commits](https://github.com/containers/image/compare/v5.4.3...v5.4.4)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",138,39,0,1
"containers/buildah","4fc49ce0ced0fd2455ed334e655eb82a0d1e0fb1","rhatdan","2020-05-20 17:00:02","true","Merge pull request #2362 from containers/dependabot/go_modules/github.com/onsi/ginkgo-1.12.1

Bump github.com/onsi/ginkgo from 1.12.0 to 1.12.1",135,40,0,1
"containers/buildah","df5116276518dbd113d01f744f10cf4908459224","cevich","2020-05-04 15:38:46","true","Cirrus: Fixes from review feedback

Signed-off-by: Chris Evich <cevich@redhat.com>",135,39,0,1
"containers/buildah","dd6cc6d6c6cd20336ec07902e1b378b2a9e972fb","yann-soubeyrand","2020-05-08 18:39:05","false","Evaluate symlinks in build context directory

During a file copy, symlinks in file path are evaluated, so the resulting path
couldn't match against .dockerignore patterns. Indeed, symlinks in build
context directory were not evaluated.

Signed-off-by: Yann Soubeyrand <yann.soubeyrand@camptocamp.com>",136,39,0,0
"containers/buildah","eb5b6ee808726188bb1f71af1e1ca972cd138c01","rhatdan","2022-04-20 20:21:48","false","Update vendor of containers/(common,storage,image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",25,63,1,1
"containers/buildah","d4103b788d81fcb7a43baa58f756309c6df3f783","TomSweeneyRedHat","2020-04-30 23:32:35","false","Add registry to buildahimage Dockerfiles

Adding the registry name registry.fedoraproject.org/
to the `FROM fedora:latest` statement in each of the
buildahimage Docker/Containerfiles.

When the buildah/testing:latest image is autobuilt by
the quay.io build triggers, Buildah's version is set to
v1.14.0 instead of v1.14.8.  If I use the same Dockerfile
and build on my test machine, the version is set to v1.14.8
as it should be.

quay.io uses Docker to do their image builds and it pulls
fedoara from docker.io by default.  I'm hoping that fully
specifying the image name will help that out.  Regardelss,
it won't hurt.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",135,39,0,1
"containers/buildah","d638cc8418c3836a1750b04f20cbe34a16b4c6f3","cevich","2020-04-22 19:02:32","true","Cirrus: Re-enable all distro versions

Signed-off-by: Chris Evich <cevich@redhat.com>",128,39,0,1
"containers/buildah","7a88d7ea841617526ac7c69eeac74859838a8223","rhatdan","2020-04-13 13:37:57","true","Merge pull request #2299 from containers/dependabot/go_modules/github.com/containers/common-0.9.0

Bump github.com/containers/common from 0.8.1 to 0.9.0",121,39,0,1
"containers/buildah","3a39d015af85cfdcaecc7678c1fd6115c987cb3a","rhatdan","2020-04-13 13:37:40","true","Merge pull request #2300 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.6.4

Bump github.com/fsouza/go-dockerclient from 1.6.3 to 1.6.4",121,39,0,1
"containers/buildah","81ad0417fb7f50a01548a8b907c2b357f458698b","TomSweeneyRedHat","2020-04-09 17:28:08","false","Bump back to v1.15.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",120,38,0,1
"containers/buildah","00eb895d6f2f13d658a9cb78714382e494974afc","rhatdan","2019-06-15 09:45:50","false","Bump to v1.9.0

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",42,29,0,1
"containers/buildah","155ce56a2cd2d5608cf43c998f1728af5e7a499b","TomSweeneyRedHat","2020-04-09 17:15:46","false","Bump to v1.14.8

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",120,38,0,1
"containers/buildah","aa40eb9fb96fcfa4d18f99491413d087c4195ed2","vrothberg","2020-04-07 10:29:08","false","make vendor: run `tidy` after `vendor`

Run `go mod tidy` after `go mod vendor` to properly clean up the
dependencies.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",118,38,0,1
"containers/buildah","779025eac6bd7c881d7c8e97ef4072b631f72c56","mtrmac","2020-04-08 18:24:18","false","Fix (make vendor)

(export a=b command args) does not run (command args) with a=b,
it sets $a to b, and marks variables $a $command $args as exported,
i.e. (command args) is not run.

So, before https://github.com/containers/buildah/pull/2287 we were not actually
running (go mod tidy), and now we are not running (go mod vendor).

Fix that.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",117,38,0,1
"containers/buildah","ce2fc8b22b5587752f29cf89a142d06bd744355e","rhatdan","2020-04-08 20:27:51","false","Bump validation

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",117,38,0,1
"containers/buildah","617dc15dbd00457942a881e2d6739dd5e7264a40","edsantiago","2020-03-31 23:29:19","false","bud.bats - cleanup, refactoring

Fix three issues identified in #2036:

 - the 'gitrepo and branch' test was pulling from a place
   that took four minutes; change it to our own repo,
   suggested by Dan, which takes just a few seconds.

   -- also, remove what I think is an unnecessary dup.
      If buildah can pull from a branch, it can pull
      from master.

 - the httpd tests were really confusing, with lots of
   copy/pasted code differing in only small ways. Refactor
   to make the purpose of each test more apparent, and
   to make it easier to add new ones as needed.

 - combine bud-http-context-dir-with-Dockerfile -pre and -post,
   since they were identical. (Context: they started off being
   different tests, with command-line options in different
   order, but as of #493 the -post form of options no longer
   works so the -post test is no longer relevant)

Signed-off-by: Ed Santiago <santiago@redhat.com>",112,38,0,1
"containers/buildah","053c915db12b4b33736d6e8ee4fa176ad1a30bd1","rhatdan","2018-10-22 16:31:07","true","Merge pull request #1120 from rhatdan/defaulttransport

Resolve image names with default transport in from command",53,21,0,1
"containers/buildah","09cce6292b7f4f6ee16da3e2001f34b1e4126679","TomSweeneyRedHat","2020-04-02 13:48:56","false","Bump to v1.14.6

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",113,38,0,1
"containers/buildah","c6e6732c9b41c6962b14bc5ceca2c15f248b3124","edsantiago","2020-04-02 15:47:41","false","dockerignore tests : remove symlinks, rework

rpm 4.16 alpha in rawhide has broken our koji build:

   https://github.com/containers/buildah/issues/2264

   https://github.com/rpm-software-management/rpm/issues/1159

TL;DR we can no longer package the 'circular-symlink' file
used in tests. This PR removes that and other symlinks from
the git working tree, and reworks the test so it runs from
a temporary directory and creates all necessary symlinks.

Also, since the test as written was simply checking ""did it
run"" without actually testing anything, add a test to confirm
that the files added to the image are exactly what we expect.

Signed-off-by: Ed Santiago <santiago@redhat.com>",113,38,0,1
"containers/buildah","40df1c6e3bb2e0708edcfd93b58d0abe1ad5192f","lumjjb","2020-04-03 20:34:43","false","Fix errorf conventions

Signed-off-by: Brandon Lum <lumjjb@gmail.com>",115,38,0,0
"containers/buildah","c46f6e03211130773d34eb87877058079936a237","rhatdan","2020-01-15 21:34:25","false","Update vendor of containers/common to v0.1.0

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #2087
Approved by: giuseppe",101,36,0,1
"containers/buildah","b3eed6b6bfe008ea86e06d5d6b9938ec018bf43e","tophercullen","2020-03-27 09:16:29","false","Fix Amazon install step

Signed-off-by: Topher Cullen <topher@shawlite.com>",114,38,0,0
"containers/buildah","5247a1f1a3b3ccf3c2ee9b45f67305c517e2d304","TomSweeneyRedHat","2020-03-26 23:00:10","false","Bump to v1.14.5

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",114,38,0,1
"containers/buildah","86fa264ac17d406b64400d1deb56ec4dcb8a40d5","carbonin","2020-03-24 01:55:36","false","Make image history work correctly with new args handling

Previously, every build-arg was recorded in the image history
even if the arg was not accessible to that layer when the build
was run.

This commit fixes that by ensuring that args are only added to
history when they are in scope. This is tracked in the
imagebuilder.Builder struct which is now accessible through
the stage reference in the StageExecutor

Fixes #2210

Signed-off-by: Nick Carboni <ncarboni@redhat.com>",112,38,0,0
"containers/buildah","e7fe3efe9ca81b9e591e8082a0d222e3bf8a9049","carbonin","2020-03-25 14:15:32","false","Fix bud-build-arg-cache test

This test had a false assumption causing it to fail with my new
changes to ARG handling.

When a build arg is provided a layer should only be re-built if
that build arg could change the output of that layer. For this
reason the previous Dockerfile would (correctly) be pulled from
cache even if a build arg was provided. To force a rebuild, we need
a RUN command after the ARG command that we're changing.

Signed-off-by: Nick Carboni <ncarboni@redhat.com>",113,38,0,0
"containers/buildah","10e59b5b31f34623696de24fb9f0a46c8ed6167a","carbonin","2020-03-19 13:27:52","false","Run stat command directly for volume ownership test

This removes the script previously used which may have been
causing #2235

Signed-off-by: Nick Carboni <ncarboni@redhat.com>",110,38,0,0
"containers/buildah","85fe5cc410a7264d10d35f960428f125bdc21f5c","carbonin","2020-03-19 14:05:07","false","Add comment for RUN command in volume ownership test

Signed-off-by: Nick Carboni <ncarboni@redhat.com>",110,38,0,0
"containers/buildah","7f6ddecfdf14dfb37587cff041827c24a8221ac3","nalind","2020-08-06 14:06:38","false","conformance testing: ignore buildah.BuilderIdentityAnnotation labels

Ignore the buildah.BuilderIdentityAnnotation label when comparing images
that we build with images built using other tools, which of course don't
automatically set that label.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",94,42,0,1
"containers/buildah","10542ed8b7d42cea52c9824a9e7d38db5d57f4a2","rhatdan","2020-03-23 15:05:17","true","Merge pull request #2242 from containers/dependabot/go_modules/github.com/openshift/imagebuilder-1.1.3

Bump github.com/openshift/imagebuilder from 1.1.2 to 1.1.3",113,38,0,1
"containers/buildah","8f55523fa7654044ad3ff79d64e0b47973aa440b","rhatdan","2020-03-13 18:30:39","false","Update github.com/openshift/imagebuilder vendoring

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",108,38,0,1
"containers/buildah","066e446c81005028f1619d237b4d81370b48e93d","TomSweeneyRedHat","2020-03-03 19:06:57","false","Bump to v1.14.2

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",99,37,0,1
"containers/buildah","878107b06f515bf77e22a0b20c7cead5afb76119","umohnani8","2020-02-26 22:15:05","false","Set correct ownership on working directory

We want to set the correct ownership on the working
directory so that the build process can actually write
to this directory.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>",98,37,0,1
"containers/buildah","8d97cfa5a1efb36dcb373160d3766835211fab3d","TomSweeneyRedHat","2020-02-22 22:50:59","false","Add Containerfile to build a versioned stable image on quay.io

I've been using this Containerfile to build versioned stable images
of Buildah for quay.io.  I build these images if I miss grabbing the
'latest' image before the next version goes to latest, or if we've
made changes to how the image is built and I need to redo the older
versions.

As we've had a few updates by different people to the Containerfiles
in these directories, I thought I'd add this one too so it can be
updated by others if needed.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",99,37,0,1
"containers/buildah","7cd6f7d048426c6c00ab689b53c4e3c1968130d8","rhatdan","2020-02-19 12:51:59","true","Merge pull request #2129 from cevich/bors_docs

Bors-ng: Add documentation and status-icon",97,37,0,1
"containers/buildah","f3a5653c921766afbaa99ec875db5198a6e6e480","nalind","2020-02-17 18:46:57","false","run: adjust the order in which elements are added to $PATH

When building the slice of environment variables to add to the
configuration for a container that we're about to run, in case of
conflicts, we want the values from the base image or working container
to override the global defaults, and we want values that were passed to
us through the API to override them both.

In cases of conflicts, values which occur later in the slice override
values which occurred earlier, so we want to add them in this order:
* values from containers.conf
* values from the base image or working container
* values passed to us through the API

We previously applied the containers.conf defaults after the base image
or working container's value, and that meant that containers.conf's
values always took precedence over the values in the image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",101,37,0,1
"containers/buildah","fc6baddc9762176e252fa15f2f83724d76a427a2","rhatdan","2020-02-18 19:50:08","false","Update to containers/common v0.3.0

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",99,37,0,1
"containers/buildah","80b6a269a1b35af06954a1eff29e12675352b3a5","rhatdan","2020-02-11 20:33:17","true","Merge pull request #2149 from TomSweeneyRedHat/dev/tsweeney/upperescape

Show error on copied file above context directory in build",114,37,0,1
"containers/buildah","a882c52918394ee575ff1cf7d1bc6a8965f1f09d","lsm5","2020-02-13 20:21:26","false","include installation steps for CentOS 8 and Stream

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",114,37,0,1
"containers/buildah","eadf63b54658ae48b8455d02555353a7bbf4c6b0","mythi","2020-02-10 17:36:06","false","Makefile: fix install.cni.sudo

github.com/containernetworking/plugins has no build.sh but
build_[linux|windows].sh. Call build_linux.sh directly to fix
install.cni.sudo.

While we're at it, create /opt/cni/bin with 'install' to encapsulate with
privileges.

Fixes: #2153

Signed-off-by: Mikko Ylinen <mikko.ylinen@intel.com>",112,36,0,0
"containers/buildah","6aebe8c0f60dd0467ec11e40111824024267ab7d","cevich","2020-02-07 19:43:30","true","Cirrus+Bors: Simplify temp branch skipping

Signed-off-by: Chris Evich <cevich@redhat.com>",111,36,0,1
"containers/buildah","0a063c48a284713431ee87c79ab0a886f61cab20","nalind","2020-01-25 14:43:01","false","copy.bats: make sure we detect failures due to missing source

Make sure we fail a build when the source for a COPY --from instruction
can't be found.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #2111
Approved by: rhatdan",106,36,0,1
"containers/buildah","e8c07c6eac0a8dc987d84fd1bd5ca7eda94f9ea4","TomSweeneyRedHat","2020-01-14 15:32:37","false","Bump to v1.13.1

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2081
Approved by: rhatdan",100,35,0,1
"containers/buildah","bf14e6ca2dd8299fc5d5145cb0ced904d5786aa8","TomSweeneyRedHat","2020-01-14 15:43:45","false","Bump back to v1.14.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2081
Approved by: rhatdan",100,35,0,1
"containers/buildah","4e23b7a10cc9bcb990a7060cdd376a7da57bd51f","rhatdan","2020-01-09 17:56:34","true","Merge pull request #2073 from vrothberg/travis

Travis: rm go 1.12.x",102,35,0,1
"containers/buildah","6cc46567d1c7011bc99ac99ecc6239f2d3df0aa9","TomSweeneyRedHat","2019-12-13 16:32:21","false","Bump to v1.12.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",88,34,0,1
"containers/buildah","4cf37c277aea84d6ff5f85a70f42b2e370ade48c","QiWang19","2019-11-11 15:23:36","false","bud COPY does not download URL

close #1846
buildah bud COPY can download the URL to the container working directory. This is not compatible with Docker.
So after this path, buildah bud COPY URL will return an error.

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1977
Approved by: QiWang19",78,33,0,1
"containers/buildah","6a555a0405b50183e3b034f9733a4b03e474aeff","TomSweeneyRedHat","2019-11-18 20:40:43","false","Touch up commit man page image parameter

The commit command does not require that a value for the
image be provided.  Change the man page to reflect that
and explain the behavior in that instance.  This is the
same behavior as Docker.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1987
Approved by: rhatdan",81,34,0,1
"containers/buildah","a88000146da9a3dad1781927ce0caa3eff0f8563","m7mdkamal","2019-11-07 19:17:35","false","Add OCIRuntime to info

Signed-off-by: Mohammed Kamal <m7mdkamal@live.com>

Closes: #1968
Approved by: rhatdan",82,33,0,0
"containers/buildah","588edb8c27f3b24372cb0a78a759c0bc76250766","rhatdan","2019-10-21 14:39:23","true","Merge pull request #1922 from tylarb/silence_using_cache

Silence ""using cache"" to ensure -q is fully quiet",77,33,0,1
"containers/buildah","441f2b825ef1893d44e2f460e5aba19ac04fa8e8","nalind","2019-09-11 14:19:13","false","Commit: check for storage.ErrImageUnknown using errors.Cause()

The storage library can return its errors wrapped in additional context,
so to do a direct comparison we need to dig down to the root cause.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",59,31,0,1
"containers/buildah","7a7e1f07ee7b16c2299f334cd8f551c3e4a0c4cb","TomSweeneyRedHat","2019-10-04 15:12:54","false","Bump back to v1.12.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1896
Approved by: rhatdan",67,32,0,1
"containers/buildah","0f7148bae580383257353468dd8dd435935dba06","rhatdan","2019-10-16 21:11:49","true","Merge pull request #1926 from rhatdan/master

Add OWNERS File to Buildah",80,33,0,1
"containers/buildah","13330a45a49648f39ff5697f56535dd16c8371fa","caiges","2019-10-05 22:15:02","false","Fix crash when invalid COPY --from flag is specified.

- Add a test for invalid COPY statements.
- Add missing dockerfile.

Signed-off-by: caiges <caigesn@gmail.com>

Closes: #1898
Approved by: TomSweeneyRedHat",68,32,0,0
"containers/buildah","e40069197023b93ccddd87b847baa2b6d4808aea","vrothberg","2019-10-02 13:12:15","true","Merge pull request #1890 from containers/dependabot/go_modules/github.com/cyphar/filepath-securejoin-0.2.2

Bump github.com/cyphar/filepath-securejoin from 0.2.1 to 0.2.2",65,32,0,1
"containers/buildah","27679eab00c3d6398dbcc0d5338826587e30992f","vrothberg","2019-09-30 12:17:59","false","update c/storage to v1.13.4

 * Update generated files
 * ImageBigData: distinguish between no-such-image and no-such-item
 * ImageSize: don't get tripped up by images with no layers
 * tarlogger: disable raw accouting

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",65,32,0,1
"containers/buildah","1dddf66acdcbbc376782fe29acb13fa1ed42728b","TomSweeneyRedHat","2019-09-13 13:50:44","false","Bump back to v1.12.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",61,31,0,1
"containers/buildah","7a7165aa48b957acce64cba9917ced30a5938136","rhatdan","2018-11-04 12:01:32","false","Change validation EPOCH

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",57,21,0,1
"containers/buildah","77c5300afff24d9cd1dc3bd2bb4d6054c3730564","baude","2018-03-13 13:53:32","false","Remove COPR

Working around this directly in the copr interface given that it is
too difficult to do upstream.

Signed-off-by: baude <bbaude@redhat.com>

Closes: #515
Approved by: rhatdan",18,14,0,0
"containers/buildah","40c3a57d5a8d2dbd712f083c46e05f958083dd0b","TomSweeneyRedHat","2018-01-16 20:26:52","false","Try to fix buildah-containers.md CI test issue

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #395
Approved by: rhatdan",30,12,0,1
"containers/buildah","07aa07716c76db7a84027593f398c82682470767","nalind","2018-09-12 18:34:05","false","Handle ErrDuplicateName errors from store.CreateContainer()

newBuilder(): When store.CreateContainer() returns a duplicate-name
error for a name that we just made up, try again with a different
made-up name.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1009
Approved by: rhatdan",38,19,0,1
"containers/buildah","643515e4184123828e7e106ba897353adc2252b0","TomSweeneyRedHat","2018-08-21 11:34:58","false","Update vendor for urfave/cli back to master

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #946
Approved by: nalind",28,19,0,1
"containers/buildah","6063bff02aab4ab5df5feb8b4ede447008d8f36d","edsantiago","2019-12-11 20:03:37","false","BATS major cleanup, step 3: yet more run_buildah

Replace plain 'buildah' invocations with run_buildah

For ease of review, this commit was entirely machine-generated via:

   $ perl -pi -e 's/^(\s+)buildah(\s)/${1}run_buildah${2}/' *.bats

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2029
Approved by: rhatdan",85,34,0,1
"containers/buildah","e7ca330f923701dba8859f5c014d0a9a3f7f0a49","runcom","2019-01-07 20:47:51","false","pkg/blobcache: add synchronization

Signed-off-by: Antonio Murdaca <runcom@linux.com>

Closes: #1265
Approved by: nalind",50,23,0,0
"containers/buildah","620fdee1a29123a6bff65c15f0be4225febabc4d","TomSweeneyRedHat","2018-11-27 14:32:36","false","Fix dangling filter for images command

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1201
Approved by: rhatdan",68,22,0,1
"containers/buildah","acc6acbb2cbbd2bc7f2d1b0398c296c8061f036a","TomSweeneyRedHat","2018-10-17 23:20:37","false","Run gofmt only on Go 1.11

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1110
Approved by: rhatdan",55,21,0,1
"containers/buildah","1be27294c9fa38234c2b004eec529438ef0cf21e","giuseppe","2018-10-09 08:50:23","false","imagebuildah: make ResolveSymLink public

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1076
Approved by: rhatdan",51,20,0,1
"containers/buildah","e9d18fc0f70602fe6c9235d2872afa2bd14861e4","rhatdan","2018-10-02 10:38:24","false","Bump to v1.5-dev

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1055
Approved by: TomSweeneyRedHat",43,20,0,1
"containers/buildah","a240912ff4a072dbe192db5d9e5e2791acf20620","TomSweeneyRedHat","2018-09-28 03:53:00","false","Ignore file not found removal error in bud

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1043
Approved by: rhatdan",39,20,0,1
"containers/buildah","f1a83a58c56674e058939c6d35f814a5406274f2","rhatdan","2018-09-19 12:55:48","true","Merge pull request #1018 from rhatdan/vendori

vendor in latest containers/image",36,20,0,1
"containers/buildah","e04613f05151ecdcd07071875fcce6219c254e18","boaz0","2018-09-03 11:20:52","false","Add flags/arguments order verification to one arg commands

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>

Closes: #984
Approved by: rhatdan",35,19,0,0
"containers/buildah","b955237b3ebdf6b18e5b4052871d7d029f1dccfe","TomSweeneyRedHat","2018-08-30 17:41:51","false","Update containers/image to fix commit layer issue

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #976
Approved by: rhatdan",33,19,0,1
"containers/buildah","5bcba1de64d46c1451668d13e9f15116fea0412a","TomSweeneyRedHat","2018-08-29 13:15:26","false","Update container/storage for lock fix

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #969
Approved by: rhatdan",31,19,0,1
"containers/buildah","9acf269110347c01fe20ca071c51d7416ff0e35d","TomSweeneyRedHat","2018-08-29 17:49:34","false","Touch up README.md for conformance tests

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #971
Approved by: rhatdan",32,19,0,1
"containers/buildah","a74bdd3ee2d3a3749cf6819b03bf6087d5ac2e18","QiWang19","2019-07-28 17:22:22","false","delete `successfully pushed` message

close #1742
Delete the line: `Successfully pushed...`

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1744
Approved by: TomSweeneyRedHat",48,30,0,1
"containers/buildah","0046d18a175856229c0984f7072d8f2f5dda49e5","rhatdan","2018-07-17 15:57:02","true","Merge pull request #864 from vrothberg/shebang

bash completion: remove shebang",31,18,0,1
"containers/buildah","a59fb7a66557741af2158358d233c15c173a2ff8","TomSweeneyRedHat","2018-06-30 19:48:53","false","Create Development plan

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #841
Approved by: rhatdan",27,17,0,1
"containers/buildah","f449b28f618e06fe47a3afdf9cf78040e9a3befa","rhatdan","2018-06-08 20:11:12","false","Switch buildah back to ErrorLevel

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #768
Approved by: rhatdan",32,16,0,1
"containers/buildah","fbc03e67b08ecd2994251838a893bb11812dca84","pixdrift","2018-06-10 10:46:04","false","Minor update to buildah config documentation for entrypoint

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #771
Approved by: rhatdan",32,16,0,0
"containers/buildah","9930e031cadc6efcbfe52b7cf801ef585b7f99ff","nalind","2018-06-14 22:04:02","false","Run(): simplify runCopyStdio()

Rework runCopyStdio() to remove the ""reading"" variable, and to reduce
cyclomatic complexity.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #795
Approved by: rhatdan",30,17,0,1
"containers/buildah","e9a2fd3498bd3bc423b45a5e27684650c79b387a","nalind","2018-05-17 21:50:13","false","Make it easier to parse our temporary directory as an image name

Make it easier to parse our temporary directory's name as an image name,
by making sure that we don't add '.' unnecessarily.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #705
Approved by: rhatdan",62,16,0,1
"containers/buildah","73820fc76a576d8891f52e0d67df052384c02afe","TomSweeneyRedHat","2018-06-12 18:43:56","false","Remove tty check from images --format

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #782
Approved by: rhatdan",33,17,0,1
"containers/buildah","10ca462c50f392fb8b97f38a2bf9666643ef686b","TomSweeneyRedHat","2018-06-09 18:41:46","false","Add registries.conf link to a few man pages

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #770
Approved by: rhatdan",32,16,0,1
"containers/buildah","0b86b161636b6ad3e733dfba0bcd474004432c89","kolyshkin","2022-01-18 03:20:56","false","util/resolveName: rm bool return

As pointed out by unparam linter, the bool returned by resolveName is
never used (at least since commit e1444dd71e11e0).

Also, since commit dcd2a92e56693e, resolveName is no longer public.

Remove the bool and the code which calculates it.

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","45772e84e41c787e6f4c40f4cf950a3491e5373f","TomSweeneyRedHat","2018-05-02 20:53:27","false","Add Files section with registries.conf to pertinent man pages

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #653
Approved by: rhatdan",48,15,0,1
"containers/buildah","966a4e19d065e017ffab46e2b12446bd4831e16b","rhatdan","2018-05-06 11:09:19","false","Declare Buildah 1.0

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #662
Approved by: rhatdan",52,15,0,1
"containers/buildah","d41282bc8a0c69445e2cd96a53cb07febb0c1b82","pixdrift","2018-05-03 05:25:15","false","Fix formatting error in run.go

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #656
Approved by: rhatdan",48,15,0,0
"containers/buildah","25367267fc51cf2b9dcade6a900ca66bd6fbcd2d","TomSweeneyRedHat","2018-03-17 18:16:33","false","Switch which for that in README.md

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #519
Approved by: rhatdan",19,14,0,1
"containers/buildah","cd999fa46373953f16565fb1c0eea279b71796c9","TomSweeneyRedHat","2018-03-18 00:03:22","false","Allow --cmd parameter to have commands as values

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #520
Approved by: rhatdan",19,14,0,1
"containers/buildah","032b56ee8d2f824dc108143956836ef85194a288","umohnani8","2018-02-06 21:02:38","false","Vendor in latest containers/image

Adds support for default certs directory to be /etc/containers/certs.d

Signed-off-by: umohnani8 <umohnani@redhat.com>",35,12,0,1
"containers/buildah","dd4a6aea97834e6db2e68b9bacb16d763078de55","baude","2018-02-08 21:23:50","false","COPR enablement

For COPR builds, we will use a a slightly modified spec and the
makesrpm method over SCM builds so we can have dynamic package
names.

Signed-off-by: baude <bbaude@redhat.com>

Closes: #460
Approved by: rhatdan",34,12,0,0
"containers/buildah","6bad262ff123ef15f3fcdb26d1c53a037f973a2d","rhatdan","2018-01-16 19:30:43","false","Bump to version 0.11

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #394
Approved by: @ripcurld0",30,12,0,1
"containers/buildah","57841cce775b697bbad727f4a53e686fb0ab2857","nalind","2017-01-27 12:24:41","false","Rename: stevedore -> lumper

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","7e042a93083ae0e5d260f03a475dde5af8ff6be5","rhatdan","2017-06-07 11:48:10","false","Cleanup man pages

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #137
Approved by: nalind",13,4,0,1
"containers/buildah","3065ea3d16a4a7162e5463602668eeff80b875d1","nalind","2017-05-19 18:13:15","false","Add a ""tag"" command

Add a ""tag"" command, for adding names to locally-stored images.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #110
Approved by: rhatdan",15,4,0,1
"containers/buildah","d0a4816fe1da91955a4102a1ce131d13e2091a5f","nalind","2017-01-28 05:24:04","false","Ensure that we always set GOPATH right for builds

Do some symlink-based trickery to make sure that we can always set
GOPATH to a value that we expect to work.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","59139af5c74edc48e49e98f17c0d76ef1e49ebd6","nalind","2017-01-27 14:38:32","false","Add the container layer to the image metadata

Add the container's layer to the layer list in the image configuration,
along with a history entry for it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","84afb117be57958dec9f6e0b0db4289c8a728b87","nalind","2017-01-27 21:20:28","false","Roll back to stable versions of some of our deps

Roll back to slightly older versions of some of our dependencies in
order to get them all to play well together.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","5a2e7ac56135c756fb78e5e979abd278cb89fef5","nalind","2017-01-28 05:09:49","false","Make the --signature-policy flag ""from""-only

Change the --signature-policy flag from being a global option to being
specific to the ""from"" command, which is the only place it's used.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","8b7705022a7807a4afaef4cf21baee2be8794152","nalind","2017-01-26 16:59:13","false","Initial commit",0,0,0,1
"containers/buildah","28453dc3c372d027edb742a5352f23288f0ef63f","umohnani8","2021-02-04 19:14:59","false","Fix build arg check

Fix the check on build args to be the length of the map
and not whether the map is nil. The nil check was causing
the cache layer to not be used as it would give a false
result.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>",96,48,0,1
"containers/buildah","1ad4873713216b7101c4622c0e5db5d35a7486b0","zhangguanzhang","2020-10-13 01:30:01","false","Fix build path wrong https://github.com/containers/podman/issues/7993

Signed-off-by: zhangguanzhang <zhangguanzhang@qq.com>",63,44,0,0
"containers/buildah","2c8436a778d39200b6ee11692b79db74d5153c4d","dfr","2022-07-08 14:25:31","false","Remove import of github.com/pkg/errors

Signed-off-by: Doug Rabson <dfr@rabson.org>",21,65,1,0
"containers/buildah","691c394956305817ede675129856b5493cdff287","nalind","2019-09-10 22:21:07","false","buildah: add a ""manifest"" command

Add an initial version of a ""manifest"" command.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1902
Approved by: rhatdan",59,31,0,1
"containers/buildah","15aa8ee735d6af9f1ef03b8129bc5792fffd09fd","openshift-merge-robot","2022-10-25 12:33:54","true","Merge pull request #4374 from mwq/patch-1

Fix word missing in Container Tools Guide",25,69,1,1
"containers/buildah","c0a7873e2c557a89e619a286846db4b29a6b57ca","nalind","2020-12-11 18:24:04","false","copier: Put: skip entries with zero-length names

When extracting archives, if we encounter an entry with a zero-length
name, skip it, instead of attempting to Join the entry's name with the
name of the parent directory where it should be placed (which just
yields the parent directory's name again), and attempting to create that
directory again, possibly as a file.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",79,46,0,1
"containers/buildah","002c18a3bb21c97b4a67e765a32ffd1be6d5c524","nalind","2018-06-07 15:25:47","false","Break out SetupIntermediateMountNamespace()

Break runSetupIntermediateMountNamespace() into its own package.
Move stringInSlice(), getHostIDs(), and getHostRootIDs() into the util
subdirectory and export them.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #796
Approved by: rhatdan",31,16,0,1
"containers/buildah","3b44a3e3b3bfa4079cf2adcbf0a88e2915171ab8","nalind","2017-03-07 18:26:17","false","Simplify copy/add logic to better match dockerd's

Simplify our implementation of copy/add to always assume that the
destination location will be a directory.  Trying to be cleverer, like
cp is, would just be confusing.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","3d755b5eb73428cedea775dc45ba199f79277105","nalind","2022-11-09 20:18:02","false","copier.Put(): clear up os/syscall mode bit confusion

When noting that a non-symlink has setuid/setgid/sticky bits, switch
from using ""syscall"" package bits and syscall.Chmod() to using ""os""
package bits and os.Chmod(), and if the item's a directory, record the
updated mode information in the ""directoryModes"" map that we'll use to
reset its permissions later.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",23,69,1,1
"containers/buildah","a2765bb1bee340c700491611b6baf4355a7c2ce5","lsm5","2017-09-20 06:47:36","false","update README.md to remove Debian mentions

ppa install steps mentioned in README.md work only for Ubuntu xenial and
zesty so far.

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",33,8,0,1
"containers/buildah","9613a07e06698cf5f6112e866d7390049e552651","rhatdan","2022-08-28 10:40:26","true","Merge pull request #4201 from lsm5/bump-cirrus-image

Cirrus: use image with fewer downloaded dependencies",16,67,1,1
"containers/buildah","f2ef995e8a42d6609ae25ecf90c17281798f39b9","rhatdan","2021-03-29 17:17:06","true","Merge pull request #3110 from zturtleman/mutli-url

Fix URL in demos/buildah_multi_stage.sh",52,50,0,1
"containers/buildah","15773bd532210f351a9befe783f5d8b157dd0228","rhatdan","2019-09-04 14:14:53","true","Merge pull request #1834 from openSUSE/interfacer

Enable interfacer linter and fix lints",59,31,0,1
"containers/buildah","072ee88817e673e8b8a13a8f43560a290f8de530","rhatdan","2018-04-26 16:35:16","false","Add --compress, --rm, --squash flags as a noop for bud

We don't have a client server operation, so there
is no reason to compress the input.

We don't currently support cache so --rm and --squash are NOOPS

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #639
Approved by: rhatdan",50,15,0,1
"containers/buildah","7793c51a419870b0151cdda3e5e14c97df5e8b6d","rhatdan","2019-05-16 13:16:57","false","Fix rootless handling of /dev/shm size

Rootless mode was ignoreing the --shm-size option.
For some reason the test that would have caught this was disabled.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1595
Approved by: vrothberg",55,28,0,1
"containers/buildah","19e44f087d5371c86a75bb2ab904c5b98519fa69","rhatdan","2018-09-18 13:39:13","true","Merge pull request #1023 from rhatdan/github

Move buildah from projecatatomic/buildah to containers/buildah",37,20,0,1
"containers/buildah","ae451b721afacf3d8edbf1d808b673b6b5ad38e4","nalind","2018-06-19 17:58:09","false","Set BUILDAH_ISOLATION=rootless when running unprivileged

When we're run by an unprivileged user, default to BUILDAH_ISOLATION=rootless.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #873
Approved by: rhatdan",30,17,0,1
"containers/buildah","ac43c1db450bfcb37c497b8a07af4363ca722652","vbatts","2018-08-02 13:56:39","true","unshare: error message missed the pid

Signed-off-by: Vincent Batts <vbatts@hashbangbash.com>",28,18,0,0
"containers/buildah","3223610ffe8f84d0adc27103b7cbb43ba4d9cef3","flouthoc","2022-10-10 06:24:09","true","imagebuildah: pull cache from remote repo after adding content summary

For certain instruction actual history matching makes sense after conent
summary is processed and added, In such cases generated `cacheKey` for
distributed cache is changed hence for such cases attempt to pull
available cache from remote repo once `cacheKey` is generated again
after adding content summary.

Example use case which works with `--cache-from` and `--cache-to` after
this commit.

```Dockerfile
FROM alpine
ARG VAR=hello
RUN echo ""Hello $VAR""
```

Closes: https://github.com/containers/buildah/issues/4315

Signed-off-by: Aditya R <arajan@redhat.com>",28,68,1,1
"containers/buildah","8dca0a65bde073363f367383cb95e8ba81d5ed07","flouthoc","2022-06-17 07:54:41","true","test: verify feature to resolve basename with args

Buildah now supports resolving base args with user args or default args
so add a test which verifies this behaviour.

Allowed use cases

```Dockerfile
FROM --platform=linux/amd64 alpine as platform-amd64

FROM --platform=linux/arm64 alpine as platform-arm64

FROM platform-${TARGETARCH}
```

Closes: https://github.com/containers/podman/issues/14375

Signed-off-by: Aditya R <arajan@redhat.com>",22,65,1,1
"containers/buildah","c9cb148e1b70ae723d4d2d6d2449a9039e358f8a","umohnani8","2018-11-18 20:10:26","false","Fix cache issue with COPY/ADD --from

In multi-stage builds, it is possible to copy data from
a previous build. When using cached images, buildah wasn't
able to detect a change in the previous build and would proceed
to use cached images. Fix buildah bud to be keep track of any
files coming from a previous build and checking whether the cached
image is stll valid or not.
Also fix removal of intermediate build containers when building
from cache. We were not keeping track of those containers so they
weren't getting deleted at the end of the build process.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>

Closes: #1182
Approved by: TomSweeneyRedHat",64,22,0,1
"containers/buildah","d355f95e253ea67723ba3e3262a7e6971696fb5d","ypu","2018-11-15 08:26:28","false","Simplify CompareJSON() in conformance test

Simplify the if branch to make it more readable.

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #1178
Approved by: rhatdan",63,22,0,0
"containers/buildah","6348eb3a0e34b331ed90f2c53ef8c67fcd0b0a5d","Luap99","2020-10-01 15:29:24","false","Bump c/common to v0.24.0

Signed-off-by: Paul Holzinger <paul.holzinger@web.de>",88,44,0,0
"containers/buildah","c1a3cd186a62e61962c661f17b32be83835e1e5a","openshift-merge-robot","2022-05-06 10:25:03","true","Merge pull request #3971 from rhatdan/main

[CI:DOCS] Fix gentoo install docs",24,63,1,1
"containers/buildah","f589dbdda10d2a6ef160664c23c729109b5baa79","openshift-merge-robot","2022-05-12 11:20:58","true","Merge pull request #3983 from giuseppe/vendor-storage-image

vendor: update c/storage and c/image",24,64,1,1
"containers/buildah","c45bfcc8aa22574a9a7d2651231c2c84d35bac7a","openshift-merge-robot","2022-04-28 11:33:04","true","Merge pull request #3936 from nalind/copier-sticky-bit

copier.PutOptions: add StripSetuidBit/StripSetgidBit/StripStickyBit",26,63,1,1
"containers/buildah","494e0a9c3f045017610b675b9973de3c26628f37","openshift-merge-robot","2022-03-29 12:17:47","true","Merge pull request #3867 from rhatdan/walk

Switch most calls to filepath.Walk to filepath.WalkDir",28,62,1,1
"containers/buildah","28c96efe5ce6abfb0735ffc5788bb262dbac09b8","openshift-merge-robot","2022-03-24 09:01:28","true","Merge pull request #3841 from edsantiago/give_a_hoot

Don't pollute",31,62,1,1
"containers/buildah","c023f92608741c02a288693a464820fdcc092796","openshift-merge-robot","2022-03-25 09:15:15","true","Merge pull request #3859 from TomSweeneyRedHat/dev/tsweeney/bumpcs

Bump c/storage to v1.39.0 in main",30,62,1,1
"containers/buildah","6ad9ec3912b1d38f697c4e64471b80c721a71e4e","giuseppe","2022-03-24 16:00:48","true","Merge pull request from GHSA-c3g4-w6cv-6v7h

do not set the inheritable capabilities",31,62,1,1
"containers/buildah","cf6d58b631216758fb65cdc1499de1d8eaf8c79d","openshift-merge-robot","2022-03-09 18:20:13","true","Merge pull request #3812 from flouthoc/test-rootless-unshared

buildah: increase rootless test coverage with `rootless + unshare`",30,61,1,1
"containers/buildah","ecaee004213992947e540bff7b26fc773db9496e","openshift-merge-robot","2022-03-21 20:58:47","true","Merge pull request #3830 from containers/dependabot/go_modules/github.com/containers/ocicrypt-1.1.3

build(deps): bump github.com/containers/ocicrypt from 1.1.2 to 1.1.3",31,62,1,1
"containers/buildah","a4c57068fac96b3c2c3a417a80dadc4296d0f357","flouthoc","2022-03-14 08:28:52","true","buildkit: mount=type=cache support locking external cache store

A shared cache on host must support locking so other parallel/concurrent builds
will wait for current executing RUN statement to finish.

* Locks the cache store as soon as RUN is triggered.
* Locked target is added to cleanup list so it can be unlocked as soon
  as RUN step is completed.

Signed-off-by: Aditya R <arajan@redhat.com>",30,62,1,1
"containers/buildah","e7e55c988c05dd74005184ceb64f097a0cfe645b","giuseppe","2022-02-28 09:38:48","true","do not set the inheritable capabilities

The kernel never sets the inheritable capabilities for a process, they
are only set by userspace.  Emulate the same behavior.

Closes: CVE-2022-27651

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",31,61,1,1
"containers/buildah","165e984b50164459617c0acb0c787af2d392a47e","flouthoc","2022-03-03 10:36:49","true","buildah: test rootless integration

Add cirrus boiler plate for rootless testing infrastructure.
Following commit introduces only neccassary foundation and skeleton
which will be used by rootless testing of buildah.

[NO NEW TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",29,61,1,1
"containers/buildah","5eccef1482c90d69cd9e9b06d95e464ef94a5303","flouthoc","2022-03-05 09:08:42","true","cirrus: add seperate task and matrix for rootless

Split rootless testing into its own cirrus task and do not merge it with
existing rootless tests.

Signed-off-by: Aditya R <arajan@redhat.com>",30,61,1,1
"containers/buildah","df864f102f240c4a6908610730a69549c17f1bdb","openshift-merge-robot","2021-04-29 19:14:50","true","Merge pull request #3190 from edsantiago/master

pr-should-include-tests: try to make work in buildah",50,51,0,1
"containers/buildah","5422557852a4c89897a7c38c58c0dd142d657939","openshift-merge-robot","2023-06-26 20:27:07","true","Merge pull request #4877 from Luap99/pasta-slirp4netns

add support for pasta(1) and slirp4netns options",13,77,1,1
"containers/buildah","b0e4e9a8d331b135b41874f7116f352f4b7c81fc","openshift-merge-robot","2022-10-17 14:58:17","true","Merge pull request #4345 from lsm5/containers-common-extra

[CI:BUILD] copr: buildah rpm should depend on containers-common-extra",27,69,1,1
"containers/buildah","a3810633dce097b0209e67911d004acfd656ed44","openshift-merge-robot","2021-10-27 17:38:17","true","Merge pull request #3601 from flouthoc/set-network-policy

networkpolicy: Should be `NetworkEnabled` instead of `NetworkDefault` when explictly set",32,57,1,1
"containers/buildah","96d1be70e4bde0bd49536305e6902dc6c4ef16a0","openshift-merge-robot","2023-09-28 16:49:50","true","Merge pull request #5062 from flouthoc/unset-label

build,config: add support for `--unsetlabel`",10,80,1,1
"containers/buildah","010a18c1d0f8bb286d730a42efb426b6d6b17e8e","openshift-merge-robot","2023-07-13 17:56:22","true","Merge pull request #4924 from lsm5/golist-gopath

[CI:BUILD] Packit: downstream task script needs GOPATH",13,78,1,1
"containers/buildah","17e6fe01c2afdde8767a13202829435d8ac6974a","flouthoc","2022-08-10 10:59:27","false","docs: specify git protocol is not supported for github hosted repo

Build from URL does not supports `git://` is source is hosted on Github.
Reason: https://github.blog/2021-09-01-improving-git-protocol-security-github/

[CI:DOCS]
[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]

Closes: https://github.com/containers/buildah/issues/4103

Signed-off-by: Aditya R <arajan@redhat.com>",17,66,1,1
"containers/buildah","3f2df82e4d9c9e2e1ad3d57601082e057bd0b69e","openshift-merge-robot","2022-06-07 17:28:32","true","Merge pull request #4043 from vrothberg/nondirdir

copier: add `NoOverwriteNonDirDir` option",22,64,1,1
"containers/buildah","7ea81422fbaf724bd45a5951aed3399c0de2c9d2","openshift-merge-robot","2021-11-23 13:49:15","true","Merge pull request #3645 from rhatdan/localip

Make LocalIP public function so Podman can use it",29,58,1,1
"containers/buildah","5b0de7b12e0644b1994cef290a9cdccca4ed57b0","openshift-merge-robot","2021-09-25 15:49:38","true","Merge pull request #3538 from dilyanpalauzov/makefile_gccgoflags

Makefile: adjust -ldflags/-gcflags/-gccgoflags depending on the go implementation",39,56,1,1
"containers/buildah","2eb97b499d74091fa3b1f4eabf8f95879176b988","openshift-merge-robot","2021-07-07 13:35:12","true","Merge pull request #3358 from vrothberg/vendor-common

vendor containers/common@main",38,53,1,1
"containers/buildah","3eb7d56498ea1f8d66c048e6b58f59ffe55acc66","openshift-merge-robot","2021-04-13 17:03:47","true","Merge pull request #3140 from edsantiago/refactor_test_helper

bats helpers.bash - minor refactoring",52,51,0,1
"containers/buildah","7071f65638b3570b19e636839ebf69b2768d8b47","openshift-merge-robot","2020-11-23 10:42:03","true","Merge pull request #2815 from rhatdan/secrets

Switch to using containers/common pkg's",79,46,0,1
"containers/buildah","44614d9fe80820f8abb7b8411bc40fa7c516e52b","TomSweeneyRedHat","2020-08-07 23:08:40","false","Handle COPY --from when an argument is used

When an argument was passed into ""COPY --from"" command in
a Containerfile like

COPY --from=${toolchainname}

The argument was never resolved to the value that it had been
set to.

Addresses: #2496

It may also address #2404 but I've not yet tested.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",82,42,0,1
"containers/buildah","d2e0cd8988a8e2524265266adf2dd0b163c5baaf","rhatdan","2020-07-14 17:29:07","true","Merge pull request #2434 from giuseppe/no-kill-error

linux: skip errors from the runtime kill",147,42,0,1
"containers/buildah","1497e5af35ed499ea2c827465b25f13edc717a28","nalind","2017-01-28 05:20:22","false","Suss out build tags, add a missing Travis dep

Figure out the right build tags to use for btrfs and libdm support, and
make sure we tell Travis to install libgpgme11-dev, because we also
build against it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","90a2137d81f3f3644b8a862e3c9e82842d99ec74","vrothberg","2019-06-18 11:44:41","false","pkg/unshare: check all errors

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","c97b61539af774a11b636713cee8a326d3346863","vrothberg","2019-06-18 11:27:34","false","tests/imgtype: ignore error when shutting down the store

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","7775e0f751aac96462de318d8306ce0de76025ea","rhatdan","2021-02-10 20:35:32","false","Fix tutorial for rootless mode

Users have gotten confused when attempting the introduction turturial in
rootless mode.  Explain that they have to `buildah unshare` before
mounting the image.

Fixes: https://github.com/containers/buildah/issues/2833

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",88,48,0,1
"containers/buildah","37ecc5d42a6e6d81212412fd749533895570498e","rhatdan","2018-04-19 08:52:24","false","Simple changes to allow buildah to pass make validate

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #606
Approved by: rhatdan",36,15,0,1
"containers/buildah","4976d8c58367e835280125e6843a279cd8843b18","rhatdan","2018-07-25 21:54:56","false","Vendor latest container/storage to fix overlay mountopt

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #885
Approved by: TomSweeneyRedHat",30,18,0,1
"containers/buildah","b08544310213a5a1f93274cf62091a4672e4db42","openshift-merge-robot","2021-05-19 21:22:27","true","Merge pull request #3241 from rhatdan/containerfile

Don't blow up if cpp detects errors",56,52,1,1
"containers/buildah","d87b736c39219009693c3dbc553ae786c0fb236a","openshift-merge-robot","2022-12-22 20:32:58","true","Merge pull request #4479 from rhatdan/group

Add support for --group-add to buildah from",19,71,1,1
"containers/buildah","8288f4b4a3e013c0bc0fb4ec8730e5f817586c6f","openshift-merge-robot","2021-05-05 21:27:36","true","Merge pull request #3205 from rhatdan/cleanup

codespell cleanup",51,51,0,1
"containers/buildah","9411e927cdcb7b92e00ba2625592a97a5605b4c6","cevich","2020-01-13 17:56:13","true","Bors: Enable app + Disable Travis

Add initial support for Bors-ng replacement for Homu providing ""ever
green"" merges of PRs.  Ref: https://bors.tech/

Note: Bors-ng cannot deal with tasks marked 'skipped' by Cirrus-CI when
testing or attempting a merge. All tasks must always run on all except
temporary branches.  The only significant marker for a required-for-merge
task are the status/pr-status name match strings in `bors.toml`.

Signed-off-by: Chris Evich <cevich@redhat.com>",101,35,0,1
"containers/buildah","04965f1198104afafd22197a479bd15c9b43148e","TomSweeneyRedHat","2023-04-07 00:51:40","false","Bump to v1.30.0

[NO TESTS NEEDED]

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",11,74,1,1
"containers/buildah","a1d22a220849a30fd9f510c2aef7b1ef16e62c1b","rhatdan","2022-11-16 21:35:31","true","Merge pull request #4419 from slonopotamus/patch-1

Fix installation instructions for Gentoo Linux",23,70,1,1
"containers/buildah","1fbf4a2f8ac8f7c4373d65663b69075632a22903","rhatdan","2021-04-20 17:52:29","false","build(deps): bump github.com/containers/image/v5 from 5.10.5 to 5.11.1

Bumps [github.com/containers/image/v5](https://github.com/containers/image) from 5.10.5 to 5.11.1.
- [Release notes](https://github.com/containers/image/releases)
- [Commits](https://github.com/containers/image/compare/v5.10.5...v5.11.1)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",50,51,0,1
"containers/buildah","410c866212b9890fb596514853e189c89e046f58","rhatdan","2021-07-19 12:57:54","false","Just restore protections of shadow-utils

Base images don't have shadow-utils permissions set correctly, this
change should speed up the building of images a little bit.

[NO TESTS NEEDED] This does not change buildah in any way, so no need to
tests.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",43,54,1,1
"containers/buildah","2aa4c7982558dea6f9f1638b2bf3264df00e75c1","rhatdan","2020-09-16 12:02:05","true","Merge pull request #2626 from rhatdan/man

Add missing --format option in buildah from man page",91,44,0,1
"containers/buildah","c19c8f9503db6032d0e11bda40247fde5d773cbe","rhatdan","2017-09-18 14:42:04","false","Merge pull request #261 from vbatts/example

examples: adding a basic lighttpd example",34,8,0,1
"containers/buildah","e623e5c004b31428dce156fc05a639cb06bd8f4b","baude","2018-02-12 15:45:12","false","Initial ginkgo framework

This is an initial attempt at bringing in the ginkgo test framework into
buildah.  The inspect bats file was also imported.

Signed-off-by: baude <bbaude@redhat.com>

Closes: #472
Approved by: rhatdan",16,13,0,0
"containers/buildah","427cc1dd0f840b98d8756852023f4747d490144e","nalind","2017-06-12 13:34:37","false","Fix ""unmount"" bash completion

Fix the infinitely self-recursing, but immediately replaced, version of
the ""umount"" completion function with the missing ""unmount"" completion
function.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #143
Approved by: rhatdan",13,4,0,1
"containers/buildah","b965fc4cdb11477138a9667b0cdb5c2841786669","nalind","2018-06-28 19:09:01","false","runConfigureNetwork(): remove an unused parameter

Remove the configureNetwork parameter from runConfigureNetwork(), which
was only called if the value was true, and which runConfigureNetwork()
itself never used.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #834
Approved by: rhatdan",28,17,0,1
"containers/buildah","9175ccea8489dc8433377d61060b0a7a24b8defb","nalind","2018-08-09 23:18:34","false","chroot: correct a comment

We're specifying the MS_RDONLY flag, so don't suggest that we're doing a
read-write mount.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #923
Approved by: rhatdan",23,18,0,1
"containers/buildah","31064fcda104db86779d5c0ea96bb40ee3229ca0","TomSweeneyRedHat","2018-10-15 22:50:56","false","Set WorkingDir to empty, not / for conformance

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1098
Approved by: rhatdan",52,21,0,1
"containers/buildah","73ed7a50004f9be3c836e0a4b42efe728f41ef34","TomSweeneyRedHat","2018-06-06 18:50:42","false","Add disable-content-trust noop flag to bud

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",37,16,0,1
"containers/buildah","6c05a352df3dd5c6c5ceb3ad75c15e2a7cb2db53","TomSweeneyRedHat","2018-01-31 00:19:30","false","Add authfile param to commit

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #433
Approved by: rhatdan",39,12,0,1
"containers/buildah","728f6411793cf3dcb75309862f34cafc1283ced5","TomSweeneyRedHat","2017-07-25 11:16:48","false","Update README.md with buildah pronunciation

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #210
Approved by: rhatdan",18,6,0,1
"containers/buildah","cec864147c00e59eb3679e5034a9f0a5e147fd1a","edsantiago","2022-11-02 13:29:00","false","remove unnecessary (hence misleading) rmi

A recently-added test included an unnecessary ""rmi --prune"".
Unnecessary code causes brain fatigue in maintainers trying
to understand its purpose. Kill it.

I've confirmed that tests pass under buildah root & rootless
and podman local & remote.

Signed-off-by: Ed Santiago <santiago@redhat.com>",24,69,1,1
"containers/buildah","2167b3098d2c0d8449d2bc6e29d8b6fbb8920c2c","rhatdan","2018-07-15 10:42:33","false","Update vendor for runc to fix 32 bit builds

Current runc builds will not build on 32 bit systems

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #863
Approved by: ripculd",31,18,0,1
"containers/buildah","11ecacf477209f7626a0d75680b02979565ca250","rhatdan","2021-05-18 13:55:25","false","Fix handling of --default-mounts-file

Fixes: https://github.com/containers/buildah/issues/3233

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",55,52,1,1
"containers/buildah","b0dc4edbae6894980f9ec3dc9f168f9d5c0c3206","rhatdan","2022-03-11 09:59:14","true","Merge pull request #3818 from containers/dependabot/go_modules/github.com/spf13/cobra-1.4.0

build(deps): bump github.com/spf13/cobra from 1.3.0 to 1.4.0",31,62,1,1
"containers/buildah","ef0ca9cd2d69e8ca70d07e19386c676ae4985644","rhatdan","2018-02-22 14:18:53","false","Bump to v0.13

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #488
Approved by: TomSweeneyRedHat",18,13,0,1
"containers/buildah","b9983a6b27379b73699754b91be7b8e70649b42c","rhatdan","2018-06-10 21:21:21","true","Merge pull request #769 from rhatdan/version

Bump to Version 1.1",32,16,0,1
"containers/buildah","06e63758ff088ede37fc1a336e48bfa43ffaee62","rhatdan","2023-09-28 18:57:03","true","Merge pull request #5021 from danishprakash/fix-containerignore-buildcontext

imagebuildah: consider ignorefile with --build-context",9,80,1,1
"containers/buildah","bba9981ead5cf452d23dfe7c8687c3cea1d282c6","rhatdan","2023-05-05 01:43:03","true","Merge pull request #4755 from flouthoc/proper-cleanup-after-run-step

run,mount: remove path only if they didnt pre-exist",9,75,1,1
"containers/buildah","33d056c2addee93cc0a59cc04cc4fcb460fc9a93","rhatdan","2022-03-24 17:18:53","true","Merge pull request #3843 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.2

build(deps): bump github.com/containerd/containerd from 1.6.1 to 1.6.2",31,62,1,1
"containers/buildah","b1d14767f32f59e544f3e6522208ef4be31a9675","QiWang19","2019-03-19 18:28:54","false","fix bug using .dockerignore

Exclude(or copy,add) files match with patterns in .dockerignore when bud with ADD or COPY in Dockerfile.

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1403
Approved by: TomSweeneyRedHat",37,26,0,1
"containers/buildah","0d2fcd9cb84fbb906257db89698dc1fb155c7ed4","vrothberg","2021-01-14 09:08:31","false","use local image name for pull policy checks

Some pull policies require to first look up a local image and compare
that to the remote counter part.  When looking up the remote image, we
need to make sure to use the name of the local image, if it exists.

This fixes a bug where a short name resolved to an image with the
""localhost/"" prefix.  This prefix is only used for local image look ups
via `shortnames.ResolveLocally`.  Hence, when looking up the remote
counter part, we must preserve this prefix.

Fixes: #2904
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",94,47,0,1
"containers/buildah","b6f32e57666800f16bcccecd32ddcd1081e9f12c","danishprakash","2023-03-15 09:55:37","true","imagebuildah: set len(short_image_id) to 12

* tests/bud.bats: add test

Signed-off-by: danishprakash <danish.prakash@suse.com>",15,74,1,0
"containers/buildah","289c512c0de2a4d4a6c0fc5c1adb96d0e905e6d9","nalind","2018-10-04 21:57:38","false","chroot: fix capabilities list setup and application

Correctly handle setting capabilities: the Clear() and Apply() methods
on the Capabilities interface take a bitmask of capability kinds, not
specific capability types.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1069
Approved by: rhatdan",51,20,0,1
"containers/buildah","e63b5d4586a4180773e9af950684915bf11957a6","nalind","2017-04-11 22:18:35","false","imagebuildah: Prepare() accepts a source image now

Update to mimic an API change in imagebuilder, which now allows us to
provide the FROM image directly via an API, potentially overriding the
first one named in the Dockerfile.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #83
Approved by: rhatdan",13,3,0,1
"containers/buildah","a147475921e7d93b9c609572cc35044e03aa5f22","nalind","2020-10-09 14:09:05","false","copier: log stderr output as debug on success

When a subprocess exits successfully, log its stderr output at debug
priority instead of just discarding it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",62,44,0,1
"containers/buildah","3163a98bdd4d7bc0f469ad47bede0ca8eeff3176","nalind","2017-06-01 16:11:14","false","Add a ""push"" command

Add a ""push"" command, which pulls an image's layers from local storage,
recomputes the image's digest and manifest, and uses the image library
to write the result to the specified location.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #141
Approved by: rhatdan",13,4,0,1
"containers/buildah","6e723f5a0add4de7ee55bdb929f70e883cddfa24","edsantiago","2021-04-29 15:40:50","false","run.bats: fix flake in run-user test

The run-user test creates a test user with random UID and GID.
If the randomly-picked UID matches that of an existing account,
the test will flake because the account's default group will
almost certainly not match the one we generated.

Solution: only pick UIDs and GIDs that are not already present
in the container image.

Signed-off-by: Ed Santiago <santiago@redhat.com>",50,51,0,1
"containers/buildah","3445a775a0b47afa6b4a3ccbb529fa10112a38b1","flouthoc","2023-08-11 10:24:46","true","vendor: bump c/common to v0.55.1-0.20230811093040-524b4d5c12f9

Signed-off-by: Aditya R <arajan@redhat.com>",10,78,1,1
"containers/buildah","1707234aba36cde8f7fc3798f016f45af01c18bf","vrothberg","2018-07-16 06:43:50","false","bash completion: remove shebang

Address rpmlint warning by removing the shebang as the completion script
isn't meant to be an executable.

Signed-off-by: Valentin Rothberg <vrothberg@suse.com>",31,18,0,1
"containers/buildah","1b49e62a7a85a3c1f807d945759589fd0b5f8e6d","openshift-merge-robot","2021-02-22 19:13:41","true","Merge pull request #3030 from containers/dependabot/go_modules/github.com/sirupsen/logrus-1.8.0

build(deps): bump github.com/sirupsen/logrus from 1.7.0 to 1.8.0",61,49,0,1
"containers/buildah","69b3e56a0abf7652fd13fca03fee176f27cb78c2","openshift-merge-robot","2021-09-14 10:13:54","true","Merge pull request #3516 from rhatdan/bump-1.23.0

Bump 1.23.0",39,56,1,1
"containers/buildah","6d35f7e1bea43118db6fb48c74af7f2191b631c0","openshift-merge-robot","2023-05-17 19:15:01","true","Merge pull request #4801 from edsantiago/rollback_llimdaert

Revert ""Proof of concept: nightly dependency treadmill""",14,76,1,1
"containers/buildah","693e8413d957820f0d7c21d38a4984e725c7b113","openshift-merge-robot","2020-10-30 09:59:30","true","Merge pull request #2732 from TomSweeneyRedHat/bump-1.17.0

Bump 1.17.0",67,45,0,1
"containers/buildah","ffe9a0f356729e5a5f2378ea383cdf9d40491bb9","openshift-merge-robot","2022-02-28 19:35:20","true","Merge pull request #3797 from flouthoc/docker-build-inherit-healthcheck

executor: docker builds must inherit `healthconfig` from baseImage if any and new build does not overrides.",32,61,1,1
"containers/buildah","bdb5ec6ccf578c62596b524a9adbfa37664a0fab","openshift-merge-robot","2022-05-17 20:35:09","true","Merge pull request #4000 from edsantiago/bats_fixes

test cleanup",25,64,1,1
"containers/buildah","ff17d740bc1658b59fc76562f4206691dcd0849e","openshift-merge-robot","2021-04-24 10:16:41","true","Merge pull request #3183 from lsm5/crun-runc

[CI:DOCS] Update steps for CentOS runc users",50,51,0,1
"containers/buildah","0d8da0ab6ebbdaf05c729af4502e890872942036","openshift-merge-robot","2021-03-03 10:01:18","true","Merge pull request #3015 from nalind/copier-mkdir-first

ADD/COPY: create the destination directory first, chroot to it",59,49,0,1
"containers/buildah","0e5768490fea493a7fd9db696ebb4fc63deb7d72","openshift-merge-robot","2022-10-06 22:43:02","true","Merge pull request #4321 from edsantiago/refactor_contextdir

bud.bats refactoring: $TEST_SCRATCH_DIR",27,68,1,1
"containers/buildah","33d3c3f0fc3a0471b66b626d5470aa3e01a9ef3c","hswong3i","2020-10-21 05:23:23","true","Update nix pin with `make nixpkgs`

Signed-off-by: Wong Hoi Sing Edison <hswong3i@pantarei-design.com>",64,45,0,0
"containers/buildah","f90b6c0fff687c3f1453475ef4f4b1fd5727fd36","TomSweeneyRedHat","2018-06-02 20:06:54","false","Add context dir to bud command in baseline test

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #748
Approved by: rhatdan",38,16,0,1
"containers/buildah","a6cf065c9eccfbaba6d093518da1f52e37d7cd46","TomSweeneyRedHat","2020-01-17 16:07:21","false","Remove cut/paste error in CHANGELOG.md

Remove a line that should have been removed from
CHANGELOG.md after cutting and pasting.

This PR replaces #2089

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",101,36,0,1
"containers/buildah","dc1bc10df64dccecf40f662e018296bc4cb19008","dfr","2022-07-15 12:17:48","false","Add FreeBSD support for 'buildah info'

On non-windows platforms, we can use the uname syscall to get kernel
version information. For uptime, we can use clock_gettime(CLOCK_UPTIME)
on FreeBSD but I don't have a solution for darwin or windows.

Note: the existing code which unconditionally reads from /proc builds
on all platforms but only works on linux since using /proc in this way
is a linux feature.

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",25,66,1,0
"containers/buildah","168c5c79b9413898085202ad9a1840c25480edeb","kpelzel","2019-06-03 22:59:28","false","Write deny to setgroups when doing single user mapping

Signed-off-by: Kevin Pelzel <kevinpelzel22@gmail.com>

Closes: #1640
Approved by: rhatdan",59,28,0,0
"containers/buildah","a6ee26b7679e55641939bac48fd39348c604e4a2","nalind","2019-03-20 18:26:37","false","imagebuildah: only initialize imagebuilder configuration once per stage

Only initialize imagebuilder's copy of the image's configuration once
per stage, so that ONBUILD instructions that we add along with a layer
in a multi-layer build won't be prepended to the current stage's list of
instructions when we reinitialize our working rootfs using that layer's
container, which is not what we want.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1485
Approved by: vrothberg",36,26,0,1
"containers/buildah","9f9f32ceddf4f1b77159a9f52482d89ecee4909a","nalind","2021-11-04 17:29:08","false","config: support the variant field

Add the variant field, along with methods for setting and querying it,
and expose them in the `buildah config` and `buildah inspect` commands.

When setting an initial architecture for a container based on an image
which doesn't contain an architecture, or from ""scratch"", normalize the
architecture name we've been given, and set both it and the variant
field at the same time.

Provide normalized architecture+variant values in `buildah info`.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",29,57,1,1
"containers/buildah","8df3a657c78c00964ded4c039cf126359ad0f416","lsm5","2018-09-26 19:17:05","false","tests: run conformance test suite in Travis

Run conformance tests in after_script section of Travis with
non-blocking failures.

Follow up to #1003

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",38,20,0,1
"containers/buildah","f146c7188b8719793bd2c8cb0378a64c02411bee","flouthoc","2022-06-17 07:51:49","true","vendor: bump openshift/imagebuilder to master@4151e43

PR https://github.com/openshift/imagebuilder/pull/229 adds support for
resolving args in base name, bump openshift/imagebuilder to
master@4151e43 so buildah could use this feature.

Signed-off-by: Aditya R <arajan@redhat.com>",22,65,1,1
"containers/buildah","767389c87dc10df56014422183b8c79170af3841","rhatdan","2017-04-14 12:48:53","false","Fix handling of man page for make install

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #72
Approved by: nalind",14,3,0,1
"containers/buildah","08201577e5864ed64c29ae59873da0ce6d2ad7bf","rhatdan","2021-03-27 09:17:12","false","Remove some stuttering on returns errors

Golangs os.* functions return the name of the file/directory they
fail to use.  We should not wrap these errors with the file/directory
to use names, causes stuttering when the user sees the errors, and looks
bad having huge error messages.

Since this is just code cleanup, existing tests should handle the
changes.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",51,50,0,1
"containers/buildah","033ca435139b75a52ca03c641bb45f9a57571802","mtrmac","2018-11-23 10:40:34","false","Vendor c/image after merging c/image#536

... which adds blob info caching

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1218
Approved by: rhatdan",64,22,0,1
"containers/buildah","0dd9b068807a1fe4680532b787297eb2722d79cb","rhatdan","2022-07-23 12:57:11","true","Merge pull request #4074 from cevich/new_bats

Cirrus: Update VM images w/ updated bats",19,66,1,1
"containers/buildah","48cede4ed0274691be4c990d38b24d7c06736d12","giuseppe","2018-10-31 12:36:25","false","rootless: do not specify --rootless to the OCI runtime

runc has a good ""auto detect"" mode to find out when running in
rootless mode.  It also makes easier to plug another OCI runtime,
since --rootless is not part of the OCI specs.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1145
Approved by: TomSweeneyRedHat",57,21,0,1
"containers/buildah","3e175b1f7acff69b551ec5cf51e9cc25ef8d5ea2","baude","2019-01-22 15:35:52","false","Replace urfave/cli with cobra

Signed-off-by: baude <bbaude@redhat.com>

Closes: #1303
Approved by: rhatdan",54,24,0,0
"containers/buildah","797f03430fb58a38a9cbd1914e6801e61aa24a14","rhatdan","2023-05-16 20:29:31","false","vendor in containers/(common,storage,image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",13,76,1,1
"containers/buildah","8a8f99e09b4b3b0c598277abb3b5ba45dda437f1","flouthoc","2023-03-01 17:18:02","true","executor: do not warn on builtin default args

Do not warn on builtin default args

Closes: https://github.com/containers/buildah/issues/4319

Signed-off-by: Aditya R <arajan@redhat.com>",19,73,1,1
"containers/buildah","0973714258bc734a75b67bf5aaba5638efaf9229","rhatdan","2023-02-16 05:12:08","true","Merge pull request #4598 from cevich/skip_renovate_subject_length

[CI:DOCS] Skip subject-length validation for renovate PRs",19,73,1,1
"containers/buildah","df8f0fa88349c1c110cb008c381009da3bbe695f","flouthoc","2022-10-10 10:21:22","true","test: retrofit 'bud with undefined build arg directory'

* Ack buildah's skipping stage behaviour so use all stages in tree.
* ARG declared before the stage has no significance for the new stage,
  warning behaviour must consider this.

Signed-off-by: Aditya R <arajan@redhat.com>",28,68,1,1
"containers/buildah","5ca2820d82c57917911157959efc70a34e7aac10","openshift-merge-robot","2022-08-23 06:09:06","true","Merge pull request #4198 from nalind/makefile-go

Makefile: always call $(GO) instead of `go`",18,67,1,1
"containers/buildah","0a9d6e6eaef2e2e7936313d449a4e226022eb865","TomSweeneyRedHat","2022-05-04 16:16:00","false","Bump to v1.26.0

As the title says.

[NO TESTS NEEDED]

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",24,63,1,1
"containers/buildah","260577593fee65e606da579c6bedd94b194e144d","openshift-merge-robot","2022-03-09 18:02:12","true","Merge pull request #3814 from Luap99/fix-network-backend-test

tests/copy: read correct containers.conf",30,61,1,1
"containers/buildah","b2897f0c20ba4886bd6f53b2b3e128d5c71c493f","openshift-merge-robot","2022-02-21 21:39:38","true","Merge pull request #3792 from lsm5/fix-bash-syntax

helpers.bash: Use correct syntax",30,61,1,1
"containers/buildah","2189882aeb64952a5b60036ea46b8e5e48ea8fe5","openshift-merge-robot","2022-01-21 18:23:27","true","Merge pull request #3732 from rhatdan/codespell

Run codespell on code",34,60,1,1
"containers/buildah","da67f97bcf11eca83368039f8ecaac86e5e3108f","openshift-merge-robot","2022-01-10 16:51:09","true","Merge pull request #3697 from Luap99/fix-cni

Fix default CNI paths",27,59,1,1
"containers/buildah","8b79d8b0778fff2db13eb84aacc4d31c22a56872","openshift-merge-robot","2021-11-23 19:29:13","true","Merge pull request #3618 from containers/dependabot/go_modules/github.com/onsi/gomega-1.17.0

build(deps): bump github.com/onsi/gomega from 1.16.0 to 1.17.0",29,58,1,1
"containers/buildah","932426be9e4328ab95fc7c9fd70eba84a73baa9b","mtrmac","2021-06-17 19:25:00","false","Remove unused util.StartsWithValidTransport

It is not used, and it should check the current list of transports
from c/image/transports instead of hard-coding (like cmd/buildah/push.go
currently does).

(Is this an API break`?)

[NO NEW TESTS NEEDED]

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",40,53,1,1
"containers/buildah","400c1de898c788e9805759642f064b12744464ee","openshift-merge-robot","2021-04-23 13:04:44","true","Merge pull request #3181 from vrothberg/restore

restore push/pull and util API",50,51,0,1
"containers/buildah","d992ade363808cd6ab80790cf749831ebec464a8","nalind","2020-07-20 20:39:50","false","build.sh: log the version of Go that we're using

Have contrib/cirrus/build.sh run `go version` and `go env`, to make it
easier to diagnose build problems that might be specific to the version
of go that we're using for the build test.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",149,42,0,1
"containers/buildah","215536fb4b76307b09a50e108e5b7f54b2183f91","nalind","2020-07-14 19:37:58","false","imagebuildah: return the right stage's image as the ""final"" image

When building multiple stages, we weren't ensuring that the image
reference we returned to our caller was a reference to the final image
we built.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",147,42,0,1
"containers/buildah","1e8c932143cb933582a9ce0c06eaee8456249224","cevich","2020-04-17 16:14:18","true","Lower number of golangci-lint threads

Also add in-line comment explaining why.

Signed-off-by: Chris Evich <cevich@redhat.com>",122,39,0,1
"containers/buildah","81e2659d52e38ef465580b1b2296e16803bc2426","rhatdan","2020-04-16 13:53:18","true","Merge pull request #2304 from TomSweeneyRedHat/dev/tsweeney/fixbyhand

Add containers.conf to stablebyhand build",122,39,0,1
"containers/buildah","bb561e01b20e6e953260b5939f8af101fcad0337","edsantiago","2020-02-10 17:23:07","false","digest test : make more robust

Instead of relying on random images from various separate
repositories, some of which are actually not the schema
version we thought we were testing (and some of which are
on unreliable registries, which causes test flakes),
craft our own images and store them all on quay.io

This commit:

  1) Adds a new script (tests/digest/make-v2sN) that
     crafts a custom image with the desired attributes:
     schema version 1 or 2, possibly with a duplicate
     layer. Script decides based on its name, that is,
     we are expected to have symlinks pointing to it.

  2) Updates digest.bats to use these newly-made images.

  3) Extends digest.bats by adding a check for 'v2s*'
     in the image name; if found, we now use 'imgtype'
     to extract the manifest and confirm that the
     pulled image has the expected schema version (1 or 2).

  4) Extends digest.bats by adding a check for duplicate
     layers in the one test that requires them.

Pushing the generated images to quay.io is left as an
exercise for the reader; as is updating the Digest SHAs
and/or tags in the individual tests in digest.bats

Fixes: #2147

Signed-off-by: Ed Santiago <santiago@redhat.com>",112,36,0,1
"containers/buildah","e4c5f795349d07df19b784a28bfa778481896e11","rhatdan","2018-06-08 22:41:09","false","Bump to v1.2-dev

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",32,16,0,1
"containers/buildah","c35eaec798087397992ae40d8b3a7d72775cf0ac","openshift-merge-robot","2023-06-29 20:04:17","true","Merge pull request #4829 from rhatdan/selinux

Fix transition test to work with latest selinux policy",13,77,1,1
"containers/buildah","83e455fd8d7cfadbe5257cc4302a6f5f391b5236","openshift-merge-robot","2022-05-04 11:23:28","true","Merge pull request #3956 from flouthoc/deep-copy-args

imagebuildah,buildDockerfilesOnce: move deepcopy of args before we spawn goroutine",23,63,1,1
"containers/buildah","ccbc897bbb1bf6c1e328aeaf8fd30f6fe5671255","openshift-merge-robot","2022-08-31 12:37:38","true","Merge pull request #4210 from nalind/move-to-registry.k8s.io

Replace k8s.gcr.io/pause in tests with registry.k8s.io/pause",17,67,1,1
"containers/buildah","47c78dd60db38429db9e1d4c988b6ae877ed30c8","openshift-merge-robot","2021-10-11 17:33:11","true","Merge pull request #3580 from jayaddison/docs/buildah-build-platform

docs: update buildah-build 'platform' option compatibility notes",40,56,1,1
"containers/buildah","23e24d0c46de98fb2c2236b6bdffe99ae55c3884","openshift-merge-robot","2022-05-25 10:21:44","true","Merge pull request #4014 from flouthoc/support-renaming-device-rootless

buildah: add support for renaming a device in rootless setups using `--device`",25,64,1,1
"containers/buildah","d5bf225ae40e44b12a6a25d87ed54b829c489c07","openshift-merge-robot","2022-04-19 18:54:02","true","Merge pull request #3918 from edsantiago/stop_littering

Stop littering",25,63,1,1
"containers/buildah","13121bee038c1663cb6c52cf4ead9c3949ee8d3c","johrstrom","2019-10-28 20:30:23","false","fix troubleshooting redirect instructions

Signed-off-by: Jeff Ohrstrom <johrstrom@hotmail.com>",80,33,0,0
"containers/buildah","e1f747152caa112fbc476c5440fdcfe5bef15c01","openshift-merge-robot","2021-09-01 14:06:40","true","Merge pull request #3487 from kurt-google/uncompress-opt

Avoid rehashing and noop compression writer",34,55,1,1
"containers/buildah","be10b8d20c32bd21c4ce1b4ed2f414ae12cb2d92","flouthoc","2023-02-15 06:59:22","true","executor: also add stage with no children to cleanupStages

While preparing list of cleanup stages, executor must add stage with no
children also to cleanupStages since a stage can also exist in the form
only `FROM base_image` i.e without any child nodes.

Ensures we leave no dandling build container for cases such as

```dockerfile
FROM quay.io/quay/busybox:latest AS busybox

FROM scratch

COPY --from=busybox /bin/busybox /bin/busybox
```

Closes: https://github.com/containers/buildah/issues/4572

Signed-off-by: Aditya R <arajan@redhat.com>",20,73,1,1
"containers/buildah","d899c7c9361ac1b780c6b15bf344c6c597f3408d","openshift-merge-robot","2021-01-04 18:58:25","true","Merge pull request #2879 from mgoltzsche/rmi_prune_fix

fix: `rmi --prune` when parent image is in store.",91,47,0,1
"containers/buildah","ac093aecd1bedb1599c038ae87affa5cdab8c3d2","TomSweeneyRedHat","2018-02-22 17:46:09","false","Add libseccomp-devel to packages to install

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #490
Approved by: rhatdan",18,13,0,1
"containers/buildah","5aeb38bd10546778d2c646e003b9ba3af41e509d","naveensrinivasan","2022-03-28 20:55:23","false","Updated dependabot to get updates for GitHub actions.

GitHub sends Dependabot alerts when we detect vulnerabilities affecting your repository
as well as when there are new updates to the dependency.

https://docs.github.com/en/code-security/dependabot/dependabot-alerts/about-dependabot-alerts

A vulnerability is a problem in a project's code that could be exploited to damage the confidentiality, integrity, or availability of the project or other projects that use its code. Vulnerabilities vary in type, severity, and method of attack.

When your code depends on a package that has a security vulnerability, this vulnerable dependency can cause a range of problems for your project or the people who use it.

Signed-off-by: naveensrinivasan <172697+naveensrinivasan@users.noreply.github.com>",28,62,1,0
"containers/buildah","670655d7f82f127df911913b513997890b5408d1","rhatdan","2023-05-17 22:11:16","true","Merge pull request #4799 from containers/renovate/tim-actions-get-pr-commits-1.x

[skip-ci] Update tim-actions/get-pr-commits action to v1.3.0",14,76,1,1
"containers/buildah","b66e8531456e2986ffc409f591c9005813589a34","rhatdan","2018-05-25 07:53:30","false","Add OnBuild support for Dockerfiles

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #722
Approved by: mheon",62,16,0,1
"containers/buildah","462e2ef7d6999fc0815eb3c279552ea1abbe4e18","rhatdan","2018-08-15 00:35:34","false","Expand variables names for --env

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #931
Approved by: vbatts",25,19,0,1
"containers/buildah","7a85ca7f3883f010226d5352bbfd43e17bdc1305","rhatdan","2019-01-19 21:10:44","true","Merge pull request #1295 from TomSweeneyRedHat/bump-1.7-dev-1

Bump to v1.7-dev-1",54,24,0,1
"containers/buildah","4c72c25a21cdf75bec444574e68816508585d780","dfr","2023-06-28 09:36:33","false","pkg/overlay: add limited support for FreeBSD

Note: in theory, we could support read/write overlays on FreeBSD using a
combination of unionfs and nullfs but this would take two mounts and the
API only lets us return a single mount from MountWithOptions. Read only
mounts can be done with just nullfs and this is enough to support read
only image mounts in podman.

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",12,77,1,0
"containers/buildah","e867db39b6b4d0659b035f6af15c89098f2a2eb9","dfr","2022-09-22 13:43:16","false","copier: Preserve file flags when copying archives on FreeBSD

This approach should also work on darwin but I have only tested on
FreeBSD.

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",20,68,1,0
"containers/buildah","fb331c18610611781e6730c58b5812f0ffcdcce4","vrothberg","2021-04-23 08:26:26","false","restore push/pull and util API

Restore the push and pull API that commit dcd2a92e5669 removed.
These changes would break vendoring into openshift/builder due
to build errors.

For the same reason, restore `util.FindImage` and `util.AddImageNames`
but deprecate the `findRegistry` argument.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",50,51,0,1
"containers/buildah","77fa9dde4a72f980a2c3ce3f7c71fa2b6e8f8f8d","rhatdan","2019-06-14 09:38:02","true","Merge pull request #1671 from rhatdan/bump-1.8.4

Bump 1.8.4",41,29,0,1
"containers/buildah","1f537a95ce6f9f14e0f3a3a5ecd4b39daa1b7042","rhatdan","2018-10-22 16:54:28","false","Use libpod GetDefaultStorage to report proper storage config

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1124
Approved by: rhatdan",53,21,0,1
"containers/buildah","6fd4f0373c3dfde6491e54f3bf916d9224faab08","flouthoc","2023-10-05 09:05:46","true","gitignore: add mkcw binary

[NO NEW TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",6,80,1,1
"containers/buildah","4d7c9fe1588f5f3961e89e96b677fc5b72ac1591","rhatdan","2022-10-12 13:01:28","true","Merge pull request #4331 from containers/dependabot/go_modules/github.com/spf13/cobra-1.6.0

build(deps): bump github.com/spf13/cobra from 1.5.0 to 1.6.0",27,68,1,1
"containers/buildah","2711b8557cb1bc5f37496313c080e27b848c2e61","openshift-merge-robot","2021-11-29 18:30:49","true","Merge pull request #3651 from flouthoc/accept-multiple-filters

images: accept multiple filter with logical `AND` between them.",32,58,1,1
"containers/buildah","52dfdd7868bf9482d3e51ed77e8352df4e6da027","openshift-merge-robot","2021-09-16 08:02:30","true","Merge pull request #3519 from cevich/update_images

Update VM Images + Drop prior-ubuntu testing",39,56,1,1
"containers/buildah","83cc5a30cba75931915907cec2e2390c1fb112e5","openshift-merge-robot","2021-09-10 07:32:49","true","Merge pull request #3504 from rhatdan/userxattr

Add support for rootless overlay mounts",39,55,1,1
"containers/buildah","d58ce8d9607f447ea30fa8a8062dfffdcf6eaedf","openshift-merge-robot","2021-05-12 21:06:47","true","Merge pull request #3209 from cevich/cron_fail_mail

[CI:DOCS] Notification email for cirrus-cron build failures",54,52,0,1
"containers/buildah","a345f0ebc22167b2f2ba6571c7ace3e773388193","openshift-merge-robot","2020-10-27 10:30:01","true","Merge pull request #2721 from containers/dependabot/go_modules/github.com/containers/storage-1.23.7

build(deps): bump github.com/containers/storage from 1.23.5 to 1.23.7",65,45,0,1
"containers/buildah","415715a5f517ab7a1712433249fb6c3e7ea30d94","openshift-merge-robot","2020-10-10 12:53:16","true","Merge pull request #2681 from nalind/moar-dockerignore

ADD and COPY: descend into excluded directories, sometimes",61,44,0,1
"containers/buildah","db2b026b8104b5c8abebf12a80f0e1594b281a35","TomSweeneyRedHat","2020-03-26 23:10:27","false","Bump back to v1.15.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",114,38,0,1
"containers/buildah","34e7eba408282e890e61395b6d97e58b88e14d25","baude","2019-04-25 19:39:49","false","allow podman to build a client for windows

the podman remote-client for windows pulls in some buildah code for
things like commit and build.  we need to perform some slight
refactoring of buildah code to accomodate that build.

Signed-off-by: baude <bbaude@redhat.com>

Closes: #1551
Approved by: rhatdan",53,27,0,0
"containers/buildah","6f59942fc703b581303db42e69cd1f18dda2516a","rhatdan","2021-01-28 20:30:58","false","[ci:docs] Fix man page for buildah push

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",93,48,0,1
"containers/buildah","018742395f1d603458e3cc261254f4a1dac970ea","rhatdan","2022-10-20 20:49:50","true","Merge pull request #4359 from rhatdan/VENDOR

Vendor in latest containers/(common,storage)",28,69,1,1
"containers/buildah","54ddef172b0c2ee7e9cf12dba4259f46af828931","rhatdan","2018-07-24 14:39:51","false","Switch to Recommends container-selinux

This way we can install buildah into a container without pulling in
SELinux policy packages.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #880
Approved by: rhatdan",31,18,0,1
"containers/buildah","a3382c36bf540169c8627cd06c3b53f0e0404151","rhatdan","2018-06-01 14:26:34","false","Add environment variable to buildah --format

If you decide you want to only build and support docker format
images, you can set this in your environment and buildah
will defautl to building docker images.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #742
Approved by: TomSweeneyRedHat",39,16,0,1
"containers/buildah","7b4dd106b72964e924ad81b4fac42464791c02b3","rhatdan","2021-03-30 19:26:24","false","Export parse.Platform string to be used by podman-remote

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",50,50,0,1
"containers/buildah","b68f88c53dc527008861d74f0cefb56296640b64","boaz0","2018-01-18 12:04:09","false","Fix: setting the container name to the image

In commit 47ac96155f1573e the image name that is used
for setting the container name is taken from the resolved image
unless it is empty.

The image has the ""Names"" field and right now the first name is
taken. However, when the image is a tagged image, the container name
will end up using the original name instead of the given one.

For example:

$ buildah tag busybox busybox1
$ buildah from busybox1

Will set the name of the container as ""busybox-working-container""
while it was expected to be ""busybox1-working-container"".

This patch fixes this particular issue.

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>

Closes: #399
Approved by: rhatdan",30,12,0,0
"containers/buildah","c8b434d1d991c8b3b88ceae06249df3f8cc15424","rhatdan","2018-08-02 23:37:01","true","Merge pull request #901 from vbatts/oom_score_adj.0

unshare: error message missed the pid",22,18,0,1
"containers/buildah","141b5a14a571eddd29c02f31b81ecaf7aca22a02","rhatdan","2019-10-31 18:57:46","true","Merge pull request #1958 from TomSweeneyRedHat/dev/tsweeney/fixarchivetest

Update bud.bats test archive test",82,33,0,1
"containers/buildah","041767a8a697906538a613abc8c67538182ecaf8","giuseppe","2018-10-09 08:51:15","false","chroot: fix the args check

two arguments are required by the program

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1076
Approved by: rhatdan",51,20,0,1
"containers/buildah","c116133dd5d62e3791ff792468c9a11b1bdffafd","giuseppe","2018-10-23 10:42:35","false","common: support a per-user registries conf file

Closes: #1124
Approved by: rhatdan",52,21,0,1
"containers/buildah","4be3b7dec9eaec592fb2c0fd54b8ec344fe67da0","nalind","2022-05-02 22:24:59","false","buildah build: add a --env

Add a `--env` option to `buildah build` that functions similarly to the
`buildah config --env` option, to complement `buildah build`'s
`--unsetenv` option.

Document that `buildah config`'s `--env` function fetches the current
value for a variable when the name is supplied, but no `=` or value
follows it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",24,63,1,1
"containers/buildah","b1bb73e01c9bf0b1b75e50a2d1947b14a8174eee","nalind","2017-04-04 21:31:02","false","Teach ""Run"" to dig user IDs out of containers

When we have cgo, use fgetpwent() to try to look up user IDs and primary
GIDs in containers.  If that fails for any reason (or if we don't have
cgo), fall back to doing what we were doing before (i.e., trying to look
up the information on the host).

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #63
Approved by: rhatdan",14,2,0,1
"containers/buildah","bdb7aff926d40bd1327321e937ccc0c347fa2309","nalind","2017-05-17 21:03:39","false","Makefile: add source deps for the CLI tool

The CLI tool also incorporates types from the 'docker' subdirectory, so
add it as a build-time dependency to check.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #117
Approved by: nalind",10,4,0,1
"containers/buildah","4a05d8643d0f88b428ab80456ef9fd9ba47044bb","nalind","2017-06-06 18:11:46","false","Add an option to specify a Create date for images

Add CommitOption option that to allow a caller to specify a creation
timestamp to use in images.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #141
Approved by: rhatdan",12,4,0,1
"containers/buildah","b39191d960e77017398919b9714659d35dc3f450","nalind","2019-03-15 23:17:32","false","images: suppress a spurious blank line with no images

When listing images when there are no images, avoid outputting an
unnecessary newline.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1418
Approved by: TomSweeneyRedHat",36,26,0,1
"containers/buildah","a984c8b9a3062e51c0ea6464be9700f1f3c1c2f1","idleyoungman","2021-03-12 23:23:21","true","Add Tag format placeholder to docs

Also fix spacing on CreatedAt table

Signed-off-by: Dan Young <dyoung@newrelic.com>",60,50,0,0
"containers/buildah","3b42b51524b7d1ac69d2df2ac2c4a8acc1355b6a","dfr","2022-08-05 13:26:39","false","chroot: Move runUsingChroot to run_common.go

This intentionally breaks the FreeBSD so that I can move the code
unmodified which will help with future merge conflicts. A subsequent
commit will resolve this by factoring out Linux-specific code.

Signed-off-by: Doug Rabson <dfr@rabson.org>",18,66,1,0
"containers/buildah","cd97c1d204dc316ba7382f75418327e487000a76","edigaryev","2020-11-09 03:14:56","false","Fix NPE when Dockerfile path contains non-directory entries

When building nondir/Dockerfile and nondir exists in os.Getwd() and
is not a directory, os.Stat() will return an error which needs to be
handled, otherwise dinfo will be nil and dinfo.Mode() will cause panic.

Signed-off-by: Nikolay Edigaryev <edigaryev@gmail.com>",67,45,0,0
"containers/buildah","655a4395627e2d594bad392f97a4bfce1b6f4e49","rhatdan","2021-02-08 18:50:06","false","build(deps): bump github.com/onsi/ginkgo from 1.14.2 to 1.15.0

Bumps [github.com/onsi/ginkgo](https://github.com/onsi/ginkgo) from 1.14.2 to 1.15.0.
- [Release notes](https://github.com/onsi/ginkgo/releases)
- [Changelog](https://github.com/onsi/ginkgo/blob/master/CHANGELOG.md)
- [Commits](https://github.com/onsi/ginkgo/compare/v1.14.2...v1.15.0)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",94,48,0,1
"containers/buildah","b3edcaa06220919715a724df92ddbb0acc2424f9","Luap99","2023-06-27 08:26:02","true","vendor: update c/{common,image,storage} to latest

includes two test fixes

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",12,77,1,0
"containers/buildah","8e299da7708d6010484a0c2dc0b6cd1db3b0d4e4","Luap99","2022-04-04 13:58:18","true","oci spec: change special mount points for namespaces

The current logic in setupRootlessSpecChanges has quite a few problems.
First of this logic is a noop for rootful and when we have a netns.
However pid and ipc could still need special mounts.

In Podman we have already working code for this so this reuses the same
logic and adapts it to buildah.
https://github.com/containers/podman/blob/4ba71f955a944790edda6e007e6d074009d437a7/pkg/specgen/generate/oci.go#L178

Since there is already logic to handle these mounts in buildah we will
add it there and also handle the special rootless case there.

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",25,62,1,0
"containers/buildah","1ab567151ab7d175c6c3f770d10bda432ab3f05b","dfr","2022-06-15 11:49:41","false","Move stdio copying utilities to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","7a5a18334ab5686c28e3337f808fccebf750fbd1","Juneezee","2023-06-28 13:48:33","true","chore: replace `github.com/ghodss/yaml` with `sigs.k8s.io/yaml`

At the time of making this commit, the package `github.com/ghodss/yaml`
is no longer actively maintained.

`sigs.k8s.io/yaml` is a permanent fork of `ghodss/yaml` and is actively
maintained by Kubernetes SIG.

[NO NEW TESTS NEEDED]

Signed-off-by: Eng Zer Jun <engzerjun@gmail.com>",12,77,1,0
"containers/buildah","73b5707003359d05f546c4dfb7e43e57ba8570e5","openshift-merge-robot","2023-07-09 11:04:11","true","Merge pull request #4911 from containers/renovate/golang.org-x-term-0.x

fix(deps): update module golang.org/x/term to v0.10.0",13,77,1,1
"containers/buildah","f0b2d39b83cd3bae8a6d0ef8c05fd384f81412a0","openshift-merge-robot","2022-08-24 17:11:10","true","Merge pull request #4200 from flouthoc/run-set-additional-gid

run: add container `gid` to additional groups",15,67,1,1
"containers/buildah","1fffb32c3e1952abdb4abed1c7cf525cba29febe","openshift-merge-robot","2022-06-08 22:27:41","true","Merge pull request #4044 from rhatdan/build

Sort buildoptions and move cli/build functions to internal",22,64,1,1
"containers/buildah","ad21b94c7b9739c08586b37a45bd67ba3540f0c7","openshift-merge-robot","2021-11-19 18:38:14","true","Merge pull request #3630 from nalind/label-pipes

run: ensure that stdio pipes are labeled correctly",27,58,1,1
"containers/buildah","4cb43961b8bd03a1558c3046f96715fc11a30d1d","flouthoc","2021-09-19 11:40:11","true","Run: Cleanup run directory after every RUN step

Following commit ensures that we cleanup dangling `/run` after every RUN
command and make sure that it does not persists on physical image. Ensure
parity with how docker behaves with `.dockerenv`.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",39,56,1,1
"containers/buildah","30c07b7d61526fbc9eb563323c5fd8455d48f843","openshift-merge-robot","2021-06-16 21:04:28","true","Merge pull request #3298 from nalind/copy-helper

tests: make it easer to override the location of the copy helper",39,53,1,1
"containers/buildah","c6e6de52210956d1b5af3e567276599899cb717e","openshift-merge-robot","2021-04-16 08:09:14","true","Merge pull request #3143 from nalind/copier-noxdev

copier: add GetOptions.NoCrossDevice",52,51,0,1
"containers/buildah","8a5447968be2ea2d7146b2da1128671f8d95dc45","caiges","2021-02-20 05:52:00","true","Fix reaping of stages with no instructions

Signed-off-by: caiges <caigesn@gmail.com>",63,49,0,0
"containers/buildah","d65ba62f561d98221cd25871bea30279837ca047","openshift-merge-robot","2021-02-16 14:03:30","true","Merge pull request #2977 from rhatdan/shrink

Eliminate the use of containers/building import in pkg subdirs",62,49,0,1
"containers/buildah","92fb2ec626002231f124a0577fbd5027cdbf4872","nalind","2020-07-15 20:08:05","false","bud.bats: correct .dockerignore integration tests

The ""bud with .dockerignore"" test shouldn't be able to copy ""subdir""
from the build context to the build container when ""subdir"" is the next
to last item listed in the build context's .dockerignore file, even
though the ""!*/sub1* after it might suggest otherwise, for
compatibility.  Add a second Dockerfile which includes every step except
the last one, which we now expect to fail, to ensure that we succeed up
until that point.

The ""bud with .dockerignore - 3"" test shouldn't expect to be able to
copy ""test1.txt"" from the build context, when it's the last item
mentioned in the build context's .dockerignore file.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",148,42,0,1
"containers/buildah","29e957aef12cf03c5d4fea6d08cfe02b69611b8e","rhatdan","2020-08-11 21:51:10","true","Merge pull request #2453 from jskovjyskebankdk/mergeTutorial

Howto for rootless image building from OpenShift",86,42,0,1
"containers/buildah","09ef0421786954c2eb696dbf7d8febbe00072970","nalind","2020-07-21 02:59:50","false","parse: fix a type mismatch in a test

Cast a value to a string when comparing it to a string.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",149,42,0,1
"containers/buildah","8b360f6e04f9aec77d44d883d446e480b53e986f","baude","2020-05-22 19:27:40","false","remove dependency on openshift struct

use of github.com/openshift/api/config/v1 is costly in size, something around 10MB.  removal of this dependancy and using a locally defined struct took the buildah executable size from around 38MB to around 27MB.  This also hits libpod and allows it also shed that size as well.

Signed-off-by: Brent Baude <bbaude@redhat.com>",133,40,0,0
"containers/buildah","853a35c6482022d915d419c97299c812880529b0","lumjjb","2020-04-28 18:07:41","false","update exit code for tests

Signed-off-by: Brandon Lum <lumjjb@gmail.com>",136,39,0,0
"containers/buildah","194e654defd384387c4a9d21b5511a4d8e5a66a9","edsantiago","2020-02-26 19:23:33","false","BATS : in teardown, umount stale mounts

Workaround for #1991, in which buildah leaves behind stale
mounts under overlayfs, which causes the 'rm -fr' in teardown()
to barf with EBUSY. Here we amend teardown() to look for
mounts underneath our temp dir and to umount them. With
this, bats runs cleanly even with STORAGE_DRIVER=overlay

Signed-off-by: Ed Santiago <santiago@redhat.com>",98,37,0,1
"containers/buildah","10b0e7acd712e51e7afad8dc16fe0292d69195f2","rhatdan","2019-09-13 15:02:58","true","Merge pull request #1856 from TomSweeneyRedHat/bump-1.11.2

Bump 1.11.2",61,31,0,1
"containers/buildah","18e618ea2d6c9bea8230ccf3c41e2f4e8d906449","mtrmac","2018-12-03 17:53:07","false","Update containers/image to 63a1cbdc5e6537056695cf0d627c0a33b334df53

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1214
Approved by: rhatdan",44,22,0,1
"containers/buildah","10a8d3bf0b4c9b591266660ea389872f7e8cd9c8","nalind","2017-01-28 07:34:15","false","Make a note to distinguish compression of layers

Add a TODO note that, once we can pull in a newer image-spec, make use
of its new media type to distinguish between compressed and uncompressed
layers in the output image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","498f0ae9d700f5ee08c6e4a6c64a8ed1fdd3e666","TomSweeneyRedHat","2017-07-21 00:02:11","false","Add credentials to buildah from

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Add credentials to buildah from

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #204
Approved by: nalind",17,6,0,1
"containers/buildah","29f6b4f706dc3ec4e908ac67bc3ecd5ab1f5b513","TomSweeneyRedHat","2022-01-26 21:09:20","false","Bump to v1.24.0

[NO TESTS NEEDED]

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",34,60,1,1
"containers/buildah","261a524b9e2b514d50b02acf2865fdf849579263","cevich","2023-05-04 15:23:54","true","Update tooling to support newer golangci-lint

Golangci-lint < v1.51.1 can't work on systems with golang 1.20.
Updating to 1.51.2 then has dependent modules that require a minimum of
golang 1.17, requiring a re-vendoring of tooling.

Signed-off-by: Chris Evich <cevich@redhat.com>",9,75,1,1
"containers/buildah","bc9c02f68d31bdd8e473ecbe3e402c4580206af7","cevich","2020-12-17 19:14:07","true","Cirrus: Support new VM Images in get_ci_vm.sh

Due to necessary changes in both scripts and within images, updates are
necessary for this script to function.  These changes also bring
the script very close to being identical to the same in the
containers/podman repository.  The intent is to support a future
where this script can simply be shared across repos.

Signed-off-by: Chris Evich <cevich@redhat.com>",82,47,0,1
"containers/buildah","835668715705a7ebbdf32d945b4baae545d98aa2","mtrmac","2022-10-19 00:55:01","false","Ensure the cache volume locks are unlocked on all paths

... and use a more traditional error handling model,
where responsibility for the cleanup passes to the caller
_only_ if the called function succeeds.

To reinforce that, hard-code nil returns on error paths
instead of returning the locks.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",27,69,1,1
"containers/buildah","ea7f5daad47b142ce2c526f2c48d497c004ab7e0","mtrmac","2018-08-04 01:21:57","false","Return a ""search registries were needed but empty"" indication in util.ResolveName

pullImage now tries (incorrectly) to redundantly compute the same
value as part of error handling.  So, return the actually used
data in util.ResolveName.

The computed value is not used yet, so should not change behavior.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #909
Approved by: rhatdan",22,18,0,1
"containers/buildah","3de05a9c1a6c444cd824f6885cc308cc7290b2c2","cevich","2020-02-06 21:18:51","true","Cirrus: Disable F29 testing

Release is no longer supported.

Signed-off-by: Chris Evich <cevich@redhat.com>",110,36,0,1
"containers/buildah","7cf6dbd44d8fa8a1121e16b78cc9520c5de868d8","lsm5","2022-06-06 18:51:57","true","[CI:DOCS] Tutorial 04 - Include Debian/Ubuntu deps

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",22,64,1,1
"containers/buildah","4bb62528239e4a1f84c71dfa62a08803b333146f","nalind","2019-04-30 21:00:10","false","Replace kubernetes/pause in tests with k8s.gcr.io/pause

Replace use of the kubernetes/pause image in tests with
k8s.gcr.io/pause, except for the case that expects that we'll get a
schema 1 image when we pull without specifying a tag, since the new
image is a schema 2 image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1564
Approved by: vrothberg",53,27,0,1
"containers/buildah","535604663204c6c0b5d10912c0f7adc807189ee4","nalind","2018-07-19 18:41:02","false","Skip certain tests when we're using ""rootless"" isolation

When we're testing with rootless isolation, skip tests that check that
we were able to influence namespace and control group settings, since we
hardwire namespace settings and don't try to configure control groups.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #873
Approved by: rhatdan",32,18,0,1
"containers/buildah","73111544416d809da3a9c086df4478bf6bd74407","cevich","2022-02-01 17:15:43","true","Cirrus: Use updated VM images

Mainly this is to confirm some changes needed for the podman-py CI
setup don't disrupt operations here. Ref:

https://github.com/containers/automation_images/pull/111

Signed-off-by: Chris Evich <cevich@redhat.com>",35,60,1,1
"containers/buildah","34f1ae6bda46836eba2d142df15e5a1ab0e08ee6","saschagrunert","2019-09-03 15:24:50","false","Preserve file and directory mount permissions

Before that change, all directory permissions were `0755` and all file
permissions had `0700`, without taking umask into consideration.

We now save the file permissions and map them correctly into the target
container.

All necessary integration tests have been added as well.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1833
Approved by: rhatdan",58,31,0,1
"containers/buildah","d7dec37df71e216cc744bf623e08332d7d0cdcde","nalind","2019-07-01 21:14:07","false","from/import: record the base image's digest, if it has one

Record the digest of the base image's manifest, if there is a base
image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1724
Approved by: rhatdan",44,29,0,1
"containers/buildah","498b45770ff9d238f95d772efa2a1fd16d941077","ashley-cui","2022-11-22 16:02:32","false","[CI:BUILD] Cirrus: Migrate OSX task to M1

Migrate our OSX build to a M1 instance, since Cirrus is sunsetting Intel-based macOS instances.

Signed-off-by: Ashley Cui <acui@redhat.com>",20,70,1,0
"containers/buildah","417908009b58fb960087858be0386e843849c3df","TomSweeneyRedHat","2018-05-21 17:01:10","false","Add console syntax highlighting to troubleshooting page

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #713
Approved by: rhatdan",63,16,0,1
"containers/buildah","57a77073aff3edd27205a478778c9f3116ae23a1","cevich","2022-11-08 18:35:10","true","Update to F37 CI VM Images, re-enable prior-fedora

Signed-off-by: Chris Evich <cevich@redhat.com>",23,69,1,1
"containers/buildah","d9248be1a1c599dd282edc436761685b8077252a","rhatdan","2023-07-28 10:13:14","true","Merge pull request #4943 from containers/renovate/github.com-containerd-containerd-1.x

fix(deps): update module github.com/containerd/containerd to v1.7.3",14,78,1,1
"containers/buildah","8f70dd9d5b0dea5390c2ad0bac7452fbb1abcdf0","rhatdan","2021-02-04 22:27:52","false","Stop testing directory permissions with latest docker

Current version of Docker, has a bug we believe, that is
creating top level directories when using ADD and COPY of
tar balls. Basically the directories end up with a 777
permissions, Buildah creates these with 755, which we
believe is correct, and matches older versions of Docker.

We need to revert this patch once we have a version of Docker
that creates these direcories with the corret permissions.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",95,48,0,1
"containers/buildah","b3b13b6d5fec620e3e4504d38df0e247dd1ee65b","rhatdan","2021-03-08 13:44:13","false","build(deps): bump github.com/onsi/ginkgo from 1.15.0 to 1.15.1

Bumps [github.com/onsi/ginkgo](https://github.com/onsi/ginkgo) from 1.15.0 to 1.15.1.
- [Release notes](https://github.com/onsi/ginkgo/releases)
- [Changelog](https://github.com/onsi/ginkgo/blob/master/CHANGELOG.md)
- [Commits](https://github.com/onsi/ginkgo/compare/v1.15.0...v1.15.1)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",57,49,0,1
"containers/buildah","b47ffb93321c20b45df6dccf59adcc656464b95c","rhatdan","2020-09-15 20:44:34","true","Merge pull request #2618 from cevich/fix_gate

Cirrus: Fix validate commit epoch",91,44,0,1
"containers/buildah","de0fb93f3d207817021d62171d85e572312523a9","rhatdan","2017-11-15 17:47:53","false","Bump to 0.6

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",30,10,0,1
"containers/buildah","cf408f758b9cb272703677b83cc59eb816f005ce","rhatdan","2023-02-28 19:51:24","false","Vendor in latest containers/(common, storage, image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",18,73,1,1
"containers/buildah","0cbe85260af940434117b79c0309c3ecb922a60e","openshift-merge-robot","2023-09-07 20:47:10","true","Merge pull request #4960 from nalind/mkcw

Produce confidential workload images",4,79,1,1
"containers/buildah","9513cb8c7bec0f7789c696aee4d252ebf85194cc","TomSweeneyRedHat","2019-12-03 16:48:49","false","Bump to v1.11.6

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",85,34,0,1
"containers/buildah","688a0db2f4b0a00ca0ab974575a2fda3571bb4ea","vrothberg","2019-05-29 14:18:10","false","cmd: check all errors

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1624
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","8e519c76b5418109c467b002ba5dffa5e22af4f8","pixdrift","2018-05-06 11:16:11","false","Update option and documentation for --force-rm

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #659
Approved by: rhatdan",52,15,0,0
"containers/buildah","45a4b816d730dee992616d737617e2957ff3d1d9","pixdrift","2018-04-13 11:50:50","false","Minor fix for lighttpd example in README

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #590
Approved by: rhatdan",32,15,0,0
"containers/buildah","e93095178bb3f8babc51bffd42a7cba1cb077cf3","rhatdan","2019-08-30 13:32:50","true","Merge pull request #1828 from vrothberg/go-proxy

Makefile: use go proxy",56,31,0,1
"containers/buildah","c9532167f4d462a75c8c64e51b1e862ac955109a","saschagrunert","2019-08-09 12:23:24","false","Update `bud`/`from` help to contain indicator for `--dns=none`

The command line help should contain the indicator that `--dns=none` is
possble to disable the creation of the `/etc/resolv.conf` file.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1774
Approved by: rhatdan",51,30,0,1
"containers/buildah","9545744e8b3d7d92f8de8e2ebbfea45a9b0b3584","cevich","2023-08-28 18:48:56","true","Cirrus: Remove multi-arch buildah image builds

These jobs have been failing since early August due to
technical/scripting problems.  Disable/remove entirely since a fix is
unlikely to be implemented anytime soon.

Ref: Abandoned recent attempt at debugging
https://github.com/containers/podman/pull/19720

Signed-off-by: Chris Evich <cevich@redhat.com>",7,79,1,1
"containers/buildah","c845d7a5fe4c269d8828f4a0324e6006e01bdb15","jlebon","2017-07-27 16:52:16","false","ci: use Fedora registry and mount repos

Use the official Fedora 26 image from the Fedora registry rather than
from the Docker Hub.

Also mount yum repos from the host. This will speed up provisioning
because PAPR injects mirror repos that are much closer and faster.

Signed-off-by: Jonathan Lebon <jlebon@redhat.com>

Closes: #225
Approved by: rhatdan",23,6,0,0
"containers/buildah","5aff4c85237dc7ccca8f66e8a048fc3644809a63","vrothberg","2019-06-27 14:30:22","false","Makefile: set GO111MODULE=off

Turn of go modules to avoid breaking build environments to accidentally
try pulling the dependencies instead of using the ./vendor directory.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1694
Approved by: rhatdan",42,29,0,1
"containers/buildah","acb46bfc7b6f203a81c74cf7a98917a336b2841b","vrothberg","2019-05-29 14:45:29","false","blobcache: log error when draining the pipe

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1624
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","6b214d29210871e486c8b2f23a5bced83a054ce5","saschagrunert","2019-07-24 11:55:25","false","Add golint linter and apply fixes

This commit enabled to golint linter in golangci-lint and applies all
necessary fixes.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1740
Approved by: rhatdan",46,30,0,1
"containers/buildah","fc27a56f12484312e79f3a3212a91c958fb023d5","nalind","2017-03-23 20:45:35","false","Rename ""list""/""delete"" to ""containers""/""rm""

Rename the ""list"" and ""delete"" commands to ""containers"" and ""rm"",
respectively, and add ""images"" and ""rmi"" counterparts for them.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #32
Approved by: rhatdan",12,2,0,1
"containers/buildah","3f805bcd8cd2fa522d6d2fd9ecfacf71da6aa5f9","rhatdan","2023-01-18 13:38:19","true","Merge pull request #4526 from flouthoc/stage-reuse

stage_executor: while mounting stages make sure freshly built stage is used",22,72,1,1
"containers/buildah","0f4242de13de7b2c7e53d14ffa3d5b3229250a5e","flouthoc","2022-11-03 14:40:50","true","Merge pull request #4393 from edsantiago/remove_cruft

remove unnecessary (hence misleading) rmi",25,69,1,1
"containers/buildah","b8cd26e3b5605c82d332b9029306bc5ee2c103e0","rhatdan","2022-06-07 13:20:22","true","Merge pull request #4017 from rhatdan/build

Move options parsing out of build.go and into pkg/cli",22,64,1,1
"containers/buildah","f4570cb323e43d8bb585c368d2c55296ba888e18","openshift-merge-robot","2022-05-03 09:34:53","true","Merge pull request #3949 from rhatdan/VENDOR

Vendor in containers/(common, storage, image)",24,63,1,1
"containers/buildah","5ec70bf01ea5e15471272714b9e772ecfb54696c","openshift-merge-robot","2022-03-10 16:04:15","true","Merge pull request #3809 from rhatdan/nohosts

Add --no-hosts flag to eliminate use of /etc/hosts within containers",32,61,1,1
"containers/buildah","cf31ef557360a2a2e1a07d5802c98ad54e8a806b","openshift-merge-robot","2021-09-10 11:58:46","true","Merge pull request #3510 from containers/dependabot/go_modules/github.com/opencontainers/selinux-1.8.5

build(deps): bump github.com/opencontainers/selinux from 1.8.4 to 1.8.5",38,55,1,1
"containers/buildah","954c48169be4e1689e20fc974a21792b7365b70d","openshift-merge-robot","2021-09-30 07:53:31","true","Merge pull request #3546 from nalind/all-the-platform

buildah build: add --all-platforms",41,56,1,1
"containers/buildah","f5f2dca6ae89b0cfbc3f992310215f3789c4a726","openshift-merge-robot","2021-08-20 17:57:58","true","Merge pull request #3462 from containers/dependabot/go_modules/github.com/containers/common-0.43.2

build(deps): bump github.com/containers/common from 0.43.1 to 0.43.2",39,55,1,1
"containers/buildah","3ed5d8e35ac81a622e7a8544f9bf81d7927b6158","openshift-merge-robot","2021-06-28 19:29:37","true","Merge pull request #3347 from rhatdan/block

Switch rusagelogfile to use options.Out",39,53,1,1
"containers/buildah","9c7f50b80b4599b7e3e090787dc5da9ece58875a","rhatdan","2021-06-09 19:25:36","true","Merge pull request #3279 from containers/dependabot/go_modules/github.com/onsi/ginkgo-1.16.4

build(deps): bump github.com/onsi/ginkgo from 1.16.3 to 1.16.4",34,52,1,1
"containers/buildah","b870be611d96ad33bd0e42f1e7c13e43375d51d1","dbgoytia","2020-08-07 17:11:31","false","Add base image name to comment

Add the name of the base image being used by the build
in the comments of the first layer created.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>",81,42,0,0
"containers/buildah","8113542fc46a7b1a503839a403adbda06fe2e6fc","flavio","2020-09-09 08:14:31","true","Update bash completion of `manifest add` sub command

Ensure the new flags added to this sub command are known
by the bash completion.

Signed-off-by: Flavio Castelli <fcastelli@suse.com>",85,43,0,0
"containers/buildah","eb59e6c1881f0df322af87c0d3e0829a2a362aa3","rhatdan","2020-08-12 14:59:06","false","Vendor in containers/storage v1.23.0

Also drop runc vendor back to v1.0.0-rc91 since this vendor
brings in an unreleased version of runtime-spec which breaks runtime-tools

Finally lower version of runtime-spec
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",86,42,0,1
"containers/buildah","bb781cf238ae0dc34098278f2aa63a20ee49886a","rhatdan","2020-02-20 22:15:30","false","Update to containers/common v0.4.1

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",99,37,0,1
"containers/buildah","bcf4495214e74eae3a6bdb90f42e35d06578429d","jobcespedes","2020-08-11 17:55:30","false","fix(buildahimage): add xz dependency in buildah image

xz package is required by buildah and podman when building a
image and ADD a tar.xz file archive is used

Closes https://github.com/containers/buildah/issues/2525
Signed-off-by: Job Cespedes Ortiz <jobcespedes@gmail.com>",86,42,0,0
"containers/buildah","ef24bbbbe73b7b154b5c5bbdc4b5d952e73a3a7b","nalind","2020-07-14 21:20:39","false","imagebuildah: wait for stages that might not have even started yet

When checking if a name specified for a FROM instruction, or a source
for a COPY instruction, was a stage for which it needed to wait,
StageExecutor was checking the Executor's stages list, to which stages
are added only as they're started.  This could cause it to mistakenly
write off a name if the corresponding stage hadn't yet been started, and
assume that the named stage was actually an image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",147,42,0,1
"containers/buildah","cd6ed4b4665bde6eddf4135055720711b3af02b0","nalind","2020-07-02 06:07:10","false","Make imagebuildah.BuildOptions.Jobs optional

Make the Jobs field in imagebuildah.BuildOptions optional.  When API
callers didn't set it, we were treating the default (zero) as if it
specified that every stage should be built in parallel.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",146,41,0,1
"containers/buildah","e29f8dc4f7c071ccad953781ecedcb57a4cf6a67","mtrmac","2020-04-08 18:33:39","false","Run (make vendor)

... now that its (go mod vendor) works again.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",117,38,0,1
"containers/buildah","4868cbc2d4039701b44ef03d955bdc7ccb90c374","carbonin","2020-03-11 13:22:06","false","Add tests for volume ownership

Signed-off-by: Nick Carboni <ncarboni@redhat.com>",108,38,0,0
"containers/buildah","a9e17e61e53bb8f2d2811ec17111006d5741a96d","rhatdan","2020-03-05 18:46:38","false","Fix errors found by codespell

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",102,37,0,1
"containers/buildah","31cffe90405f07fb174f85fe5153400173228802","TomSweeneyRedHat","2020-02-22 19:39:48","false","Search for local runtime per values in containers.conf

After determining the type of runtime to use,
either ""runc"" or ""crun"" dependent upon the system, search
the list of that type of runtime in the containers.conf
file.  It includes the location of those runtimes in a
number of different architectures.  Once found, set the
runtime to use to that value.

Fixes: #2113

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",99,37,0,1
"containers/buildah","c50c287aa5456b06f637cc3e9904a843717868ff","umohnani8","2018-04-26 17:18:34","false","Add FIPS mode secret to buildah run and bud

If the host is in FIPS mode and /etc/system-fips exists
/run/secrets/system-fips is created in the container so that
the container can run in FIPS mode as well.
Vendor in libpod/pkg/secrets and remove the duplicate secrets code
in buildah.
Also remove the hidden --default-mounts-file flag that was being used for test,
as it is not needed anymore and makes the code simpler.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #603
Approved by: rhatdan",50,15,0,1
"containers/buildah","9add3c8f7962c21cdc3e4bb9edd8263b15f6fc81","TomSweeneyRedHat","2018-11-07 22:42:14","false","Add note to install about non-root on RHEL/CentOS

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1166
Approved by: rhatdan",62,21,0,1
"containers/buildah","9ba84851dd67f398e5bd55982758f3a64ecb9699","vrothberg","2022-01-10 12:54:03","false","vendor c/common

Also update the tests to account for the changes when pulling from the
dir transport.  Images pulled via the dir transport are not tagged
anymore; the path is not a reliable source.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",27,59,1,1
"containers/buildah","029bdbcbd07f9b70188363cd4e5f6842a878d2bd","rootfs","2018-01-09 17:33:05","false","fix buildah push description

Signed-off-by: Huamin Chen <hchen@redhat.com>

Closes: #387
Approved by: rhatdan",30,11,0,0
"containers/buildah","0d74147039a0fdf463a89b54ea78b4d4e5c44e64","rhatdan","2022-10-19 21:36:20","false","Vendor in latest containers/(common,storage)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",24,69,1,1
"containers/buildah","fe002ae429c58ab020d6a3c4d658f765db45df6b","rhatdan","2022-12-11 11:32:26","true","Merge pull request #4408 from cevich/F37_update

Update to F37 CI VM Images, re-enable prior-fedora",16,70,1,1
"containers/buildah","88274f586a66b1700b07b3990baa95b80235efe2","rhatdan","2021-11-23 13:56:23","true","Merge branch 'main' into dependabot/go_modules/github.com/onsi/gomega-1.17.0",29,58,1,1
"containers/buildah","b480ce832f3e96c0d27f3842643161115d20e395","rhatdan","2021-11-18 20:20:50","false","Turn on rootless cgroupv2 tests

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",28,58,1,1
"containers/buildah","5259a84b7a5ce355d3bb4639c04de794898f16a4","rhatdan","2017-08-01 20:23:35","false","atomic transport is being deprecated, so we should not document it.

containers/image now fully supports pushing images and signatures to an
openshift/atomic registry using the docker:// transport.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #238
Approved by: rhatdan",24,6,0,1
"containers/buildah","92295496bf27f8de346fdfc26eb1616ae743acd4","openshift-merge-robot","2020-10-20 11:14:51","true","Merge pull request #2703 from nalind/copier-create-error

copier.copierHandlerPut: don't check length when there are errors",62,45,0,1
"containers/buildah","60880a74e0186492667e8b53672fa6f1d9aa96a8","openshift-merge-robot","2022-01-12 23:52:17","true","Merge pull request #3706 from cevich/freshen

Cirrus: Freshen VM images",31,59,1,1
"containers/buildah","e6f732096c0cb8f03faddec33443ed7987968f25","openshift-merge-robot","2021-11-19 15:42:16","true","Merge pull request #3636 from containers/dependabot/go_modules/github.com/docker/docker-20.10.11incompatible

build(deps): bump github.com/docker/docker from 20.10.10+incompatible to 20.10.11+incompatible",28,58,1,1
"containers/buildah","f46387420eba4c59fba1ee221344ab9b18d399ce","openshift-merge-robot","2021-09-24 10:15:54","true","Merge pull request #3535 from nalind/race-check

Makefile: check for `-race` using `-mod=vendor`",41,56,1,1
"containers/buildah","e97fdb8eb12908e877468bc2e95f9e46c03828f6","openshift-merge-robot","2021-04-23 15:04:45","true","Merge pull request #3147 from rhatdan/manifest

Add buildah manifest rm command",50,51,0,1
"containers/buildah","00aa7f01d32880a9ba130275277734e2ef7561b2","openshift-merge-robot","2020-12-22 15:52:43","true","Merge pull request #2867 from rhatdan/master

Drop log message on failure to mount on /sys file systems to info",84,47,0,1
"containers/buildah","73ae0013fc6a05b74078ef4d1108ed6221ff7fde","openshift-merge-robot","2020-10-01 21:24:10","true","Merge pull request #2642 from edsantiago/xref_manpages

New CI check: xref --help vs man pages",87,44,0,1
"containers/buildah","ac00f570fedc8de74e2b10ee089450abe1d86085","mariushoch","2020-07-03 12:48:00","false","Allow ""readonly"" as alias to ""ro"" in mount options

Apparently docker supports this as well, see
https://docs.docker.com/storage/volumes/#use-a-read-only-volume

Signed-off-by: Marius Hoch <hoch.m00@gmail.com>",146,41,0,0
"containers/buildah","0d5ab1d96261ac714841f975b810b0d7e123e0a2","rhatdan","2020-04-24 10:39:08","true","Merge pull request #2313 from containers/dependabot/go_modules/github.com/containers/common-0.9.1

Bump github.com/containers/common from 0.9.0 to 0.9.1",131,39,0,1
"containers/buildah","c5546750573cdef524be7159fe837f23274e9718","rhatdan","2020-04-07 21:02:01","true","Merge pull request #2289 from TomSweeneyRedHat/bump-1.14.7

Bump 1.14.7",118,38,0,1
"containers/buildah","9637a24425d011664f4ad2dc3baf0d26e62db108","nalind","2022-08-16 21:07:22","false","cmd/buildah: add ""manifest create --amend""

When `buildah manifest create` is given the `--amend` flag and a list
with the name that was specified for the to-be-created list already
exists, just reuse the list.

Make the `--insecure` flag, if we see it, conflict with `--tls-verify`,
but have the reverse of the effect that `--tls-verify` does, and teach
the `buildah manifest` `add`, `create`, and `push` subcommands about
it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",17,67,1,1
"containers/buildah","9ff37b0cf0526ba419cde657220de821f6cccfc2","nalind","2018-03-02 22:30:47","false","shallowCopy: avoid a second read of the container's layer

Avoid reading the container's layer a second time in shallowCopy (after
the first time it's read, in NewImageSource()).

Our second copy of the diff isn't going to match the first one if it's
of any serious size, because when NaiveDiff is used to generate the
diff, whiteout entries have their times set to ""now"", rather than a
fixed value, which causes both the uncompressed and compressed digests
to differ from what NewImageSource() records in the manifest.

Instead, use the generic manifest-reading API that the image library
now provides to read the layer info list and the config blob info, and
use their values to PutBlob() them to the destination image.

We can probably drop shallowCopy() completely, since the newer version
of the image library has a more reliable HasBlob(), which should save us
the time that shallowCopy() was originally meant to save, but we should
probably consider the use of compression for this code path as part of
that, too.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #506
Approved by: rhatdan",20,13,0,1
"containers/buildah","444060c5188d656ea09c074a9b217d34b3671177","nalind","2019-04-03 18:57:55","false","commit: check that we always set a ""created-by""

Check that when we use ""buildah commit"" to create an image, we always
specify a value in the created-by field in the item that we're appending
to the image's history.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",53,26,0,1
"containers/buildah","63c090808a63d18d72ff03d2dc33619f3c007ab3","nalind","2020-01-29 16:05:20","false","sign.bats: set GPG_TTY=/dev/null

Set GPG_TTY=/dev/null, which should hopefully prevent ENOTTY errors
during gating tests in CI.  h/t Chris Evich.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #2120
Approved by: rhatdan",107,36,0,1
"containers/buildah","76395efa52a2344bfdf47b13c92610225b16edf1","nalind","2017-05-18 16:17:35","false","Add an initial ""inspect"" command

Add an ""inspect"" command, which can be used to dump the contents of the
Buildah object for a working container, or the starting one we'd get for
a specified image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #109
Approved by: rhatdan",15,4,0,1
"containers/buildah","532e267a5856c56e7151b9ea011b7f783a746e53","umohnani8","2018-04-12 16:29:53","false","Fix secrets patch

The secrets code was just tarring and copying the contents of the secrets directory on host as is.
This meant it was not accounting for any symlinks inside the directory, leading up to the contents
not being copied over.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #582
Approved by: rhatdan",33,15,0,1
"containers/buildah","1680a5f0a06c0d371202a506069cdb9d33e942e4","TomSweeneyRedHat","2017-11-23 00:23:21","false","Fix iterator and a few typos in baseline test

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #335
Approved by: rhatdan",31,10,0,1
"containers/buildah","d84dc6424082022c5823dd4f1ced5d927fd5d8bb","TomSweeneyRedHat","2019-04-10 18:36:54","false","Create buildahimage Dockerfile for Quay

The Dockerfile in the buildahimage directory will be
used by quay.io/buildah when ever a new tag is created
here in this GitHub repo.  It will build a new buildahimage
image automatically.

At least that's the theory.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1506
Approved by: vrothberg",58,26,0,1
"containers/buildah","a0b2fe584913eae6ae3401d9c6c0868c7381fc6b","nalind","2021-03-22 16:01:05","false","pkg/chrootuser: use a bufio.Scanner

Use a bufio Scanner rather than our own cobbled-together
read-a-line-at-a-time function.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",53,50,0,1
"containers/buildah","44468f811c185e3b37809782c4395cc28309f6b3","nalind","2018-05-01 19:37:13","false","Force ""localhost"" as a default registry

Extend util.ResolveName() to prepend ""localhost"" to the list of
registries, and teach util.FindImage(), util.ExpandNames(), and
util.AddImageNames() to use util.ResolveName().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #648
Approved by: rhatdan",48,15,0,1
"containers/buildah","0cd9445b15dbe4f2dc15b97b4875b2aca183e1a3","openshift-merge-robot","2021-10-01 21:23:12","true","Merge pull request #3562 from cevich/fix_conformance_setup

Cirrus: Fix defunct package metadata breaking cache",42,56,1,1
"containers/buildah","cfecb3782851576d10304c68d49df5dcc8b94538","TomSweeneyRedHat","2018-08-25 19:22:41","false","Fix rename to also change container name in builder

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #959
Approved by: rhatdan",31,19,0,1
"containers/buildah","02f30c773e64a5df20503209def7802f961ee4dc","nalind","2017-01-27 15:55:04","false","Rename: lumper -> buildah

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","69ea563256138ee2e3d5311ca050398070795596","kolyshkin","2022-01-20 02:55:30","false","tests/tools/Makefile: simplify

1. Remove GO111MODULE=on and -mod=vendor. Those are not required
   (default) since go 1.16 (or earlier), and go 1.16 is currently
   the oldest supported release.

2. Remove go-build define:
   - cd `pwd` does not make any sense;
   - @echo > /dev/null masks any errors during tools building;
   - $(shell basename ...) could be replaced by $(notdir ...);
   - the above is not needed since we already have what we need
     as a target ($@);
   - finally, this is problematic for e.g. cpuguy83/go-md2man/v2
     (as it builds the binary named v2).

   So, just use $(GO_BUILD) -o $@ path/to/package

3. GO_BUILD does not need to be exported.

4. Mark $(BUILDDIR) target as phony -- a mere existence of the directory
   should not cause make to skip building the binaries.

K.I.S.S!

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","e3d4860067a4442ef7b83908f473180f760c27cf","giuseppe","2022-09-20 07:14:36","true","vendor: update c/common

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",19,68,1,1
"containers/buildah","b9e43034f26d66c6baeb30a7d943f730d01a44e1","nalind","2021-04-15 18:47:43","false","Log the final error with %+v at logging level ""trace""

If the logging level is at least ""trace"", log the final error we print,
if there is one, using %+v as the verb, or %v (changed from %s)
otherwise.  If the error was wrapped using github.com/pkg/errors, this
will provide a backtrace.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",52,51,0,1
"containers/buildah","c5f58e5f086c4e87689e2199c729ef1147df4c27","nalind","2020-10-14 15:44:01","false","CI: require that conformance tests pass

With imagebuilder v1.1.8, our conformance tests should start passing, so
we don't need to tolerate any failures in them going forward.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",63,45,0,1
"containers/buildah","9430ed4fcc15ca9a4b66b13371b1ff64731417f9","nalind","2018-08-31 07:07:13","false","Bump maximum cyclomatic complexity to 45

It's a worthwhile goal, but for the moment I don't want to have to
refactor the new error-checking bits in runCopyStdio() to get it back
under 40.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #980
Approved by: rhatdan",34,19,0,1
"containers/buildah","d7fe23ee54e88ef2251339afca13cf74f64529ab","nalind","2018-05-22 17:21:37","false","Run integration tests under travis_wait in Travis

Run tests under travis_wait - some of the RPM build tests take a bit
longer than 10 minutes to complete, and we don't want to time out and
cancel the test run as a result.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #716
Approved by: rhatdan",62,16,0,1
"containers/buildah","08ae38206ae24b2e519f9c51d24a78250702fe7d","TomSweeneyRedHat","2019-05-02 01:07:57","false","Bump back to 1.9.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1566
Approved by: nalind",52,27,0,1
"containers/buildah","32311f22fcf7b26a053cb70e172096124348565d","TomSweeneyRedHat","2019-02-26 21:27:46","false","Bump back to 1.8-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Bump version back to 1.8-dev after spinning 1.7.1.

Closes: #1371
Approved by: rhatdan",61,25,0,1
"containers/buildah","cf753ee6fe1f606c4456d2d76690534f8170d9a3","umohnani8","2018-06-28 17:59:42","false","Fix buildah bud --layers

When building with layers, the last step wouldn't get implemented
if a cache already existed. This fix checks if every step in the dockerfile
is the same, and if it is it just creates a copy of the existing image
with the new name passed in by the user. The images will have the same
IDs and the new one will just be another tag of the original image.
This is what docker build does as well.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #832
Approved by: rhatdan",28,17,0,1
"containers/buildah","fcbd144c40d5e1b737967151e2eb67bd4005d1ac","openshift-merge-robot","2022-02-16 20:39:40","true","Merge pull request #3784 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.0

build(deps): bump github.com/containerd/containerd from 1.5.9 to 1.6.0",27,61,1,1
"containers/buildah","d2e7a94cbfac9a15cfb2ee3631b6115609a2dce6","openshift-merge-robot","2023-01-04 17:18:56","true","Merge pull request #4495 from flouthoc/bump-storage-to-a747b27

vendor: bump c/storage to `a747b27`",21,71,1,1
"containers/buildah","6c61d9d77f7f48b825f8b6cd3af278dc758c8e6d","openshift-merge-robot","2022-01-25 15:39:46","true","Merge pull request #3743 from nalind/build-v

docs/buildah-build.1.md: don't imply that -v isn't just a RUN thing",33,60,1,1
"containers/buildah","a642acb850c8989e665515b1a0fb56e45f36a430","openshift-merge-robot","2020-10-14 21:04:06","true","Merge pull request #2690 from QiWang19/allow-insecure

Skip tlsVerify insecure BUILD_REGISTRY_SOURCES",63,45,0,1
"containers/buildah","bf64d38de3d6864246061163d069e0823b6dfeb2","openshift-merge-robot","2022-03-03 20:48:50","true","Merge pull request #3805 from lsm5/remove-kubic

[CI:DOCS] remove references to Kubic for CentOS and Ubuntu",29,61,1,1
"containers/buildah","898db4381cfd9a7940ea221d5b2a4ceab0ad86fd","openshift-merge-robot","2021-11-30 08:52:22","true","Merge pull request #3656 from nalind/copier-removeall

copier: RemoveAll possibly-directories",31,58,1,1
"containers/buildah","7474ed6fc7751574a1029835e5db850f85d419fb","openshift-merge-robot","2022-12-09 16:13:24","true","Merge pull request #4454 from containers/dependabot/go_modules/golang.org/x/crypto-0.4.0

build(deps): bump golang.org/x/crypto from 0.3.0 to 0.4.0",16,70,1,1
"containers/buildah","43fd1f5a9bfd95fe60f914cc6199f51ec26401b8","openshift-merge-robot","2023-02-21 19:09:35","true","Merge pull request #4611 from nalind/update-tutorial

docs/tutorials/04: add defaults for Run()",16,73,1,1
"containers/buildah","080e7d02403d45190aef537781898a06efae2816","openshift-merge-robot","2022-09-14 17:33:05","true","Merge pull request #4234 from flouthoc/fix-mount-parse

parse: make processing fields for `--mount` order agnostic",20,68,1,1
"containers/buildah","9866cc048b4add7431d0dfe183f94a830e089a56","openshift-merge-robot","2021-05-19 09:41:43","true","Merge pull request #3236 from rhatdan/VENDOR

Update vendor of containers/common v0.38.3",57,52,1,1
"containers/buildah","17d8e1b5d8992ccc52f1d487f0aae3f05987c85e","openshift-merge-robot","2021-03-04 10:36:22","true","Merge pull request #3055 from rhatdan/overlay

Set upperdir permissions based on source",56,49,0,1
"containers/buildah","356668389682ea765d2717760d6f5329ff99aff6","flouthoc","2023-01-02 07:12:55","true","buildah: add prune command and expose CleanCacheMount API

* Just like buildkit buildah must allow cleaning the buildcache and cache
generated on host by `--mount=type=cache` just like buildkit's `prune`
command.

* Also expose `CleanCacheMount` API so other tools like `podman` can use
  it.

See: https://github.com/moby/buildkit#cache
Closes: https://github.com/containers/buildah/issues/4486

Signed-off-by: Aditya R <arajan@redhat.com>",22,71,1,1
"containers/buildah","dd0f4f1b1eb49b841179049ac498e4b0f874b462","vbatts","2018-12-07 14:55:55","false","Makefile: allow packagers to more easily add tags

With the `?=` operator, then `make binary TAGS=...` will clobber, but
this way `make binary BUILDTAGS=foo` will append.

Also, this matches the skopeo `BUILDTAGS`

Signed-off-by: Vincent Batts <vbatts@hashbangbash.com>

Closes: #1228
Approved by: giuseppe",51,22,0,0
"containers/buildah","9790b8977174088cbadf420f31026ed5654dc5a9","TomSweeneyRedHat","2018-01-27 23:17:05","false","Allow all auth params to work with bud

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #419
Approved by: rhatdan",36,12,0,1
"containers/buildah","5cdbcfc0201da6b059b474ce4039a8f45485392a","edsantiago","2021-07-26 19:26:32","false","Proposed patch for 3399 (shadowutils)

Signed-off-by: Ed Santiago <santiago@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",38,54,1,1
"containers/buildah","1b8d997a07d15702bd69e21e7e31693fb7022866","rhatdan","2020-09-15 13:18:25","false","Drop error messages about OCI/Docker format to Warning level

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",90,44,0,1
"containers/buildah","5aec4fe722c99b3846fc2b499527cd8a49f6f2fe","rhatdan","2017-10-13 18:46:23","false","Vendor in latest code from containers/storage

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #288
Approved by: rhatdan",30,8,0,1
"containers/buildah","0b7c50023bd507dd7949e092dc52824962864a03","rhatdan","2022-06-10 10:03:54","false","Fix up buildah images

Fedora no longer ships /etc/containers/storage.conf but
/usr/share/containers/storage.conf, this causes the buildimages
to fail to build. This PR uses the storage.conf in /usr.

Removed Centos7 image, since this distribution is no longer supported
and no reason to ship an image specific to this distribution.
Removed stablebyhand image, since this does not look like it is needed
any longer, and was not being maintained.

[NO NEW TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",22,64,1,1
"containers/buildah","1cd77acafe7e09af58efde3e6928277c91273f12","rhatdan","2023-06-05 20:06:02","true","Merge pull request #4842 from containers/renovate/github.com-containerd-containerd-1.x

fix(deps): update module github.com/containerd/containerd to v1.7.2",16,76,1,1
"containers/buildah","ca4eb1a93c63ef6f3120b10e56323aa898e16708","nalind","2019-11-21 20:32:41","false","bind: don't complain about missing mountpoints

When we go to unmount a tree of mounts, if one of the directories isn't
there, instead of returning an error as before, log a debug message and
keep going.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1996
Approved by: rhatdan",83,34,0,1
"containers/buildah","153d9d5e4c509b63421e363196a480f780bc9fe3","nalind","2018-06-11 18:15:00","false","Run(): tweak terminal mode handling

Default to using a controlling terminal if all three stdio descriptors
are terminals, not just stdout.

Don't try to set stdin to raw mode while running a container if it's not
a terminal, in which case it doesn't support terminal modes.

Don't try to read the window size of stdin if it's not a terminal, in
which case it doesn't have a window size.  Provide a way to explicitly
set it for those cases.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #795
Approved by: rhatdan",32,16,0,1
"containers/buildah","34d6ee13b8e0c622cef140d2965e352a074dcd5f","nalind","2021-08-10 22:11:15","false","imagebuildah: move multiple-platform building internal

Move multiple-platform build juggling logic from the CLI wrapper
directly into the imagebuildah package, to make using it easier for
packages that consume us as a library.

This requires reading Dockerfiles into byte slices so that we can
re-parse them for each per-platform build, rather than parsing them
directly, as we used to, since building modifies the parsed tree.

When building for multiple platforms, prefix progress log messages with
the platform description.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",37,54,1,1
"containers/buildah","aa61e230803d8f3ec799942fdd829fca63615f9f","nalind","2017-01-27 11:28:12","false","Parameterize the binary name

We're going to change the package name, likely sooner rather than later,
so parameterize it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","03c50f46c2ea972e570348a5def1a61f629b09aa","EricHripko","2019-06-08 16:56:41","false","Add a test for the symlink pointing to a directory

Signed-off-by: Eric Hripko <ehripko@bloomberg.net>

Closes: #1637
Approved by: rhatdan",60,28,0,0
"containers/buildah","dcd2a92e56693e920e383aa4024892cf24b7cc54","vrothberg","2021-04-10 17:44:51","false","use new containers/common/libimage package

Move all code related handling container image over to the new
`libimage` package in containers/common.  The new package is an
attempt to consolidate the code across the containers tools under the
github.com/containers umbrella.

The new `libimage` packages provides functionality to perform all kinds
of operations for managing images such as local lookups, pushing,
pulling, listing, removing, etc.

The following packages have been moved over the containers/common:

`manifests` -> `common/image/manifests`
`pkg/manifests` -> `common/pkg/manifests`
`pkg/supplemented` -> `common/pkg/supplemented`

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",52,50,0,1
"containers/buildah","472c46f98035c7e08dbbc64dc405691783553bde","edsantiago","2022-10-06 12:22:56","false","bud.bats refactoring: $TEST_SCRATCH_DIR, part 2 of 2

Manual cleanup, basically a lot of eyeballing:

 - search for 'cp -R', look for instances that the script
   goofed on, clean those up

 - grep TEST_SCRATCH_DIR tests/bud.bats|grep -v contextdir|less
   and look for whatever looks wrong. This mostly found cases
   of ""use-layers"" where there were multiple mkdirs.

Signed-off-by: Ed Santiago <santiago@redhat.com>",27,68,1,1
"containers/buildah","4026fa9696764121563094fba4545951eec47af5","giuseppe","2021-02-05 15:46:01","true","run: fix check for host pid namespace

check the pidns is shared with the host only when the pidns mode is
specified.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",96,48,0,1
"containers/buildah","4d963eb5e12be4985ff2bca2c005bd544032677c","dfr","2022-08-05 14:16:06","false","chroot: Move runUsingChrootExecMain to run_common.go

Again, this breaks the FreeBSD build and this will be addressed by
refactoring in the next commit.

Signed-off-by: Doug Rabson <dfr@rabson.org>",18,66,1,0
"containers/buildah","dc07d9ff515c11b9afc42afdfe1650da37cc9643","edsantiago","2022-06-14 13:49:23","false","More test cleanup

- ""run_buildah 0"" should be simply ""run_buildah"" (the 0 is implicit)

- remove ""mktemp -d"". Those are evil. (Reason: they are not cleaned up,
  so they pollute the test system. We have $TEST_SCRATCH_DIR. Use it.

- replace a few icky '[[ ... ]]' checks with 'assert'

Signed-off-by: Ed Santiago <santiago@redhat.com>",22,65,1,1
"containers/buildah","552d09b272ecf4113176d5a0cebcfd20ba238b70","edsantiago","2022-04-26 15:09:11","false","Rename $TESTSDIR (the plural one), step 4 of 3

...rename $TESTDIR (the singular one) to $TEST_SCRATCH_DIR,
which is clearer but unfortunately longer

Signed-off-by: Ed Santiago <santiago@redhat.com>",24,63,1,1
"containers/buildah","018cdfe93966972c6f082afe37bc00fdbfff641a","rhatdan","2022-09-18 10:17:52","true","Merge pull request #4229 from rhatdan/network

buildah bud --network=none should have no network",20,68,1,1
"containers/buildah","56d302d734b6509e0d96fe7826df2e77ff179c5d","rhatdan","2021-06-17 19:14:48","true","Merge pull request #3310 from containers/dependabot/go_modules/github.com/containers/image/v5-5.13.1

build(deps): bump github.com/containers/image/v5 from 5.13.0 to 5.13.1",41,53,1,1
"containers/buildah","91f54ed546ce54785d165e61d1a45871b6817e3e","danishprakash","2023-09-05 11:39:31","true","tests/bud: add tests

Signed-off-by: danishprakash <danish.prakash@suse.com>",6,79,1,0
"containers/buildah","751f92ed13c408e6f15ae9cf17bdb4b7cae176a0","rhatdan","2019-10-28 20:56:48","false","Add support for make vendor-in-container

Certain versions of go have different vendoring capabilities.
We want to make sure that vendoring the the vendor checker are
running with the same version of golang.  We do this by using
podman to run a container of the lates golang container image.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1949
Approved by: TomSweeneyRedHat",80,33,0,1
"containers/buildah","5129d28aac625f771c91d253e059e3eb9403d188","openshift-merge-robot","2021-01-06 11:25:27","true","Merge pull request #2885 from cevich/track_libseccomp_golang

Cirrus: Track libseccomp and golang version",91,47,0,1
"containers/buildah","70a27a77b5284211e66d31e46c28c18ec4a39a45","openshift-merge-robot","2021-03-23 18:09:23","true","Merge pull request #3095 from nalind/user-spec

COPY --chown: expand the conformance test",54,50,0,1
"containers/buildah","e47f4a1f6eecb404140485f9fd568aafa3f61fc3","openshift-merge-robot","2021-10-09 10:40:24","true","Merge pull request #3577 from TomSweeneyRedHat/dev/tsweeney/cign2

[CI:DOCS] Touch up Containerfile man page to show ARG can be 1st",41,56,1,1
"containers/buildah","33b7088fec7b6483168607283489c9e18302333e","openshift-merge-robot","2023-06-27 11:01:36","true","Merge pull request #4883 from Luap99/vendor

vendor: update c/{common,image,storage} to latest",12,77,1,1
"containers/buildah","7657739909b3432439bc5050e732dd69285e5a90","openshift-merge-robot","2023-05-19 11:31:26","true","Merge pull request #4806 from flouthoc/bump-logrus

vendor: bump logrus to `v1.9.2`",14,76,1,1
"containers/buildah","c15269d58a88349b137e680f54b2f1563a96fac0","openshift-merge-robot","2021-02-24 15:42:22","true","Merge pull request #3006 from barthy1/mult_arch_buildah_build

Add multi-arch image build",58,49,0,1
"containers/buildah","c21965d1b53854d50f089308182ce0e9f5659db4","openshift-merge-robot","2021-05-19 19:12:26","true","Merge pull request #3242 from rhatdan/VENDOR

Vendor in containers/common v0.38.4",57,52,1,1
"containers/buildah","9bf6b5e2245fe1e3d0691ddd517a500e026bdfa0","TomSweeneyRedHat","2019-09-06 19:53:24","false","Downgrade .papr to highest atomic verion

Per @jlebon, the highest level of fedora atomic is 29, not 30.
Bumping the version down one in hopes of fixing our test
issues.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1845
Approved by: rhatdan",60,31,0,1
"containers/buildah","d84f05a304ece7998fe848b94e0201f4927a0bf2","TristanCacqueray","2018-04-20 01:00:35","false","Fix README example of buildah config

The example needs to use config argument before the container name,
otherwise it is failing with: too many arguments specified.

Signed-off-by: Tristan Cacqueray <tdecacqu@redhat.com>

Closes: #610
Approved by: rhatdan",38,15,0,0
"containers/buildah","ef571ef45f1755381af34d2f75a2996963233019","rhatdan","2018-09-12 20:50:45","false","Vendor in latest containers/image and containers/storage

Storage fixes a deadlock situation, when lots of buildahs/podmans
are running at the same time.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1010
Approved by: nalind",38,19,0,1
"containers/buildah","100d5b12eba3d1ae2b62a09910c0a12134d11e37","nalind","2021-09-27 21:26:01","false","buildah build: add --all-platforms

Add a --all-platforms that instructs the builder to build for the
intersection of all platforms for which the build's base images are
available.  Returns an error if any of them aren't references to
manifest lists.  We've learned that we can't really trust architecture
and OS information stored in image config blobs, so we don't try to
salvage that case.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",38,56,1,1
"containers/buildah","211972afc7604330dfde6d0899c4c44d0880cfb6","openshift-merge-robot","2021-10-07 11:22:26","true","Merge pull request #3573 from containers/dependabot/go_modules/github.com/opencontainers/selinux-1.9.1

build(deps): bump github.com/opencontainers/selinux from 1.8.5 to 1.9.1",42,56,1,1
"containers/buildah","0508fba0644511fd5007ad3dee66f9abf1cc590b","openshift-merge-robot","2021-02-09 21:55:36","true","Merge pull request #2990 from rhatdan/VENDOR

Vendor in containers/image v5.10.2",95,48,0,1
"containers/buildah","74cd96acf358d20ed8187466a1647f91291af442","openshift-merge-robot","2022-04-18 23:11:53","true","Merge pull request #3916 from flouthoc/manifest-create-retry-with-local

manifest-create: allow creating manifest list from image in `local-storage`",27,63,1,1
"containers/buildah","0ec651fd3c4a26eebaf3ca857b46138b23aec42e","openshift-merge-robot","2021-01-28 19:40:32","true","Merge pull request #2938 from umohnani8/arg-cache

Rebuild layer if a change in ARG is detected",94,48,0,1
"containers/buildah","9e6e15c314bfd014e4d10c6305427bfdc63e1572","flouthoc","2023-03-02 05:54:39","true","tests/bud: remove unwated test

Expecting warning for the builtin defaults in not in sync with what
buildkit is doing or docker is doing so buildah should do the same.

Signed-off-by: Aditya R <arajan@redhat.com>",19,73,1,1
"containers/buildah","f5fc96e79b76048a6c6d5f2c79aa5491f7ec5eb2","AndASM","2022-09-30 15:52:39","false","Changed build argument from `RELEASE` to `FLAVOUR`

Due to concerns about the ambiguous overloaded meaning of RELEASE in
this context, the build argument has been renamed to `FLAVOUR`.

Signed-off-by: Andrew Meadows <andrew@befuddled.ca>",20,68,1,0
"containers/buildah","4f376bbb5e3c46abe243b5eed25afe9495d46911","TomSweeneyRedHat","2017-11-12 00:35:09","false","Set option.terminal appropriately in run

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #323
Approved by: rhatdan",29,9,0,1
"containers/buildah","21397a1be29ed578957eb6c4c7bfcb4c6763eeec","nalind","2020-11-05 17:46:21","false","Run: correctly call copier.Mkdir

Make sure the directory we're creating is explicitly below the chroot we
want to create it under.

Fix a similar incorrect call in imagebuildah.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",67,45,0,1
"containers/buildah","7e80ec00adfd0629470412935b7e55d0b40b0aea","rhatdan","2022-02-02 19:36:50","false","Bump version of containers/image and containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",34,60,1,1
"containers/buildah","2ac987a52ff8412fb8f2908a191009751a6a1c62","rhatdan","2018-11-20 17:28:46","false","Vendor in latest content from github.com/containers and opencontainers

Update opencontainers/selinux to fix potential race condition when relabeling.
Update containers/image to pull in some debugging improvements and small potential
bugs
Update containers/libpod to fix small potential bugs.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1189
Approved by: giuseppe",64,22,0,1
"containers/buildah","bb710f39d01868e47224f35f48a128fbea6539c4","rhatdan","2019-01-05 18:31:33","true","Merge pull request #1244 from vrothberg/vendor-everything

Vendor containers/{image,storage} for faster compression and parallel pulls",53,23,0,1
"containers/buildah","4888163cf12b4e0c0d32ef7eb0ed941c2c81d4f7","rhatdan","2018-08-04 08:00:35","false","Bump to v1.3

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #911
Approved by: rhatdan",22,18,0,1
"containers/buildah","36605c29eb258caa9720dbd42622269a81dd1bfa","rhatdan","2019-01-31 10:48:59","false","Prepend a comment to files setup in container

setup.rpm attempts to modify /etc/hosts, if it thinks
it has never been modified.  By adding a #comment to the
front of the file, it should prevent this from blowing up
the build.

Also add hostname to the /etc/hosts file linked to localhosts

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1313
Approved by: vrothberg",54,24,0,1
"containers/buildah","d03123204dd59c6b760567e5b1d79def312cf441","atgreen","2017-11-10 11:25:51","false","Add RHEL build instructions.

Signed-off-by: Anthony Green <green@redhat.com>

Closes: #322
Approved by: rhatdan",29,9,0,0
"containers/buildah","3d7403130100c3558ea14a1c21482559109de043","rhatdan","2019-03-25 10:23:56","false","Move pkg/chrootuser from libpod to buildah.

We don't want to vendor anything from libpod into Buildah.
We want to switch this around.  Moving pkg content from libpod
to Buildah allows us to fix this.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1400
Approved by: giuseppe",39,26,0,1
"containers/buildah","0f114e993c1c9af83e7584ef70be252a31f8ee13","rhatdan","2019-01-17 22:00:03","true","Merge pull request #1287 from nalind/ensure-container-path

imagebuildah: make EnsureContainerPath() check/create the right one",51,24,0,1
"containers/buildah","a5e5f219cbf1aec53e75b5094c982347fbbbf7e8","rhatdan","2018-08-02 18:00:39","false","Remove rpm.bats, we need to run this manually

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #891
Approved by: rhatdan",29,18,0,1
"containers/buildah","c0ffda06843f51c45656b94182b106be1effd973","rhatdan","2022-07-27 11:24:59","true","Merge pull request #4135 from flouthoc/output-fix

stage_executor, output: generate correct artifacts for `multi-stage` builds and `cached` builds with `--output`",19,66,1,1
"containers/buildah","b20e423639c58bd59a5bfa77d48d99bd4923ae6a","rhatdan","2018-04-04 12:40:51","false","Bump to v0.16.0

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #552
Approved by: rhatdan",26,14,0,1
"containers/buildah","bbf27625d58bc2d91b8f78ccb592729e453e76fc","rhatdan","2021-04-22 16:54:37","false","Remove buildah bud --loglevel ...

This was never hooked up and just causes confusion for users.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",49,51,0,1
"containers/buildah","7acdfe8e8dd171f587f8c9a4af4a143082fcb101","rhatdan","2020-12-30 12:16:24","false","Add support for --manifest flags

This patch allows users to build a multi arch image with simple commands
using emulation software.

```
buildah bud --arch arm --manifest myimage /tmp/mysrc
buildah bud --arch amd64 --manifest myimage /tmp/mysrc
buildah bud --arch s390x --manifest myimage /tmp/mysrc
```

And something like this for buildah commit
```
build() {
	ctr=$(./bin/buildah from --arch $1 ubi8)
	./bin/buildah run $ctr dnf install -y iputils
	./bin/buildah commit --manifest ubi8ping $ctr
}
build arm
build amd64
build s390x
```

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",88,47,0,1
"containers/buildah","0ce1071650c5ab8b7f5e696855e1e05198e2f1f4","umohnani8","2018-10-08 18:17:31","false","Walk symlinks when checking cached images for copied/added files

If a cache is found for a copied/added file, check for symlinks
and follow the symlink to get most up to date information of
file status.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>

Closes: #1075
Approved by: rhatdan",51,20,0,1
"containers/buildah","d46d16c6df6b0561780e6220adf73bae8ac4de79","bertinatto","2018-02-24 22:40:44","false","Add multi-stage builds tests

Signed-off-by: Fabio Bertinatto <fbertina@redhat.com>

Closes: #495
Approved by: nalind",18,13,0,0
"containers/buildah","300eb17c0c5176da819ddff2f7e611943ecdb6c4","edsantiago","2021-02-23 13:33:26","false","[CI:DOCS] buildah-from.md: remove dup arch,os

PR #2869 (--manifest) documented --arch and --os in the
buildah-from man page, without realizing that those were
already documented.

Here I choose to keep the old --arch and the new --os

Signed-off-by: Ed Santiago <santiago@redhat.com>",60,49,0,1
"containers/buildah","944aee21286601eacbf03563a6838e0ed13550b3","edsantiago","2019-10-18 16:10:48","false","BATS tests - lots of mostly minor cleanup

First, and possibly most controversial, remove --debug flag.
Output on test failure is painful to read. It is unlikely
(but not inconceivable) that --debug will be of any use.

Second, fix a failure message so it properly uses %s instead
of string interpolation. (If the test name itself includes
a percent sign, we get undefined behavior on output).

Fix a few instances of 'buildah' to be 'run_buildah'.

Remove some unnecessary 'run/echo/check-status' sequences,
sticking with the much cleaner 'test'. When BATS shows
an error of the form 'this failed: [ $status -eq 0 ]'
I weep in despair.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1935
Approved by: giuseppe",79,33,0,1
"containers/buildah","01f9ae2d70d48552f8fc44aceb0f5882027a6dc9","nalind","2018-10-30 18:41:49","false","Test blob caching

Check that when we use blob caching, the blobs that we commit and push
which came from the base image are indeed the same as the ones from the
base image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1149
Approved by: rhatdan",54,21,0,1
"containers/buildah","9d6da3a44fd4c2495f3abc4ce6d3e91ac4427b4c","nalind","2019-03-18 14:10:04","false","buildah-bud.md: correct a typo, note a default

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1419
Approved by: rhatdan",36,26,0,1
"containers/buildah","a5129ec3eb5c0c085ea6e5ba37c95f5d9d12601b","nalind","2017-12-14 22:41:36","false","Add a test that 'rmi' works with truncated image IDs

Add a test to ensure that 'buildah rmi' works if passed a truncated
version of an image's ID.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #361
Approved by: rhatdan",33,10,0,1
"containers/buildah","a4ca99f108cfb48cf96fff0cfa43d2850cecb2f0","nalind","2017-02-02 20:20:55","false","Use trusty for Travis CI builds

Use trusty for Travis CI builds - the btrfs-tools package in precise
didn't include headers that we needed.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,0,0,1
"containers/buildah","568b19813cb2bce3e42a44b02f1604bcf7686b4e","nalind","2021-02-16 18:41:17","false","copier: return child process stderr if we can't JSON decode the response

If the subprocess exits with an error, but we can't decode its stdout as
a proper status result, check if it produced error output.  If it did,
then return its error output as the error.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",62,49,0,1
"containers/buildah","12a17e5dfa888da5535206f9ec5c94cebc38e334","nalind","2021-02-03 16:07:34","false","blobcache: fix sequencing error

Wait for the goroutine that's saving a decompressed copy of the blob to
finish before checking the digest that it's computing, to avoid a race
condition which would cause us to read the digest value before we're
finished computing it.
Refuse to get involved when compression isn't gzip, pending a bigger
update to handle zstd correctly.
Set CompressionOperation and MediaType when suggesting substitutions.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",96,48,0,1
"containers/buildah","ce13780b83c0f11a49be254d7e076519c2109bf9","nalind","2017-03-17 22:45:19","false","Add a couple of tests for ""run""

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","67e53418466a4a8084d437c0e0db88babb62c6c6","TomSweeneyRedHat","2018-01-02 17:48:35","false","Add kernel version requirement to install.md and touchups

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #372
Approved by: rhatdan",27,11,0,1
"containers/buildah","af5bbde0180026ae87b7fc81c2dc124aa73ec959","TomSweeneyRedHat","2018-09-14 18:57:08","false","Fix grammar in Container Tools Guide

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1017
Approved by: rhatdan",38,20,0,1
"containers/buildah","798a250d435845fd86e0f3e4eed92105e6b707a3","rhatdan","2022-12-09 17:06:01","false","Update vendor or containers/(image, storage, common)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",16,70,1,1
"containers/buildah","3aea4093d4b3bb03799bd6c1d49e6d4cc6b65d06","rhatdan","2022-06-07 12:51:57","false","Sort buildoptions and move cli/build functions to internal

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",22,64,1,1
"containers/buildah","9042b86b2d580781c4f242c6201e513e589e7965","rhatdan","2022-06-09 20:01:50","false","Vendor in latest github.com/sirupsen/logrus

[NO NEW TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",23,64,1,1
"containers/buildah","1cc85e7c597bb9a74ae04326d125c342646a091a","giuseppe","2021-09-22 15:34:16","true","push: support to specify the compression format

add two new flags to ""buildah push"" to allow tweaking the compression
format for the data layers.

The flag --compression-format allows users to specify the compression
algorithm to use.

With --compression-level it is possible to tweak the compression
level.

An image usage for partial pulls can be pushed with:

$ buildah push --compression-format zstd:chunked FOO

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",40,56,1,1
"containers/buildah","a986f34af5455eb576413f260595f47892aa924a","giuseppe","2019-03-13 13:01:52","false","slirp4netns: set mtu to 65520

it improves significantly the performance of the slirp4netns network:

https://github.com/rootless-containers/slirp4netns/tree/777bdccceffa5bee38dbfd9eefc06628cc160ff6#iperf3-netns---host

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1404
Approved by: vrothberg",34,26,0,1
"containers/buildah","3088277ee8156d9b89b46fb049d68735c91a7930","rhatdan","2018-04-25 14:00:46","false","Add support for --iidfile to bud and commit

Add support for an --iidfile which specifies the file to write the
image id, when committing a new image.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #636
Approved by: TomSweeneyRedHat",55,15,0,1
"containers/buildah","c0b8ba5d25dd387ab0582f21b44117f46847e42a","rhatdan","2020-09-15 21:13:56","false","Add missing --format option in buildah from man page

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",91,44,0,1
"containers/buildah","f9cff07b812177ca5e54dc1b3947df0a1833e735","Luap99","2022-01-05 20:36:49","true","use libnetwork from c/common for networking

Podman uses the new netavark network stack. Buildah should be able to do
the same. Both projects should use the same networking code which was
move to c/common/libnetwork. The new network interface can use either
CNI or netvavark. Using the same code for podman and buildah is
important to ensure that both use the same backend. Mixing CNI and
netavark is not supported.

This also fixes some outstanding CNI issues, e.g. buildah trying to
connect all cni networks.

[NO NEW TESTS NEEDED]

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",26,59,1,0
"containers/buildah","1087564fc5fe2de869ebcb55b5cc03c8b4d36dc6","openshift-merge-robot","2020-11-09 09:00:22","true","Merge pull request #2758 from nalind/cache-image-info

imagebuildah.getImageTypeAndHistoryAndDiffIDs: cache results",67,45,0,1
"containers/buildah","4952862a22b879768e2d869749257b36cb32397f","eschnett","2023-01-05 18:16:11","true","Correct minor comment

[NO NEW TESTS NEEDED]

Signed-off-by: Erik Schnetter <schnetter@gmail.com>",20,71,1,0
"containers/buildah","2ea2c076c059afaf1ba7f7f43fbbb8b17efba27a","openshift-merge-robot","2022-04-08 13:50:39","true","Merge pull request #3894 from nalind/test-registry

integration tests: learn to start a dummy registry",24,62,1,1
"containers/buildah","1c80ba415a68683eb70955f8878887038750b2df","cevich","2021-06-23 15:52:06","true","Cirrus: Updates for master->main rename

Signed-off-by: Chris Evich <cevich@redhat.com>",37,53,1,1
"containers/buildah","6b207f7b0c2a988bd57a64de5e55e9ecea375631","nalind","2018-02-06 17:02:21","false","Fix unintended reversal of the ignoreUnrecognizedInstructions flag

We were interpreting the ignoreUnrecognizedInstructions incorrectly, so
fix that, and call out the unrecognized instruction keyword in the error
message (or debug message, if we're ignoring it).

Should fix #451.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #452
Approved by: rhatdan",36,12,0,1
"containers/buildah","78dd2b1f71b941b332665ede0c44f76c9c796c8a","jacobwgillespie","2021-06-21 13:06:23","true","Extract version command implementation to function

Signed-off-by: Jacob Gillespie <jacobwgillespie@gmail.com>",36,53,1,0
"containers/buildah","39880517a19ffde1ca2fca5f29cb051309e56773","slp","2022-06-09 12:41:42","false","Update vendor of containers/storage

Signed-off-by: Sergio Lopez <slp@redhat.com>",22,64,1,0
"containers/buildah","8a6ad7d3d52f0efad88bf6eccd5204815c6da2c7","vbatts","2018-12-07 15:13:01","false","Makefile: soften the requirement on git

When building from the source tarball, .git is not present, and `:=` can not
just be overridden with `make binary GIT_COMMIT=...` but and can be with
`?=`

Signed-off-by: Vincent Batts <vbatts@hashbangbash.com>

Closes: #1229
Approved by: rhatdan",51,22,0,0
"containers/buildah","cc734103a0ff8551c233645a1b7d1a55ac04f7fd","TomSweeneyRedHat","2021-04-18 00:27:35","false","Fix arg missing warning in bud

If a Containerfile had an ARG specified with a value and it was
referenced later in a multifrom scenario, a Warning would be raised
unless there was a `--build-arg` option specified for the argument.

This change removes the warning if the ARG has a value specified
in the Containerfile.  We still need the warning however, if it
is not specified via a `--build-arg` or within the Containerfile.

Fixes:  #3020

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",53,51,0,1
"containers/buildah","677b771195392ee132de92a98d28e22919af3d1e","ashley-cui","2019-07-30 15:24:09","false","Add '-' minus syntax for removal of config values

Minus syntax for `--env`, `--label`, and `-annotation` flags for `buildah config` subcommand.

Signed-off-by: Ashley Cui <ashleycui16@gmail.com>

Closes: #1748
Approved by: rhatdan",47,30,0,0
"containers/buildah","a97a904729ea68b8342ea3d699d401050e99ce94","rhatdan","2022-03-08 13:14:01","true","Merge pull request #3811 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.7.10

build(deps): bump github.com/fsouza/go-dockerclient from 1.7.9 to 1.7.10",30,61,1,1
"containers/buildah","2f545788b67b2a8ef3fb5d1100cff8709aadad7d","nalind","2017-03-17 21:32:53","false","Default ""from"" to --pull=true

Change the behavior of ""from"" to default to have --pull be true, rather
than the previous default of false.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","377fd209d8cad790f0a6e2212c57877ffeea2626","nalind","2018-08-20 19:24:20","false","Add docker.HealthConfig.StartPeriod

The HealthConfig.StartPeriod field was added to docker late in 2016.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #943
Approved by: TomSweeneyRedHat",27,19,0,1
"containers/buildah","74a319586ecbf3207c6bb18e83cfc0557ca47368","nalind","2019-05-06 21:17:50","false","getParent/getChildren: handle layerless images

Adjust parent/child logic to handle cases where images have no layers.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1580
Approved by: rhatdan",56,27,0,1
"containers/buildah","9d545aac8cc7f1d18eee86cce93defa70711c4ef","nalind","2021-09-23 17:32:55","false","Makefile: check for `-race` using `-mod=vendor`

When checking if `go test` supports `-race` on the current platform, use
`-mod=vendor` if it's available, so that the compiler won't try to pull
down our dependencies, and run it against a package that has fewer
dependencies.

Run `go tool dist list` once, and filter its results to derive the
cross-compile target lists, rather than running it three times.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",39,56,1,1
"containers/buildah","b9749f8f05f6388d248bdbe18750e315ec37f96d","kolyshkin","2022-01-18 02:28:53","false","imagebuildah/executor.go: fix gosimple warning

Fix the following warning:

> 	imagebuildah/executor.go:307:6: S1033: unnecessary guard around call to delete (gosimple)
>						if _, stillUnused := exec.unusedArgs[list[0]]; stillUnused {
>						^

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","fa7f030da8ac2cfc9455c3326fd33558df4e1aab","giuseppe","2019-05-28 10:25:39","false","linux: add check for sysctl before using it

check that the sysctl we'd like to use is supported by the kernel
before using it.

Closes: https://github.com/containers/buildah/issues/1618

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1619
Approved by: rhatdan",57,28,0,1
"containers/buildah","fb325c70640372ba5e9aed172694cd0e9dc9f7d7","giuseppe","2018-10-23 10:05:22","false","unshare: create a new mount namespace

it is needed to support other backends than vfs.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1124
Approved by: rhatdan",52,21,0,1
"containers/buildah","0986de40360ae9a9f1826d91472af9d35143426f","rhatdan","2022-05-25 09:51:47","false","Fix codespell errors

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",25,64,1,1
"containers/buildah","55db29386524137edec70bc3451ef77e7dc6e248","rhatdan","2023-05-19 21:13:10","true","Merge pull request #4807 from flouthoc/change-debian

test: use debian instead of docker.io/library/debian:testing-slim",14,76,1,1
"containers/buildah","79f41e3235ecc17d711a9aa06ec769234ec95399","rhatdan","2022-09-30 16:25:27","false","Bump to v1.28.0

[NO TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",20,68,1,1
"containers/buildah","1d741379083685c45e2484e6a6946e39776b814a","rhatdan","2021-11-22 14:27:17","false","Make LocalIP public function so Podman can use it

[NO NEW TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",29,58,1,1
"containers/buildah","820fafc889b69b069d6ac8614eaf60d7eaf4c6e5","rhatdan","2023-01-05 15:33:31","false","Vendor in latest containers/(common, image, storage)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",20,71,1,1
"containers/buildah","c65d8376413d68f819646a293c5a3e04184f14cb","rhatdan","2022-12-12 19:41:48","true","Merge pull request #4443 from flouthoc/extend-cache-from-api

remote-cache: support multiple sources and destination for `--cache-to` and `--cache-from`",16,70,1,1
"containers/buildah","ffa3034c8e1bd0e358eb7c1174554d2709d13c7e","rhatdan","2022-11-04 13:34:59","true","Merge branch 'main' into VENDOR",22,69,1,1
"containers/buildah","5b1b0d27ca424f98f1a6c8ae43b5a462861a0ed2","rhatdan","2021-12-03 14:27:53","false","Wire logger through to config

Currently we are only wiring the logger into run_linux.go
Not into the Config section.

This PR is needed in order to update vendor in Podman.
https://github.com/containers/podman/pull/12375

[NO NEW TESTS NEEDED] Tests will be done in Podman.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",30,58,1,1
"containers/buildah","22f4c3db00cef32b56629e57c7dfb28f74658351","openshift-merge-robot","2021-04-02 18:20:08","true","Merge pull request #3124 from rhatdan/tty

Setup alias for --tty to --terminal",49,50,0,1
"containers/buildah","3ec3ecc8c2600e9cfc211d51cf329168c53f969c","openshift-merge-robot","2023-08-10 00:10:58","true","Merge pull request #4964 from lsm5/main-packit

[CI:BUILD] Packit: add fedora-eln targets and build docs with vendored go-md2man",10,78,1,1
"containers/buildah","3b8acfb245eab346b71b1d67b0bfef6cdb5398d1","openshift-merge-robot","2021-03-09 12:12:25","true","Merge pull request #3065 from alvistack/master-linux-amd64

Update nix pin with `make nixpkgs`",58,49,0,1
"containers/buildah","e481c9b4a6e2bb043e5d30c4257079001548e706","openshift-merge-robot","2021-03-05 19:45:26","true","Merge pull request #3062 from rhatdan/pull

Make PolicyMap and PullPolicy names align",57,49,0,1
"containers/buildah","370cda2917138d5d2f80ffccf1cfa7ad26fb4f89","openshift-merge-robot","2023-03-26 10:49:03","true","Merge pull request #4684 from giuseppe/mount-new-sysfs-with-new-netns

run_linux: Update heuristic for mounting /sys",12,74,1,1
"containers/buildah","20dd347b9a60f90c149118344ad29e68a8b112ec","slonopotamus","2022-11-16 07:44:11","true","Fix installation instructions for Gentoo Linux

Signed-off-by: Marat Radchenko <marat@slonopotamus.org>

Signed-off-by: Marat Radchenko <marat@slonopotamus.org>",23,70,1,0
"containers/buildah","3c9e9baee8cc6ec6ee7e561abc00ec5bce1b9546","openshift-merge-robot","2023-09-14 19:00:28","true","Merge pull request #5046 from nalind/tag-1.32

Tag a v1.32.0 release",5,80,1,1
"containers/buildah","176f0532b4685cb36215171ce26e7b94f2b6cca2","rhatdan","2023-08-25 19:16:07","true","Merge pull request #4997 from dfr/parse-groups

pkg/chrootuser: Ignore comments when parsing /etc/group on FreeBSD",8,79,1,1
"containers/buildah","933c8c89fb3aaf509974bd1a780034641095d0b4","nalind","2021-11-29 17:51:16","false","copier: RemoveAll possibly-directories

When we attempt to remove a directory to make way for a non-directory as
part of extracting content, use RemoveAll() instead of Remove().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",32,58,1,1
"containers/buildah","faa321f1086b38ebe030a847897d6b725577f7e7","lsm5","2018-09-12 01:46:17","false","run container-diff tests in Travis

This commit will cause Travis to spawn a fedora container
which will build a Dockerfile using docker and buildah bud
and then compare both images using container-diff.

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>

Closes: #1003
Approved by: rhatdan",37,19,0,1
"containers/buildah","bd32a04c37f704f902e53774d547973b36f62cb1","kolyshkin","2023-05-31 23:01:29","false","Remove device mapper support

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",16,76,1,0
"containers/buildah","b34e4d5789599c0eaba9951a8010db3caf47dccf","kolyshkin","2022-01-18 02:24:23","false","util.go: fix gosimple warning

Fix this warning from gosimple linter:

>	util.go:127:19: S1040: type assertion to the same type: ref.DockerReference() already has type reference.Named (gosimple)
>			if named, ok := ref.DockerReference().(reference.Named); ok {
>					^

Since containers/image commit dfe2fafaa2d702e5a932721aed55b996024051b1
(made in 2017), DockerReference() always return reference.Named type.

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","d3e06dc91827711be3c0d4f53b5ef8461d7243e1","saschagrunert","2019-06-25 14:26:41","false","Update docker/libnetwork to get rid of outdated sctp package

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1690
Approved by: rhatdan",42,29,0,1
"containers/buildah","4ece9c447ae3d706ab496a6a81e39defad333ec2","cevich","2019-12-20 15:24:48","true","Cirrus: Fixes from review feedback

Signed-off-by: Chris Evich <cevich@redhat.com>",90,35,0,1
"containers/buildah","a630e35131b27c75e6b4b2bc57c8f3cde944718f","cevich","2023-05-30 20:29:35","true","CI: Support testing w/ podman-next COPR packages

Sometimes important updates need to be made to dependent packages and
run through CI w/o waiting for package release and new CI VM image
builds.  Support this in buildah CI as in podman CI, by updating
packages during setup when the magic string is present and PR is in
draft-mode.

Note: To support containerized testing, both `CIRRUS_CHANGE_TITLE`
and `CIRRUS_PR_DRAFT` env. vars. are passed through.  For these tasks,
this will result in **TWO** updates - One for the host, and another one
in the container.

Signed-off-by: Chris Evich <cevich@redhat.com>",15,76,1,1
"containers/buildah","f3f3c55301dbc0615c01463b47868169e6b840f0","openshift-merge-robot","2021-09-17 13:28:52","true","Merge pull request #3517 from flouthoc/step-modified-labels

build: Add additional step nodes when labels are modified",39,56,1,1
"containers/buildah","4db17cc7a259065c08a81a8aeec7d1dc17e92a0d","openshift-merge-robot","2023-09-13 00:34:16","true","Merge pull request #5040 from containers/renovate/github.com-containerd-containerd-1.x

fix(deps): update module github.com/containerd/containerd to v1.7.6",5,79,1,1
"containers/buildah","c0915a5bf080abb926964f042f605faa3d793920","openshift-merge-robot","2021-02-27 12:10:04","true","Merge pull request #3042 from jmguzik/complement-add-copy-chmod-doc

complement add/copy --chmod documentation",57,49,0,1
"containers/buildah","5a8b6529d44ebc5c152e7b54c986f90012de8462","openshift-merge-robot","2021-02-01 11:40:54","true","Merge pull request #2948 from rhatdan/docs

[ci:docs] Fix man page for buildah push",94,48,0,1
"containers/buildah","08a2ca0132b061fd4e0ceaf7b35a77f745da8b9c","openshift-merge-robot","2023-04-27 10:32:58","true","Merge pull request #4757 from flouthoc/fix-platform-docs

 build: `--platform` must accept only arch",13,75,1,1
"containers/buildah","535262498a70ddc8f82599cbdc6be8e67161109e","openshift-merge-robot","2021-03-07 13:10:53","true","Merge pull request #2756 from nalind/overlay-volumes

imagebuildah: use overlay for volumes when using overlay",57,49,0,1
"containers/buildah","2e1d92e1be1281e058d4ac526ade3d6617ac7857","openshift-merge-robot","2020-11-20 20:51:04","true","Merge pull request #2814 from tuananh/fix-examples-bash-script

fix: non-portable shebang #2812",78,46,0,1
"containers/buildah","1b8c014f3eee13d26d126b945959087629505396","openshift-merge-robot","2022-03-29 12:19:46","true","Merge pull request #3871 from turrisxyz/naveensrinivasan/dependabot

Updated dependabot to get updates for GitHub actions.",28,62,1,1
"containers/buildah","b2bd51341dbcac20d190776ad201e0b533b403ea","flouthoc","2022-04-18 06:54:57","true","manifest-create: allow creating manifest list from local image

`manifest create` must perform a final lookup on local storage while
user adds image while creating a manifest list because there can be
scenarios when image is not pushed to remote reistry and it only exists
on local storage.

A change similar to this was added here: https://github.com/containers/buildah/pull/3877
Also see: https://github.com/containers/buildah/blob/main/cmd/buildah/manifest.go#L328

Closes: https://github.com/containers/buildah/issues/3915

Signed-off-by: Aditya R <arajan@redhat.com>",27,63,1,1
"containers/buildah","f0d3140e5a1a9867cf8c8f0d8a811dacb53a73cc","flouthoc","2021-09-28 11:20:36","true","build: Add support for buildkit like --mount=type=bind

Following commit adds support for using buildkit like
`--mount=type=bind` with `RUN` statements. Mounts created by `--mount`
are transient in nature and only scoped to current RUN statements.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",38,56,1,1
"containers/buildah","e81dd7983c37c494a9d86c4ef2c90140e444fe10","flouthoc","2022-04-04 05:37:01","true","build, commit: allow removing default identity labels

Allow end users to remove default identity labels if they want to.
Since there are instances where images can be reproduced across version
hence users must have option to suppress default labels.

Closes: https://github.com/containers/buildah/issues/3826

Signed-off-by: Aditya R <arajan@redhat.com>",25,62,1,1
"containers/buildah","481b3cc95e8c741eccbb96b58d27fe68d066db02","flouthoc","2022-11-01 05:30:01","true","userns: add arbitrary steps/stage to --userns=auto test

Support for build with `--userns=auto` was added here https://github.com/containers/buildah/pull/4064
but it never tested a build where multiple ephemeral containers were
used. So just add arbitrary steps and stages to the exisitng
`--userns=auto` test to make sure build still works fine.

Signed-off-by: Aditya R <arajan@redhat.com>",24,69,1,1
"containers/buildah","3814945f9bf0e69d2f1299550805953826669d5c","TomSweeneyRedHat","2018-03-26 21:50:56","false","Touchup README to re-enable logo

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #536
Approved by: rhatdan",21,14,0,1
"containers/buildah","12523e03c334ccd8f54fa65d09606d09a1565756","TomSweeneyRedHat","2018-10-11 22:59:02","false","Vendor in latest libpod

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1088
Approved by: rhatdan",53,20,0,1
"containers/buildah","505a4472301ef5d9e2313b1c952de9406d2b1a9f","bogdando","2020-11-24 08:47:22","false","Add a source debug build

Add target: make all DEBUG=1.
Uses the -N -l go compiler options to disable compiler optimizations
and inlining. Using these build options allows you to subsequently
use source debugging tools like delve.

Signed-off-by: Bogdan Dobrelya <bdobreli@redhat.com>",78,46,0,0
"containers/buildah","adfc2343872c8ebb530f224cd3ece168f465cc8e","rhatdan","2022-08-26 09:10:28","true","Merge pull request #4204 from containers/dependabot/go_modules/github.com/opencontainers/runc-1.1.4

build(deps): bump github.com/opencontainers/runc from 1.1.3 to 1.1.4",16,67,1,1
"containers/buildah","80fcb2460b2f74c935249b3501d67b2e645c05ff","rhatdan","2019-02-14 20:59:42","false","Help document using buildah mount in rootless mode

Update man page to show example of using buildah mount
in rootless mode.

Also enhance buildah mount --help to explain the buildah unshare
requirement.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1341
Approved by: TomSweeneyRedHat",59,25,0,1
"containers/buildah","f6498cf6e5156bbd37c7681b61c95af6618e82a4","rhatdan","2022-01-10 13:44:38","true","Merge pull request #3695 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.7.7

build(deps): bump github.com/fsouza/go-dockerclient from 1.7.6 to 1.7.7",27,59,1,1
"containers/buildah","45538bc76b55000d00539f8dd0a16d069b5270c3","rhatdan","2022-01-11 20:38:41","true","Merge branch 'main' into secrets",28,59,1,1
"containers/buildah","e4309501e4446e2a7118ed1df31de5260c7dfc6b","rhatdan","2023-05-16 14:30:38","true","Merge pull request #4792 from flouthoc/move-volume-validation-backend

build: validate volumes on backend",13,76,1,1
"containers/buildah","9f5e1b3a77758c6585410c4187f4d47d0cff3c47","rhatdan","2018-01-03 13:43:56","false","Make lint was complaining about some vetshowed err

We often use err as a variable inside of subblocks, and
we don't want golint to complain about it.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #379
Approved by: nalind",29,11,0,1
"containers/buildah","c07017d2895e617d6dd4b6c8d68f883122ddc733","rhatdan","2018-06-06 21:57:30","false","Report errors on bad transports specification when pushing images

We ignore valid errors when pushing images. This patch will check
if the user gave us a valid transport and report the error.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #760
Approved by: @mtrmac",32,16,0,1
"containers/buildah","d92da92e4d4b476beac000d2f2b4932c80811cae","rhatdan","2022-01-26 00:43:32","true","Update docs/buildah-build.1.md

Co-authored-by: Tom Sweeney <tsweeney@redhat.com>",34,60,1,1
"containers/buildah","123c8313d0ce168c33593e57b36f63b5fb83f8cd","rhatdan","2020-09-17 13:06:54","true","Merge pull request #2624 from rhatdan/mount

Fix buildah mount to display container names not ids",92,44,0,1
"containers/buildah","eedab4fd872c3be8ab15af767897f92c78a71fde","lsm5","2022-02-21 19:58:40","true","helpers.bash: Use correct syntax

Fixes gating test failure:
```
 /usr/share/buildah/test/system/./helpers.bash: line 474: !is_cgroupsv2: command not found
 ```

Co-authored-by: Yiqiao Pu <ypu@redhat.com>

I'm just the committer.

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",30,61,1,1
"containers/buildah","85476bf093822f682b08ed34b039116c16536a05","rhatdan","2017-11-22 13:57:31","false","Buildah bud does not work with SELinux

buildah bud was not setting the mount label on the image
so SELinux in enforcing mode is blocking writing to the image

This patch also fixes a similar problem with the `buildah mount`
command

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #332
Approved by: TomSweeneyRedHat",30,10,0,1
"containers/buildah","bf70abf3734570f9905d0504a6e2c4d3be4a9d99","rhatdan","2018-04-04 11:17:09","false","Remove requires for ostree-lib in rpm spec file

I stupidly added this in a previous patch. rpm figures this
out for you so no need to specify.  On RHEL systems ostree-libs
does not exist.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #551
Approved by: rhatdan",26,14,0,1
"containers/buildah","84a261dd106bf3a0286bd96da4abca40d6c2071f","rhatdan","2021-01-04 14:23:44","false","Upper directory should match mode of destination directory

When we mount over a destination directory inside of the container
we need to preserve the mode of the destination.

Needed to fix: https://github.com/containers/podman/issues/8801

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",91,47,0,1
"containers/buildah","f4cfe9c65b232d280b80e15b7dab8ef0ddbfdaf4","rhatdan","2019-08-08 13:34:47","true","Merge pull request #1747 from TomSweeneyRedHat/dev/tsweeney/trubs

Add overlayfs to fuse-overlayfs tip",51,30,0,1
"containers/buildah","126b578d8e6b4b81875c842c7486440582ec013d","rhatdan","2017-04-18 19:52:53","false","Contribute buildah.spec

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #70
Approved by: rhatdan",13,3,0,1
"containers/buildah","37e9d254ccef0c2f719fa458205f04ea0db7058e","rhatdan","2021-04-19 10:22:41","false","Fix copier when using globs

In Docker if you are copying more then one object, and
one of them is successful, then the command is successful. Currently in
buildah each glob has to be successful. This PR matches Buildah to
Docker.

Fixes: https://github.com/containers/podman/issues/9594

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",53,51,0,1
"containers/buildah","53be3d39f1cb4a182cfc3559726332f643f335c8","giuseppe","2019-05-24 11:56:03","false","unshare: fallback to single usermapping

if setting an unprivileged user namespace with newuidmap/newgidmap
failed, then fallback to a single ID mapping.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1612
Approved by: rhatdan",54,28,0,1
"containers/buildah","27a97cdc3dffce76fc9b9ac7699cebcf335e0586","nalind","2017-02-10 20:00:09","false","Make the example script exit on error

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,0,0,1
"containers/buildah","0d717cd0a52376c80cb527a344a1d7446b0d56e7","openshift-merge-robot","2023-09-29 16:57:35","true","Merge pull request #5066 from ranjithrajaram/devel-doc

[CI:DOCS] Protocol can be specified with --port. Ex. --port 514/udp",7,80,1,1
"containers/buildah","72c539082edc07745417da2eb391219bbef6dcad","openshift-merge-robot","2023-08-01 07:11:04","true","Merge pull request #4945 from mtrmac/close-image

Ensure created ImageSource / ImageDestination objects are closed",14,78,1,1
"containers/buildah","d106e425a335fd1d027292e753934250d1d8bdf8","cevich","2023-01-11 18:59:29","true","Cirrus: Update VM Images

Of special note: These images use a down-rev kernel which is not subject
to https://bugzilla.redhat.com/show_bug.cgi?id=2159066

Signed-off-by: Chris Evich <cevich@redhat.com>",22,71,1,1
"containers/buildah","e89d43047059d42c003254d15a62e8affacab5a4","openshift-merge-robot","2022-09-27 12:40:12","true","Merge pull request #4296 from rhatdan/codespell

Run codespell on code",21,68,1,1
"containers/buildah","a818b5527f02cfeaaeed271cf281081d5351ebb6","openshift-merge-robot","2022-06-09 03:41:25","true","Merge pull request #3986 from Luap99/resolvconf

use resolvconf package from c/common/libnetwork",22,64,1,1
"containers/buildah","64a37f2a62fe9b423872f0883964d69e9a355c6d","openshift-merge-robot","2022-04-22 21:48:38","true","Merge pull request #3922 from rhatdan/VENDOR

Update vendor of containers/(common,storage,image)",25,63,1,1
"containers/buildah","843cbe7813a504a0823744ad80e7fad8d2f02ee0","flouthoc","2022-03-16 02:59:59","true","parse: convert exposed GetVolumes to internal only

Implementation of `GetVolumes` seems to be changing with addition of new
features hence moving it from exposed parse package to internal parse
package and move needed helpers with it.

Signed-off-by: Aditya R <arajan@redhat.com>",31,62,1,1
"containers/buildah","78a1d08ebae468cebff9e40d119caec0309a8a7d","openshift-merge-robot","2021-11-19 22:29:41","true","Merge pull request #3640 from cevich/use_static_fedora-minimal

Tests should rely only on static/unchanging images",27,58,1,1
"containers/buildah","a80feebe8778fd74b076598b0a7ae9027310fcd1","TomSweeneyRedHat","2021-07-29 23:58:43","false","c/image, c/storage, c/common vendor before Podman 3.3 release

In preparation for Podman v3.3.0, start the vendor dance

c/common  - v0.42.0
c/image   - v5.15.0
c/storage - v1.33.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",36,54,1,1
"containers/buildah","162fbaf909be409ab56c8e50d802c587a0c600be","openshift-merge-robot","2021-05-14 11:06:33","true","Merge pull request #3221 from rhatdan/error

Check earlier for bad image tags name",54,52,1,1
"containers/buildah","f01ddd680041c68f3110f54d967c5b9570525dab","openshift-merge-robot","2021-01-07 11:34:34","true","Merge pull request #2883 from rhatdan/overlay

Upper directory should match mode of destination directory",91,47,0,1
"containers/buildah","e6e6042334783d0197459b2198e9d84453401104","nalind","2020-07-20 20:30:42","false","test-unit: increase the test timeout to 40/45 minutes

Increase the timeout we give for unit tests from the default (10
minutes) to 40 minutes for the tests, 45 minutes for the test job, since
they're timing out in CI.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",149,42,0,1
"containers/buildah","d29655bf596b45fe7f8fb03dc1ecfac0154a1435","TomSweeneyRedHat","2020-06-23 19:40:17","false","Add bud regression tests

We recently made a couple of commits to the imagebuilder
project to address #2345 and #2192.  Tests were created
in that project, but I thought it best to add some
regression tests here in Buildah too.

FYI: @petr-motejlek and @tachoknight

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",143,41,0,1
"containers/buildah","0ac2a67ab21144ed5df93bb78b88f704a9cf3496","rhatdan","2020-05-25 11:56:04","true","Merge pull request #2376 from containers/dependabot/go_modules/github.com/onsi/ginkgo-1.12.2

Bump github.com/onsi/ginkgo from 1.12.1 to 1.12.2",136,40,0,1
"containers/buildah","37df2b9690e545dd0dd5ac511b6765956baa409f","lumjjb","2020-04-01 18:15:56","false","implementation of encrypt/decrypt push/pull/bud/from

Signed-off-by: Brandon Lum <lumjjb@gmail.com>",112,38,0,0
"containers/buildah","a4b593acf6f789fc6c56c77a244d1ee5bb44900e","rhatdan","2020-04-07 14:46:17","false","Bump github.com/containers/image/v5 from 5.3.1 to 5.4.3

Bumps [github.com/containers/image/v5](https://github.com/containers/image) from 5.3.1 to 5.4.2.
- [Release notes](https://github.com/containers/image/releases)
- [Commits](https://github.com/containers/image/compare/v5.3.1...v5.4.3)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",118,38,0,1
"containers/buildah","d31630b223f767ecb0d8163ec004180d87b595a5","TristanCacqueray","2019-01-04 13:10:07","false","Remove duplicate entries from images JSON output

This change is a follow-up to 7c2467c to use the break outer
construct and only display a single JSON block per image.

Closes: #1259
Signed-off-by: Tristan Cacqueray <tdecacqu@redhat.com>

Closes: #1260
Approved by: rhatdan",54,23,0,0
"containers/buildah","4743c2e7f132010a01de2d9cf96d10244fced423","umohnani8","2018-04-06 14:56:09","false","Update buildah push doc

The example for the oci transport was misleading as it showed a different format.
Added an example for oci-archive. Added oci-archive to the Destinations.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #559
Approved by: rhatdan",26,14,0,1
"containers/buildah","785b3bf30a9dba427594bc1e10adff2c4daf400a","nalind","2021-11-29 15:14:47","false","image: set MediaType in OCI manifests

In image-spec 1.0.2, the MediaType field is now available in OCI
manifests, so set it.

Update the imgtype helper to output the MediaType field as-is from OCI
image manifests instead of just always supplying the expected value.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",31,58,1,1
"containers/buildah","98ff540de5306b62c6382ed1b03f58a6f617f8b4","openshift-merge-robot","2022-03-31 08:15:29","true","Merge pull request #3882 from nalind/copier-test

copier test: use correct UID/GID in test archives",26,62,1,1
"containers/buildah","cc80ccc252275a10f923baec2ac88527e14ab2c4","nalind","2019-09-04 18:57:10","false","makeImageRef: ignore EmptyLayer if Squash is set

If Squash is set, then we're only committing one layer, so if EmptyLayer
is set, which would normally tell us to skip committing the final layer,
we should ignore the EmptyLayer flag.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1839
Approved by: TomSweeneyRedHat",59,31,0,1
"containers/buildah","b77856eae3c90b6cc431cfa44507f769e0c9afd8","mtrmac","2018-11-23 10:40:49","false","Update for API changes

NOTE: This is a very minimal update; blobinfocache.go should be
substantially reworked to benefit from the cache instead of decompressing
layers to get the DiffID values.

Also removes some HasBlob checks in the blobinfocache test suite which don't have
a direct equivalent in the new API, and makes the test suite independent
of host's signature policy.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1218
Approved by: rhatdan",64,22,0,1
"containers/buildah","2283f62a3826e3f17810c8274c612797564f8d1b","mtrmac","2018-06-11 22:31:04","false","Pass a types.Image to Builder.initConfig

Both callers of initConfig use a types.Image to get a manifest and
config; so, preserve the types.Image and pass it to Builder.initConfig.

This does not change behavior (except for making the lifetime of
a types.Image a bit longer in one case), but it will allow moving the
manifest/config load into Builder.initConfig in the future.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #776
Approved by: rhatdan",33,16,0,1
"containers/buildah","acbe3014380748ba638b39397a4957c2514d89ec","kolyshkin","2022-01-18 03:23:09","false",".golangci.yml: enable unparam linter

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","318e2f608adfbf472cb6c125fb38ed8fccadba84","QiWang19","2018-11-11 05:37:31","false","Sort CLI flags

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1173
Approved by: rhatdan",62,21,0,1
"containers/buildah","b8f939db45f852bdf62657975a45a4c19ef8bb82","nalind","2017-03-06 22:20:44","false","Fix parsing of the --storage-driver option

In the CLI tool, that's a string flag, not a boolean.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","29359f0d0bb337cdf1accd8868dea6f8fa8cfe73","nalind","2018-05-11 17:00:14","false","Implement basic recognition of the ""--isolation"" option

Add the basics of handling the ""--isolation"" option, though at the
moment, the only recognized option is ""oci"", which is our default.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #822
Approved by: rhatdan",56,15,0,1
"containers/buildah","14d58918fb125293c2804dd93a4eac0c452e9da9","nalind","2022-03-07 20:56:42","false","tests/copy: initialize the network, too

Force libnetwork to record the network configuration so that its
auto-detection logic doesn't get confused by the presence of the image
that we're writing to storage, after it's been written.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",30,61,1,1
"containers/buildah","1b05c67961bc32d2a469ece45183c984dd868ec7","nalind","2017-04-11 18:39:16","false","imagebuildah: Commit() doesn't need a parser node

The Commit() method doesn't use its parser node argument, and the
Commit() method in the dockerclient builder in imagebuilder doesn't, so
switch to match its signature.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #74
Approved by: rhatdan",13,2,0,1
"containers/buildah","65707368d8e1830ab795cdd692c512cfab600d37","nalind","2018-10-17 22:06:16","false","Use a blob cache when we're asked to use one

Add API hooks for designating locations to be used as blob caches when
pulling and pushing images.  When we commit read-only copies of
container layers for use in images, if we're using blob caching, store a
copy of the layer in the blob cache directory so that it can be found.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1149
Approved by: rhatdan",55,21,0,1
"containers/buildah","4f3abf9367ff4b36dbb77acb61538ec0e6d811a5","nalind","2023-07-25 22:17:33","false","Add some docs for `build --cw`, `commit --cw`, and `mkcw`

Add docs for the new --cw option recognized by both `commit` and
`build`, and the new `mkcw` command.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",13,78,1,1
"containers/buildah","1e105cfe037581508c680d0d322c4fcd922de37e","bbodiya-akamai","2019-09-04 14:41:48","false","replace --debug=false with --log-level=error

Signed-off-by: Brian Bodiya <bbodiya@akamai.com>",59,31,0,0
"containers/buildah","bdd78ad9174ba5c495396337b8b87054e298d3c1","TomSweeneyRedHat","2019-10-04 14:43:15","false","Bump to v1.11.3

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1896
Approved by: rhatdan",67,32,0,1
"containers/buildah","bff1c193a3d736b0246a04895044be70fbd813fe","dfr","2022-06-15 11:10:31","false","Move checkAndOverrideIsolationOptions to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","9afaf748c290158518d96fe9d42e43ae637c5088","nalind","2019-10-25 21:16:45","false","version: also note the version of containers/image

Include the containers/image version in our version output.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1902
Approved by: rhatdan",80,33,0,1
"containers/buildah","d3064796af36d5db8c5a7ce721a09e287e61fa3a","openshift-merge-robot","2022-09-21 13:11:14","true","Merge pull request #4269 from giuseppe/update-common-and-storage

vendor: update c/storage and c/common",20,68,1,1
"containers/buildah","5686018e7992684d55dd8bd552fb5720dce5a606","flouthoc","2022-06-22 10:48:00","true","build: support OCI hooks for ephemeral build containers

Following PR adds support for OCI hooks attached to each of ephemeral
build contains which are created by `RUN` step invoked during `buildah
build` command.

Following PR also adds `--hooks-dir` flag to `buildah build` option
which allows end-users to specify one or more configuration directories
for OCI-hooks.

Note: Following PR migrates `pkg/hooks` from `podman` to `buildah` so
buildah could implement this feature and once merged `podman` can start
using `buildah/pkg/hooks`.

For usage see man-page and example test-case.

See: https://github.com/opencontainers/runtime-spec/blob/main/config.md#posix-platform-hooks

Closes: https://github.com/containers/buildah/issues/4068

Signed-off-by: Aditya R <arajan@redhat.com>",24,65,1,1
"containers/buildah","44f96a5178e41fc649dd3b9e525d163da527b464","openshift-merge-robot","2022-05-31 14:49:39","true","Merge pull request #4021 from lsm5/ubuntu-2204-lts-cirrus

Cirrus: use Ubuntu 22.04 LTS",27,64,1,1
"containers/buildah","67c2219bf1fae7cc0093f2b7854cc778040369ff","openshift-merge-robot","2022-05-25 14:32:48","true","Merge pull request #4015 from rhatdan/codespell

Fix codespell errors",24,64,1,1
"containers/buildah","d5b66920bd42caf74020a86a25faee4e0b0d228a","cevich","2021-11-19 15:52:28","true","Tests should rely only on static/unchanging images

Around 18th of Nov. 2021, a new/incompatible
`quay.io/libpod/fedora-minimal:latest` was pushed by the quay
auto-builder servicing the podman repo.  This caused a number of
problems across several branches.  To address this, the auto-builder was
disabled and a fixed F34 based image was tagged and pushed as both
`latest` and `34`.  However, all repositories which use this test image
need to be individually updated to reference it.

See https://github.com/containers/podman/pull/12343

Signed-off-by: Chris Evich <cevich@redhat.com>",28,58,1,1
"containers/buildah","42dbc976287676a7a188a3e60a715c49e62bc036","openshift-merge-robot","2021-07-28 00:08:43","true","Merge pull request #3399 from rhatdan/dockerfile

Fix handling of --restore shadow-utils",37,54,1,1
"containers/buildah","d99221f776788822d0bf0c902c1aaca705c18e61","openshift-merge-robot","2021-06-15 20:35:12","true","Merge pull request #3286 from nalind/cpp-logging

imagebuildah: use the specified logger for logging preprocessing warnings",37,53,1,1
"containers/buildah","4196ede96f395cccb89a2d5921e0ee729bfc12ae","openshift-merge-robot","2021-06-15 20:34:13","true","Merge pull request #3300 from cevich/more_link_fixes

[CI:DOCS] Fix links to c/image master branch",37,53,1,1
"containers/buildah","ab0163adf5be6c27c2cdcfdc74031340c2372739","nalind","2020-07-02 17:12:33","false","Resolve a possible race in imagebuildah.Executor.startStage()

Don't allocate the Executor's stages member, which is a map, from
possibly-multiple goroutines that check if it's nil and allocate it if
it is, since that's racy.  Just allocate the map when we create the
structure it's part of.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",146,41,0,1
"containers/buildah","8a4646d584af5c2b39a15c5d1e2887b900118faf","cevich","2020-06-26 18:42:36","true","Cirrus: Fix missing htpasswd in registry img

Recently the registry image was updated significantly with breaking
changes.  Most were caught, this one was not.  Instead of relying on the
(clearly) unreliable container image, simply install the package
providing the htpasswd command locally.

Signed-off-by: Chris Evich <cevich@redhat.com>",147,41,0,1
"containers/buildah","28aa5ee861dd67909914a6872109f806ff412350","cevich","2020-04-20 18:34:25","true","golangci-lint: Disable gosimple

For some reason, this particular check causes the process to be killed
after some amount of time.  No error message is displayed, with or
without `--verbose`.  Disable the check with an explanatory comment.

Signed-off-by: Chris Evich <cevich@redhat.com>",125,39,0,1
"containers/buildah","935a6188d5b7ee0d51f409409d161de03cfd6d74","DanielCalvo","2020-02-09 00:26:38","true","Fixing formatting & build instructions

Fixed a typo on markdown link for Podman, revised build instructions for correctness, reviewed & added consistent sudo usage for Debian and Ubuntu.

Signed-off-by: Daniel Calvo <vioseven@gmail.com>",111,36,0,0
"containers/buildah","9819c4a6ebf62136dbb95d80b91276118b257474","giuseppe","2018-12-04 11:06:46","false","vendor: update containers/storage

inherit a change for rootless containers to ignore devices nodes
inside of images.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1217
Approved by: vrothberg",46,22,0,1
"containers/buildah","9c8c58c33b0b6e15f2fa780042ef46552a8a26d4","baude","2018-09-06 19:17:59","false","Exclude --layers from the common bug cli flags

Other applications like podman would like to switch the the default value
for --layers.  Because we re-use this code, we just need to pop layers out
of the budflags.

Signed-off-by: baude <bbaude@redhat.com>

Closes: #991
Approved by: rhatdan",36,19,0,0
"containers/buildah","89bc2a6a6ab9b88ad1a31b63181b95dcd9825cd3","TomSweeneyRedHat","2019-10-31 14:15:56","false","Fix --pull=true||false and add --pull-never to bud and from (retry)

(Replaces #1873 as it had lint issues that were timing out tests that I couldn't
track down easily)

Prior to this fix, if someone did `buildah bud --pull=false .` and the image in
the Containerfile's FROM statement was not local, the build would fail. The same
build on Docker will succeed. In Docker, when `--pull` is set to false, it only
pulls the image from the registry if there was not one locally. Buildah would never
pull the image and if the image was not locally available, it would throw an error.
In certain Kubernetes environments, this was especially troublesome.

To retain the old `--pull=false` functionality, I've created a new `--pull-never`
option that fails if an image is not locally available just like the old
`--pull=false` option used to do.

In addition, if there was a newer version of the image on the repository than
the one locally, the `--pull=true` option would not pull the image as it should
have, this corrects that.

Changes both the from and bud commands.

Addresses: #1675

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1959
Approved by: rhatdan",82,33,0,1
"containers/buildah","d6b7e33846711659a3961ccc317731dd8b284700","TomSweeneyRedHat","2018-10-25 14:29:07","false","Fix unshare gofmt issue

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1129
Approved by: rhatdan",51,21,0,1
"containers/buildah","6417a9a07481b87e20f25a15648d8a3196c5eceb","saschagrunert","2020-01-20 11:31:09","false","Allow users to set OS and architecture on bud

When building images we now allow the architecture and operating system
to be overwritten via the new `--os` and `--arch` flags. This allows the
use case of packing pre-built or cross-compiled binaries into container
images with specifying the correct environment. The `--platform` flag
now takes the `os/arch` format into account as well.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #2097
Approved by: rhatdan",103,36,0,1
"containers/buildah","88696184563e19c60bf1a5a4358055944197e811","cevich","2019-11-08 15:39:53","true","Cirrus: Update packages + fixes for get_ci_vm.sh

Signed-off-by: Chris Evich <cevich@redhat.com>",79,33,0,1
"containers/buildah","d1c4a74a392afe06ae2cb45d9e583b752e64f8a6","giuseppe","2018-11-20 17:19:53","false","vendor: update selinux

inherit a change for not failing a recursive relabelling if the file
is removed between the directory is read and the lsetxattr syscall.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1188
Approved by: rhatdan",64,22,0,1
"containers/buildah","a99139c1965b4426177fc70ee53a8e8dfdf3b6f9","saschagrunert","2019-08-12 13:10:14","false","Allow buildah bud to be called without arguments

This allows to simply call `buildah bud`, which assumes the current
working directory as build context. This directory should contain a
Dockerfile, which has been mentioned in the docs as well.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1784
Approved by: rhatdan",54,30,0,1
"containers/buildah","3af9f97ce896aced9c180a11b26ef16a23216173","saschagrunert","2019-07-18 08:38:27","true","Add stylecheck linter and apply fixes

Signed-off-by: Sascha Grunert <sgrunert@suse.com>",48,30,0,1
"containers/buildah","0c70609031db21538cf294ac7a45d3c5a8c6cb93","TomasTomecek","2017-07-10 05:44:16","false","gitignore build artifacts

* manpages
* buildah binary
* imgtype binary

Signed-off-by: Tomas Tomecek <ttomecek@redhat.com>

Closes: #183
Approved by: rhatdan",18,5,0,0
"containers/buildah","cd1b62a9ada31031abdc57f3f7f15b97071d9faf","jamescassell","2019-04-12 23:03:39","false","auto pass http_proxy to container

- pass all proxy env vars
- --http-proxy option for bud and from
- bash_completion and docs

Signed-off-by: James Cassell <code@james.cassell.me>

Closes: #1525
Approved by: giuseppe",54,27,0,0
"containers/buildah","e130f2bef34fcdbce681a3bcf913ce0373fa878c","TomSweeneyRedHat","2018-05-02 20:12:35","false","Touch up auth test commands

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #652
Approved by: rhatdan",48,15,0,1
"containers/buildah","371bc34fe40901cd762b946c3f07da53dcf48b80","andrm","2023-05-23 08:05:22","false","Fix auth.json path (validated on Fedora 38)
wq
Signed-off-by: Andreas Mack <andreas.mack@gmail.com>

Signed-off-by: Andreas Mack <andreas.mack@konsec.com>",18,76,1,0
"containers/buildah","646c2829013366773bc58dd27672ccd043ce4fc2","dfr","2022-11-06 15:10:40","false","Use TypeBind consistently to name bind/nullfs mounts

This allows declaring run mounts using e.g. '-mount=type=nullfs,...' on
FreeBSD which makes more sense for FreeBSD users. It is also consistent
with 'podman run' which requires the nullfs mount type on FreeBSD.

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",23,69,1,0
"containers/buildah","a21a427145f0905842163e6f8998bb2060951886","vrothberg","2019-06-18 11:10:24","false","conformance tests: nilness: allocate map

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","324040f8150e1c27c373c89e33a596c787930021","barthy1","2021-03-02 12:08:47","false","Add information about multi-arch images to the Readme

Signed-off-by: Yulia Gaponenko <yulia.gaponenko1@de.ibm.com>",58,49,0,0
"containers/buildah","c46716525cb925d166927a8506345d7d1b175d84","nalind","2017-02-17 18:54:49","false","Make the runtime for ""run"" more configurable

Provide RunOptions which can be used to change the runtime to something
other than ""runc"", and add an option that allows passing in additional
global arguments for the runtime.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","631cda1e5fa56e26468c14db65da86490d287b2c","nalind","2017-03-17 21:21:21","false","Update flag Usage strings to highlight arg types

Update the Usage strings that we include in Flag structures so that the
type of argument displayed in help output isn't just ""value"".

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","d172dd9ebe7b2c175ea52e5f5a23605723ecb559","nalind","2019-06-05 21:50:19","false","imagebuildah: use a stable sort for comparing build args

When checking if a history entry in a candidate image that represents a
RUN instruction matches what we'll do if the image is not a valid cached
image, sort the arguments.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1647
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","b7ccc2397b3c60c6eda9a3b84b0708c5ab60bb2b","nalind","2017-05-16 21:07:31","false","Import and namespace more types

Import more manifest and schema variables and types, and rename some of
them to incorporate version numbers.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #118
Approved by: rhatdan",10,4,0,1
"containers/buildah","d6340f18c1ebbffd063fd7748f3252a41fd65121","nalind","2019-03-22 21:06:56","false","commit: set created-by to the shell if it isn't set

Set the CreatedBy field of the new image's new history item to the shell
if we don't have a different value to set.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",37,26,0,1
"containers/buildah","16dc82bd9b418bd930512cb29e28c6da258fe1d3","nalind","2017-03-16 14:59:07","false","Merge pull request #9 from nalind/postmove

Catch up to the projectatomic move",7,2,0,1
"containers/buildah","39aaef4a617c84ce68102c753467a630903d6ed6","nalind","2019-05-06 20:39:48","false","bud.bats: test scratch images with --layers caching

Test scratch builds, and our ability to find cache images that don't
have layers.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1580
Approved by: rhatdan",56,27,0,1
"containers/buildah","63862c4047d364ea28ed8e9d5475ece51d760565","baude","2018-06-26 17:56:02","false","bind/mount_unsupported.go: remove import errors

In bind/mount_unsupported.go, only one import is needed. The current version
causes compilation errors when building for darwin.

../src/github.com/projectatomic/libpod/vendor/github.com/projectatomic/buildah/bind/mount_unsupported.go:6:2: imported and not used: ""fmt""
../src/github.com/projectatomic/libpod/vendor/github.com/projectatomic/buildah/bind/mount_unsupported.go:7:2: imported and not used: ""os""
../src/github.com/projectatomic/libpod/vendor/github.com/projectatomic/buildah/bind/mount_unsupported.go:8:2: imported and not used: ""path/filepath""

...

Signed-off-by: baude <bbaude@redhat.com>",28,17,0,0
"containers/buildah","9128a40ada95482c66f9fa76653bf02ca7383be2","ipbabble","2017-12-07 16:18:13","false","Fixed some Tom nits.

Signed-off-by: William Henry <whenry@redhat.com>",31,10,0,0
"containers/buildah","deaad44fe5c74b72214c7aa3e1adf8a9ad53d775","flouthoc","2022-04-04 05:34:33","true","manifest-add: allow override arch,variant while adding image

While adding image to manifest list if we ever fallback to scenario
where we are looking for image in local storage then do not override
system context with the one generated from parsing options, instead let
it use systemContext from host.

Signed-off-by: Aditya R <arajan@redhat.com>",25,62,1,1
"containers/buildah","d460e2ed0d845c48e0719597ee06d9dca8cdc842","openshift-merge-robot","2021-01-21 13:44:17","true","Merge pull request #2924 from containers/gating_test_SAN_fix

Workaround for RHEL gating test failure",96,48,0,1
"containers/buildah","d4f72ffc70b6641458c037dc99b892ab84ed643e","openshift-merge-robot","2021-02-10 23:49:38","true","Merge pull request #2993 from terceiro/fix-cache-with-build-args

Fix caching layers with build args",76,49,0,1
"containers/buildah","9c2f1a741b49ffc551d746af0c0c4a0f7a386d27","openshift-merge-robot","2022-01-21 15:49:30","true","Merge pull request #3727 from rhatdan/VENDOR

Vendor in latest containers/common",35,60,1,1
"containers/buildah","7a3bc6efd400cd597b11489dd2a9560b35796368","umohnani8","2017-11-15 20:18:48","false","Use credentials from kpod login for buildah

buildah push and from now use the credentials stored in ${XDG_RUNTIME_DIR}/containers/auth.json by kpod login
if the auth file path is changed, buildah push and from can get the credentials from the custom auth file
using the --authfile flag
e.g buildah push --authfile /tmp/auths/myauths.json alpine docker://username/image

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>

Closes: #325
Approved by: rhatdan",30,10,0,1
"containers/buildah","1e94614a42311ee955f268dabef76dcec6e9cf0c","major","2018-03-26 17:10:47","false","Clean up README.md

This patch removes the redundant horizontal rule and cleans up some
dangling whitespace.

Signed-off-by: Major Hayden <major@redhat.com>

Closes: #535
Approved by: TomSweeneyRedHat",21,14,0,0
"containers/buildah","5ece066f82c6072b47bffd470ca8c1690ee8270a","openshift-merge-robot","2023-07-22 11:49:01","true","Merge pull request #4900 from rhatdan/VENDOR

Vendor in latest containers/(common, storage, image)",14,78,1,1
"containers/buildah","9c8d096bdfc2ff5037c7f2cc800d95acc8a0fea8","rhatdan","2022-10-17 12:45:33","true","Merge pull request #4344 from containers/dependabot/github_actions/dawidd6/action-send-mail-3.7.1

build(deps): bump dawidd6/action-send-mail from 3.7.0 to 3.7.1",27,69,1,1
"containers/buildah","d8ce874faf7a505b549ee32ebaa4a03f55f7b85d","openshift-merge-robot","2022-07-22 13:37:06","true","Merge pull request #4128 from flouthoc/optimize-cache-hits

imagebuildah: optimize cache hits for `COPY` and `ADD` instructions",19,66,1,1
"containers/buildah","2c8c0f435f3ab761160d6fed4224aba46af892fa","openshift-merge-robot","2022-07-25 14:54:50","true","Merge pull request #4133 from dfr/freebsd-chroot

Rename chroot/run.go to chroot/run_linux.go",21,66,1,1
"containers/buildah","149880a1a447563053d8d53fee5675fc3e082b49","flouthoc","2022-05-23 19:04:11","true","squash: never use build cache when computing last step of last stage

* Last step of a squashed build produces a layer which contains contents
from other layers as well. So last step of last stage should be always
computed and never fetched from build cache, while other steps and
stages don't have this restriction.

* Refactor: drop squashToggle since its not useful

SquashToggle is not useful anymore since we don't alter
s.executor.squash instead we pass squash as bool to `s.commit(`

Signed-off-by: Aditya R <arajan@redhat.com>",26,64,1,1
"containers/buildah","7ede3f92cee19ff244be38b1162e9d68ad87fd6a","openshift-merge-robot","2022-04-08 14:12:20","true","Merge pull request #3836 from Luap99/netns-default

buildah: actually use containers.conf settings",24,62,1,1
"containers/buildah","8657d7ec9b82474fae1e202f437b92836ebe476a","openshift-merge-robot","2021-09-13 18:06:52","true","Merge pull request #3515 from rhatdan/VENDOR

Vendor in containers/common v0.44.0",39,55,1,1
"containers/buildah","ddda1bdcff0985c520800abd07c8cb55b83e88b7","rhatdan","2021-04-12 13:18:50","false","Bump containers/storage vendor to v1.29.0

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",52,51,0,1
"containers/buildah","fd4818065ae0e75a62e36ea59215ce8fbd3e6d2d","openshift-merge-robot","2021-03-08 16:06:40","true","Merge pull request #3069 from containers/dependabot/go_modules/github.com/onsi/ginkgo-1.15.1

build(deps): bump github.com/onsi/ginkgo from 1.15.0 to 1.15.1",57,49,0,1
"containers/buildah","167c6562eeba3f4666c203c6be23057ba162499e","openshift-merge-robot","2020-11-04 10:04:56","true","Merge pull request #2742 from nalind/perms

copier: try to force loading of nsswitch modules before chroot()",69,45,0,1
"containers/buildah","3fa4f2bb0cd6c94a76de21b01a10d5d44424711a","nalind","2020-09-01 18:41:22","false","StageExecutor.intermediateImageExists: recognize cached images based on scratch

Update imagebuildah.StageExecutor.intermediateImageExists() to recognize
images based on scratch as viable candidates for cache images when we
ourselves are based on scratch.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",84,43,0,1
"containers/buildah","3835460c3ba74a3e664229b519306d3a596d0b3c","nalind","2019-07-25 14:10:03","false","Use pipes for copying

Use the copier package to rework how we handle ADD and COPY.

When evaluating cache for content that's being copied/added in, switch
from (digest the data, check for a cache entry, then maybe copy the data
and create the new layer) to (copy the data and create the new layer,
digesting as we go, check for a cache entry, either commit or discard
the new layer).

Use the copier package for ADD, COPY, and for ensuring that a specified
directory exists in the working container's rootfs.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",46,30,0,1
"containers/buildah","0ee5ea325ab27144f262c8895b9b0724041a49ff","lumjjb","2020-05-12 19:20:13","false","Updated docs

Signed-off-by: Brandon Lum <lumjjb@gmail.com>",135,40,0,0
"containers/buildah","43f8bb3c5f4e3702378a0c3ca75123650be7d0a2","estroz","2018-10-02 21:00:48","false","docs/tutorials/01-intro.md: enhanced installation instructions

Enhanced installation instructions with links to necessary documentation.

Signed-off-by: Eric Stroczynski <ericstroczynski@gmail.com>

Closes: #1060
Approved by: rhatdan",46,20,0,0
"containers/buildah","43becab3bbe38c2ca29f723315fe604fec38f7cf","openshift-merge-robot","2023-03-16 16:14:05","true","Merge pull request #4668 from rhatdan/VENDOR

Vendor in latest containers/(storage, common, image)",14,74,1,1
"containers/buildah","adfb256a0fc3754c6a478ed4f928a78bdf4945f0","TomSweeneyRedHat","2018-01-10 16:26:48","false","Remove new errors and use established ones in rmi

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #388
Approved by: rhatdan",30,11,0,1
"containers/buildah","c22957b5be1b5463c8be22d7380a08f48155d256","TomSweeneyRedHat","2019-06-18 19:41:33","false","vendor logrus v1.4.2

vendor logrus v1.4.2

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1680
Approved by: rhatdan",44,29,0,1
"containers/buildah","9af767e64c31b3de4e97b7ec790ad6a79ed0b380","rhatdan","2023-11-05 12:10:57","true","Merge pull request #5138 from containers/renovate/github.com-spf13-cobra-1.x

fix(deps): update module github.com/spf13/cobra to v1.8.0",1,81,1,1
"containers/buildah","a53f342fa1937fd5e982d6e58d5e1e66157139ab","mtrmac","2022-09-30 17:56:44","false","Update for https://github.com/klauspost/pgzip/pull/50

... to fix reads of compressed data by docker-archive:

> go get github.com/klauspost/pgzip@master
> make vendor

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",20,68,1,1
"containers/buildah","a275736931f5ba48180e856ba89b001100c2ec98","openshift-merge-robot","2022-10-13 09:19:30","true","Merge pull request #4222 from mtrmac/c-image-errors

Update for https://github.com/containers/image/pull/1299 + update tests",28,68,1,1
"containers/buildah","ee3cbd904228208599ec4121312e5034997bd983","rhatdan","2022-10-12 14:17:48","true","Merge pull request #4328 from containers/dependabot/go_modules/github.com/containers/ocicrypt-1.1.6

build(deps): bump github.com/containers/ocicrypt from 1.1.5 to 1.1.6",27,68,1,1
"containers/buildah","7faf1e016a77c257f4d09b42ced1c41b9fa1998e","openshift-merge-robot","2021-09-17 10:28:53","true","Merge pull request #3518 from nalind/always-race

Makefile: only use race detection when it's available",39,56,1,1
"containers/buildah","e4b947fe3d3c08bbae1dcfdea7420d1238e7ee34","openshift-merge-robot","2021-05-12 19:17:47","true","Merge pull request #3222 from vrothberg/layers

buildah bud: fix containers/podman/issues/10307",54,52,0,1
"containers/buildah","6f84692919a8cd5b60a2e36801481d73aa5ca313","openshift-merge-robot","2021-06-29 10:08:04","true","Merge pull request #3349 from containers/dependabot/go_modules/github.com/containers/ocicrypt-1.1.2

build(deps): bump github.com/containers/ocicrypt from 1.1.1 to 1.1.2",39,53,1,1
"containers/buildah","f812e8f6c1edf345a146ea9f443ad9d0de18bc69","cevich","2021-05-06 16:03:12","true","Notification email for cirrus-cron build failures

This duplicates the github-action workflow of the same name/purpose from
the podman reposiory.  Every day it will check the most recent list
of Cirrus-cron initiated builds, and only send an e-mail if any failed.

Some measures are taken in this version to re-use a script and some
data from the podman repo.  There is no way (as of this commit) to
avoid duplicating the workflow file.

Signed-off-by: Chris Evich <cevich@redhat.com>",52,51,0,1
"containers/buildah","8ce6b7075ae4384189f3d759cd1f75051d37526a","openshift-merge-robot","2021-04-26 09:51:59","true","Merge pull request #3182 from nalind/compat

Add compabitility wrappers for recently removed packages",50,51,0,1
"containers/buildah","8bb100be2a9e2b85210a52437b07318810371534","rhatdan","2020-08-11 09:28:41","false","Add --omit-timestamp flag to buildah bud

Currently you can only do deterministic builds with commit command
this change will cause the metadata in the container image to be
epoch 0.

Next step is to save the data in the tar balls as 0.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>
Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",86,42,0,1
"containers/buildah","8999c1cffc8edea6270c98fbbc6d199d3bed5605","cben","2020-06-16 15:11:54","false","CHANGELOG.md: Fix markdown formatting

It appears this line is there by mistake?  No similar lines in other release sections, nor in changelog.txt.

This makes following indented lines parse as continuation of a list item, instead of literal block:
https://github.com/containers/buildah/blob/master/CHANGELOG.md#v173-2019-04-16

Signed-off-by: Beni Cherniavsky-Paskin <cben@redhat.com>",143,41,0,0
"containers/buildah","cd9d5d00b2c4f997baa8b8ea171a15aacda6a673","TomSweeneyRedHat","2020-05-04 21:03:30","false","Add Security Policy

Add a Security Policy for Buildah.
This will point to the Containers Project page
just as the Code-of-Conduct Page does.
Once this is approved/merged, I'll do similar PR
for each of the other projects in the Containers
domain.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",134,39,0,1
"containers/buildah","b09fdc33e8d37924d3584f7526d5c0fda086d7fc","lsm5","2020-01-16 11:13:19","false","update install instructions for Debian, Raspbian and Ubuntu

Resolves: #1918

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>

Closes: #2088
Approved by: rhatdan",101,36,0,1
"containers/buildah","9c65e5699cfa486531b3f123d9ce74873f0e18aa","mtrmac","2018-12-03 18:02:47","false","Update for sysregistriesv2 API changes

Mostly this is a straightforward elimination of manual GetRegistries calls.

In getCopyOptions, we just remove setting the DockerInsecureSkipTLSVerify
values because the docker:// tranport now does that automatically.  (This
actually changes behavior, because docker:// supports namespace prefixes
in addition to matching only by hostnames, but that's a superset of the
previous behavior.)

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1214
Approved by: rhatdan",44,22,0,1
"containers/buildah","fc4e55b65c12163d9fab93e0147cc8850f0598fe","openshift-merge-robot","2023-03-05 17:06:43","true","Merge pull request #4641 from containers/renovate/golang.org-x-term-0.x

fix(deps): update module golang.org/x/term to v0.6.0",17,73,1,1
"containers/buildah","dfd177bab011a2e3f010eec996b0091332da7999","rhatdan","2023-08-28 10:01:37","true","Merge pull request #5004 from flouthoc/oci-hooks-docs

[CI:DOCS] docs: add reference to oci-hooks",8,79,1,1
"containers/buildah","c9b4aa565cbaacca60a520ca8a9a4356c465a4c7","rhatdan","2019-06-15 13:33:27","true","Merge pull request #1676 from rhatdan/bump-1.9.0

Bump 1.9.0",42,29,0,1
"containers/buildah","d3778cb7841da7b004299829bc8666110a4ef5a7","rhatdan","2021-03-15 11:52:22","false","Lookup Containerfile if user specifies a directory

Currently if the user specifies a --file path
and path is a directory, we only append on Dockerfile.
This PR searches for Containerfile and then Dockerfile.

Fixes: https://github.com/containers/buildah/issues/3078

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",59,50,0,1
"containers/buildah","4cd35abbbf7e172d00006723944db973017d4534","rhatdan","2018-07-06 09:37:54","false","Fix becoming a maintainer link

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #852
Approved by: TomSweeneyRedHat",31,17,0,1
"containers/buildah","3b954c29892d49ce794b7fd1ef95a5635afd8785","rhatdan","2021-02-23 21:22:03","false","Make sure we set the buildah version label

Currently if the buildah image has a label that was built with
an older version of buildah, we don't update to the latest version.

This PR Will cause the new version to use the current label.

Fixes:https://github.com/containers/buildah/issues/3035

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",61,49,0,1
"containers/buildah","1267508918b77cdfbbabb3b55c91e5f0840d33e5","rhatdan","2022-01-21 11:59:49","false","Run codespell on code

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",35,60,1,1
"containers/buildah","79a38083669881027f6e143adcabb45768434ed9","rhatdan","2022-01-21 14:19:30","false","Vendor in latest containers/image

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",35,60,1,1
"containers/buildah","1040f105ceebb27a2dec5f04e365523a311b23c9","rhatdan","2021-02-04 20:52:52","true","Merge pull request #2967 from umohnani8/arg-cache

Fix build arg check",96,48,0,1
"containers/buildah","e4ce08b9becc408379552650a9a15171479256a1","rhatdan","2020-09-16 11:54:43","true","Merge pull request #2616 from containers/dependabot/go_modules/github.com/openshift/imagebuilder-1.1.7

build(deps): bump github.com/openshift/imagebuilder from 1.1.6 to 1.1.7",91,44,0,1
"containers/buildah","ec35bc428a4b19a4a6892845644aa48aa577739e","openshift-merge-robot","2021-07-15 19:38:10","true","Merge pull request #3101 from vrothberg/source

buildah source - create and manage source images",42,54,1,1
"containers/buildah","3d17d5e4e21d4b96371122cc7342fe963c522157","openshift-merge-robot","2021-04-19 14:47:52","true","Merge pull request #3155 from TomSweeneyRedHat/dev/tsweeney/multifromargfix

Fix arg missing warning in bud",53,51,0,1
"containers/buildah","99b80441b651cb47def200267ba0c2af69499253","openshift-merge-robot","2021-03-03 21:28:42","true","Merge pull request #3041 from rhatdan/shrink

Shrink the vendoring size of pkg/cli",60,49,0,1
"containers/buildah","36a56cea583c2fb5e619dc18e7131097e9b1f360","joellord","2020-07-21 23:32:15","false","Update 02-registries-repositories.md

I had a 'unknown flag --creds username:apikey' error message when trying as documented. Adding the '=' has fixed my issues (v.1.15)

Signed-off-by: Joel Lord <joelphy@gmail.com>",149,42,0,0
"containers/buildah","f8ae2f524ddf9e7df31fed057a8a734dcfc2c050","rhatdan","2020-05-01 15:25:14","false","Update containers/common v0.10.0

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",135,39,0,1
"containers/buildah","7dc45489dc72395cbef6db649b146df80e869dcd","rhatdan","2020-03-26 10:25:21","false","revert #2246 FIPS mode change

Discussion on this is happening in:
https://bugzilla.redhat.com/show_bug.cgi?id=1804193

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",112,38,0,1
"containers/buildah","d9ac7092dcbbd23a1eb18d940018e64cff55f28b","TomSweeneyRedHat","2020-03-17 20:21:36","false","Bump back to v1.15.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",109,38,0,1
"containers/buildah","13dcf6d53190fe31a149147485526585b6b03f1e","TomSweeneyRedHat","2020-02-07 20:08:47","false","Show error on copied file above context directory in build

When a COPY command in a Container file looked like ""../file.txt""
SecureJoin would secure the file by lopping off the ""../"".
However, the code would then append that file name to the passed in
context directory and look for the file.  That would fail as in most
cases there was no `{context-dir}/file.txt`, rather the file was at
`{context-dir}/../file.txt`.  Using a relative directory like this
outside of the context directory can be a security risk.  Docker
doesn't allow it nor should we.

This change now errors out when a file that starts with `../` is
presented as a copy from target.

Addresses: https://github.com/containers/libpod/issues/5035

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",111,36,0,1
"containers/buildah","b68a8e1b99f63719488b65fe347c2bcc72cadfe2","estroz","2018-11-28 19:08:47","false","clean up makefile variables

Signed-off-by: Eric Stroczynski <ericstroczynski@gmail.com>

Closes: #1204
Approved by: rhatdan",43,22,0,0
"containers/buildah","7734b68d6a8ee9614d4a01de2f1ba547d826e9ed","openshift-merge-robot","2020-12-21 20:38:09","true","Merge pull request #2823 from TomSweeneyRedHat/dev/tsweeney/override_from

Allow FROM to be overriden with from option",84,47,0,1
"containers/buildah","4bcf09eb2f7185086d409dda75a7c46444907a42","openshift-merge-robot","2023-03-15 19:17:43","true","Merge pull request #4610 from cevich/debian_sid_vm_images

Replace Ubuntu -> Debian SID",15,74,1,1
"containers/buildah","5839025cf72fdd08a197dddfe2c614a5812394aa","openshift-merge-robot","2021-10-05 16:48:06","true","Merge pull request #3569 from lsm5/bump-containerd

Bump containerd to v1.5.7",43,56,1,1
"containers/buildah","1ade4e7d3075ead485ddd23bd620a6e418f574c4","openshift-merge-robot","2023-09-14 23:08:53","true","Merge pull request #5047 from containers/renovate/github.com-opencontainers-image-spec-1.x

fix(deps): update module github.com/opencontainers/image-spec to v1.1.0-rc5",5,80,1,1
"containers/buildah","2c83535a5d831eec4f26f532d30dfd28e576d9ba","openshift-merge-robot","2020-10-01 21:14:10","true","Merge pull request #2667 from nalind/no-extract-directory-items

ADD: only expand archives at the right time",87,44,0,1
"containers/buildah","d6fd289adb59c67b1a35cfcc157d4e0fa83d8da3","openshift-merge-robot","2022-05-03 15:10:11","true","Merge pull request #3899 from flouthoc/set-correct-targetplatform

build: automatically set correct `$TARGETPLATFORM` where expected.",24,63,1,1
"containers/buildah","c5e047e4b33757df35c2ebc98e11a07996774536","openshift-merge-robot","2021-04-19 13:03:53","true","Merge pull request #3158 from containers/dependabot/go_modules/github.com/openshift/imagebuilder-1.2.1

build(deps): bump github.com/openshift/imagebuilder from 1.2.0 to 1.2.1",52,51,0,1
"containers/buildah","68cd60292259fa6b9fe09b9eee06d391eaf8228a","openshift-merge-robot","2021-11-11 14:12:42","true","Merge pull request #3611 from rhatdan/unsetenv

Add --unsetenv option to buildah commit and build",30,57,1,1
"containers/buildah","9129ae9f29de6588cad6bcbbd7a3b9ffff8cbe01","openshift-merge-robot","2021-02-08 16:36:17","true","Merge pull request #2984 from vrothberg/iidfile

--iidfile: print hash prefix",94,48,0,1
"containers/buildah","3e320b9ae4c3f4c9db8e7295b2dc7e114cca38c2","TomSweeneyRedHat","2018-05-15 15:37:46","true","Merge pull request #688 from pixdrift/env-ci

Add buildah bud CI tests for ENV variables",60,16,0,1
"containers/buildah","8d9e9d6f73468b6e0b876342b54589281459180a","slp","2021-01-25 13:55:06","false","Makefile: allow building without .git

Use the same strategy as podman for obtaining the commit id, so we
don't fail if this is a release without the "".git"" directory.

Signed-off-by: Sergio Lopez <slp@redhat.com>",95,48,0,0
"containers/buildah","abf3f0d554145f343932bf277145e2e5225c6914","cevich","2021-01-07 15:22:05","true","Fix bud capabilities test

This test fails after updating to new VM images which include
https://github.com/containers/common/pull/319

Work around the problem by adding in the capabilities expected
to be present.  Thanks to @edsantiago and @giuseppe for the fix.

Signed-off-by: Chris Evich <cevich@redhat.com>",91,47,0,1
"containers/buildah","47ac96155f1573e1bbf7804461f6850ff67e8747","nalind","2017-06-28 21:07:58","false","Use configured registries to resolve image names

When locating an image for pulling, inspection, or pushing, if we're
given an image name that doesn't include a domain/registry, try building
a set of candidate names using the configured registries as domains, and
then pull/inspect/push using the first of those names that works.

If a name that we're given corresponds to a prefix of the ID of a local
image, skip completion and use the ID directly instead.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #360
Approved by: rhatdan",20,5,0,1
"containers/buildah","5a6a88b5eda8f29e4005a91203b59ea140ee0eba","nalind","2017-03-15 20:42:37","false","More on importing containers that we didn't create

Continue the work from a0d394af74387fedb862efb933c31a86db40d07e by
making open-by-path work correctly again.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,2,0,1
"containers/buildah","22422cc399e6465fbe527ef396ade231a0daf280","nalind","2017-02-13 16:44:47","false","Update to match API changes in dependencies

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","86fa0803e8991b2c970c1c248d8ff350c39a50ac","nalind","2018-01-04 23:05:40","false","Sanity check the history/diffid list sizes

When building an image's config blob, add a sanity check that the number
of diffIDs that we're including matches the number of entries in the
history which don't claim to be empty layers.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #383
Approved by: rhatdan",29,11,0,1
"containers/buildah","7b4e1ea30863e23f09ca71925bc9d7348a9a3cd1","openshift-merge-robot","2023-06-30 08:59:47","true","Merge pull request #4899 from rhatdan/VENDOR

Update vendor of containers/common",13,77,1,1
"containers/buildah","462429b74872274215f132fd141a8dcafd17d7e5","openshift-merge-robot","2022-10-05 10:30:05","true","Merge pull request #4316 from flouthoc/fix-warning-test

test: remove unneeded/expensive `COPY . .`",26,68,1,1
"containers/buildah","2c09b0725c09a8df37dcfc2a6cc6966d6d12de3d","openshift-merge-robot","2021-08-31 10:25:43","true","Merge pull request #3488 from siretart/patch-1

corrected man page section; .conf file to mention its man page",35,55,1,1
"containers/buildah","fa0b318cca4afcb9ca4f97b8251a45f45f75b929","openshift-merge-robot","2022-04-12 20:03:48","true","Merge pull request #3909 from lsm5/main-cve-2022-27191

Bump golang.org/x/crypto to 7b82a4e",25,63,1,1
"containers/buildah","6fda3dc3ae769498bfa73be0c178ed58afd39e65","pixdrift","2018-05-03 05:48:50","false","Extend tests for empty buildah run command

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #656
Approved by: rhatdan",48,15,0,0
"containers/buildah","6f8073e412bdcc0c42521d11a8100710d8c4ef53","vrothberg","2019-06-24 07:28:17","false","install.md: mention go modules

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1621
Approved by: rhatdan",44,29,0,1
"containers/buildah","4a8e4b2c12f2427ebd6f45de97e23ac41d8cfd8c","nalind","2017-04-19 19:27:10","false","Bump fsouza/go-dockerclient

Update the version of github.com/fsouza/go-dockerclient that we vendor,
and pick up its new dependency on github.com/moby/moby.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",11,3,0,1
"containers/buildah","b319442a510183907cc6776ab063119357a9b82a","nalind","2018-06-27 17:28:01","false","Force ownership of /etc/hosts and /etc/resolv.conf to 0:0

Explicitly force the owner of /etc/hosts and /etc/resolv.conf to 0:0 in
the container, instead of attempting to let ID maping implicitly handle
it, since when we're being run unprivileged, the owners of the source
files are already unmapped IDs.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #823
Approved by: rhatdan",28,17,0,1
"containers/buildah","303a8df35dbb1b7ae71a1de427c72f776df04b67","nalind","2017-06-20 21:37:50","false","Ensure volume points get created, and with perms

Ensure that volume points are created, if they don't exist, when they're
defined in a Dockerfile (#151), and that if we create them, we create
them with 0755 permissions (#152).

When processing RUN instructions or the run command, if we're not
mounting something in a volume's location, create a copy of the volume's
initial contents under the container directory and bind mount that.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #154
Approved by: rhatdan",14,5,0,1
"containers/buildah","f7f08391bef07cb773f7e834087057f6b908edf8","nalind","2019-03-16 01:00:19","false","squash.bats: test squashing in multi-layered builds

Test mixing squashing with builds using multiple layers.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1490
Approved by: rhatdan",36,26,0,1
"containers/buildah","66701d43b894fca2f6859bfe56cb77221364d99a","QiWang19","2019-10-28 17:13:07","false","remove XDG_RUNTIME_DIR from default authfile path

This patch will let authfile path default to the containers/image location for authentication file. Which for now will be xdg_runtime_dir, but eventually will switch to kernel keyring.

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1947
Approved by: rhatdan",80,33,0,1
"containers/buildah","398b08ff652ec63965b963bdb2c4dfb6ce5373f6","rhatdan","2019-05-10 20:54:05","false","Make buildah run --isolation follow BUILDAH_ISOLATION environment

Currently buildah run ignores the variable.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1587
Approved by: vrothberg",57,27,0,1
"containers/buildah","d3f30df3c21bce05d046cb4e002244e70e38767f","rhatdan","2022-10-17 13:21:27","true","Merge pull request #4347 from edsantiago/consistent_no_tests_included

[CI:BUILD] pr-should-include-tests: allow specfile, golangci",27,69,1,1
"containers/buildah","41b7852611f57433a4d27027080e2617b2252f72","rhatdan","2019-12-13 15:12:32","false","Rework overlay pkg for use with libpod

Podman uses the overlay mounts differently then in buildah.  Specifically the
overlay mount points can be used over and over again when starting and stopping
the container.  Since the paths are backed into the contianer config, we have
to be able to cleanout just the Upper and Merged directory rather then destroying
and recreating the overlay directories on each container start.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1822
Approved by: vrothberg",88,34,0,1
"containers/buildah","cd88667465a9f4a46daf3c6c2975a9883885c7fe","rhatdan","2019-11-16 16:31:41","false","Ran buildah through codespell

Thanks to Dmitry Smirnov @onlyjob for suggesting this tool.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1985
Approved by: TomSweeneyRedHat",82,34,0,1
"containers/buildah","999827e5d6750f89ca3e6f8894cb6567f062aa91","rhatdan","2023-03-30 10:43:05","true","Merge branch 'main' into renovate/github.com-onsi-gomega-1.x",12,74,1,1
"containers/buildah","a9e66ec72b55c7d2a854adca9670f8a336f95fc5","rhatdan","2021-09-28 14:41:24","false","Add man page for Containerfile and .containerignore

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",38,56,1,1
"containers/buildah","a9342e315b3e5b2478b6edb051e1615e585a5211","rhatdan","2023-06-05 20:07:12","true","Merge pull request #4830 from cevich/ci_next

CI: Support testing w/ podman-next COPR packages",16,76,1,1
"containers/buildah","1bd6f909e8a8baed172bcb90cf81b66e925161fd","rhatdan","2023-01-09 20:17:36","true","Merge pull request #4509 from flouthoc/secret-relative

build, secret: allow relative mountpoints wrt to work dir for `--mount=type=secret`",21,71,1,1
"containers/buildah","b94d4ce2a5b41b64dc5bf82c801530333694599c","rhatdan","2022-06-07 13:22:08","true","Merge pull request #4022 from ashley-cui/spaghetti

Fix TODO: de-spaghettify run mounts",22,64,1,1
"containers/buildah","01a210b5341c403d33c6817c1f99e497ba4af454","nalind","2019-04-17 15:03:19","false","Use errors.Cause() when checking for IsNotExist errors

Use errors.Cause() when asking if os.IsNotExist() recognizes an error
result from any call that isn't into the standard library or the
golang.org/x/sys package.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",51,27,0,1
"containers/buildah","7baf73b2a565818507f7bb5a8a901b705aa9cb54","nalind","2023-02-16 19:39:41","false","imagebuildah.StageExecutor: suppress bogus ""Pushing cache []:...""

When we changed the cache-from and cache-to options to take slices of
name values instead of single values, we didn't update logic that
checked if a value was set to handle cases where we had a non-nil slice
with no elements in it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",18,73,1,1
"containers/buildah","464a3e587fb1134eaa8605bc6fc4c4498827de59","nalind","2018-10-02 20:44:12","false","pullImage(): when completing an image name, try docker://

If we're handed a name for a source image, and
alltransports.ParseImageName() doesn't like it as-is, we normally try
prefixing the Transport option and parsing it again.  If that option
isn't set, though, we return an error, when we should be trying the
default (""docker""), which is how NewBuilder() does things.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1072
Approved by: rhatdan",46,20,0,1
"containers/buildah","b92279faa4d754dd137958eb7af765591db28b34","nalind","2017-05-23 16:24:09","false","Increase the timeout for metalinter from 2m to 4m

Increase the timeout that we set for running the metalinter from 2
minutes to 4 minutes, for cases where the calling environment is more
heavily loaded than we expected.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #119
Approved by: rhatdan",15,4,0,1
"containers/buildah","3a2ac2c388a4d623aac6608867782993e6f25a93","rhatdan","2022-07-07 14:21:48","true","Merge pull request #4096 from flouthoc/build-file-should-not-dir

imagebuildah, BuildDockerfiles: error out if path to `containerfile` is a `directory`",23,65,1,1
"containers/buildah","58e9674d7d17bc5928c53aa865b51cbabe86e159","rhatdan","2023-06-05 20:05:25","true","Merge pull request #4844 from flouthoc/refactor-gettmpdir

GetTempDir: honor `image_copy_tmp_dir` from `containers.conf`",17,76,1,1
"containers/buildah","fb6d3cb571f2b25a791aa5bc60fb88d5e3134af7","rhatdan","2023-02-14 05:07:20","true","Merge pull request #4581 from containers/renovate/tim-actions-get-pr-commits-digest

[skip-ci] Update tim-actions/get-pr-commits digest to 55b867b",19,73,1,1
"containers/buildah","60028775b9bf56830dc30c1326502d1534ec9544","rhatdan","2021-01-27 15:13:31","true","Merge pull request #2939 from TomSweeneyRedHat/bump_crypto

Bump golang.org/x/crypto to the latest",94,48,0,1
"containers/buildah","382a0779b0b456e197fc015eea65362221f7633c","rhatdan","2022-11-11 20:31:31","true","Merge pull request #4412 from containers/dependabot/go_modules/github.com/onsi/gomega-1.24.1

build(deps): bump github.com/onsi/gomega from 1.24.0 to 1.24.1",22,69,1,1
"containers/buildah","761bad5e7144919817214a54787ecc6db8c888fd","edsantiago","2021-03-23 15:55:06","false","tests: prefetch: use buildah, not podman, for pulls

The _prefetch helper has proven invaluable in reducing pull-
related flakes. However, it is now failing because it uses
podman to pull, and buildah tests rely on shortnames, and
podman no longer works with shortnames.

Solution: use buildah, not podman, for initial image pulls.
(The reason we used podman in the first place is because
buildah does not have save/load. But since image store
is shared, we can use buildah for pull and podman for save
and load.)

Add shortname config to registries.conf. I don't think it's
actually necessary or even used, but we can tweak it later.

And, fix one test in from.bats that was using inconsistent
names between buildah and podman.

Signed-off-by: Ed Santiago <santiago@redhat.com>",55,50,0,1
"containers/buildah","3e5102046ec5a99b87c69e40c44db13adf7a8c49","mtrmac","2018-06-11 22:47:48","false","Don't throw away the manifest MIME type and guess again

When loading the manifest using a types.Image.Manifest,
we also get a manifest MIME type; don't just throw it away
and then guess as if the data was never available, just use it
directly (now that the loading is close enough for the throwing
away to be noticeable).

[Ultimately, this loads the manifest from a c/image/storage
backend, which calls manifest.GuessMIMEType anyway, so this
does not change behavior right now, but if the c/image/storage
backend ever changed to record MIME types, it would make a
difference.  At the very least, we now run the heuristic once
instead of twice.]

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #776
Approved by: rhatdan",33,16,0,1
"containers/buildah","a930251d21cae951ee78ad4a386ac277fce1bad4","nalind","2017-04-27 17:52:08","false","Bump github.com/mattn/go-shellwords

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #87
Approved by: nalind",9,3,0,1
"containers/buildah","8b8320b28295e7403640bb1fdfbb94ce8b291c5f","nalind","2017-04-19 19:27:46","false","Bump golang.org/x/sys

Update the version of golang.org/x/sys that we vendor.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",11,3,0,1
"containers/buildah","010184cebb12d191ef14bfe5e0a94703c11a9b00","nalind","2017-03-21 19:47:02","false","Merge pull request #17 from nalind/chrootarchive

Use chrootarchive to head off tar shenanigans",11,2,0,1
"containers/buildah","0d6bf94eb67d7aeed9b1ebfe40ffb6967be0a08a","nalind","2017-10-05 21:39:44","false","Fix some validation errors

Fix some validation errors flagged by metalinter.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",32,8,0,1
"containers/buildah","318fc8940f00c1c90d402b1f6de4ce7ade64f4da","nalind","2018-10-02 18:48:11","false","Enforce ""blocked"" for registries for the ""docker"" transport

Check if reading and writing from the registry named by an image is
allowed when the transport is ""docker"".

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1056
Approved by: rhatdan",43,20,0,1
"containers/buildah","652a8e1a52cf3c288c8b31dffa0c5b249c1de856","nalind","2022-01-24 22:20:04","false","docs/buildah-build.1.md: don't imply that -v isn't just a RUN thing

The current wording doesn't clearly state that volumes specified using
-v are only a factor when executing RUN instructions.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",34,60,1,1
"containers/buildah","86ced703864bdd1a4cde177321a7d18713543853","nalind","2018-07-31 22:03:16","false","Add and implement IsolationOCIRootless

Add an IsolationOCIRootless that runs the OCI runtime with its
--rootless flag, with network and UTS namespaces disabled, with IPC,
PID, and user namespaces forcibly enabled.  In this mode, we don't
attempt to set the container's hostname (because we don't have our own
UTS namespace), and we don't try to set any supplemental groups.  The
/sys directory is replaced with a bind mount of the host's /sys rather
than a fresh sysfs instance.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #873
Approved by: rhatdan",31,18,0,1
"containers/buildah","5af04e8cc1feaaa190ea9d7b56b21423d36240b6","rhatdan","2019-07-19 07:32:41","true","Merge pull request #1729 from openSUSE/linters

 Add unconvert, stylecheck, goimports and misspell linter and apply fixes",49,30,0,1
"containers/buildah","aba61cdec4c800bcca78137f9b28d0f0315f87ec","rhatdan","2021-01-14 21:47:41","false","Fix version of release to v1.19.1

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",93,47,0,1
"containers/buildah","d7e530e44fec2664ffdfde7ebed2cb250be1af71","rhatdan","2019-01-15 17:57:28","false","Vendor in latest containers/storage

This will fix the labeling of container images
when using user namespace

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1282
Approved by: umohnani8",52,24,0,1
"containers/buildah","5a9c591abf18aa910a0d1e20a738c429ef2e78b7","rhatdan","2018-02-07 13:44:32","true","Merge pull request #455 from umohnani8/certs

Make /etc/containers/certs.d the default certs directory",35,12,0,1
"containers/buildah","73401a48e208c0f4986211b9b68d5737fffe080d","vrothberg","2019-07-23 15:58:15","false","vendor github.com/containers/storage@v1.12.15

* make local-cross more reliable for CI
* Fix cross-compilation
* zstd: use github.com/klauspost/compress directly
* Add support for installing man pages
* Remove merged directory when it is unmounted
* Switch to golangci-lint
* Update generated files
* Keep track of the UIDs and GIDs used in applied layers
* Add cirrus vendor check
* Switch to go modules
* Use same variable name on both commands
* cirrus: ubuntu: try removing cryptsetup-initramfs
* Move lockfiles to their own package
* getLockfile(): use the absolute path
* lockfile: don't bother releasing a lock when closing a file
* locking: take read locks on read-only stores
* locking test updates

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1739
Approved by: TomSweeneyRedHat",46,30,0,1
"containers/buildah","5b8579d897444564565ce2aabac01175d7aad32d","nalind","2017-03-23 20:49:24","false","Merge pull request #25 from nalind/vendor-updates

Vendor updates",12,2,0,1
"containers/buildah","f53f9ea24620bd3112ff2399f8f424677fbfdff5","nalind","2020-10-14 15:43:03","false","bump(github.com/openshift/imagebuilder) to v1.1.8

Update imagebuilder to v1.1.8.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",63,45,0,1
"containers/buildah","0ce9d1ee1d8040de8efe0f393787bd2100ed7e3c","nalind","2018-10-04 17:46:34","false","namespaces.bats: fix handling of uidmap/gidmap options in pairs

We were building the --userns-uid-map and --userns-gid-map CLI flags
into a single flag/value argument.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1069
Approved by: rhatdan",51,20,0,1
"containers/buildah","22fc573de6b1884357621df841a991a59403cae2","openshift-merge-robot","2021-05-07 13:09:27","true","Merge pull request #3211 from rhatdan/overlay

Preserve ownership of lower directory when doing an overlay mount",52,51,0,1
"containers/buildah","72ef18232a0b30f54cc7ace20c1794f2171ee06a","openshift-merge-robot","2021-02-22 21:26:41","true","Merge pull request #3031 from edsantiago/new_tests_check

pr-should-include-tests: recognized ""renamed"" tests",61,49,0,1
"containers/buildah","7a7cf3feaa7a1c23a2b6d3856d0d264f003cbf65","openshift-merge-robot","2020-11-02 11:47:42","true","Merge pull request #2738 from containers/dependabot/go_modules/github.com/containers/storage-1.23.8

build(deps): bump github.com/containers/storage from 1.23.7 to 1.23.8",67,45,0,1
"containers/buildah","395f6f5b2d0f1493a790c4869b87ddb5c8b84cc6","openshift-merge-robot","2023-05-16 14:27:58","true","Merge pull request #4791 from flouthoc/required-wo-value

secret: accept `required` flag without value",13,76,1,1
"containers/buildah","0e745d1512f9fdad78ce6bd225c582732fec9a04","flouthoc","2022-07-07 05:43:56","true","tests: retrofit test since --file does not supports dir

Signed-off-by: Aditya R <arajan@redhat.com>",23,65,1,1
"containers/buildah","639320efbb19299f85d0a6847e137577155f9ce1","openshift-merge-robot","2021-10-25 07:44:49","true","Merge pull request #3595 from currybullen/fix-shebang-in-readme

fix: another non-portable shebang",35,57,1,1
"containers/buildah","e925b5852e0760373f22007c0cf6c0604a4c7d4d","openshift-merge-robot","2023-05-04 05:25:00","true","Merge pull request #4773 from cevich/fix_cirrus_cron

[CI:DOCS] Cirrus: Fix meta task failing to find commit",9,75,1,1
"containers/buildah","7f81b68d58019d3137a399a7d521608a7537c00d","openshift-merge-robot","2022-01-28 14:42:08","true","Merge pull request #3754 from containers/dependabot/go_modules/github.com/onsi/gomega-1.18.1

build(deps): bump github.com/onsi/gomega from 1.18.0 to 1.18.1",33,60,1,1
"containers/buildah","9e5580789556f3497941a3c0d98b83ad01107f06","openshift-merge-robot","2022-09-21 11:07:23","true","Merge pull request #4257 from flouthoc/conflict-isolation-network

run,build: conflict `--isolation=chroot` and `--network`",21,68,1,1
"containers/buildah","acb97f178cf28012907abf169c315efe6f30a78a","openshift-merge-robot","2020-11-30 19:28:37","true","Merge pull request #2828 from nalind/no-bic

pkg/supplemented test: replace our null blobinfocache",77,46,0,1
"containers/buildah","08285077282648b7f4751facabe325a5845bb7a7","openshift-merge-robot","2022-05-03 19:56:29","true","Merge pull request #3955 from flouthoc/deep-copy-args

buildah: deep copy `options.Args` before performing concurrent `build/stage`",24,63,1,1
"containers/buildah","ddd893d8621d489b80f1e478942f3c3fe3acbe28","Luap99","2022-03-24 13:49:02","true","tests/helpers.bash: assert handle corner cases correctly

Right now `assert t:[1] != t:[1]` passes. This is obviously incorrect
and some test might not be working correctly because of this. We have to
special case this like the ""=="" case.

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",31,62,1,0
"containers/buildah","186b301685c5b2a5b3e1cc06fa66362909460458","vrothberg","2023-01-16 15:27:13","false","[CI:DOCS] README: drop sudo

Running the script from the README does not require root privileges.
The text seems to predate Buildah's rootless support.  It was brought to
my attention during a presentation last week where an attendee asked
whether Buildah requires root privileges after reading the README.

Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",21,72,1,1
"containers/buildah","ff57e92d44de73e3f9343dedd9132e8243fe3873","nalind","2018-10-31 13:55:53","false","rootless: only discard network configuration names

When changing settings for rootless containers, only discard the part of
the networking configuration that specifies which networks we want to
configure, and preserve whether or not we want to use the host's network
namespace.

If we were told to create an empty network namespace or to just attach
to another namespace, go ahead and try to do that.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1146
Approved by: rhatdan",57,21,0,1
"containers/buildah","78f6451bc243a2e2ba6eb8ae2cb4ad098da38783","nalind","2018-06-14 19:41:05","false","Escape use of '_' in .md docs

Escape uses of _ in markdown docs, so that it isn't mistakenly treated
as a formatting character.

Fix a couple of copy-paste errors.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #794
Approved by: rhatdan",30,17,0,1
"containers/buildah","984ea9bdb569d7b4624619b1eaee9e07bc97ae9f","nalind","2019-03-07 23:13:12","false","imagebuildah resolveSymlink: fix handling of relative links

Relative symbolic links replace the link's basename during path
resolution, but we weren't removing the link's basename when computing
the to-be-cleaned value.

Rename ResolveSymLink to make it non-public again, since libpod no
longer uses it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1392
Approved by: vrothberg",65,25,0,1
"containers/buildah","bb5cbf1849fbb51dd01d28ca17d25bf5b26b290f","nalind","2019-07-15 21:57:26","false","Run: correct a typo in the --cap-add help text

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1721
Approved by: rhatdan",49,30,0,1
"containers/buildah","15792b227aef533cc37640c0539e3a10f371272d","TomSweeneyRedHat","2017-11-28 20:06:52","false","Allow push to use the image id

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #341
Approved by: nalind",33,10,0,1
"containers/buildah","16d9d97d8c02193d55b136e947d0cf7828466312","jlebon","2017-07-27 16:51:35","false","ci: rename files to the new PAPR name

Rename the YAML file and its auxiliary files to the newly supported
name.

Signed-off-by: Jonathan Lebon <jlebon@redhat.com>

Closes: #225
Approved by: rhatdan",23,6,0,0
"containers/buildah","b2054360ae5d28f57f0401747930bf857bd64100","flouthoc","2022-11-04 05:21:12","true","imagebuildah:build with --all-platforms must honor args for base images

Commit:
https://github.com/containers/buildah/commit/217b2d524c041674066f2e0d329ec2ad5a62004b
was pushed to `main` accidently while it incorrectly assumes that `ENV`
must be used while processing base image, however `ENV` should be only
evaluated inside `RUN` instruction and not for any containerfile
instruction such as `FROM <>`. This fixes change made in above commit.

Following commit ensures that imagebuildah considers `HeadingArgs`
and `UserArgs` when its evaluating base image to pull all images from
manifest list early when build is invoked with `--all-platforms`

Closes: https://github.com/containers/buildah/issues/4399

Signed-off-by: Aditya R <arajan@redhat.com>",23,69,1,1
"containers/buildah","70cfc09f7b85207e6b666b4a0ccd885e1dab4031","flouthoc","2021-10-08 07:55:37","true","mount: add tmpcopyup to tmpfs mount option

Signed-off-by: Aditya Rajan <arajan@redhat.com>",42,56,1,1
"containers/buildah","a4200ae6b590c4b08b223e45513b1894636d1d02","mtrmac","2019-01-02 20:12:09","false","Remove no longer used isReferenceInsecure / isRegistryInsecure

These functions are no longer used. Also, code should typically rely
on the automatic use of the sysregistriesv2 configuration inside
c/image/docker instead of managing that manually, so they are
unlikely to have any users in the future.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1255
Approved by: rhatdan",54,23,0,1
"containers/buildah","344fbdc882742cd011e338dbe7ec1e0bfc1fa5cd","mtrmac","2018-08-09 22:35:32","false","Remove an unused srcRef.NewImageSource in pullImage

- The result is not used anywhere
- In the common case of pulling from docker:// this does not do
  anything notable (only sets up configuration, no network checks)
- ... but it can be pretty expensive for compressed archives,
  creating an uncompressed on-disk copy.
- copy.Image soon after the removed code calls srcRef.NewImageSource
  internally anyway.

This should not change behavior on success; it may change which error is
reported if there is more than one reason for the pull to fail.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #922
Approved by: TomSweeneyRedHat",23,18,0,1
"containers/buildah","eceb6efb48d496f2a58e629b44eeb45262d8d315","mtrmac","2018-06-11 19:41:19","false","Don't ignore v2s1 history if docker_version is not set

buildah itself clears docker_version in Builder.fixupConfig; so,
buildah-created v2s1 images do not pass this test
(buildah from buildah-created-v2s1) creates an image with empty
history, which causes (buildah commit) to complain about the mismatch
between history and layer DiffID list.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #776
Approved by: rhatdan",32,16,0,1
"containers/buildah","d9ecd7c591917e16bc03233f33c132b800c38bcb","cevich","2023-06-06 18:29:58","true","[CI:DOCS] Update comment to remove ambiguity

Ref: https://github.com/containers/buildah/pull/4828/files#r1218341500

Signed-off-by: Chris Evich <cevich@redhat.com>",15,76,1,1
"containers/buildah","0eb266a958dfec32edd09d3b525107925987fe8d","giuseppe","2023-05-11 19:00:49","true","run: drop Pdeathsig

it is not safe to use prctl(PR_SET_PDEATHSIG) in a Go program since
the parent of the process is considered the *thread* that created the
child process, and the Go runtime can free a thread at any time.   We
would either need to lock the thread, or simpler just not use it.

[NO NEW TESTS NEEDED]

Closes: https://github.com/containers/podman/issues/17918

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",12,75,1,1
"containers/buildah","7ac60e3b9843f8b6bcef15c66469d7685bfdb508","ypu","2018-09-30 07:19:46","false","Update copy chown test

Update the test case to check the file owner and group during build.

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #1052
Approved by: rhatdan",43,20,0,0
"containers/buildah","543de3501fa0214d3fbedcfd179f1dc58484afd5","lsm5","2018-08-26 17:25:04","false","Makefile: use $(GO) env-var everywhere

One location was still using the hardcoded default binary.

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>

Closes: #960
Approved by: rhatdan",31,19,0,1
"containers/buildah","348665657c1aca7599c7515ba065f6d03b5456f2","nalind","2020-07-30 18:00:25","false","copier: add Mkdir()

Add a function for doing Mkdir-possibly-in-a-chroot, for ensuring that a
directory exists without having to possibly create it directly from
outside of a chroot.

Make use of filepath.ToSlash() and filepath.FromSlash() where it's
appropriate.

Add more unit tests.

Address some review comments:

* Check for ERANGE instead of E2BIG errors from llistxattr() and
  lgetxattr() as indicators that the buffer we passed to them is too
  small.
* Factor an `isRelevantXattr` helper out of Lgetxattrs() and
  Lsetxattrs().
* Drop our getcwd() function in favor of using os.Getwd().
* Adjust the comment describing the GetOptions.KeepDirectoryNames field.
* Clean hdr.Name before attempting to compute where an item being
  extracted should go.
* When writing items to the filesystem, create with 0?00 permissions,
  set ownership, then set the correct permissions.
* Merge StatResponse.Error, GetResponse.Error, and PutResponse.Error
  into Response.Error.
* When reading items from the filesystem, if a glob matches multiple
  items, and one of the items is excluded, continue checking the other
  items.
* Make sure we always Wait() on a child process if we spawned one.
* Clean up the cleanup logic for pipes that we use to communicate with a
  child process.
* Clean up the kill-the-child-process logic we call when we encounter an
  error communicating with the child process.
* Drop the separate Options structure, use helper methods to simplify
  pulling out the right ID maps and exclusions list for the request.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",151,42,0,1
"containers/buildah","cbeb888e3018ddfe42133aba9d258045e1516488","nalind","2017-04-10 18:15:30","false","Clean up image pulling policy

Change how we represent image pulling policy from a pair of booleans to
a single field which can take three values (never, if-missing, always),
with the default value being if-missing.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #71
Approved by: rhatdan",13,2,0,1
"containers/buildah","7545685800162760a41364d6127c49742f73feac","nalind","2023-09-05 15:12:45","false","Don't try to look up names when committing images

Don't try to look up an image by name when we're committing an image,
because we don't want to accidentally take advantage of any fuzzy
matching that libimage might start doing.  Instead, just use the
normalization call.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,79,1,1
"containers/buildah","e616dc116a117ae084fe333e49c592648c0effe5","nalind","2017-07-26 15:01:48","false","Avoid parsing image metadata for dates and layers

Avoid parsing metadata that the image library keeps in order to find an
image's digest and creation date; instead, compute the digest from the
manifest, and read the creation date value by inspecting the image,
logging a debug-level diagnostic if it doesn't match the value that the
storage library has on record.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #218
Approved by: rhatdan",19,6,0,1
"containers/buildah","a468ce0ffd347035d53ee0e26c205ef604097fb0","nalind","2021-06-02 20:22:28","false","chroot: fix environment value leakage to intermediate processes

Blake Burkhart reports that when running processes using ""chroot""
isolation, the process being run can examine the environment of its
immediate parent and grandparent processes (CVE-2021-3602).

When run in a container in a CI/CD environment, the environment may
include sensitive information which was shared with the container in
order to be used only by buildah itself.  The command being executed is
able to read such information.

This patch reduces the set of environment variables passed to these
intermediate processes, from all variables to the one which is used to
control the level of debug logging.  It also corrects a misleading debug
message and expands the description of chroot isolation in man pages.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",36,52,1,1
"containers/buildah","92e0c3fdcf00f580c14abe531d766aa95ceafd88","nalind","2020-06-18 22:03:43","false","Rework conformance testing

Move the conformance tests from ginkgo to using the default testing
package and github.com/stretchr/testify/require, preserving the existing
tests and adding more.

Add conformance tests to our Cirrus configuration, currently marked as
an allowed failure.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",143,41,0,1
"containers/buildah","0ded0dca2326a7d1c6c0d415e032d596eee9628d","nalind","2022-07-26 14:38:12","false","Fix a copy/paste error message

When we fail to create the pipe we're using to signal a start, don't
complain about failing to create the creation pipe.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",19,66,1,1
"containers/buildah","4fee54d742dd20ea79ca94f3c5ab31fa98e60551","rhatdan","2020-12-04 10:57:19","true","Merge branch 'master' into network",78,46,0,1
"containers/buildah","80f73013cd910ddd9425c510cf1fc15e5dae07e0","rhatdan","2017-03-23 17:32:16","false","Remove link from CLI

We have decided not to support using the --link param in the CLI.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",12,2,0,1
"containers/buildah","583f0df0bfe66dcc98fb3201b4baccfb622e0965","rhatdan","2023-02-15 02:36:44","true","Merge pull request #4586 from containers/dependabot/github_actions/tim-actions/get-pr-commits-1.2.0

build(deps): bump tim-actions/get-pr-commits from 1.1.0 to 1.2.0",20,73,1,1
"containers/buildah","45398cd196701632476e934e27e2e5ecf3e31628","rhatdan","2017-05-19 20:08:57","false","Code cleanup

Other tools use --storage-opt, buildah should be consistent

Cleanup buildah.1 man page

add options to buildah man page
add missing commands

Finally sort the commands in the buildah command.

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #112
Approved by: rhatdan",15,4,0,1
"containers/buildah","02cc30ba17cee811c90d20c20aabe1234d1f8d73","rhatdan","2018-05-16 18:13:12","false","Add support for buildah bud --label

We want to be able to add labels when building a container image.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #698
Approved by: umohnani8",61,16,0,1
"containers/buildah","956d9d86f005927c6f4aef5f3f3b2f8af7738163","openshift-merge-robot","2022-05-06 09:56:53","true","Merge pull request #3970 from containers/dependabot/go_modules/github.com/docker/docker-20.10.15incompatible

build(deps): bump github.com/docker/docker from 20.10.14+incompatible to 20.10.15+incompatible",24,63,1,1
"containers/buildah","78b0a372932aaad47fcaeb1ff0a05b5bb411fe72","TomSweeneyRedHat","2018-03-30 00:25:12","false","Change image time to locale, add troubleshooting.md, add logo to other mds

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #544
Approved by: rhatdan",23,14,0,1
"containers/buildah","46db02116c2ef3e6cd2120da665611201cd8ecdf","Enrico204","2022-09-12 23:29:15","false","Update install.md: Debian 11 (Bullseye) is stable

Signed-off-by: Enrico204 <enrico204@gmail.com>",23,67,1,0
"containers/buildah","85ab067e58161707776ff8ca640c0e0b27759ae0","TomSweeneyRedHat","2019-11-11 19:13:17","false","Bump back to v1.12.0-dev

Closes: #1978
Approved by: rhatdan",78,33,0,1
"containers/buildah","0abc9ac97bfb6fcbccf9e2bf53641f904bca85eb","TomSweeneyRedHat","2020-07-01 15:06:34","false","Bump openshift/imagebuilder to v1.1.6

As the title says.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",146,41,0,1
"containers/buildah","22cc868b3750e19295bb2f16fbe6517068a59998","openshift-merge-robot","2022-12-21 18:52:31","true","Merge pull request #4478 from containers/dependabot/github_actions/actions/stale-7

build(deps): bump actions/stale from 6 to 7",18,71,1,1
"containers/buildah","cd3504b3a4b897bc60c3baf8f3c5423f50feebcb","rhatdan","2022-09-30 16:17:57","true","Merge pull request #4304 from rhatdan/VENDOR

Update vendor containers/(common,image)",20,68,1,1
"containers/buildah","625c7a9d3fecfad85e679326c14c6b787d461754","openshift-merge-robot","2022-03-22 10:48:24","true","Merge pull request #3820 from flouthoc/mount-cache-sharing

buildkit: `--mount-type=cache` must support `locking` external cache store.",31,62,1,1
"containers/buildah","b4f407e631ab506d9547a62656cfb3256b06ff26","mtrmac","2021-06-17 17:52:23","false","Don't use alltransports.ParseImageName with known transports

Call the per-transport API directly, which is marginally more
efficient.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",40,53,1,1
"containers/buildah","ba5ee0e8e1e36dde6735cba086fe80a87a095fd2","cevich","2021-05-04 18:48:08","true","Multi-arch github-action workflow unification

This is a port from the podman repository, of substantially the same
workflow with a number of bugfixes and readability improvements
compared to the original.  Same for the README.md updates.

The significant changes compared to the prior implementation are:

* Run periodically instead of only after every master push.
* Add a build for the ""testing"" image flavor.
* Fix a blank `org.opencontainers.image.source` value.
* Instead of pushing a `main` (or `master`) tagged image, use `latest`.
* Simplify use of env. vars. and workflow vars.

Note: Aside from a `s/podman/buildah/g` this commit makes the
buildah and podman workflows identical.  This is needed to better
support a smooth transition to a future/intended unification effort.

In other words, I intend to develop a single, shared workflow/script
that can be used for all three: skopeo, buildah, and podman.

Signed-off-by: Chris Evich <cevich@redhat.com>",49,51,0,1
"containers/buildah","651c8159e9179827e543e1885e04e998d9af8c98","vrothberg","2021-04-06 08:33:02","false","fix local image lookup for custom platform

Move the platform check into `resolveLocalImage` and inspect each of the
candidates in the given order.  This preserves the local lookup order
and fixes a bug reported in containers/podman/issues/9915.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",51,50,0,1
"containers/buildah","83ad8086e71ae3420d0637dc8afd9c7f580e614f","openshift-merge-robot","2021-04-01 19:18:44","true","Merge pull request #3083 from umohnani8/sym

Check for symlink in builtin volume",52,50,0,1
"containers/buildah","b2f7e278cc3f8f19a316829d2fece2012fe49f0e","openshift-merge-robot","2021-03-10 18:27:48","true","Merge pull request #3059 from barthy1/multi_arch_build_fix

Update multi-arch buildah build setup with new logic",59,49,0,1
"containers/buildah","1a04337f29621cda84f227cdae3289ec65b5a39b","openshift-merge-robot","2021-01-22 17:41:20","true","Merge pull request #2926 from rhatdan/crun

Pick default OCI Runtime from containers.conf",95,48,0,1
"containers/buildah","a13b1de79f2503ad0edd95f6f9f4aa52310848e8","cevich","2020-09-16 10:56:36","true","Lint: Use same linters as podman

Signed-off-by: Chris Evich <cevich@redhat.com>",91,44,0,1
"containers/buildah","6f7d05bcf6aa2e8e21f15286fe29c58a040e4d3d","bertinatto","2018-04-10 17:35:03","false","Allow referencing stages as index and names

Signed-off-by: Fabio Bertinatto <fbertina@redhat.com>

Closes: #495
Approved by: nalind",28,14,0,0
"containers/buildah","f52762a9ee0e4c2d11b667fe966de8d1ced2d576","openshift-merge-robot","2021-01-22 10:55:42","true","Merge pull request #2927 from tvendelin/master

Added required devel packages",96,48,0,1
"containers/buildah","7f340f91f99034113c33cd687ce268c379f7d671","openshift-merge-robot","2021-01-28 21:29:19","true","Merge pull request #2943 from rhatdan/VENDOR

Bump to containers/image v5.10.1",93,48,0,1
"containers/buildah","825561b2cec87c7053713e93046ae8748d45469f","flouthoc","2022-07-07 05:33:04","true","BuildDockerfiles: error out if path to containerfile is a directory

PR https://github.com/containers/buildah/pull/1132 added a support for
`buildah build -f <path-to-dir>` but it was decided that `-f` should
only support file and not a directory hence error out for such use-case.

Change matches with behaviour of docker and buildkit

Closes: https://github.com/containers/podman/issues/14836

Signed-off-by: Aditya R <arajan@redhat.com>",23,65,1,1
"containers/buildah","1de958dc999a25c1e5e502d46c7011954f06737f","saschagrunert","2019-08-05 11:55:56","false","Add automatic apparmor tag discovery

The 'apparmor' build tag is now added if libappamor was found on the
local system.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1763
Approved by: rhatdan",49,30,0,1
"containers/buildah","7f21aa8defc5e9cb593f373d44ddae8e9b54b0fe","openshift-merge-robot","2021-06-10 20:47:17","true","Merge pull request #3280 from alvistack/master-linux-amd64

Update nix pin with `make nixpkgs`",34,52,1,1
"containers/buildah","566cc1309fc8cdf7e87d1babed2aa4acbf25907e","afbjorklund","2019-01-06 12:54:06","false","Use NoPivot also for RUN, not only for run

Forgot to read this config, for the ""bud""

Signed-off-by: Anders F Björklund <anders.f.bjorklund@gmail.com>

Closes: #1262
Approved by: rhatdan",51,23,0,1
"containers/buildah","8548885dc89ffb188faad49c6ea58085197a78eb","openshift-merge-robot","2021-09-27 16:02:58","true","Merge pull request #3541 from containers/dependabot/go_modules/github.com/containers/common-0.46.0

build(deps): bump github.com/containers/common from 0.45.0 to 0.46.0",38,56,1,1
"containers/buildah","b6c883d1aa03373d84933346bdb44419913545ed","openshift-merge-robot","2021-09-04 10:03:29","true","Merge pull request #3492 from flouthoc/manifest-rm-only-manifest

manifest: Make sure manifest `rm` only removes manifests not referenced images.",37,55,1,1
"containers/buildah","b5b24fe26eb09c397e3dbf0c2a4f7b1ef5f2007b","openshift-merge-robot","2020-11-25 01:16:56","true","Merge pull request #2806 from rhatdan/filter

Fix crash on invalid filter commands",78,46,0,1
"containers/buildah","b81af1e2129c52d194de2e962ede5873414e17f4","TomSweeneyRedHat","2018-04-10 17:07:31","false","Display imageId after commit

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #566
Approved by: rhatdan",28,14,0,1
"containers/buildah","21b914e84a17c8581bd5cc8e46cabb8c46e63359","TomSweeneyRedHat","2019-07-30 14:34:24","false","Add overlayfs to fuse-overlayfs tip

This adds a note about replacing overlayfs with
fuse-overlayfs.  We've had a number of issues reported
about overlayfs not working in a rootless environment
and this will hopefully help.  Reference: #1745, #1720 and

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",47,30,0,1
"containers/buildah","350c509ecf7ef809e9b05fb4832b5e55abdc104e","dfr","2022-08-05 13:10:03","false","chroot: Move RunUsingChroot and runUsingChrootMain to run_common.go

This leaves runUsingChrootSubprocOptions in the platform-specific file
since syscall.SysProcIDMap isn't available on FreeBSD.

Signed-off-by: Doug Rabson <dfr@rabson.org>",18,66,1,0
"containers/buildah","9dfb213a15099a48cae5912fd83bbe539a75def6","rhatdan","2019-02-28 02:50:22","false","Vendor in latest containers/storage

Replaces a lot of write locks with read locks, which should help with
performance.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1376
Approved by: TomSweeneyRedHat",62,25,0,1
"containers/buildah","4290ab5af24368e498396c7fc69cd65bff424f85","rhatdan","2022-10-27 17:23:03","false","vendor in latest containers/(storage, common, image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",24,69,1,1
"containers/buildah","b2252395fe5a8f6d934eeeccbf1a5b3d9f338be0","rhatdan","2018-09-20 14:00:28","true","Merge pull request #1029 from nalind/dangling-whitespace

Get rid of dangling whitespace in markdown files",37,20,0,1
"containers/buildah","3454d5b2915593cd0b0b62569a22b889ee06ddb0","rhatdan","2023-08-25 19:00:19","false","Support passing of ULimits as -1 to mean max

Docker allows the passing of -1 to indicate the maximum limit
allowed for the current process.

Fixes: https://github.com/containers/podman/issues/19319

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",8,79,1,1
"containers/buildah","2064b29f40d39d73232464ea88a32e6a88a30554","nalind","2018-06-04 21:36:26","false","Run(): add options for adding and removing capabilities

Add RunOptions and BuildOptions flags for modifying the list of granted
capabilities from the default.

Default to granting the current (as of this writing) defaults from
runtime-tools, with CAP_NET_RAW removed:
* CAP_AUDIT_WRITE
* CAP_CHOWN
* CAP_DAC_OVERRIDE
* CAP_FOWNER
* CAP_FSETID
* CAP_KILL
* CAP_MKNOD
* CAP_NET_BIND_SERVICE
* CAP_SETFCAP
* CAP_SETGID
* CAP_SETPCAP
* CAP_SETUID
* CAP_SYS_CHROOT

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #799
Approved by: rhatdan",37,16,0,1
"containers/buildah","6b556bc5b0720a4946f75eb44d181b17a42fa1d4","nalind","2019-02-13 15:21:47","false","Test on xenial, not trusty

Trusty's kernel is too old to provide memfd_create().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1334
Approved by: giuseppe",58,25,0,1
"containers/buildah","2048c74819df152877183be35ab9358ec4fff534","nalind","2017-05-23 19:00:57","false","Cleanup: use FileInfo's own IsDir() method

Use os.FileInfo's IsDir() method instead of Mode().IsDir().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #120
Approved by: rhatdan",15,4,0,1
"containers/buildah","3651b7af29cadc7e932a5ed4a444343fc75b8e76","hshiina","2021-03-09 01:09:54","true","Merge branch 'master' into system-tests",58,49,0,0
"containers/buildah","1fee8d4f72c6303885089fb20366064ef0ad299c","openshift-merge-robot","2023-09-18 17:07:21","true","Merge pull request #5050 from nalind/copy-context-dir-relative

add/copy: make sure we handle relative path names correctly",7,80,1,1
"containers/buildah","d6b9027e79868e6e490adcc1f726611cc9ac4074","TomSweeneyRedHat","2019-01-16 14:10:34","false","Bump 1.7-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",51,24,0,1
"containers/buildah","97ba8c1bb247ede65c0e775ef1abab190ea3a94a","TomSweeneyRedHat","2022-01-26 21:51:17","false","Bump to v1.25.0-dev
[NO TESTS NEEDED]

As the title says.

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",34,60,1,1
"containers/buildah","d06be8cdd446c2a8336b50757e4c4260325225a5","giuseppe","2018-09-03 19:33:32","true","unshare: keep the additional groups of the user

Do not reset the additional groups for a rootless user when creating a
new user namespace.  In this way, users of the ""docker"" group are
still able to use the docker-deamon: destination.

Closes: https://github.com/projectatomic/buildah/issues/978

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",35,19,0,1
"containers/buildah","3d93408a062a766170f3cf0055cb94074edda22a","kolyshkin","2022-01-18 03:02:22","false","all: fix capabilities.NewPid deprecation warnings

Since commit 3eef1ed0bd12bcccf (January 2019) using
capabilities.NewPid() is deprecated.

Replace with NewPid2().

Note that in chroot/run.go we used to load then clear all capabilities
bits. With NewPid2, this is no longer needed -- we do not load caps, so
there is no need to clear.

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","e1c7a5cd231b1c9d1c55395da0b8d38c7234c27e","openshift-merge-robot","2021-02-16 09:51:27","true","Merge pull request #2978 from TomSweeneyRedHat/dev/tsweeney/emptydir2

Don't fail copy to emptydir",63,49,0,1
"containers/buildah","289b538cb30d2b2466e3dce48d4388644b9e594f","openshift-merge-robot","2021-04-02 12:13:09","true","Merge pull request #3118 from edsantiago/bats_fixes

System-test cleanup",49,50,0,1
"containers/buildah","547bd9a5cb56441f8c006d17751968984830838e","TomSweeneyRedHat","2019-06-04 12:40:56","false","Bump to v1.8.3

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1641
Approved by: nalind",59,28,0,1
"containers/buildah","8d8f00e124a802b2317703ab9a911e0ebbdc389b","edsantiago","2021-02-08 15:20:36","false","'make validate': require PRs to include tests

This is an almost-clone of podman PR 8911[1], in which Ed
ticks off developers by requiring that PRs include tests.

 [1] https://github.com/containers/podman/pull/8911

Motivated by the just-merged #2973, which is exactly the sort
of tiny little change that can have huge consequences down
the line and/or be easy to undo.

Changes from the podman version: allow '[NO NEW TESTS NEEDED]'
in addition to just '[NO TESTS NEEDED]', and make the former
the default suggestion. It's clearer. And, of course, update
the test-suite cases to reflect the buildah git tree.

Unrelated parasitic change: I removed the '@'s from 'validate'
steps; this will make it easier to (1) confirm that all desired
rules were invoked, and (2) on failure, see the exact command
that failed, making it quicker/easier for dev to reproduce.

Signed-off-by: Ed Santiago <santiago@redhat.com>",93,48,0,1
"containers/buildah","e2364773a0d0e6e9fd842564a3ba86f064697339","openshift-merge-robot","2020-11-05 15:14:40","true","Merge pull request #2746 from alvistack/master-linux-amd64

Update nix pin with `make nixpkgs`",68,45,0,1
"containers/buildah","bae06b14fcd246685ec8bac7d138dbd44940b8a4","rhatdan","2018-04-17 08:14:37","false","buildah images and podman images are listing different sizes

After reviewing how the sizes are shown.  It looks like podman was
using docker/units to display size.  Its size is based off of multiples
of 1000, which according to Wikipedia is correct for image sizes.

https://en.wikipedia.org/wiki/Binary_prefix

Buildah was using multiples of 1024.  This patch switches buildah to use the same
multiple and to reduce its accuracy to two decimal points so that buildah
podman will return the same sizes.  This also will match the way that docker
reports image sizes.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #594
Approved by: umohnani8",32,15,0,1
"containers/buildah","ce772b7aa0ffa7df31659de9b5826e136eabb224","cevich","2021-05-11 18:19:01","true","Cirrus: Support [CI:DOCS] test skipping

Signed-off-by: Chris Evich <cevich@redhat.com>",54,51,0,1
"containers/buildah","cfa10d16c9807cf95eb810c339713da90da72ef0","mtrmac","2022-10-19 00:13:05","false","Maintain cache mount locks as lock objects instead of paths

They exist in memory anyway, so this is more efficient:
we avoid the need to manually touch the filesystem again,
the associated costs - and the error paths go away.

[NO NEW TESTS NEEDED]

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",27,69,1,1
"containers/buildah","d528a085ff8a79c14f96967400a07f5aed2b9992","mtrmac","2019-02-23 01:45:52","false","Neutralize buildah/unshare on non-Linux platforms

On macOS, tests/validate/govet.sh fails with
> can't load package: package github.com/containers/buildah/unshare: C source files not allowed when not using cgo or SWIG: unshare.c

because unshare/unshare_{cgo,gccgo}.go are Linux-only.

On macOS, the only ""active"" files are Linux-only unshare.c and
empty unshare_unsupported.go.

Callers need to differentiate between Linux/non-Linux anyway, because
none of the Linux-specific symbols are available on non-Linux; so,
remove unshare_unsupported.go entirely, making this subpackage
completely non-existent on non-Linux platforms.  (Alternatively,
the unshare_unsupported.go file could contain stubs for the Linux
API, but both callers have Linux build tags anyway, so nothing
would benefit right now.)

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1365
Approved by: rhatdan",59,25,0,1
"containers/buildah","1a2af6864d860d1320dabca091ba6b2f10c5c1e4","AndASM","2022-10-07 20:36:36","false","Update contrib/buildahimage/Containerfile

Co-authored-by: Chris Evich <1183438+cevich@users.noreply.github.com>
Signed-off-by: Andrew Meadows <andrew@befuddled.ca>",29,68,1,0
"containers/buildah","c615c3e23d0a43dcb0989eec37edf4ff96430a84","boaz0","2018-01-29 01:48:00","false","Fix typo then->than

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>

Closes: #423
Approved by: rhatdan",37,12,0,0
"containers/buildah","2d5a2997a352f8762e3849ddd877f4e22fbbd224","rhatdan","2021-12-16 18:44:32","true","Merge pull request #3674 from flouthoc/cache_squashed

stage_executor: re-use all the layers from `cache` for `squashed` case and `commit` as late as possible.",30,59,1,1
"containers/buildah","763304270e7c4183457ef096cc42037e69d19c6e","rhatdan","2023-03-02 13:40:45","true","Merge pull request #4629 from Steffen1989/fix_tutorial_1

[CI:DOCS] Fix tutorial for rootless mode",16,73,1,1
"containers/buildah","e5e054795b44b3af65d618ca04547c0061d9167e","rhatdan","2019-07-12 12:11:24","false","Bump to v1.9.1

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",50,29,0,1
"containers/buildah","555b5a5015147cef832d843e87dddbcad4d43350","rhatdan","2019-07-19 09:43:03","false","Handle ReadOnly images when deleting images

When deleting all images, ignore read/only images.

If user attempts to remove a read/only image, report an error.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1732
Approved by: @TomSweeneyRedHat",49,30,0,1
"containers/buildah","028686ef639dc6fd836a53fea8e4c7340c6f9647","rhatdan","2023-07-26 17:13:20","true","Merge pull request #4941 from containers/renovate/github.com-docker-docker-24.x

fix(deps): update module github.com/docker/docker to v24.0.5+incompatible",13,78,1,1
"containers/buildah","58053a4779db76aa2af490751c02435b9c64c74d","rhatdan","2023-09-26 13:43:16","true","Merge pull request #5060 from lsm5/packit-fail-tag

[CI:BUILD] Packit: tag @packit-build team on copr build failures",9,80,1,1
"containers/buildah","538c6654529f99dfc66051ec91ee21817fe5b668","rhatdan","2023-04-08 11:02:34","true","Merge pull request #4702 from cbandy/env-passthrough

Pass process environment variables by reference",11,74,1,1
"containers/buildah","eaad6b4130d0ba8033d5f5a3effa0b765bf69685","edsantiago","2019-10-29 16:26:14","false","Fix another broken test: copy-url-mtime

The newer-than and older-than test was failing (desired result)
but it's because the command had a syntax error (not desired)!

Rewrite that section a little, making it more robust (actually
confirming that mtime is preserved, versus simple mtime match
because of time of execution) and also with more readable
diagnostic in case of error.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1935
Approved by: giuseppe",81,33,0,1
"containers/buildah","2f0179fae20fa1899491abacb99fe38839892913","QiWang19","2019-04-18 13:57:31","false","fix bug dest path when COPY .dockerignore

Fix the destination file path if .dockerignore is not empty. Avoid copying the source directory level into the container.

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1533
Approved by: rhatdan",52,27,0,1
"containers/buildah","f629ded01a240c7e4a67001c279d593fefe5dabd","openshift-merge-robot","2021-05-20 00:35:24","true","Merge pull request #3244 from TomSweeneyRedHat/bump-1.21.0_try2

Bump 1.21.0 [NO TESTS NEEDED]",55,52,1,1
"containers/buildah","437f92c52d48bcfd562586b563ae321dd24b468e","openshift-merge-robot","2021-04-28 21:41:09","true","Merge pull request #3184 from nalind/resolve-symlink

imagebuildah: drop resolveSymlink()",49,51,0,1
"containers/buildah","a23615aecf3d898d487dffed04e1303cae87833a","vrothberg","2021-07-19 11:49:02","false","refine dangling filter

By proxy by vendoring containers/common.  Previously, a ""dangling"" image
was an untagged image; just a described in the Docker docs.  The
definition of dangling has now been refined to an untagged image without
children to be compatible with Docker.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",43,54,1,1
"containers/buildah","0662a4e3643b4dd39b166d538ee1115d129c0da7","edsantiago","2019-12-12 21:47:36","false","BATS major cleanup: blobcache.bats: refactor

Split out into its own commit, because it's a big one
to review.

The same code was literally copy-pasted a bunch of times, with
the only difference being the use of $doomeddir vs $destdir in
a couple of spots. Refactor, and while we're at it refactor the
tests for expected matches and mismatches.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2029
Approved by: rhatdan",88,34,0,1
"containers/buildah","2eb5b6f5e648df628dfaa71aa23c391d947fc62e","giuseppe","2020-10-27 14:30:00","true","overlay: fix umount

there can be multiple overlay mounts for a container.  Each mount is
performed in a ../userdata/overlay subdirectory.

Iterate the subdirectories and attempt to unmount them.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",65,45,0,1
"containers/buildah","f6a02585a6fcd2d75da12c76d579bdb8388b7257","nalind","2018-06-06 14:41:40","false","build-using-dockerfile,commit: disable compression by default

When committing an image to local storage, compressing the new layers
only wastes time because they need to be decompressed again when being
written to local storage.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1274
Approved by: rhatdan",37,16,0,1
"containers/buildah","8292693fc89d467b4d409360362d80350477d657","nalind","2017-03-22 19:17:53","false","Correctly report errors returned by commands

When running our various subcommands, report errors that they return
correctly, and ensure that in those cases we don't exit with status 0.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",12,2,0,1
"containers/buildah","21c71b634bf5c1ed569ffc336193846218ccd421","nalind","2017-04-19 12:51:25","false","Bump containers/image and image-spec

Update to the current github.com/containers/image and
github.com/opencontainers/image-spec packages.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",13,3,0,1
"containers/buildah","769f44828bd1216d7970652dfb9b1aa70cb1a73d","nalind","2018-06-28 20:03:27","false",".papr.sh: Also test with BUILDAH_ISOLATION=chroot

After the previously-defined tests are run, run the integration tests
again with chroot isolation.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #836
Approved by: rhatdan",28,17,0,1
"containers/buildah","545825046257859245d3513e0f1fa21b43844f58","nalind","2017-06-19 14:23:35","false","Update the example commit target to skip transport

Update the target name that we use when committing an image in the
example script to not mention the local storage transport, since the
default is to use it anyway.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #163
Approved by: rhatdan",12,5,0,1
"containers/buildah","6afcabc1aa440b0d1eb8d91aafccaa5c5268e5af","nalind","2017-03-15 21:25:05","false","Test looking up containers by name and root

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,2,0,1
"containers/buildah","a64f7d11875278224498fc67fccb33b916dec872","nalind","2017-03-15 21:19:29","false","Better distinguish between image names and IDs

When recording the origins of working containers, take better care to
distinguish between image names and IDs.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,2,0,1
"containers/buildah","2145666c1634d4fa36547b45dca27bc76453d9d3","rhatdan","2023-04-08 21:41:15","true","Merge pull request #4726 from rhatdan/VENDOR

Bump to v1.30.0",11,74,1,1
"containers/buildah","3cb835dfef5e5b67e76c783b905e7a6d32c61e49","rhatdan","2018-12-17 22:12:03","false","Properly handle Hostname inside of RUN command

This will get buildah bud to follow docker build handling of
hostname environment variable and hostname command properly

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1242
Approved by: giuseppe",53,23,0,1
"containers/buildah","68ccdd77feb794cf9cdacae1ae6c590e0fc95a9b","rhatdan","2017-10-06 14:15:27","false","Fix timeout issue

We are seeing some wierd timeouts in testing, if we eliminate
the bridged networkin in the container runtime, we hope to be
able to eliminate this problem.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #283
Approved by: nalind",32,8,0,1
"containers/buildah","113dffd78b729788e579e84d6a46fce0655d1ae4","vrothberg","2019-05-29 14:26:22","false","chroot: fix error handling in deferred funcs

errors.Wrap(err) and friends will return nil if err is nil, so make
setting the error conditional.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1624
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","1a1a728e19477e47f2f53d35fd8bbc225caf2346","rhatdan","2019-08-31 10:31:01","true","Merge pull request #1827 from TomSweeneyRedHat/bump-1.11.0

Bump 1.11.0",57,31,0,1
"containers/buildah","2cf9c8f2b86b5b651dbb6aa6d7210e480475eb27","rhatdan","2020-09-11 14:06:31","false","Fix up code based on codespell

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",89,43,0,1
"containers/buildah","fbf46d33c4e01199281c7a69e68605ec7d611fd3","rhatdan","2018-06-08 22:41:00","false","Bump to v1.1

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",32,16,0,1
"containers/buildah","357d4aeb4316808728208d27e8898edd3d42b704","rhatdan","2019-12-04 13:44:49","true","Merge pull request #2003 from TomSweeneyRedHat/bump-1.11.6

Bump 1.11.6",85,34,0,1
"containers/buildah","b23f145416cd8ed4f76f2ebac6434ea3c03ce128","umohnani8","2018-02-13 19:37:31","false","Vendor in packages

vendor in profiles from github.com/docker/docker/profiles to support seccomp.
vendor in latest runtime-tools to support bind mounting.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #477
Approved by: rhatdan",17,13,0,1
"containers/buildah","9d2907c4deb18341805c2bb37fc631afd21473c1","EricHripko","2019-05-26 12:56:13","false","Create directory paths for COPY thereby ensuring correct perms

Signed-off-by: Eric Hripko <ehripko@bloomberg.net>

Closes: #1615
Approved by: rhatdan",54,28,0,0
"containers/buildah","99066e01046bfe41f0943511d55682cdfc6ad943","shyukri","2018-02-23 11:08:12","false","Add openSUSE in install section

Signed-off-by: Shyukri Shyukriev <shshyukriev@suse.com>

Closes: #492
Approved by: rhatdan",17,13,0,0
"containers/buildah","1ef527c81ae38b52946769dead63d4f41ffcd2f9","TomSweeneyRedHat","2019-01-08 22:39:53","false","Add CreatedAtRaw date field for use with Format

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

This adds the ability to see a ""raw"" date format for the CreatedAt field rather than the pretty formatted variety.

Wit this in place the files will print thusly:

.CreatedAt: ""Jan 8, 2019 09:22""
.CreatedAtRaw: ""2019-01-08 09:22:52.330623532 -0500 EST""

This hopefully at least partially addresses #1266
Once agreed to, we might want to do a similar thing for buildah containers and then in similar commands in Podman.

Closes: #1269
Approved by: rhatdan",51,23,0,1
"containers/buildah","c84db980aeac8f27d17a34c75f2422ca23185a1a","TomSweeneyRedHat","2018-02-01 15:48:45","false","Touch up rmi -f usage statement

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #441
Approved by: rhatdan",44,12,0,1
"containers/buildah","9ff68b3cdead1f67c6cbab8bea419dd39a25af96","caiges","2019-11-12 16:50:21","false","Add builder identity annotations.

Use io.podman.version and fix inspect tests

Signed-off-by: caiges <caigesn@gmail.com>

Closes: #1917
Approved by: TomSweeneyRedHat",79,33,0,0
"containers/buildah","4387e7e3c30685ca8d14a10834e678baf7cd3913","dfr","2022-06-14 15:10:11","false","Add freebsd cross build targets

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","309f714b5f13b18bdabeeb76b663c1bd06d94ff3","dfr","2022-08-06 07:17:47","false","chroot: Move isDevNull to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",17,66,1,0
"containers/buildah","8e36f5fc9c4dd2226a7f8aa7d96b2af978ff0b23","dfr","2022-06-15 10:53:44","false","Move configureEnvironment to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","9855bc797f0532bae9987e07ba06d0cbf9c71ff8","openshift-merge-robot","2021-08-26 14:09:08","true","Merge pull request #3475 from rhatdan/dockerfile

Fix ownership of /home/build/.local/share/containers",39,55,1,1
"containers/buildah","8b6df9ac09acf29884c743038d4daa22f456e82c","openshift-merge-robot","2021-11-23 18:36:14","true","Merge pull request #3641 from rhatdan/VENDOR

UPdate vendor of container/storage",29,58,1,1
"containers/buildah","fd14bfe54538187e9c180333dc0fcf26e8225fc8","flouthoc","2022-09-15 08:42:19","true","buildah: make --cache-ttl=0s equivalent to --no-cache

If user explicitly specified `--cache-ttl=0s
it would effectively mean that user is asking
to use no cache at all. In such use cases
buildah can skip looking for cache entierly
by setting `--no-cache=true` internally.

Closes: https://github.com/containers/buildah/issues/4244

Signed-off-by: Aditya R <arajan@redhat.com>",21,68,1,1
"containers/buildah","baeea1febb8c22f461a082812e5969dba49c7913","mtrmac","2018-12-04 21:55:15","false","Remove BlobCache.PutBlob

It has no users, and removing it removes an unused code branch in the putBlob
implementation.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1218
Approved by: rhatdan",46,22,0,1
"containers/buildah","502533183e7bc9bddee6eda7d87f4b8c989a3eef","TomSweeneyRedHat","2019-02-21 23:00:43","false","Bump to 1.8-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1359
Approved by: rhatdan",59,25,0,1
"containers/buildah","1eaaf79069d888a7ce7ffd5ead765517c4ad12d8","rhatdan","2018-10-19 18:49:51","false","Allow container storage to manage the SELinux labels

Also speed up container name selection by making sure the container name
is not chosen before trying it out.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",56,21,0,1
"containers/buildah","f892eb62913711a97c19da7f2ad03ce16106b34e","rhatdan","2019-08-08 19:20:42","true","Merge pull request #1773 from TomSweeneyRedHat/bump-1.10.1

Bump 1.10.1",51,30,0,1
"containers/buildah","8fc5b0116f4c2eaca11038d64fa48d2e93cc6b08","rhatdan","2019-12-06 11:40:34","false","Start using containers/common

We have moved share code from buildah, podman and others into containers/common.

Specifically for this PR we are moving to use containers/common/pkg/unshare and
containers/common/pkg/cgroups.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #2010
Approved by: QiWang19",86,34,0,1
"containers/buildah","3b16a70308346c639279f895ca71cbe798e2cc8b","rhatdan","2022-01-21 18:25:31","true","Merge branch 'main' into systemflag",34,60,1,1
"containers/buildah","e50fee57383fabad4cb27e153e22bd27ad9eb9b9","baude","2017-06-26 14:52:51","false","cmd/buildah/containers.go: Add JSON output option

Consumers of the buildah output will need structured text like
the JSON format.  This commit adds a --json option to
buildah containers.

Example output:
```
[
    {
        ""ID"": ""8911b523771cb2e0a26ab9bb324fb5be4e992764fdd5ead86a936aa6de964d9a"",
        ""Builder"": true,
        ""ImageId"": ""26db5ad6e82d85265d1609e6bffc04331537fdceb9740d36f576e7ee4e8d1be3"",
        ""ImageName"": ""docker.io/library/alpine:latest"",
        ""ContainerName"": ""alpine-working-container""
    }
]

```

Signed-off-by: Brent Baude <bbaude@redhat.com>

Closes: #164
Approved by: rhatdan",17,5,0,0
"containers/buildah","e868628a3dbaeb2d5dcfef737ed00cd69353ea8a","giuseppe","2021-02-12 09:31:29","true","buildah: use volatile containers

overlay supports a new mount option ""volatile"" that reduces I/O by
ignoring fsync and syncfs requests.

Enable it for Buildah containers as they are not supposed to survive a
machine crash and they are thrown away if the build fails.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",67,49,0,1
"containers/buildah","6fd10cd924b2b29f89c7f82e1ba7d711d926c662","openshift-merge-robot","2022-05-16 19:09:29","true","Merge pull request #3995 from nalind/test-helpers-rootless

test helpers: default to being rootless-aware",25,64,1,1
"containers/buildah","8d08247a7cf0b322439a18cd20802f141a294488","openshift-merge-robot","2021-06-10 20:52:42","true","Merge pull request #3293 from cevich/fix_links

[CI:DOCS] Fix docs links due to branch rename",34,52,1,1
"containers/buildah","b9fdee0764268e116b138decb66eae13b268b6cb","openshift-merge-robot","2020-12-22 14:34:28","true","Merge pull request #2862 from rhatdan/VENDOR

SELinux no longer requires a tag.",84,47,0,1
"containers/buildah","35bfc66a620dbdf46973db26eabd9e5ef0d9e233","flouthoc","2022-07-11 06:09:18","true","buildah: set XDG_RUNTIME_DIR before setting default runroot

In sessions which are rootless and contains no valid login session
`XDG_RUNTIME_DIR` is not set for such use-case `getStore(` automatically
sets `XDG_RUNTIME_DIR` just move it before we set default `runroot` so we
end up populating correcting `runroot` for cases which are rootless and
no valid login is present.

Closes: https://github.com/containers/buildah/issues/4093

Signed-off-by: Aditya R <arajan@redhat.com>",21,65,1,1
"containers/buildah","9c7efb96c97665b9561180918eb152d318ddf316","flouthoc","2022-02-15 09:12:12","true","history: only add proxy vars to history if specified

`Buildkit/Docker` adds variables in pre-allowlist for e.g `proxy
variables` to OCI/Docker history only if user explicitly specifies them in
Dockerfile using `ARG`.

By default variables in pre-allowlist e.g `proxy variables` will be used
normally but will not be leaked into `docker/OCI` history of images.

A test for following behviour is added with this commit and similar test
can be verified against `Docker/Buildkit`

Closes: https://github.com/containers/buildah/issues/2937

Signed-off-by: Aditya R <arajan@redhat.com>",29,61,1,1
"containers/buildah","be682de68c06582155b01976d3dacf4db948664c","flouthoc","2023-05-15 11:14:50","true","build: validate volumes on backend

Validate build volumes on backend and not on frontend

Closes: https://github.com/containers/podman/issues/17139

[NO NEW TESTS NEEDED]
Exisiting volumes checks must pass. ( Tests might need retrofit in error
message )

Signed-off-by: Aditya R <arajan@redhat.com>",12,76,1,1
"containers/buildah","97a52b13bb27a737b2e393f0410c51e91f87679c","openshift-merge-robot","2022-09-07 12:13:44","true","Merge pull request #4223 from rhatdan/exit

Don't call os.Exit(1) from manifest exist",18,67,1,1
"containers/buildah","5bab9b065168ccec3173f23aabf8cd9b260ffb08","vrothberg","2019-07-29 09:42:04","false","vendor github.com/containers/image@v2.0.1

* progress bar: use spinners for unknown blob sizes
* use 'containers_image_ostree' as build tag
* ostree: default is no OStree support
* Add ""Env"" to ImageInspectInfo
* config.go: improve debug message
* config.go: log where credentials come from
* Fix typo in docs/containers-registries.conf.5.md
* docker: delete: support all MIME types
* Try harder in storageImageDestination.TryReusingBlob
* docker: allow deleting OCI images
* ostree: improve error message

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1730
Approved by: TomSweeneyRedHat",50,30,0,1
"containers/buildah","5f7e47bd2c40fe8d78e9f1fa7ccbe4c0982f6186","tetchel","2021-03-03 23:11:11","false","fix: Containerfiles - smaller set of userns u/gids

Signed-off-by: Tim Etchells <tetchel@gmail.com>",59,49,0,0
"containers/buildah","b361fe9a2b6b9f1069c2f7158434c547ca312d71","nalind","2020-10-08 17:41:23","false","imagebuildah: redo step logging

* Don't try to count COMMIT as a step; it's very confusing and doesn't
  match the behavior of traditional docker build.
* Include the step count for the stage, which is easy if we're not
  trying to predict COMMIT, which we don't always do, because we don't
  always have to, in multi-stage builds.
* In multi-stage builds, prefix the stage number and stage count, which
  is fun to see when we're building stages in parallel.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",61,44,0,1
"containers/buildah","7d2d8761e971c0954cbc9df8f309227f0fd5d33b","nalind","2017-06-02 15:03:23","false","Include image-spec and runtime-spec versions

Include the versions from the image-spec and runtime-spec that we were
built with as part of our --version and --help output.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #131
Approved by: nalind",12,4,0,1
"containers/buildah","f7dc659e52ba861f12f13c7f98030773a785cbb9","nalind","2017-11-08 16:46:56","false","Bump github.com/vbatts/tar-split

Update github.com/vbatts/tar-split to v0.10.2 and pin that version
instead of master, to pick up https://github.com/vbatts/tar-split/pull/42

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #318
Approved by: rhatdan",30,9,0,1
"containers/buildah","4d8ae6c48c25c63eeb47d6ceab5dbab7a933f989","nalind","2019-05-21 23:53:00","false","config: expand variables only at the command line

Skip our own attempt to expand variables in the SetEnv API, since we
need to let the Dockerfile parser be the only place that happens when
we're building using a Dockerfile.

Move the expansion logic to the CLI, and have it log an error when it
encounters a variable that it can't expand.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1607
Approved by: TomSweeneyRedHat",56,28,0,1
"containers/buildah","ea182a70e145d91667dd664a9cbe4e73f3e69927","nalind","2018-06-07 18:41:54","false","Change RunOptions.Stdin/Stdout/Stderr to just be Reader/Writers

Change RunOptions.Stdin from a ReadCloser to a Reader, since we weren't
closing it.  Likewise, change RunOptions.Stdout and .Stderr from
WriteClosers to Writers, since we weren't closing them, either.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #792
Approved by: rhatdan",31,16,0,1
"containers/buildah","239c06cfaa0e1ad245499c7a96fbf7ab5afea419","nalind","2022-07-26 14:19:11","false","imagebuildah: complain about the right Dockerfile

When we encounter an error parsing an additional Dockerfile, complain
about the right file, instead of the one we parsed before it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",19,66,1,1
"containers/buildah","fb14850b5093b6b53f730f99d26ffb1e4e0616db","umohnani8","2018-02-23 17:38:39","false","Fix secrets patch for buildah bud

buildah bud was failing to get the secrets data
The issue was buildah bud was not being given the /usr/share/containers/mounts.conf file path
so it had no secrets to mount
Also reworked the way the secrets data was being copied from the host to the container

Signed-off-by: umohnani8 <umohnani@redhat.com>",17,13,0,1
"containers/buildah","d9578d32cd703594e670c60c0303513e347ee100","flouthoc","2022-12-07 12:06:12","true","build, mount: allow realtive mountpoints wrt to work dir

When working with `--mount=type=bind` and `--mount=type=cache` allow
`target` to accept relative paths w.r.t to the configured work dir.

Closes: https://github.com/containers/buildah/issues/4309

Signed-off-by: Aditya R <arajan@redhat.com>",16,70,1,1
"containers/buildah","50a4acb01570d4d8de780fa9eb14425999d398f7","flouthoc","2022-08-08 10:17:50","true","make,cross: ignore loong64 from target list

Released and used version of https://github.com/etcd-io/bbolt/tree/v1.3.6
does not defines certain constants for `loong64` ARCH so avoid building
for `loong64` in `make cross` and `cross-build` CI test.

Remove this commit once `v1.3.7` is out since this is fixed on master
branch.

[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",17,66,1,1
"containers/buildah","7205e33598a5132e41ab65082eea0f2efe703a07","openshift-merge-robot","2022-06-02 17:56:09","true","Merge pull request #4020 from cevich/fix_debug

Fix use generic/ambiguous DEBUG name",25,64,1,1
"containers/buildah","8068c1ba80912683b369a3c1b82d2f667630ac24","openshift-merge-robot","2022-03-28 13:49:50","true","Merge pull request #3869 from containers/dependabot/go_modules/github.com/onsi/gomega-1.19.0

build(deps): bump github.com/onsi/gomega from 1.18.1 to 1.19.0",28,62,1,1
"containers/buildah","22b3de4cb58c26b3a7bb900719c8ac3364fc65a1","openshift-merge-robot","2021-05-14 08:27:32","true","Merge pull request #3226 from cevich/fix_fail_mail_repo

[CI:DOCS] github: Fix bad repo. ref in workflow config",54,52,1,1
"containers/buildah","1678745383871712985bc1600d61cdf3c2ac3e1e","openshift-merge-robot","2020-12-09 13:40:55","true","Merge pull request #2844 from edsantiago/move_from_docker_io

Move away from using docker.io",78,46,0,1
"containers/buildah","806d2c55b18e0224961c7dad6d87e4d02f940e6d","nalind","2020-07-21 03:58:36","false","test-unit: invoke cmd/buildah tests with --flags

Pass options to the test using two hyphens, which cobra expects, rather
than a single hyphen, which the standard library's flag package would
expect.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",149,42,0,1
"containers/buildah","da071e1c598a59257e44e9b243957e2503008dbb","rhatdan","2020-04-27 14:41:01","false","Fix permissions on containers.conf

When running in a rootless buildah, the build user
is not allowed to read /etc/containers/containers.conf
which is causing these containers to fail.

This patch makes containers.conf world readable.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",136,39,0,1
"containers/buildah","5723277f23e9c2cbcd3ebb1d4eb94c420d73ae30","giuseppe","2020-03-02 12:30:26","true","run_linux: fix tight loop if file is not pollable

do not attempt again to poll the file if it is not pollable and the
the errno is not syscall.EINTR or syscall.EAGAIN.

Closes: https://github.com/containers/buildah/issues/2194

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",102,37,0,1
"containers/buildah","4a14ffe113f0235e944521b0c02a40b52814c0fe","rhatdan","2020-02-09 12:33:48","false","Merge pull request #2150 from TomSweeneyRedHat/dev/tsweeney/coc

Add Code of Conduct",111,36,0,1
"containers/buildah","e9969bca8be4a57b1ee815cb5d589f605b9e2aee","wking","2019-09-16 04:15:12","false","util/util: Fix ""configuraitno"" -> ""configuration"" log typo

Typo from 765c09d6db (Update containers/image to v2.0.0, 2019-06-03, #1634).

Signed-off-by: W. Trevor King <wking@tremily.us>

Closes: #1861
Approved by: TomSweeneyRedHat",61,32,0,0
"containers/buildah","c78e9387a00fd0bf4e0757c02acf3bc7951a5f6e","TomSweeneyRedHat","2023-08-04 19:29:02","true","Merge branch 'main' into fix_bad_test_env",12,78,1,1
"containers/buildah","aed3fdc763707532712e9ffba751d3853bc6e320","nalind","2022-07-26 14:18:25","false","Fix a typo in an error message

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",19,66,1,1
"containers/buildah","1680e26eb4d416d647399a860484953e02f77d29","nalind","2022-05-02 22:37:36","false","Handle OS version and features flags

Teach `buildah build` and `buildah config` about the OS version and
features fields.  We don't tend to use them on Linux, but they're in the
OCI and Docker config structures, so we need to be able to preserve and
manipulate their values, much as we do for variant information.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",24,63,1,1
"containers/buildah","b44c7b64da81598bb8e364236d3fec1bd4e0896e","rhatdan","2021-09-13 14:38:41","false","Vendor in containers/common v0.44.0

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",39,55,1,1
"containers/buildah","802a9042c8f7a6e5f9d97f11c7a1665421034fb3","openshift-merge-robot","2021-06-21 12:55:35","true","Merge pull request #3325 from containers/dependabot/go_modules/github.com/containers/common-0.40.1

build(deps): bump github.com/containers/common from 0.40.0 to 0.40.1",36,53,1,1
"containers/buildah","aecbf3bbd46505a025fa5782f21ce85080827588","rhatdan","2021-03-13 11:41:15","false","Add documentation and testing for .containerignore

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",59,50,0,1
"containers/buildah","fde2597af81a023392d283d7461d020262b32715","rhatdan","2020-11-19 13:14:58","false","Add --ignorefile flag to use alternate .dockerignore flags

Allow users to override location of the .dockerignore file.
If user specified an --ignorefile flag, buildah will read the
file and pass in the exclude lines based on the .dockerignore
contents.

Also add a --contextdir flag to buildah copy and buildah add to
specify where the context directory is located.  For these two
commands the --ignorefile flag requires the --contextdir flag.

When the --ignorefile flag is passed in, the .dockerignore files
in the context directory will be ignored.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",75,46,0,1
"containers/buildah","858b00c9a0169f31bbd061952d009e34390a8960","rhatdan","2020-11-15 11:24:39","false","Fix testing error caused by simultanious merge

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",76,46,0,1
"containers/buildah","e8f92e09a1b84780a30b1f76ddac63d7a8041943","rhatdan","2020-10-31 09:58:59","false","(*Builder).Run: MkdirAll: handle EEXIST error

It is not entirely correct to always ignore EEXIST here. It should only
be ignored in one special case: when a working directory already exists,
and is an absolute symlink to another directory under container root.

MkdirAll reports an error because the symlink is broken in the host
context (without chroot).

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",66,45,0,1
"containers/buildah","3afba37c91f7d3c7711e8a3274b34eb361aba48a","TomSweeneyRedHat","2019-03-04 20:01:44","false","Update pull and pull-always flags

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Update the `--pull` and `--pull-always` options in the from and bud
commands to add clarity to their functionality.

Fixes #1381

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1382
Approved by: vrothberg",63,25,0,1
"containers/buildah","42b27b56b707775e94fcc58f6875bb3056625871","TomSweeneyRedHat","2018-04-11 14:03:49","false","Fix docker login issue in travis.yml

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #572
Approved by: nalind",31,14,0,1
"containers/buildah","f2ff8943d60609392d34ee756bb00e62d23d1a45","openshift-merge-robot","2023-02-16 19:48:13","true","Merge pull request #4439 from lsm5/fix-copr

[CI:BUILD] copr: fix el8 builds",18,73,1,1
"containers/buildah","18cd2d5f2e3fc1e137deae0c2605d072f5ed7573","openshift-merge-robot","2022-08-11 04:34:59","true","Merge pull request #4181 from nalind/scrub-usernames

Scrub user and group names from layer diffs",18,66,1,1
"containers/buildah","236c0bab10aba72ddc771270fa6f080b1850157a","ashley-cui","2022-05-27 02:47:30","false","Fix TODO: de-spaghettify run mounts

Code Cleanup: Buildkit run mount setup functions no longer have 13
arguments and are slightly more readable. Use structs instead.

[NO NEW TESTS NEEDED]

Signed-off-by: Ashley Cui <acui@redhat.com>",25,64,1,0
"containers/buildah","37eb992226fb64891d8b6d34125a923b44f53166","openshift-merge-robot","2022-03-22 10:44:26","true","Merge pull request #3831 from containers/dependabot/go_modules/tests/tools/github.com/golangci/golangci-lint-1.45.0

build(deps): bump github.com/golangci/golangci-lint from 1.44.2 to 1.45.0 in /tests/tools",31,62,1,1
"containers/buildah","717299f5b32f076d250ba9a73caec1046a5d3266","shanduur","2021-06-04 06:37:25","true","fix(docs): typo

Signed-off-by: Mateusz Urbanek <mateusz.urbanek.98@gmail.com>",36,52,1,0
"containers/buildah","27f6ef5eea20ccfdc1977ceef2b1916bdffbc853","openshift-merge-robot","2021-05-07 09:17:26","true","Merge pull request #3208 from containers/dependabot/go_modules/github.com/onsi/gomega-1.12.0

Bump github.com/onsi/gomega from 1.11.0 to 1.12.0",52,51,0,1
"containers/buildah","664629525c342985284b2b10837f38700d56d296","openshift-merge-robot","2021-04-12 10:17:22","true","Merge pull request #3135 from cevich/new_f34b_images

Cirrus: Update VMs w/ F34beta",52,51,0,1
"containers/buildah","044ea3470ecde122c53b628d615256fea27c9f84","openshift-merge-robot","2021-02-08 18:36:14","true","Merge pull request #2982 from containers/dependabot/go_modules/github.com/containers/storage-1.25.0

build(deps): bump github.com/containers/storage from 1.24.5 to 1.25.0",94,48,0,1
"containers/buildah","06d974b700548a1bd86f907e358703e67bdab92f","openshift-merge-robot","2021-02-24 14:35:22","true","Merge pull request #3004 from jmguzik/support-for-chmod-flag-add-and-copy

Chmod flag for add and copy",59,49,0,1
"containers/buildah","5643a7fa8ccdf477e6965c6c53a76f84d21b46d5","michalbiesek","2023-08-14 13:51:12","true","chroot: `setSeccomp` add support for `ArchPARISC(64)` and `ArchRISCV64`

Signed-off-by: Michal Biesek <michalbiesek@gmail.com>",9,79,1,0
"containers/buildah","14675d465395dabed125749c10223118d19b1408","openshift-merge-robot","2020-11-09 18:20:54","true","Merge pull request #2748 from rhatdan/uidmap

Verify userns-uid-map and userns-gid-map input",66,45,0,1
"containers/buildah","01f7a929ad93f998cc6c4151e10c1a0ecc2fdadb","openshift-merge-robot","2020-11-09 23:22:39","true","Merge pull request #2753 from rhatdan/entrypoint

Fix buildah config --cmd to handle array",66,45,0,1
"containers/buildah","455f2f11d9b810457bf37ed6e9581067d7ed5c9d","openshift-merge-robot","2021-09-28 21:18:26","true","Merge pull request #3525 from flouthoc/cleanup-run-directory-after-step

build: Cleanup transient mount destinations with every RUN step",38,56,1,1
"containers/buildah","ffbe0e40ae6ca28cc5a8e99b7889efbe73c2987e","openshift-merge-robot","2022-08-23 11:32:14","true","Merge pull request #4195 from flouthoc/config-retry-timeout

buildah: add support for `--retry` and `--retry-delay` incase of `push/pull` failures.",18,67,1,1
"containers/buildah","5d723ff5ab4e0306ee79ef4c67b15e81a81050f8","saschagrunert","2019-07-10 08:41:44","false","Add errcheck linter and fix missing error check

This commit enabled the errcheck linter and fixes an uncovered stat to
`os.DevNull`. Beside this, we disable go modules within the
`tests/tools/Makefile` to allow independent offline builds.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1713
Approved by: vrothberg",49,29,0,1
"containers/buildah","2088f6bd78896696ec5ae2960fb41f6cd9ba9867","cevich","2023-03-15 19:43:19","true","Fix requiring tests on Makefile changes

Changes to how things are built shouldn't trigger the
'pr-should-include-tests' check.

Signed-off-by: Chris Evich <cevich@redhat.com>",15,74,1,1
"containers/buildah","1096b876c8b7700c1948d2deeef3ed9cf5f201da","cevich","2021-07-02 14:39:53","true","Update cirrus-cron notification GH workflow

Simple update due to master->main rename.  The only functional change is
to only run the workflow on weekdays.  Nobody's around on the weekend to
respond anyway.

Signed-off-by: Chris Evich <cevich@redhat.com>",38,53,1,1
"containers/buildah","d43787be28684eefd7942908731f615bf89d2471","QiWang19","2019-04-06 16:03:58","false","add --dns* flags to buildah bud

use --dns* flags to change /etc/resolv.conf in the container during the build.
Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1491
Approved by: rhatdan",52,26,0,1
"containers/buildah","2eab6011f4bb3e71957204546d3a3e8b8c1d34d9","nalind","2020-10-20 19:16:31","false","Makefile: cross: remove windows.386 target

Remove bin/buildah.windows.386.exe as a cross-compile target.  Updating
components to fix the build for the darwin.amd64 target against newer
golang.org/x/sys breaks compilation of windows.386 (for now?).

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",63,45,0,1
"containers/buildah","5c98d3c22006ab14f16aee6b4c94c3666c8aa15b","nalind","2019-06-07 21:58:04","false","add: handle hard links when copying with .dockerignore

Detect files that are hard linked together, and use that information to
avoid copying their contents more often than we have to.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1789
Approved by: rhatdan",60,28,0,1
"containers/buildah","9560ff5b42645aa25b7fe0599e9c1f37138ec173","nalind","2021-09-09 18:11:50","false",".cirrus.yml: run cross_build_task on Big Sur

Update which version of Mac OS X we use for running the cross-compile
check in CI from Catalina (10.15) to Big Sur (11).

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",38,55,1,1
"containers/buildah","222e72aa750a6f06ae71830d37cfe9a0bd6d8170","nalind","2021-04-01 17:28:14","false","Put a few more minutes on the clock for the CI conformance test

Up the timeout for conformance tests by 5 minutes.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",52,50,0,1
"containers/buildah","53c3e6434dde103e0619a8c0ed3465acd3639a1c","nalind","2017-11-27 23:41:36","false","Bump RPM version to 0.8

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #340
Approved by: rhatdan",31,10,0,1
"containers/buildah","678dfb50a6d4458bc322da3258efca4f45d2586c","nalind","2020-01-17 15:44:47","false","Makefile: use a $(GO_TEST) macro, fix a typo

Use a $GO_TEST macro, which sets GO111MODULE=on like $GO_BUILD does, to
run tests from the Makefile.  Also, fix a typo.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #2104
Approved by: rhatdan",101,36,0,1
"containers/buildah","ab84d442616d59fbd5533953668f08c9aa117b50","lsm5","2020-12-09 19:44:29","false","update installation doc to reflect current status

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",78,46,0,1
"containers/buildah","1419fda897c5f059dba38264121fb62e0ae8adc6","openshift-merge-robot","2021-07-16 17:22:43","true","Merge pull request #3385 from cevich/generic_steps

[CI:DOCS] Multi-arch image workflow: Make steps generic",43,54,1,1
"containers/buildah","c5dea2e6828fe8da02f0360844db1ee0a902661c","openshift-merge-robot","2022-03-25 12:57:51","true","Merge pull request #3860 from giuseppe/drop-rhel-7

[CI:DOCS] install: drop RHEL/CentOS 7 doc",28,62,1,1
"containers/buildah","d33bb41ed268e929b9f5a223c109d7e3d8b48f6c","openshift-merge-robot","2020-10-21 13:40:02","true","Merge pull request #2708 from rhatdan/stdin

Buildah bud should not use stdin by default",64,45,0,1
"containers/buildah","92919284c27376f56d95200e2f5dd58afbc28007","openshift-merge-robot","2022-08-22 07:47:26","true","Merge pull request #4192 from flouthoc/cache-selinux-default

mount,cache: enable `SElinux` shared content label (`z`) option by default",18,67,1,1
"containers/buildah","f4de7b75f257a05c65b69f69aba23ed9703429b3","openshift-merge-robot","2021-10-14 16:57:55","true","Merge pull request #3588 from vrothberg/fix-deref

imagebuildah: fix nil deref",37,57,1,1
"containers/buildah","db8d5921a770e7536b34c56d062b47795b548d35","flouthoc","2022-08-01 18:09:57","false","release: tag v1.27.0

  * build: support filtering cache by duration using `--cache-ttl`.
  * build: support building from commit when using git repo as build context.
  * build: clean up git repos correctly when using subdirs.
  * build: add support for distributing cache to remote sources using `--cache-to` and `--cache-from`.
  * imagebuildah: optimize cache hits for `COPY` and `ADD` instructions.
  * build: support OCI hooks for ephemeral build containers.
  * build: add support for `--userns=auto`.
  * copier: add NoOverwriteNonDirDir option .
  * add initial support for building images using Buildah on FreeBSD.
  * multistage: this now skips the computing of unwanted stages to improve performance.
  * multiarch: support splitting build logs for `--platform` using `--logsplit`.
  * build: add support for building images where the base image has no history.
  * commit: allow disabling image history with `--omit-history`.
  * build: add support for renaming a device in rootless setups.
  * build: now supports additionalBuildContext in builds via the `--build-context` option.
  * build: `--output` produces artifacts even if the build container is not committed.
  * build: now accepts `-cpp-flag`, allowing users to pass in CPP flags when processing a Containerfile with C Preprocessor-like syntax.
  * build: now accepts a branch and a subdirectory when the build context is a git repository.
  * build: output now shows a progress bar while pushing and pulling images
  * build: now errors out if the path to Containerfile is a directory.
  * build: support building container images on environments that are rootless and without any valid login sessions.
  * fix: `--output` now generates artifacts even if the entire build is cached.
  * fix: `--output` generates artifacts only for the target stage in multi-stage builds.
  * fix,add: now fails on a bad HTTP response instead of writing to container
  * fix,squash: never use build cache when computing the last step of the last stage
  * fix,build,run: allow reusing secret more than once in different RUN steps
  * fix: compatibility with Docker build by making its --label and --annotate options set empty labels and annotations when given a name but no `=` or label value.

[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",18,66,1,1
"containers/buildah","e5c5760e87be6085ec510f2e6ce16b835191aca3","TomSweeneyRedHat","2021-04-13 22:08:07","false","Bump to v1.20.2-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",52,51,0,1
"containers/buildah","ce608bcecdeb077daab846c83b026c508cff9688","TomSweeneyRedHat","2022-02-16 17:01:15","false","Bump to v1.24.2

[NO TESTS NEEDED]

As the title says.

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",27,61,1,1
"containers/buildah","0dd5e78b6a18077419f075a1c4d1730eaf849602","TomSweeneyRedHat","2019-04-04 18:11:41","false","Make cleaner error on Dockerfile build errors

This is a fix for https://bugzilla.redhat.com/show_bug.cgi?id=1695622

If the build process had an error during the Dockerfile processing, the
error message was very verbose.  This change moves the original
message to be shown during a debug session and shortens the
errors to the heart of the problem.

Testing:
-------------------

```
OLD:
STEP 1: FROM alpine
STEP 2: ADD reallybadfile /tmp
error building at step {Env:[PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin] Command:add Args:[reallybadfile /tmp] Flags:[] Attrs:map[] Message:ADD reallybadfile /tmp Original:ADD reallybadfile /tmp}: no files found matching ""/root/tsweeney/workspaces/buildah/src/github.com/containers/buildah/reallybadfile"": no such file or directory
[root@localhost buildah]# pwd
/root/tsweeney/workspaces/buildah/src/github.com/containers/buildah

NEW:
STEP 1: FROM alpine
STEP 2: ADD reallybadfile /tmp
error building at STEP ""ADD reallybadfile /tmp"": no files found matching ""/root/tsweeney/workspaces/buildah/src/github.com/containers/buildah/reallybadfile"": no such file or directory

STEP 2: ADD reallybadfile /tmp
DEBU[0000] ADD []string(nil), imagebuilder.Copy{FromFS:false, From:"""", Src:[]string{""reallybadfile""}, Dest:""/tmp"", Download:true, Chown:""""}
DEBU[0000] error building at step {Env:[PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin] Command:add Args:[reallybadfile /tmp] Flags:[] Attrs:map[] Message:ADD reallybadfile /tmp Original:ADD reallybadfile /tmp}: no files found matching ""/root/tsweeney/workspaces/buildah/src/github.com/containers/buildah/reallybadfile"": no such file or directory
error building at STEP ""ADD reallybadfile /tmp"": no files found matching ""/root/tsweeney/workspaces/buildah/src/github.com/containers/buildah/reallybadfile"": no such file or directory

```
Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1482
Approved by: rhatdan",52,26,0,1
"containers/buildah","66ff1dd00694215ba0b144baeb3115323e619779","TomSweeneyRedHat","2019-01-16 14:17:20","false","Fix contrib/rpm/bulidah.spec changelog date

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1283
Approved by: rhatdan",51,24,0,1
"containers/buildah","c8844f060e31f093204ffc0f70387f05b4c28975","mtrmac","2018-06-11 22:08:57","false","Explicitly handle ""from scratch"" images in Builder.initConfig

... instead of silently ignoring failures to parse the manifest.

This does not change behavior, but it clearly delineates the
existing/scratch cases, and that which will allow us to better
handle errors in the future.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #776
Approved by: rhatdan",33,16,0,1
"containers/buildah","f795888c56cd7bca2f61c5dccef0695ad7e49526","jayaddison","2021-10-10 16:26:45","false","docs: update buildah-from, buildah-pull 'platform' option compatibility notes

Signed-off-by: James Addison <jay@jp-hosting.net>",40,56,1,0
"containers/buildah","674aa1feea876847090442e108835b6c327756c3","rhatdan","2023-01-18 13:39:13","true","Merge pull request #4516 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.9.2

build(deps): bump github.com/fsouza/go-dockerclient from 1.9.0 to 1.9.2",21,72,1,1
"containers/buildah","03686e522727fe86aeb5ad7acf605e64c26a98b5","rhatdan","2018-06-01 18:52:16","false","Give better messages to users when image can not be found

Had to vendor latest containers/image to get path to /etc/containers/registries.conf

Currently if /etc/containers/registries.conf does not exist, you can not pull i
images and the error message tells you bad information.

 buildah from alpine
Get https://localhost/v2/: dial tcp [::1]:443: connect: connection refused

With this change

./buildah from alpine
image ""alpine"" not found in /etc/containers/registries.conf registries: image not known

Even if the registry.conf file exists, the error message does not tell you much useful.

buildah from alpine1
Error determining manifest MIME type for docker://registry.access.redhat.com/alpine1:latest: Error reading manifest latest in registry.access.redhat.com/alpine1: unknown: Not Found

As opposed to the following, which will at least give the admin a chance to
figure out where he wants to add registries.
./buildah from alpine1
image ""alpine1"" not found in /etc/containers/registries.conf registries: image not known

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #743
Approved by: rhatdan",38,16,0,1
"containers/buildah","ca84f0ce3892aafce142c2753377663236cc8f70","rhatdan","2020-03-30 14:54:42","false","Bump github.com/containers/storage from 1.16.5 to 1.17.0

Bumps [github.com/containers/storage](https://github.com/containers/storage) from 1.16.5 to 1.17.0.
- [Release notes](https://github.com/containers/storage/releases)
- [Changelog](https://github.com/containers/storage/blob/master/docs/containers-storage-changes.md)
- [Commits](https://github.com/containers/storage/compare/v1.16.5...v1.17.0)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",111,38,0,1
"containers/buildah","123493895ffc7f22a683aee93ed0823194cf987f","rhatdan","2017-12-26 12:18:41","true","Merge pull request #370 from rhatdan/master

Bump to version 0.10",32,11,0,1
"containers/buildah","ebb0d8eeb3d4d9fe9fb5308bb10a580127524714","umohnani8","2018-05-29 14:41:01","false","Validate common bud and from flags

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #731
Approved by: rhatdan",43,16,0,1
"containers/buildah","4d155b93b47e4fde6977229f0ea872a4afcbc34f","nalind","2017-04-10 18:25:07","false","imagebuildah: add AdditionalTags

Add an AdditionalTags field to the imagebuildah options structure, to
provide for additional tags which we'll want to apply to the image that
we're writing.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #88
Approved by: rhatdan",13,2,0,1
"containers/buildah","610eb7a0b2d4d8dbbc9e5c694d3a448a4636e7b8","nalind","2019-03-20 17:06:29","false","commit: make target image names optional

Make the name of the image to create an optional parameter.  If none is
specified, use a temporary mostly-random name that can't be interpreted
as an ID, so that the image copying logic will compute the correct ID to
assign to the new image, and remove the temporary name before returning.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1486
Approved by: rhatdan",36,26,0,1
"containers/buildah","5f5fcf8fd44accee753449ba4685cd6ead6b1c64","nalind","2018-05-09 13:57:49","false","Update github.com/containers/storage

Update github.com/containers/storage to version
f382d39d7a6caa855bb1f6243967b630d7389781.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #704
Approved by: rhatdan",53,15,0,1
"containers/buildah","d2e102d910225db2ab9f2588a3c546952a6ac163","nalind","2017-04-27 17:51:11","false","Bump github.com/docker/distribution

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #87
Approved by: nalind",9,3,0,1
"containers/buildah","0f7f7a1a9d3558a385eeab3213c34fcf9db14bd9","QiWang19","2019-06-28 20:07:38","false","import method ValidateVolumeOpts from libpod

move ValidateVolumeOpts from libpod to buildah so libpod can vendor it in.

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1698
Approved by: rhatdan",43,29,0,1
"containers/buildah","4a74ca7d2ba9eac48156a78740f4d5d598dc80d8","edsantiago","2021-04-20 21:55:25","false","push to docker test: don't get fooled by podman

Gating tests have failed (at least) twice already because
one of the push.bats tests runs ""which docker"" and skips
if it's missing. Sadly, some gating-test systems install
podman-docker (possibly when there's a bodhi that combines
podman and buildah). This causes the test to fail.

Solution: confirm that if docker exists, it isn't podman
in disguise. Since we need to do a similar check in
the pull-from-docker-daemon test in pull.bats, refactor
that into a common skip_if_no_docker helper.

Signed-off-by: Ed Santiago <santiago@redhat.com>",49,51,0,1
"containers/buildah","027cd7d18ff04ad6f0f081ff9d235f5caefc4a2a","openshift-merge-robot","2023-08-31 10:42:01","true","Merge pull request #5016 from vrothberg/vendor-common

vendor containers/common@12405381ff45",8,79,1,1
"containers/buildah","2a1af042de29c053a53b102cdbb8c5bc037e8d3e","openshift-merge-robot","2022-04-06 13:13:04","true","Merge pull request #3901 from Luap99/build-args

buildah build should accept at most one arg",25,62,1,1
"containers/buildah","5500333c2e06ab2cf02900bda69a9b07ce76da3d","openshift-merge-robot","2022-05-24 18:48:33","true","Merge pull request #4013 from flouthoc/fix-layers-and-swap

squash, layers: never use build cache when computing last step of last stage",25,64,1,1
"containers/buildah","5de65a079bff410700f55c25c613597e9caad7a7","openshift-merge-robot","2022-08-29 10:45:58","true","Merge pull request #4206 from containers/dependabot/go_modules/github.com/onsi/gomega-1.20.1

build(deps): bump github.com/onsi/gomega from 1.20.0 to 1.20.1",16,67,1,1
"containers/buildah","3ddb98811a09b1d3dee48fcd27235cd9b827931c","openshift-merge-robot","2021-09-17 11:13:50","true","Merge pull request #3522 from rhatdan/main

[CI:DOCS] Add flouthoc to OWNERS",39,56,1,1
"containers/buildah","dc7625a8075807fca76107174a0f50e8569d718a","openshift-merge-robot","2021-11-24 13:39:03","true","Merge pull request #3647 from containers/dependabot/go_modules/github.com/containernetworking/cni-1.0.1

build(deps): bump github.com/containernetworking/cni from 0.8.1 to 1.0.1",29,58,1,1
"containers/buildah","ac30ed23d61e795730a66aaf3836d4b2430a7145","flouthoc","2022-09-12 10:51:17","true","parse: make processing flags in --mount order agnostic

Flags processing in `--mount` must not be hardcode to expect first field to
be `type` instead it should be order agnostic.

Closes: https://github.com/containers/podman/issues/15748

Signed-off-by: Aditya R <arajan@redhat.com>",22,67,1,1
"containers/buildah","39f4cfb79d9ea4d462b97ee73babca973d756cb5","rhatdan","2020-10-15 09:16:50","false","Stop excessive wrapping

Golang built in functions like os.Create and others print the name of
the file system object when they fail.  Wrapping them a second time
with the file system object, makes the error message look like crap
when reported to the user.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",61,45,0,1
"containers/buildah","533bf95d1ed4e9b90289ae6521ba1fda8597fd71","nalind","2020-09-23 14:17:38","false","chroot: create bind mount targets 0755 instead of 0700

Create the target mountpoints for bind mounts, when they don't already
exist, with 0755 permissions, for better consistency with runc.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",90,44,0,1
"containers/buildah","09138e29bcd0cc0521fcd99534903ba6116ce385","eigengrau","2020-08-16 09:37:22","false","imagebuildah: don’t blank out destination names when COPYing

When ADDing an archive file, the destination file-name is blanked out to ensure
that archive contents are extracted in-place. However, when COPYing an
archive-file, we don’t want to blank out the destination filename.

Fixes: #2549

Signed-off-by: Sebastian Reuße <seb@wirrsal.net>",88,43,0,0
"containers/buildah","b658fb793ce5963172d0ef0d1b57819ea0ba99e2","ypu","2019-10-29 06:37:00","false","Tests: Add test cases for push test

Add following test cases for push:
  - buildah push image to containers-storage
  - buildah push image to docker-archive and oci-archive
  - buildah push image to docker and docker registry

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #2004
Approved by: rhatdan",80,33,0,0
"containers/buildah","0693b164cb77dae7a8412e4444c4a96b20977da3","edsantiago","2020-08-11 20:46:36","false","Avoid feeding run_buildah to pipe

The usage 'run_buildah ... | grep' (or pipe whatever) works,
but it's a super bad pattern. Replace all instances of it
with a one-two of 'run_buildah' and 'expect_output'. Some
of these needed a little minor massaging.

Also: 'run_buildah ... || true' -> 'run_buildah 125 ...'.
I don't review all buildah PRs, so this one slipped by me.

Also: clean up trailing whitespace

Digression: why is 'run_buildah | grep' bad? Because:
  - it is inaccurate. run_buildah does 'echo $output',
    but it also emits other output (the buildah command
    itself, and possible expected-status mismatch).
    It is possible that a pipe-grep could trigger
    on one of these.
  - the reason run_buildah emits these things is so
    a human can look at debug output on failure and
    recognize what command was run, what the output
    was. If we pipe-grep, we lose that.
  - it is possible that a pipe-grep will mask
    a failing run_buildah (I'm not sure about this)
  - expect_output is more precise anyway, hence
    makes a better test.

Signed-off-by: Ed Santiago <santiago@redhat.com>",86,42,0,1
"containers/buildah","2f671a26b2b0b062b5352561e3d7858ebe9a81db","rhatdan","2020-04-16 13:48:43","false","Return exit code from failed containers

Buildah run was exiting with the correct exit code, when a container
failed.  Buildah bud was not, so this should fix this.

Also switched to the proper exit codes when containers fail.  When
Buildah fails to execute it will exit with a 125 exit code like
Podman does.  If a command fails to execute inside of a container
we will exit with a 126. Currently we do not support the 127 for
exiting when the command does not exist.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",122,39,0,1
"containers/buildah","75116bbb7088829d006762936439460845fc7713","carbonin","2020-03-26 00:40:09","false","Update github.com/openshift/imagebuilder to v1.1.4

Signed-off-by: Nick Carboni <ncarboni@redhat.com>",112,38,0,0
"containers/buildah","f0507a5d3aa64db800c1e0f08b379a48fdbd8448","rhatdan","2020-03-25 21:12:48","false","Fix fips-mode check for RHEL8 boxes

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",113,38,0,1
"containers/buildah","5dd1783e051550e762de935e72e2ab02b4d36c31","rhatdan","2020-03-18 20:45:26","false","vendor in containers/common v0.6.1

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",109,38,0,1
"containers/buildah","0ccc4c9ad5d217bac2bfd0c7bfd897acf14c0ca9","rhatdan","2020-02-06 20:55:00","true","Merge pull request #2139 from rhatdan/close

Close tarSource when finished using it",110,36,0,1
"containers/buildah","a15a927d8d1bdb8303d711fb050f084bec93a312","nalind","2017-01-28 07:18:02","false","Compress committed image layers by default

When committing an image, default to compressing the layer using Gzip.
This can lead to problems pulling the image back out of
containers/storage if the package that pulls it out was built using a
different version of go, but it works around a problem where
containers/image might not be able to detect that an uncompressed layer
is actually a layer.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","8e0fc35541500b812b711242a31f3fcf395d658f","nalind","2018-05-04 14:21:34","false","copy.bats: check ownerships in the container

When testing the --chown flag, expect ownership of content that we copy
in while specifying an owner to match the IDs of that owner as the
container knows them.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",50,15,0,1
"containers/buildah","7a691eb1e5b3eb0a598b3b52ab355113a85d68fe","aaerrolla","2023-08-07 03:55:18","true","Merge branch 'main' into main",11,78,1,0
"containers/buildah","fdf344c6515156935417e32369244c4d1eed88e9","mheon","2021-06-22 19:55:00","false","Add support for default network creation

As part of the podman-machine work, we need to stop distributing
the default CNI configuration that has traditionally been
supplied by Podman, 87-podman.conflist. Buildah (as root) also
uses this file, and will be unable to set up container networking
without it.

The replacement we've introduced is the ability to automatically
create said configuration file using a package in
containers/common. This has already been added to Podman, and
this PR adds it to Buildah.

[NO TESTS NEEDED] as there's no real easy way to verify that
Buildah made the network - no explicit command for listing
networks.

Signed-off-by: Matthew Heon <matthew.heon@pm.me>",37,53,1,1
"containers/buildah","ec9db747d96c33c823463df1b852d1907f1fcbaa","rhatdan","2017-11-08 00:40:04","true","Merge pull request #316 from rhatdan/selinux

Add secrets patch to buildah",30,9,0,1
"containers/buildah","b835631bf4ea26f121a26ec95c737beb3a7fbcfe","rhatdan","2023-06-29 20:13:08","false","Update vendor of containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",13,77,1,1
"containers/buildah","aa5b867a6e1b2f1b64f22f7fe83cb3329eb6b048","rhatdan","2018-10-01 21:58:27","true","Merge pull request #1050 from TomSweeneyRedHat/dev/tsweeney/docfixes

Add buildah.io to README.md and doc fixes",42,20,0,1
"containers/buildah","9a4425427583fb70031e4b69bea7a81a8cbdbacc","rhatdan","2018-08-24 10:51:36","false","Cleanup code to more closely match Docker Build images

Hostname should be set to a random name if not set.
Workdir should default to """" not to ""/""
If Volumes and Entrypoint are not set they should return NULL not []

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #958
Approved by: TomSweeneyRedHat",31,19,0,1
"containers/buildah","7ae362bcedfed09eb5c644a94696fe59e16126dd","rhatdan","2019-05-10 16:39:27","false","Vendor in latest containers/storage and containers/image

Container image also switched out the version of bolddb
we were uisng.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1586
Approved by: vrothberg",58,27,0,1
"containers/buildah","0fcc8ff8f50a62e56cfb3c36c9680895ea221db5","rhatdan","2021-01-15 01:38:21","false","If destination does not exists, do not throw error

When using volume mounts, the destination directory will get
created if it does not exists. The current code blows up when
the destination directory did not exists.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",93,47,0,1
"containers/buildah","4704e6cb3f8537d128d4e945547b992286dac937","rhatdan","2021-02-06 22:49:40","false","Eliminate the use of containers/building import in pkg subdirs

We want to shrink the size of the import when importing pkg from
buildah. This should help us shrink the size of the golang bindings
in podman.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",92,48,0,1
"containers/buildah","135542ecf045c2ad83789be659d3396afb2860b5","rhatdan","2019-04-18 12:44:00","false","Move Host IDMAppings code from util to unshare

This will make vendoring in pkg/unshare easier into other
packages like skopeo.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1532
Approved by: TomSweeneyRedHat",52,27,0,1
"containers/buildah","df1fb74ff00fa08dd9e864b4a2c7ca324cd3e7c1","rhatdan","2023-06-05 20:06:52","true","Merge pull request #4836 from nalind/debug-capabilities

At startup, log the effective capabilities for debugging",16,76,1,1
"containers/buildah","5feccafd34ca2e78eec807f3e6985ede881c4377","rhatdan","2018-08-01 18:35:10","false","Add additional SELinux tests

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #897
Approved by: ripcurld",30,18,0,1
"containers/buildah","9049b6108cc52069517862f68aee87f560abcf16","nalind","2017-05-22 16:08:20","false","Test writing while selecting metadata formats

Add a test helper for examining image metadata and checking their types,
and add tests that use it to verify that after writing either Docker v2
or OCI v1 images, that the manifest and configuration blobs that we
stored for them successfully decode as the correct data types.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #118
Approved by: rhatdan",15,4,0,1
"containers/buildah","73bfd79ef6e6dfe26910a7a3eb0c7ce1419fb1e9","nalind","2018-05-31 14:56:40","false","Run(): process RunOptions.Mounts, and its flags

RunOptions.Mounts has been mistakenly ignored since #700; handle them.

Process the options on the bind mounts in RunOptions.Mounts the same way
we handle the ones in Builder.CommonBuildOpts.Volumes, so that flags
that control read-only/read-write usage, SELinux labeling, and mount
propagation will work.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #739
Approved by: rhatdan",42,16,0,1
"containers/buildah","973bb88ef1861a5b782c722c471dd79b6732852c","rhatdan","2019-02-01 15:29:45","false","Move tar commands into containers/storage

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1298
Approved by: TomSweeneyRedHat",56,24,0,1
"containers/buildah","ab9547f1ebf8a1762947eb09bc543577c2f8543e","boaz0","2018-09-09 14:44:05","false","Add flags/arguments order verification to other commands

This is the third part of adding flags/args order verficiation.
In this part I am adding it to command lines that take no
arguments or more than 1 arguments such as buildah-images.

Added tests too to verify it works correctly.

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>

Closes: #1002
Approved by: rhatdan",36,19,0,0
"containers/buildah","b8a8a01c6cfddc61402debfddf2ea00b92ca9f1e","TomSweeneyRedHat","2020-01-29 19:06:34","false","Bump to v1.13.2

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2122
Approved by: rhatdan",107,36,0,1
"containers/buildah","cc9f15f09f6ad036ec1057646765f7007101650b","flouthoc","2023-08-28 07:56:05","true","docs: add reference to oci-hooks

Closes: https://github.com/containers/buildah/issues/4987

Signed-off-by: Aditya R <arajan@redhat.com>",8,79,1,1
"containers/buildah","d27a82356852e960df6c9d75d3c38dee734c50d8","flouthoc","2023-07-27 16:47:28","true","manifest/inspect: add support for tls-verify and authfile

Add flags for `manifest inspect` i.e `--tls-verify` and `--authfile`

Signed-off-by: Aditya R <arajan@redhat.com>",14,78,1,1
"containers/buildah","3b7f0a19c41ae20302f7579140678bfc9af4bc37","saschagrunert","2019-12-04 09:25:43","false","Vendor containers/storage v1.15.1

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1998
Approved by: rhatdan",85,34,0,1
"containers/buildah","61f53195041db2fba5f636905e033f085216f6c7","bertinatto","2018-01-12 10:54:30","false","Don't overwrite directory permissions on --chown

Signed-off-by: Fabio Bertinatto <fbertina@redhat.com>

Closes: #389
Approved by: rhatdan",30,11,0,0
"containers/buildah","e84247b54394d36f7233fd92dfae3855aef8c842","NotBobTheBuilder","2023-03-28 14:57:31","true","Merge branch 'main' into build-arg-file",13,74,1,0
"containers/buildah","67a65970e85ba5c2aa58b0bd24e8ce4f2440498a","openshift-merge-robot","2022-10-26 16:38:01","true","Merge pull request #4377 from edsantiago/safeimage

Define and use a safe, reliable test image",26,69,1,1
"containers/buildah","aad501512e5d9d818cb63e1f1693f3cc2ecaa319","openshift-merge-robot","2022-04-01 19:25:37","true","Merge pull request #3883 from turrisxyz/naveen/feat/set-perms-actions

[CI:DOCS] Set permissions for GitHub actions",27,62,1,1
"containers/buildah","b8757e98cbecff53b0379a1753a6707d0d52c615","openshift-merge-robot","2021-09-22 00:08:59","true","Merge pull request #3528 from containers/dependabot/go_modules/github.com/containers/common-0.44.1

build(deps): bump github.com/containers/common from 0.44.0 to 0.44.1",39,56,1,1
"containers/buildah","b00ab350a73970e315d9ab05f3e9877d6bd20abf","vrothberg","2019-02-21 10:11:38","false","install.md: add section about vendoring

Add a section about how we do vendoring and to troubleshoot related
issues.  Note that the text is a verbatim copy from libpod's
install.md.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1354
Approved by: rhatdan",59,25,0,1
"containers/buildah","9879c18473dce041487192e0bee1b2569c7af6f1","navidys","2022-04-23 08:30:08","false","using consistent lowercase 'invalid' word in returned err msg

Signed-off-by: Navid Yaghoobi <n.yaghoobi.s@gmail.com>",25,63,1,0
"containers/buildah","6c4bef7f2e17432d4dc4065299cec08754ca5863","umohnani8","2018-06-08 16:55:46","false","Add --layers and --no-cache to buildah bud

This patch adds in the caching feature to buildah bud.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #784
Approved by: rhatdan",32,16,0,1
"containers/buildah","4ecb129f896601edfc62448d7c52d9521fd1cd57","cevich","2019-08-09 15:05:14","true","Cirrus: Update VM images

These were produced as an intended byproduct of:
https://github.com/containers/libpod/pull/3754

Where 'systemd_banish.sh' was run during base-image production.
Therefor, during run-time there should no longer be interference
of testing by background/periodic processes.

Signed-off-by: Chris Evich <cevich@redhat.com>",51,30,0,1
"containers/buildah","430f3dc0b418e8cb6fdd31885c981967a607ebc7","mtrmac","2019-02-21 23:01:08","false","CHANGES BEHAVIOR: Remove the string format input to localImageNameForReference

It should always be redundant with the reference itself; so,
use srcRef.StringWithinTransport() in the cases where we do
need to understand and hard-code the string syntax, after all.

Also improve the oci: format parsing a bit, to be robust
against including an image name.

NOTE: This might change the semantics a bit because StringWithinTransport
does not guarantee preserving the original string (e.g. paths
tend to be normalized not to contain symlinks).  Using local paths
as docker/distribution image names is conceptually so problematic
that this seems worth the code cleanup - but I might be wrong.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","0e7b6bd29d4d183fc9cd59fcfac8be97e7210a0e","saschagrunert","2019-08-13 07:26:09","false","Update documentation about bud

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1788
Approved by: rhatdan",52,30,0,1
"containers/buildah","07aaf5ed8e8f2d15ddd302c71b8d3a58dbc4703e","TomSweeneyRedHat","2019-06-18 22:05:10","false","Add bud test for RUN with a priv'd command

In Buildah v1.8.4 we had an error that occured when a
RUN command in a Dockerfile did a privileged command
such as yum, dnf, apk, etc. This test will cover the
scenario reported in #1679

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1682
Approved by: rhatdan",45,29,0,1
"containers/buildah","a5b553432d5e1ff211d99a0e8bebea17b57bf17b","TomSweeneyRedHat","2021-10-08 00:05:43","false","[CI:DOCS] Touch up Containerfile man page to show ARG can be 1st

The Containerfile man page says FROM must be the first statement
in the file.  However, that is not true as the ARG instruction can proceed it.

Addresses: #3555

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",42,56,1,1
"containers/buildah","3bdbcdf6488771d8cd080a38904111c95f52990e","TomSweeneyRedHat","2018-08-13 14:18:04","false","Handle COPY --chown in Dockerfile

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #925
Approved by: rhatdan",23,19,0,1
"containers/buildah","05cb1aef13a1f75bb342189d5ba2c8ef4c4d90f7","rhatdan","2018-07-14 10:03:15","false","Bump to v1.2

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #862
Approved by: rhatdan",32,18,0,1
"containers/buildah","6e36119844bc1b3c0481ebf70706b9ad0d6c83db","rhatdan","2022-04-12 10:35:44","false","Update vendor of storage,common,image

Preparing for release update vendoring.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",24,63,1,1
"containers/buildah","4d87007327f1500b76aaf0be621a51bb45f61f66","rhatdan","2017-11-02 17:40:05","true","Merge pull request #307 from ipbabble/tutorial-fix

Made some edits based on tsweeney feedback.",30,9,0,1
"containers/buildah","320e67f1f8063b73353403b6bfbaf0c3495b8593","rhatdan","2019-10-30 17:07:55","false","Bump github.com/onsi/ginkgo from 1.10.1 to 1.10.2

Bumps [github.com/onsi/ginkgo](https://github.com/onsi/ginkgo) from 1.10.1 to 1.10.2.
- [Release notes](https://github.com/onsi/ginkgo/releases)
- [Changelog](https://github.com/onsi/ginkgo/blob/master/CHANGELOG.md)
- [Commits](https://github.com/onsi/ginkgo/compare/v1.10.1...v1.10.2)

Add support for make vendor-in-container

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",82,33,0,1
"containers/buildah","8c3d8b1e45b0d628c2c48bc6b6bc493dae3b684a","rhatdan","2019-02-21 20:13:10","false","Stop printing default twice in cli --help

Currently we are printing two defaults.  This change will
let the flags package print out the defaults.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1358
Approved by: TomSweeneyRedHat",59,25,0,1
"containers/buildah","7919c96a69f1519da73c581224fdcdb425a63471","rhatdan","2018-06-27 09:52:56","true","Merge pull request #828 from baude/vendorruntimetools

vendor in latest runtime-tools",28,17,0,1
"containers/buildah","c3c6cb2cbd2d251088262dfdd158a7718d225657","nalind","2018-04-27 15:22:13","false","'buildah config': stop replacing Created-By whenever it's not specified

The CLI shouldn't have had a default here, which made us treat it as if
it had been specified every time, potentially overwriting a value that
had previously been explicitly set.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #641
Approved by: rhatdan",51,15,0,1
"containers/buildah","04ce6f39c453bdb4a50ed63124e4c41b57ca89e3","nalind","2017-04-11 14:27:05","false","imagebuildah: Reexport some things

Have imagebuildah reexport some constants and its own Mount type, to
reduce the number of our dependencies that a prospective consumer of
this package would also need to import directly.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #84
Approved by: rhatdan",13,2,0,1
"containers/buildah","63808f9ad674425c7892a12cab987aabb0f6a81c","nalind","2019-05-15 18:51:19","false","imagebuildah: tighten cache checking back up

Since we started adding layers for only certain instructions, history
matching for cached images hasn't been precise enough.  Since we now
include a full image history, though, we can compare a candidate cache
image's history with our base image's exactly, and then check if the
current instruction would produce its final history entry.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1593
Approved by: rhatdan",56,28,0,1
"containers/buildah","06b9328c0cb9a1815a8b66e9a6658b5d90eafd33","nalind","2019-05-28 23:07:03","false","bud.bats: test COPY with a final ""/"" in the destination

Add a test to ensure that COPY instructions that use a final ""/"" in the
destination location make sure that the destination is a directory.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1620
Approved by: TomSweeneyRedHat",57,28,0,1
"containers/buildah","a2bd274d11e1953af8310b250c1fbe3c1d3133e0","nalind","2017-06-26 13:55:59","false","imgtype: add debugging, reexec, an optimization

In the imgtype test helper, add a -debug flag, correctly handle things
on the off chance that we need to call a reexec handler, and read the
manifest using the Manifest() method of an image that we're already
opening, rather than creating a source image just so that we can call
its GetManifest() method.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #162
Approved by: rhatdan",17,5,0,1
"containers/buildah","318beaa7205b58e8e61803b0f0d2b3bf21462ca5","nalind","2017-11-09 16:26:15","false","integration tests: default to /var/tmp

Default to running integration tests using /var/tmp as scratch space,
since it's more likely to support proper SELinux labeling than /tmp,
which is more likely to be on a tmpfs.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #320
Approved by: nalind",30,9,0,1
"containers/buildah","ec4d02512da245fe3390285ed4c9cae72da2c0b9","mtrmac","2018-06-11 21:34:36","false","Simplify dead but dangerous-looking error handling

Drop error returns from makeDockerV2S2Image and makeOCIv1Image, they
are always nil.  Then drop the code which ""handles"" the errors
by silently ignoring them.

Right now that does not matter, but if make*Image ever did start
returning errors, the existing caller would silently ignore them
and record useless empty data.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #776
Approved by: rhatdan",32,16,0,1
"containers/buildah","26d2444d9f0b721ac4ca04e28976b647098bf0d3","rhatdan","2020-09-15 18:53:14","false","Improve buildah completions

Watching users playing with buildah, they were disappointed in some of
the command completions that were missing. I have added the ones that they
were looking for plus a few more.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",91,44,0,1
"containers/buildah","cf34522a2e804803b05dbcfd377e7678e2c04bfb","rhatdan","2019-12-23 15:25:34","false","Update container/storage to v1.15.4

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #2043
Approved by: TomSweeneyRedHat",93,35,0,1
"containers/buildah","fcc12bdadf6a5fab77e62e1bd12663bb6fbc3eda","rhatdan","2019-04-06 08:47:02","false","Bump to Replace golang 1.10 with 1.12

Vendor in containers/storage v1.12.2

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1384
Approved by: vrothberg",52,26,0,1
"containers/buildah","33c2a8a418579db3e59a66bb925eaf627fa74623","rhatdan","2017-06-05 13:42:30","false","gccgo is giving errors about using copy

golang-bin-1.8.1-1.fc26.x86_64
gcc-go-7.1.1-1.fc26.x86_64

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #135
Approved by: nalind",12,4,0,1
"containers/buildah","8d3ee96abcf3174144b58bcabd9565a3aafdfc18","rhatdan","2018-09-18 13:36:12","false","Builtin volumes should be owned by the UID/GID of the container

When creating a building VOLUME for a container we need to create it
with the ownership/permsissions of the directory that we will be mounting on.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",37,20,0,1
"containers/buildah","7af6ab235161994ca8a44a096b781352936a22e2","rhatdan","2017-06-28 15:04:35","false","Add the missing buildah version from the readme and the buildah man page

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #173
Approved by: rhatdan",20,5,0,1
"containers/buildah","043b1a45aaf04a94d6d76a383a973665df2cc60d","saschagrunert","2019-07-18 08:30:42","true","Fix CNI version retrieval to not require network connection

The `go list -m` requires a network connection which will not work on
build systems without access to the internet. We now extract the version
directly from `go.mod`, which should be valid for any case.

The same approach will now be used for the RUNC_COMMIT retrieval.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>",48,30,0,1
"containers/buildah","93d8b9f1c51d6d5799acc2aa4b9fc00827d4fc57","TomSweeneyRedHat","2018-11-28 16:39:44","false","Add v1.5 Release Announcement

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1205
Approved by: rhatdan",42,22,0,1
"containers/buildah","e9184eaac6615cd3c20ed5bbdc44e12c2d5f5f56","danmack","2019-05-03 17:39:09","false","Correct manpage formatting in files section

Signed-off-by: Dan Mack <mack@macktronics.com>

Closes: #1575
Approved by: TomSweeneyRedHat",53,27,0,0
"containers/buildah","3ec6a6bd92fba9cdc999a40fa167633176a8222a","TomSweeneyRedHat","2019-01-16 00:00:27","false","Bump to v1.6

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1281
Approved by: rhatdan",52,24,0,1
"containers/buildah","8195db90c1aef6b9b2a498c261b7f5636adaff8e","cevich","2022-01-12 16:32:48","true","Cirrus: Re-order tasks for more parallelism

Execute all tasks in three dependent, parallel groups

1. Meta + smoke + vendor + cross
2. Unit + int. + containerized-int. + conformance
3. Success

Signed-off-by: Chris Evich <cevich@redhat.com>",29,59,1,1
"containers/buildah","de31778eec8c80dc0ee7665fceae1a45718ed092","TomSweeneyRedHat","2019-12-13 16:42:33","false","Bump to v1.13.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",88,34,0,1
"containers/buildah","95f16ab2604fcb5fdb47272190a5964df64eeb97","TomSweeneyRedHat","2018-02-17 19:23:06","false","Remove you/your from manpages

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #484
Approved by: rhatdan",19,13,0,1
"containers/buildah","eed3aa20c96ec62514758d0e3e5658ae08b451e3","rhatdan","2023-03-09 16:06:14","true","Merge pull request #4645 from mathiasgredal/ifnewer-pull-command

Add ""ifnewer"" as option in help message for pull command",16,73,1,1
"containers/buildah","b1c6243f8a660841d5254b4c19aeb4617afa8b25","rhatdan","2017-06-29 12:27:09","false","Need \n for Printing untagged message

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #176
Approved by: rhatdan",15,5,0,1
"containers/buildah","e2025771727311e42020ef8d6e8b120a599386c6","nalind","2017-03-23 17:50:51","false","Make Run() commands share the host's network

Make commands we run in Run() use the host's networking.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #34
Approved by: rhatdan",12,2,0,1
"containers/buildah","5a011dbe5ffddc1995df4d2966823a2d17bf774d","nalind","2018-10-31 13:09:05","false","run: only set up /etc/hosts or /etc/resolv.conf with network

Only set up bind mounts of copies of the host's /etc/hosts and
/etc/resolv.conf files if we're not just going to create a new,
unconfigured network namespace.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1146
Approved by: rhatdan",57,21,0,1
"containers/buildah","cfe911a3f0bf7f5ca084fdf823cdd7d02d50d7cd","rhatdan","2021-06-23 14:44:11","false","Change references from master to main

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",37,53,1,1
"containers/buildah","b15f7a43cc57ffda88e06d357544e1d119de9bc5","openshift-merge-robot","2022-03-01 20:04:39","true","Merge pull request #3800 from nalind/abscontext

add: ensure the context directory is an absolute path",30,61,1,1
"containers/buildah","1065fd2bf0b4e665037de13807e825a5b16739d3","openshift-merge-robot","2021-04-27 14:56:46","true","Merge pull request #3173 from hshiina/bud-namespace

Test namespace flags of 'bud' subcommand",49,51,0,1
"containers/buildah","c3b7dcb8482bc226a8a3accf9e113238f91cfa93","openshift-merge-robot","2023-05-30 17:58:12","true","Merge pull request #4823 from rijenkii/main

Add a warning to `build --secret` docs",16,76,1,1
"containers/buildah","800a3ed799f2a4c31c595ef4ea4b2d5980e83ba6","openshift-merge-robot","2021-02-08 20:13:10","true","Merge pull request #2980 from containers/dependabot/go_modules/github.com/onsi/ginkgo-1.15.0

build(deps): bump github.com/onsi/ginkgo from 1.14.2 to 1.15.0",94,48,0,1
"containers/buildah","bb03eb3f92a7790bb26e9bad1c544107eeab4b3f","TomSweeneyRedHat","2020-01-30 17:31:15","false","Make the commit id clear like Docker

Using this Dockerfile:
```
FROM alpine AS tommer
```
Docker does:
```
Sending build context to Docker daemon  17.92kB
Step 1/1 : FROM alpine AS tommer
latest: Pulling from library/alpine
c9b1b535fdd9: Pull complete
Digest: sha256:ab00606a42621fb68f2ed6ad3c88be54397f981a7b70a79db3d1172b11c4367d
Status: Downloaded newer image for alpine:latest
 ---> e7d92cdc71fe
Successfully built e7d92cdc71fe
```

While Buildah does:
```
STEP 1: FROM alpine AS tommer
STEP 2: COMMIT tom
e7d92cdc71feacf90708cb59182d0df1b911f8ae022d29e8e95d75ca6a99776a
e7d92cdc71feacf90708cb59182d0df1b911f8ae022d29e8e95d75ca6a99776a
```
Per user requests, we've over time eliminateed some of the ""noisier"" output that
Docker has, and that's now led to some confusion when we show an intermediate
image id (after the commit) and then as in the case, the same final
image id immediately afterwards.  We display only the full final image id to
make scripting easier per other user requests.

To aid with this, this pr will cause the intermediate image to be displayed
after an `-->` like Docker and will also show the 12 character short id.

If the `--quiet` option is used, this shorter id will not be displayed, only
the final longer one.

New behavior:
```
STEP 1: FROM alpine AS tommer
STEP 2: COMMIT tom
--> e7d92cdc71f
e7d92cdc71feacf90708cb59182d0df1b911f8ae022d29e8e95d75ca6a99776a
```
Fixes: https://github.com/containers/libpod/issues/5012

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",106,36,0,1
"containers/buildah","3177db512bed9aaa306c158052ca6091c7a9426b","TomSweeneyRedHat","2020-01-29 19:22:59","false","Bump back to v1.14.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2122
Approved by: rhatdan",107,36,0,1
"containers/buildah","8dd8e1a80304f47629d478bfb51b00e223c3d403","cheesiong-lee","2019-03-29 02:18:37","false","Add missing step in installing into Ubuntu

Signed-off-by: cheesiong.lee <cheesiong.lee@prophetstor.com>

Closes: #1458
Approved by: rhatdan",46,26,0,0
"containers/buildah","6941254c29793a94ad72c7fd0d874b86665287c3","TomSweeneyRedHat","2019-12-21 21:43:59","false","Fix option handling for volumes in build

If the volume option was specified like: `--volume ""${HOME}/.cache/zae9ujei:/myvol:rw,Z""`,
the COBRA code that processed the input from the user was considering the value to be a
SliceVar with two volumes `${HOME}/.cache/zae9ujei:/myvol:rw` and `Z` due to the comma.

Converted the COBRA code to consider the input as an ArrayVar instead and the value is
handled appropriately.  Also increased the testing to catch this going forward.

Addresses: #2000

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2039
Approved by: rhatdan",90,35,0,1
"containers/buildah","b3fbb59827fc93e4c05c2bb1a780490589f82330","flouthoc","2022-05-24 10:23:32","true","buildah: add support for renaming a device in rootless setups

Buildah now supports renaming devices while performing a build using
`--device <some-name>:<new-name>`. Implementation is similar to `podman`
where we prefer using `bind-mount` for devices instead of `mknod` in
`rootless` setups.

Usage
```console
buildah build -t test --device /dev/null:/test/dev/null .
```

Closes: https://github.com/containers/buildah/issues/4002

Signed-off-by: Aditya R <arajan@redhat.com>",26,64,1,1
"containers/buildah","104e21e0363b54bc8da24dd30fd5728ceb5d9e1b","hswong3i","2020-12-29 04:34:54","true","Update nix pin with `make nixpkgs`

Signed-off-by: Wong Hoi Sing Edison <hswong3i@pantarei-design.com>",88,47,0,0
"containers/buildah","cdac8e1ba9f50d02f3727370ae42c8f17e9b5928","dfr","2022-06-23 10:59:19","false","Move cleanupTempVolumes and cleanupRunMounts to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",21,65,1,0
"containers/buildah","f1cec509e03302341bddb6e8a5ecd2ea5a49bc27","TomSweeneyRedHat","2019-01-23 18:33:09","false","Add Quiet to PullOptions and PushOptions

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Add Quiet to the PullOptions and PushOptions structures.
If set to true output will be in 'quiet' mode.  This
will primarily be used by callers such as OpenShift.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1302
Approved by: rhatdan",54,24,0,1
"containers/buildah","344ab5cfd2bf5452941474b6a7411cf1011736c6","boaz0","2018-09-12 18:16:06","false","Fix arg usage in buildah-tag

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>

Closes: #1008
Approved by: rhatdan",38,19,0,0
"containers/buildah","15cd09d18e3ed1517e462dc172dd402bf1e213d0","rhatdan","2019-03-26 12:26:47","true","Merge pull request #1441 from nalind/requires-restart

imagebuildah: fix requiresStart/noRunsRemaining confusion",39,26,0,1
"containers/buildah","0bdbd1a80eb1f025207ca1a3d4b51da383dd3078","rhatdan","2022-09-04 11:22:51","false","Buildah should ignore /etc/crio/seccomp.json

[NO NEW TESTS NEEDED]

Fixes: https://bugzilla.redhat.com/show_bug.cgi?id=2123251

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",20,67,1,1
"containers/buildah","2333db32fdd324d5e68dcbd0d991ccc1ba497a66","rhatdan","2023-04-05 14:00:58","true","Merge pull request #4691 from containers/renovate/github.com-opencontainers-runc-1.x

fix(deps): update module github.com/opencontainers/runc to v1.1.5",10,74,1,1
"containers/buildah","a75b263f7563ce8027db46012b097f3fc71bbab0","edsantiago","2023-01-05 13:42:11","false","system tests: remove unhelpful assertions

Regular primitive bats uses assertions like '[ $foo = something ]'.
These are worthless for debugging: when they fail, all you know
is that foo is not ""something"" but you don't know what foo _is_.

Find and replace those assertions with 'assert', which is
more informative. Instances found via:

   $ ack '^ *\[' tests/*.bats

There are many matches for 'test' (instead of '[') but those
mostly look like file-existence ones, which are less evil
than string-check tests. I'm leaving those be for now.

Signed-off-by: Ed Santiago <santiago@redhat.com>",20,71,1,1
"containers/buildah","485a4eac5951adca72ee86eafcb2d9246416205d","rhatdan","2022-06-07 13:21:13","true","Merge pull request #4038 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.6

build(deps): bump github.com/containerd/containerd from 1.6.5 to 1.6.6",22,64,1,1
"containers/buildah","9a3250308b199010772339e79bc7b4aab29bf018","rhatdan","2022-04-22 10:42:52","false","Update vendor of containers/(common,storage,image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",25,63,1,1
"containers/buildah","cc4149b1e1e47a5139229997744d6224e997d598","rhatdan","2021-12-03 15:59:26","true","Merge branch 'main' into error",30,58,1,1
"containers/buildah","f280cd02854937fe302f94be40b8a50cef0b0186","rhatdan","2020-11-10 11:58:31","false","Add --policy flag to buildah pull

This allows the user to specify the pull policy for pulling images.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",67,45,0,1
"containers/buildah","58541a36f1a57d8d4492e07ceb47134c85ae2530","rhatdan","2020-09-17 15:22:58","true","Merge pull request #2630 from nalind/add-relative

Add(): fix handling of relative paths with no ContextDir",92,44,0,1
"containers/buildah","61f50c8cfb1fad27155117e0d6a72fa99d65ddc3","nalind","2020-07-20 21:54:25","false","Fix compilation of tests/testreport/testreport

Trying something based on a note in
https://www.gitmemory.com/issue/golang/go/31544/484565502

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",149,42,0,1
"containers/buildah","76ff3f05c3b4586d905fe52521fc3ea79da5a5ad","TomSweeneyRedHat","2020-06-16 15:16:04","false","Bump ImageBuilder to v1.1.5

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",143,41,0,1
"containers/buildah","cc4586890f33bcb1a1f2ce4c6c281c6119cdbf5f","rhatdan","2020-05-23 10:39:45","false","Bump github.com/containers/common from 0.11.2 to 0.11.4

Release notes
Commits

Dependabot compatibility score

Dependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting @dependabot rebase.
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",133,40,0,1
"containers/buildah","40423353eb11c775785dec4401b8d41621b58379","TomSweeneyRedHat","2020-03-03 19:16:53","false","Bump back to v1.15.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",100,37,0,1
"containers/buildah","acc7c35b615dc753c084f00087e3e211bf960593","rhatdan","2019-12-17 16:00:03","true","Merge pull request #2026 from containers/dependabot/go_modules/github.com/containers/image/v5-5.1.0

Bump github.com/containers/image/v5 from 5.0.0 to 5.1.0",90,35,0,1
"containers/buildah","bd32b5e838d941f6d1a18b94632eeffc00ea72a5","vrothberg","2019-10-02 12:20:32","true","Merge pull request #1889 from containers/dependabot/go_modules/github.com/spf13/cobra-0.0.5

Bump github.com/spf13/cobra from 0.0.3 to 0.0.5",65,32,0,1
"containers/buildah","d2c1fd8ec27141359b4d8d64acbdb5e4da5b4772","TomSweeneyRedHat","2019-09-15 17:29:56","false","Use Containerfile by default

Use the file named ""Containerfile"" if no build file is specified.  If
not found, fall back to Dockerfile.

This is the initial PR, we probably will have more doc tweaking to do overtime.

```
STEP 1: FROM alpine
STEP 2: COMMIT tom
961769676411f082461f9ef46626dd7a2d1e2b2a38e6a44364bcbecf51e66dd4

STEP 1: FROM alpine
STEP 2: COMMIT tom
961769676411f082461f9ef46626dd7a2d1e2b2a38e6a44364bcbecf51e66dd4

```
Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1860
Approved by: rhatdan",62,32,0,1
"containers/buildah","4a6f4aeb6badef5e326e4849b58383ec0aea9d44","rhatdan","2018-10-19 21:24:49","false","Resolve image names with default transport in from command

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",55,21,0,1
"containers/buildah","ccbff5ffe78debddc8f9051347f728136af6d5f0","nalind","2019-05-29 14:00:38","false","bud.bats: test replacing symbolic links

Add a test that ensures that we don't fail to replace a symbolic link.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1623
Approved by: giuseppe",58,28,0,1
"containers/buildah","18cc34c896f68ae45b24817dd4990cc257e32bb6","nalind","2019-05-01 13:34:58","true","Merge pull request #1550 from TomSweeneyRedHat/dev/tsweeney/imageupstream

Add upstream buildahimage",53,27,0,1
"containers/buildah","5c00086866165825bed45963f9eefd16ff5a0245","nalind","2017-04-19 19:28:59","false","Bump opencontainers/runtime-spec and runtime-tools

Update the versions of github.com/opencontainers/runtime-spec and
github.com/opencontainers/runtime-tools that we vendor.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",11,3,0,1
"containers/buildah","8db406b6832bbf6b53b045be854dd01831484dae","nalind","2018-05-18 20:09:01","false","util.ResolveName(): handle completion for tagged/digested image names

When checking if an image name includes a registry name, when checking
for cases where parsing it inserts additional path components, handle
cases where the name includes a tag or digest component.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #710
Approved by: rhatdan",63,16,0,1
"containers/buildah","4d0eb18796e969424e60cd7a11a30bcca96cdfb8","giuseppe","2022-01-26 10:16:24","true","overlay: always honor mountProgram

if a mountProgram is specified, use it also in rootfull mode.

Closes: https://github.com/containers/buildah/issues/3281

[NO NEW TESTS NEEDED]

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",34,60,1,1
"containers/buildah","f995696f2804da07967272a299877d4bc136c59a","QiWang19","2019-11-06 03:57:38","false","Check nonexsit authfile

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1967
Approved by: rhatdan",82,33,0,1
"containers/buildah","ff72568a7004843d615ec6cc0fa3ded987bbd1a8","saschagrunert","2019-08-22 12:58:34","false","Disable empty logrus timestamps to reduce logger noise

The logrus timestmaps are always empty where we can disable them to have
cleaner log outputs:

Before:
```
DEBU[0000] [graphdriver] trying provided driver ""overlay""
```

After:
```
DEBU [graphdriver] trying provided driver ""overlay""
```

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1812
Approved by: rhatdan",53,31,0,1
"containers/buildah","2055fe9131c9d2dc6ceee5458ca731f4b2a40c56","TomSweeneyRedHat","2020-01-18 16:41:36","false","Bump c/storage to v1.15.7

As the title says, bumping to c/storage v1.15.7 to
get overlayv2 fix.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2094
Approved by: rhatdan",102,36,0,1
"containers/buildah","2fed5fc912e707823d0582a54fdb41c28f2f9c34","flouthoc","2023-05-04 05:55:16","true","run,mount: remove path only if they didnt pre-exist

It seems buildah was cleaning path after unmounting the content which
was added by `--mount`, however buildah should `remove` only if the path
it did not pre-exist otherwise it should just simply `unmount`.

Following behaviour aligns buildah to buildkit

Closes: https://github.com/containers/buildah/issues/4739

Signed-off-by: Aditya R <arajan@redhat.com>",9,75,1,1
"containers/buildah","6d01253522872f1910d2ea30320cf3de3736a8c9","openshift-merge-robot","2021-11-30 18:53:33","true","Merge pull request #3637 from rhatdan/cgroup

Grab all of the containers.conf settings for namespaces",30,58,1,1
"containers/buildah","59cd527d6d40b5a77d7f3e6560b90c2ef7102c93","openshift-merge-robot","2020-12-22 14:08:59","true","Merge pull request #2847 from rhatdan/stdin

Allow users to specify stdin into containers",84,47,0,1
"containers/buildah","f63a0a9d2e48eea82ed623c06ceb90c9804507e2","openshift-merge-robot","2022-02-01 18:39:36","true","Merge pull request #3760 from containers/dependabot/go_modules/github.com/containers/storage-1.38.2

build(deps): bump github.com/containers/storage from 1.38.1 to 1.38.2",35,60,1,1
"containers/buildah","e451a6f7ef027997b870d6a83a1365b9ef1bf2f7","openshift-merge-robot","2021-06-10 20:50:28","true","Merge pull request #3291 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.7.3

build(deps): bump github.com/fsouza/go-dockerclient from 1.7.2 to 1.7.3",34,52,1,1
"containers/buildah","f3c5c034256bc0d4eb358d8f08439f3a9630f526","openshift-merge-robot","2021-01-05 15:34:33","true","Merge pull request #2884 from nalind/copier-ignore-devices

copier.PutOptions: add an ""IgnoreDevices"" flag",90,47,0,1
"containers/buildah","02b3b5095ee0b81534b1b23bfbb798e726d3f5df","openshift-merge-robot","2020-11-30 15:17:56","true","Merge pull request #2826 from geonizeli/patch-1

inserts forgotten quotation mark",77,46,0,1
"containers/buildah","a9c340541df2e898b25966d3dfeb57b5d742f572","nalind","2020-11-16 22:10:57","false","intermediateImageExists: ignore images whose history we can't read

When attempting to read the history of an image in order to try to check
if it's suitable as a cache entry for an image we're building, if we
fail to read its history, ignore the image instead of failing.

If the image was pulled into local storage for a different architecture,
or it's a list with no entry in it for the local architecture, or if
it's a list which references an image for the local architecture that we
haven't pulled down, we'll get an error back from the image library, and
we don't want to fail because of that.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",76,46,0,1
"containers/buildah","d410ce9aeacb6fea9c993a5a632e361aa1ae3242","nalind","2017-04-13 20:45:18","false","Update bash-completions for build-using-dockerfile

Add completion for build-using-dockerfile and our renaming of the
containers/images --no-truncate flag to --notruncate during the CLI
overhaul.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #59
Approved by: rhatdan",14,3,0,1
"containers/buildah","9327431e97084da0b0d7dae42e54ad438496e234","nalind","2017-08-31 17:53:13","false","Avoid trying to print a nil ImageReference

When we fail to pull an image, don't try to include the name of the
image that pullImage() returned in the error text - it will have
returned nil for the pulled reference in most cases.  Instead, use the
name of the image as we were told it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #255
Approved by: nalind",30,7,0,1
"containers/buildah","c06852aa4ded9b46385bb15caddbd4f2ee84c3cf","nalind","2019-08-13 04:31:14","false","Vendor github.com/openshift/api

Add github.com/openshift/api to our list of dependencies, and update
dependencies.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1787
Approved by: rhatdan",52,30,0,1
"containers/buildah","de9c3841c788b77e689abbd609d325c5d409a69c","edsantiago","2022-09-21 02:02:40","false","Fix broken dns test (from merge collision)

And, while I'm at it, fix grammar (""cannot"" is one word)

Signed-off-by: Ed Santiago <santiago@redhat.com>",20,68,1,1
"containers/buildah","f68f10923475ae75df53790594b44c4e5c0ecc9d","dfr","2022-06-15 10:51:32","false","Don't crash in configureUIDGID if Process.Capabilities is nil

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","e008b736ac056f6bb06a05d492a952602a98a835","rhatdan","2018-04-16 20:37:53","false","Clarify the use of buildah config options

Make it clearer to the user which options can be executed
multiple times, versus those that can only used once.

Cleanup some documentation issues

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #592
Approved by: rhatdan

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #602
Approved by: pixdrift",31,15,0,1
"containers/buildah","cc619c28d93148f220c292bef9d8fe840fff7b1b","nalind","2023-09-07 13:43:22","false","Make sure that pathnames picked up from the environment are absolute

When we read TMPDIR and SSH_AUTH_SOCK from the environment, convert them
to absolute paths before using them.  Call auth.GetDefaultAuthFile()
instead of reading REGISTRY_AUTH_FILE.

[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",4,79,1,1
"containers/buildah","c44efcfb75691f9559f5b7bb0abae566a37eead1","rhatdan","2023-01-05 18:41:43","true","Merge pull request #4507 from eschnett/patch-2

Correct minor typo in comment",20,71,1,1
"containers/buildah","c0f6c6b7ad764c4aff83ed481ed2f0d1442c7f4d","giuseppe","2023-01-17 16:02:04","true","[Itests: change the runtime-flag test for crun

crun might not print any debugging message, so change the runtime-flag
test to use --log=log-file and test it was created.

Closes: https://github.com/containers/buildah/issues/4503

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",22,72,1,1
"containers/buildah","ccc99160bb0612b60e58ab0de070690b35cf53f1","rhatdan","2022-10-13 19:38:32","true","Merge pull request #4338 from containers/dependabot/github_actions/dawidd6/action-send-mail-3.7.0

build(deps): bump dawidd6/action-send-mail from 2.2.2 to 3.7.0",26,68,1,1
"containers/buildah","8e697e4f4801f11032f0bf02a34620ae4aa13599","rhatdan","2022-10-13 19:37:54","true","Merge pull request #4337 from containers/dependabot/github_actions/tim-actions/get-pr-commits-1.2.0

build(deps): bump tim-actions/get-pr-commits from 1.1.0 to 1.2.0",26,68,1,1
"containers/buildah","8f6abac5fe487f01b6d55cc3ce3e3d84cabaadfa","nalind","2022-04-26 21:33:10","false","copier.Put(): write to read-only directories

Try to improve our ability to write to directories that aren't
writable.  If we encounter an EPERM error while attempting to create an
item, attempt to temporarily make writable the directory that we're
writing the item to, and restore its permissions on our way out.

The error usually isn't seen when run as UID 0, whether in a user
namespace or not, which is usually how we're called, but running the
unit tests as an unprivileged user will verify it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",25,63,1,1
"containers/buildah","cc5e80f6de81d3da05bd40e78258911289534076","cevich","2022-04-26 15:58:16","true","Cirrus: Update CI VMs to F36

Signed-off-by: Chris Evich <cevich@redhat.com>",24,63,1,1
"containers/buildah","bfe412b1c6452d12a28c38f97d2682937d4d6364","openshift-merge-robot","2021-11-19 19:53:13","true","Merge pull request #3638 from rhatdan/unsetenv

Fix UnsetEnv for buildah bud",27,58,1,1
"containers/buildah","580356f0c34bed19e1f935bfe2a32d42924466fd","rhatdan","2020-12-21 20:21:39","false","SELinux no longer requires a tag.

It should work fine on linux and not linux boxes. Since there
is no glibc added, we can safely compile and run this code
on non SELinux boxes.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",84,47,0,1
"containers/buildah","c40f7eac4cbd186803977500badc4854ea3749b5","nalind","2020-11-30 17:17:58","false","pkg/supplemented test: replace our null blobinfocache

In our tests, drop our own doesn't-do-anything BlobInfoCache
implementation, and just use the one provided by the image library.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",77,46,0,1
"containers/buildah","1f8bf4dba27d9a157f966dad3a1e0f58091091d8","rhatdan","2020-09-11 14:07:30","true","Merge pull request #2583 from TomSweeneyRedHat/dev/tsweeney/tutclarify

Update Buildah Tutorial to address BZ1867426",89,43,0,1
"containers/buildah","1799dfc47ee33009ad39e1a507ec0f258bf0ca0a","nalind","2020-09-03 17:44:26","false","CI: expand cross-compile checks

Expand the list of OS/arch combinations we check when we're checking if
we can successfully be cross-compiled, and fix up a couple of places
that wouldn't pass otherwise.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",82,43,0,1
"containers/buildah","3997b89efc03715b27a51fa47caa335196bfa257","QiWang19","2020-08-05 17:46:15","false","fix  bug manifest inspct

Allow continuing getting image reference if encounters errors previously.

Signed-off-by: Qi Wang <qiwan@redhat.com>",97,42,0,1
"containers/buildah","8bcc55a5ee8c61d165dc49c5b49d9d75464a5b1e","rhatdan","2020-03-10 13:43:54","false","Fix FORWARD_NULL errors found by Coverity

Error: FORWARD_NULL (CWE-476): [#def50]

These errors could lead to crashes in the code.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",105,37,0,1
"containers/buildah","d12222c59f1c837e39a0542f3d9fe485018789c1","rhatdan","2020-02-18 22:41:40","true","Merge pull request #2170 from nalind/env-precedence

run: adjust the order in which elements are added to $PATH",98,37,0,1
"containers/buildah","92d7248b8ba0d86084a7cd0cc49a1971369e4eb4","rhatdan","2020-02-11 21:37:54","true","Merge pull request #2157 from mythi/cni-install

Makefile: fix install.cni.sudo",114,37,0,1
"containers/buildah","0094c919147f7ff7872853532f501e768a21714b","rhatdan","2020-02-05 21:25:40","true","Merge pull request #2143 from vrothberg/gpgme

bump github.com/mtrmac/gpgme",110,36,0,1
"containers/buildah","fc06a4d599ef9180c06f84f3c037c7ba4ba64d72","vrothberg","2019-10-01 09:54:29","true","Merge pull request #1882 from containers/dependabot/go_modules/github.com/opencontainers/selinux-1.3.0

Bump github.com/opencontainers/selinux from 1.2.2 to 1.3.0",66,32,0,1
"containers/buildah","fff56be52a8c06dd91ba2d2158472ff3c7151aac","nalind","2018-06-22 17:31:41","false","Add a Dockerfile

Build an image that forces use of the ""vfs"" driver and uses ""chroot""
isolation.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #836
Approved by: rhatdan",30,17,0,1
"containers/buildah","fe7e09c08e29f027eba1f3e20df2e325382561f8","giuseppe","2019-01-14 10:04:14","false","unshare: do not set USER=root

do not override the USER environment variable to ""root"" as it confuses
the runc rootless mode.  runc is using the USER variable to determine
whether XDG_RUNTIME_DIR must be honored or not.

Closes: https://github.com/containers/buildah/issues/1271

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1278
Approved by: rhatdan",51,23,0,1
"containers/buildah","6552b619cab95e8bff8192d54c66c467ec025267","nalind","2023-11-07 22:45:03","false","conformance: use require.NoErrorf() more

Use require.NoErrorf() as a check instead of the more general
require.Nil(), which was both less specific and didn't expect a format
string.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,81,1,1
"containers/buildah","d0da9f68139d6858a9f98452becc479ea5c9929f","rhatdan","2023-08-07 18:16:27","true","Merge pull request #4954 from containers/renovate/golang.org-x-crypto-0.x

fix(deps): update module golang.org/x/crypto to v0.12.0",11,78,1,1
"containers/buildah","8543176d56e6a823842a9644bc330021d99b0c7f","rhatdan","2023-06-05 20:06:37","true","Merge pull request #4837 from edsantiago/test_better

intermediate-images inherit-label test: make it debuggable",16,76,1,1
"containers/buildah","216d6be9633f7d40a0ca722a0959ce69aaf518c4","rhatdan","2023-04-17 21:25:57","true","Merge pull request #4743 from containers/renovate/github.com-opencontainers-runtime-spec-1.x

fix(deps): update module github.com/opencontainers/runtime-spec to v1.1.0-rc.2",12,75,1,1
"containers/buildah","69099cfa7bea5df55c2a572c2fa7f2989b5f7b32","rhatdan","2023-03-30 10:43:38","true","Merge pull request #4585 from containers/renovate/github.com-opencontainers-runtime-tools-digest

fix(deps): update github.com/opencontainers/runtime-tools digest to e931285",12,74,1,1
"containers/buildah","8125e45a5863989a81f3507a14346a4a2f61ac69","rhatdan","2023-02-14 05:26:49","false","Fix documentation on which Capabilities are allowed by default

Buildah uses the default list of capabilities as specified in
containers.conf. The man pages should reflect this.

Fixes: https://github.com/containers/buildah/issues/4576

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",19,73,1,1
"containers/buildah","128a6cb3f518c5a48c328a23c88709b091493cc0","openshift-merge-robot","2023-02-15 05:40:14","true","Merge pull request #4580 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.17

build(deps): bump github.com/containerd/containerd from 1.6.16 to 1.6.17",20,73,1,1
"containers/buildah","fa7de7d89ad15e55a9e05fbbcaac78c26f1bc2ef","jmguzik","2021-02-26 23:41:30","false","complement add/copy --chmod documentation

Signed-off-by: Jakub Guzik <jakubmguzik@gmail.com>",57,49,0,0
"containers/buildah","054a14b63d58b7cb96a63fd2b944d61fa1bf3fd6","lumjjb","2020-05-12 19:09:05","false","clean up comments

Signed-off-by: Brandon Lum <lumjjb@gmail.com>",135,40,0,0
"containers/buildah","769a3e54652c04d9e1e6b4ab90d87507a79f6f2b","carbonin","2020-03-10 23:39:34","false","Preserve volume uid and gid through subsequent commands

Fixes #2202

Signed-off-by: Nick Carboni <ncarboni@redhat.com>",108,37,0,0
"containers/buildah","ca1704fcbb9573561141d57c2dfc95a36c803a05","rhatdan","2018-04-26 13:01:15","false","Modify man pages so they compile correctly in mandb

This fixes an issue where if you did
man -k buildah-bud

buildah-bud (1)    - (unknown subject)

Now you will see

man -k buildah-bud
buildah-bud (1)      - Build an image using instructions from Dockerfiles.

More importantly
man -k Dockerfile
buildah-bud (1)      - Build an image using instructions from Dockerfiles.
docker-build (1)     - Build an image from a Dockerfile
docker-image-build (1) - Build an image from a Dockerfile
Dockerfile (5)       - automate the steps of creating a Docker image
podman-build (1)     - Build a container image using a Dockerfile.

Will now list buildah-d

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #638
Approved by: TomSweeneyRedHat",52,15,0,1
"containers/buildah","dd3dff5a618f1849c03d8a9848ca23a6a93b5ef9","ypu","2018-12-17 07:59:48","false","Add some tests for buildah pull

Add some tests for pull image from different transport.

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #1241
Approved by: rhatdan",54,23,0,0
"containers/buildah","618bf54c74fe2868717db58a9ee2d11120212cb7","nalind","2018-08-08 20:38:53","false","Export a Pull() function

Provide a Pull() function that can be called directly, to go with the
Push() function.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #918
Approved by: rhatdan",23,18,0,1
"containers/buildah","8efeb7f4aca9376219b726a657625a07fbaf703f","nalind","2017-06-23 15:53:51","false","Handle ""run"" without an explicit command correctly

When ""run"" isn't explicitly given a command, mix the command and
entrypoint options and configured values together correctly.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #160
Approved by: rhatdan",17,5,0,1
"containers/buildah","a677a93059c1882bcde428a38600fd7d9e89b7eb","nalind","2022-04-01 14:37:45","false","Create shorter names for containers based on image IDs

When we specify the image name to use for creating a container by using
its ID, truncate the ID before appending the suffix.  An untruncated ID
is already as long as the static HOST_NAME_MAX value used by some
applications, and we started making the container's name the FQDN of the
container in f8c152694c1edce4b9b1d80d926f94226caab90c, which would have
created problems for those applications.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",27,62,1,1
"containers/buildah","70b57afda64cfe68b50dd66a7a4580c2db882cda","lsm5","2017-10-02 18:49:22","false","use Makefile var for go compiler

This will allow compilation with a custom go binary,
for example /usr/lib/go-1.8/bin/go instead of /usr/bin/go on Ubuntu
16.04 which is still version 1.6

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>

Closes: #278
Approved by: rhatdan",31,8,0,1
"containers/buildah","a405d62cb4e99a6892dcadd1670f225979a3c273","dfr","2022-06-15 10:32:39","false","Move runLookupPath to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","5c27e00ba8900b85a4314bbd20f16298cbf1cea6","openshift-merge-robot","2020-10-31 09:50:10","true","Merge pull request #2734 from nalind/cache-check-format

imagebuildah: cache should take image format into account",67,45,0,1
"containers/buildah","1a7078322301c2c4ce3f469d0c9d10f277593779","openshift-merge-robot","2021-06-16 19:36:18","true","Merge pull request #3302 from containers/dependabot/go_modules/github.com/containers/image/v5-5.13.0

build(deps): bump github.com/containers/image/v5 from 5.12.0 to 5.13.0",39,53,1,1
"containers/buildah","60813b5c36ef759b50d43521189b81d1a88ebd55","openshift-merge-robot","2020-11-17 17:28:21","true","Merge pull request #2803 from nalind/bud-no-terminal

imagebuildah: disable pseudo-terminals for RUN",77,46,0,1
"containers/buildah","77b2623ffe6c0ca8f69cf8afaf29f9a5efd7af29","openshift-merge-robot","2022-07-22 18:22:47","true","Merge pull request #4130 from nalind/userns-defaults

Set user namespace defaults correctly for the library",19,66,1,1
"containers/buildah","2030d0bd28301ccdea94500af79003d422fb26c5","openshift-merge-robot","2022-01-20 20:17:29","true","Merge pull request #3723 from kolyshkin/tests-tools-bump

Tests tools bump",35,60,1,1
"containers/buildah","873a9e1fe983da3819bfabd0db23cbea6d088893","flouthoc","2022-07-29 17:19:34","true","vendor: bump to c/common@87fab4b7019a

Bump to c/common@v0.49.1-0.20220729170140-87fab4b7019a for Manifest
Inspect support with OCI annotations

[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",19,66,1,1
"containers/buildah","9cd28db91e140cf25cfaaa0ee53e4dbc3186651c","flouthoc","2023-05-26 12:35:28","true","vendor: bump c/storage to v1.46.2-0.20230526114421-55ee2d19292f

[NO NEW TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",18,76,1,1
"containers/buildah","7d9447b2f1462941055f1d170ddf20d6690d3b61","flouthoc","2023-05-19 09:12:12","true","vendor: bump logrus to 1.9.2

Logrus v1.9.1 causes panic and has some issues, which were fixed by
reverting necessary commits in `v1.9.2`.

See: https://github.com/sirupsen/logrus/releases/tag/v1.9.2

Fixes issues: https://github.com/containers/podman/pull/13808#issuecomment-1552887130

[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",14,76,1,1
"containers/buildah","d281eabbbf15a8bf6a5bd2f5c68d44b9f2555c11","rhatdan","2022-07-25 19:55:22","true","Merge pull request #4134 from rhatdan/VENDOR

Update vendor of containers/(common, storage, image)",21,66,1,1
"containers/buildah","49603b548377ce6e6ab14fb9ff821dcb609452e9","rhatdan","2023-06-05 20:06:19","true","Merge pull request #4841 from kolyshkin/quieter-make

docs/Makefile: don't show sed invocations",16,76,1,1
"containers/buildah","57dde8e9777f9d902594b45ab6cd71e51f4e47a8","rhatdan","2021-01-07 16:43:28","false","Make buildah push support pushing manifests lists and digests

Currently manifests just look like images in container storage.
It is surprising to the user when they go to push the images
that they end up failing, and have to use the buildah manifest push.

This patch causes buildah push to failover to buildah manifest push
if the image is a manifest.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",91,47,0,1
"containers/buildah","cf6e5fd8a68033d2b3061b16649bdd45ebf29a5a","rhatdan","2018-08-23 16:55:16","false","Warn about using Commands in Dockerfile that are not supported by OCI.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #957
Approved by: umohnani8",33,19,0,1
"containers/buildah","e3f2ffafa5e03b375eb68b8ab78868cc21ef8bad","rhatdan","2023-04-08 10:58:05","true","Merge pull request #4724 from containers/renovate/github.com-containers-common-0.x

fix(deps): update module github.com/containers/common to v0.52.0",11,74,1,1
"containers/buildah","a673ac7ae62c793dff46920181c82def7d78b6a6","rhatdan","2017-10-10 12:22:36","false","Merge pull request #284 from rhatdan/cleanup

Fix validateOptions to match kpod",32,8,0,1
"containers/buildah","217b2d524c041674066f2e0d329ec2ad5a62004b","rhatdan","2022-11-03 20:50:25","false","Expand args and env when using --all-platforms

Fixes: https://github.com/containers/buildah/issues/4399

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",24,69,1,1
"containers/buildah","4f3826734242258c3373cae0c48a6734356531b6","umohnani8","2018-01-29 22:10:59","false","format should override quiet for images

quiet was overriding format, but we want format to override quiet
if both the flags are set for buildah images.

Changed it so that it errors out if both quiet and format are set.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #426
Approved by: rhatdan",38,12,0,1
"containers/buildah","4b6ba974ccf6fb2a4f8e72c48e95d448acbe6a0d","nalind","2017-05-17 21:02:40","false","Make the output image format selectable

Make it possible to select the output format for Commit() and the
imagebuildah package, and wire that through to a --format option in the
CLI's ""commit"" and ""bud"" commands.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #118
Approved by: rhatdan",10,4,0,1
"containers/buildah","f0404c688a4d2e917bb0dd114badc514349a22ed","nalind","2021-01-04 21:44:30","false","copier.PutOptions: add an ""IgnoreDevices"" flag

Prior to 1.16, when ADDing contents to a working container, if we were
being run by an unprivileged user using a user namespace, content that
was a device node would be ignored.

Add a flag in copier.PutOptions that tells copier.Put() to ignore
entries that are either a device, or a hard link to a device.

Make buildah.Add() set the IgnoreDevices flag in PutOptions when
libcontainer says we're running in a user namespace.

Together, these two changes should restore the earlier behavior.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",90,47,0,1
"containers/buildah","c2305273eb7a51a3edd9a6f19d93f6fc11113442","nalind","2017-02-06 18:54:27","false","Add an initial README

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,0,0,1
"containers/buildah","f33ae08da50b2a0a85d9f294f09a3a3fa2a0f094","nalind","2017-03-21 20:37:59","false","Update vendored dependencies

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","9a6dc67054b4708ffd10d58d3c57ed2807cefce7","nalind","2017-04-19 13:03:50","false","Bump and pin github.com/docker/go-connections

Update and pin the version of github.com/docker/go-connections that we
vendor.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",13,3,0,1
"containers/buildah","310363c1146b65e6b7f21134283905d8d6caaf47","giuseppe","2019-02-06 12:42:36","false","main: fix rootless mode

the args argument is always an empty slice, so it breaks the code for
detecting if we need a new user namespace.  Use directly os.Args[1:].

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1324
Approved by: rhatdan",56,24,0,1
"containers/buildah","d6745ab34f014770914d16675917cb9b4d373013","vrothberg","2019-03-25 11:42:21","false","vendor imagebuilder v1.1.0

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1440
Approved by: rhatdan",39,26,0,1
"containers/buildah","b165cfb986cbee7e6fe5452c50c7ea17e3b1e5e1","vrothberg","2019-06-18 11:25:02","false","bind/util.go: remove unused func

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","d27b8837096d6544d34119f75ffc3a1a58bb157a","flouthoc","2022-03-04 10:38:38","true","tests: skip tests for rootless which need unshare

Instrument test so that they can be executed in rootless environment.

Certain tests perform mount directly and they need a seperate
usernamespace, these tests are marked to be skipped for `rootless
environment`

Signed-off-by: Aditya R <arajan@redhat.com>",29,61,1,1
"containers/buildah","746b5a6e9a2f14ea98a5f94093dee2caf1c4bcab","openshift-merge-robot","2020-10-06 17:29:11","true","Merge pull request #2647 from hshiina/idmapping-test

Set directory ownership when copied with ID mapping",87,44,0,1
"containers/buildah","371e4ca6cc3706861717fac1dbd53896032f5c0e","openshift-merge-robot","2021-01-22 11:03:39","true","Merge pull request #2886 from cevich/native_osx_build

Native OSX build",95,48,0,1
"containers/buildah","263fb1cb5be706518681b66ee7c118ebc686c1d3","openshift-merge-robot","2021-04-20 19:51:38","true","Merge pull request #3168 from nalind/debug-timestamps

Restore log timestamps",49,51,0,1
"containers/buildah","617a76be4d5624e80290d28ccdc396041d857a93","openshift-merge-robot","2022-02-09 20:11:53","true","Merge pull request #3762 from cevich/new_python_images

Cirrus: Use updated VM images",30,60,1,1
"containers/buildah","55d55bc7739835a3680dad7b14bc446d87bd4e17","kolyshkin","2022-01-18 02:43:36","false","bind/mount.go: fix linter comment

Newer golangci-lint does not understand the nolint: directive
because it is followed by some comment.

To fix, add a comment before the (human) comment.

While at it, remove the space after // since comments targeted for
non-humans should not have space (this is currently not enforced by
golangci-lint).

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","fb2b2bdf6bc5d9e7a94199dafb167d4a12e8e184","giuseppe","2018-11-12 10:56:01","false","vendor: update containers/storage

inherit some fixes for rootless overlay with fuse-overlayfs.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1171
Approved by: rhatdan",61,21,0,1
"containers/buildah","8b9c777a2edd2321a9a9f8a3931fa4814d623945","nalind","2018-05-18 20:54:13","false","Test with Go 1.10, too

And teach govet.sh about build tags.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #711
Approved by: rhatdan",63,16,0,1
"containers/buildah","544e63de426ba95df03926f0162012e0c470c8b0","nalind","2017-10-25 03:02:13","false","Bump containers/image and containers/storage

Update containers/image and containers/storage to current master
(17449738f2bb4c6375c20dcdcfe2a6cccf03f312 and
0d32dfce498e06c132c60dac945081bf44c22464, respectively).

Also updates github.com/docker/docker, golang.org/x/sys, and
golang.org/x/text.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #187
Approved by: rhatdan",30,9,0,1
"containers/buildah","0b4d9732383a98a01a6f4a2144ff5677e1eab905","nalind","2021-03-22 16:00:02","false","COPY --chown: expand the conformance test

Expand conformance test coverage for COPY --chown, and correct our
behavior when the argument is a single number: instead of assuming the
number is the UID and GID = 0, the GID should be the same as the UID.

This means that we can't quite use the same function for parsing the
arguments for COPY --chown and USER, as they evidently have different
defaults for the case where the argument is a single number.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",53,50,0,1
"containers/buildah","ee965317b15583187d85d7dc8651311331a978e2","nalind","2021-08-27 15:10:17","false","conformance: tighten up exception specifications

Modify how we process exceptions in conformance tests so that we don't
unintentionally disable an attribute comparison (such as ""mtime"") on
items below a directory when we try to skip that attribute comparison on
the directory itself.

Fix some incorrect specifications for filesystem differences that we're
supposed to ignore, and use the -t flag in more places where we RUN the
`touch` command to create files that end up in the final image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",37,55,1,1
"containers/buildah","2adbe2a58a77b014be59c68abf58b682ad5e5c20","edsantiago","2022-10-05 17:28:24","false","System test cleanup: document, clarify, fix

Primary purpose: fix ""preconfigured TARGETARCH/etc"" test so
it will work under podman and on multiarch.

Root cause of it not working: I mistakenly advised @flouthoc,
in #4310, to write a containerfile in $TEST_SCRATCH_DIR. I
thought it was an empty directory. Big, big mistake. (Sorry,
Aditya). Document this near the variable definition, and
fix the test once again.

@nalind pointed out that the containerfile doesn't need to
be generated on-the-fly, so, use a static one. In the spirit
of DIE, read the TARGETxxx vars from it. Not that we're
expecting more variables, but, it's just cleaner.

Also, as long as I'm here: in run_buildah, when logging the
command being run, use #/$ prompt for root/rootless. I was
getting too confused looking at logs of root runs.

Signed-off-by: Ed Santiago <santiago@redhat.com>",27,68,1,1
"containers/buildah","dee4b68ef0df379fbdc8cf36457d6de147963f74","edsantiago","2019-12-11 18:28:27","false","BATS major cleanup, part 1: log-level

PR #1935 removed the default --debug logging; so all run_buildah
calls now use the default (error). It is safe to remove unnecessary
instances of --log-level=error .

For ease of review, this commit was entirely machine-generated via:

    $ perl -pi -e 's/ --log-level=error / /' *.bats

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2029
Approved by: rhatdan",85,34,0,1
"containers/buildah","1091222b2735c4070d271bd74e9aec149c32c6a6","edsantiago","2022-11-03 13:38:08","false","Stop using ubi8

First: because we have a bunch of tests that rely on the image
manifest list, and ubi8 is not under our control: we've already
seen where ubi8 gets changed without our knowledge, requiring
almost a week of scrambling to get things fixed again.

Second, the registry it lives on is unreliable.

Signed-off-by: Ed Santiago <santiago@redhat.com>",25,69,1,1
"containers/buildah","e47145ce24bf58e775dd3673e711bbb531ffe51b","edsantiago","2019-12-04 21:41:37","false","imgtype: check earlier for expected manifest type

imgtype has a --expected-manifest-type option; the intention
seems to be to fail if the given image is not of the expected
type. This was not actually working as intended: the user-
specified expected-type was being trusted prematurely and
used to set state inappropriately.

Solution: check earlier, and bail if actual != expected.

There's quite a bit of duplicate code which I think can be
refactored here but it's probably ok to defer that for
the proverbial rainy day.

Fixes: #1951

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2006
Approved by: TomSweeneyRedHat",86,34,0,1
"containers/buildah","ea0506a4941a3d673251508d0c1e936045f154bc","abergmeier","2022-01-14 20:39:29","false","Allow processing of SystemContext from FlagSet

In situations where you don't want/need Cobra climbing behavior nor
Cobra at all using FlagSet is the easier sell.

Signed-off-by: Andreas Bergmeier <abergmeier@gmx.net>",32,59,1,0
"containers/buildah","46ba99c47f01dd8873ce668860305f143e4c1e71","edsantiago","2019-10-28 22:03:31","false","yet more fixes

- add explicit --log-level=debug in some buildah-bud invocations
  where we need to check debug output
- use expect_line_count() in one place, to get better diagnostics
- formats test: refactor, make more readable
- imgtype invoker: remove -debug
- fix one more instance of 'step' needing to be 'STEP'
- fix one mkdir to mkdir -p, and run rm -rf beforehand, to deal
  with a failed prior run that might have left state

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1935
Approved by: giuseppe",80,33,0,1
"containers/buildah","b65a41f3914daa63e7d1b28492ed159c56395ab5","pixdrift","2018-05-02 23:50:13","false","Expanding buildah run cmd/entrypoint tests

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #656
Approved by: rhatdan",48,15,0,0
"containers/buildah","2c4f388bdf7d41073e3e052af412e3d3566a26ee","vrothberg","2019-06-17 11:32:59","false","chroot: only log clean-up errors

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1624
Approved by: TomSweeneyRedHat",42,29,0,1
"containers/buildah","12967782f001e21fc1b0694f39630af63d6aedf0","openshift-merge-robot","2021-02-23 10:40:26","true","Merge pull request #3032 from cevich/disable_f32

Cirrus: Temp. disable prior-fedora (F32) testing",60,49,0,1
"containers/buildah","567141716e5802c556a53e3ec6021105e5e17a09","saschagrunert","2019-08-22 12:07:56","false","Add `--log-level` command line option and deprecate `--debug`

The previous log-level implementation does not seem to work, which is
now fixed and aligns to other projects like podman and CRI-O. Therefore
the `--debug` flag has been deprecated and is now hidden.

Added documentation as well as integration tests.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1811
Approved by: rhatdan",53,31,0,1
"containers/buildah","1fc5a499588143aa5146a573b1952650025141b3","bertinatto","2017-11-30 14:34:02","false","Add --chown option to add/copy commands

Signed-off-by: Fabio Bertinatto <fbertina@redhat.com>

Closes: #336
Approved by: rhatdan",32,10,0,0
"containers/buildah","0dac0dfa51667134f02de888194056bb8c360c5a","cevich","2023-06-06 21:18:50","true","Renovate: Don't touch fragile test stuffs

Fixes: #4848

There's a reason we maintain a cache of test-only images in a special
registry namespace: So we rarely/never need to muck with sensitive name
references in the tests themselves.  Teach renovate to simply ignore
updates to all test-related stuffs.

Signed-off-by: Chris Evich <cevich@redhat.com>",15,76,1,1
"containers/buildah","c0d49f8eb4cd267e899e5c65fbc6fb9c38d9efdf","cevich","2021-07-20 14:53:38","true","Multi-arch: Always push updated version-tagged img

Fixes #3365

Given a near daily release of Fedora updates, some addressing security
issues, it's safest for users to always have an updated version-tagged
image.  The cost of this is more image churn, but for a relatively small
image this should hopefully be a minor burden vs improved security.

Note: This is not a perfect solution, as there may be no
hard-dependencies between buildah and other packages with security
updates.  However it is an improvement over the previous regime where we
simply pushed the latest version-tagged image once, then never touched
it again.

Minor: Rename `gen_fqin` identifier to `reponame_reg` to be more
consistent with it's sister block `containers_reg`.

Signed-off-by: Chris Evich <cevich@redhat.com>",42,54,1,1
"containers/buildah","11802e600a5d8070f09c74b332dbe408e76e9150","vrothberg","2019-04-04 07:49:14","true","Merge pull request #1477 from nalind/created-by-shell

commit: always set created-by",52,26,0,1
"containers/buildah","4bd9f81f8c4984ed5e156958ee2bf508c438839e","danstiner","2019-04-14 05:38:05","false","Detect changes in rootdir

Fixes issue where `COPY . <dest>` would never detect changes by
using `filepath.Rel()` instead of custom string slicing.

Signed-off-by: Daniel Stiner <danstiner@gmail.com>

Closes: #1511
Approved by: rhatdan",53,27,0,0
"containers/buildah","ecd74746ccd5f9821fbcbe77c7fb454aba609f08","openshift-merge-robot","2021-10-31 09:58:44","true","Merge pull request #3598 from ashley-cui/envs

Add support for env var secret sources",32,57,1,1
"containers/buildah","0ade935ec426d768eacf040a2e45afaf12c66d12","openshift-merge-robot","2021-03-01 17:53:50","true","Merge pull request #3046 from containers/dependabot/go_modules/github.com/containers/storage-1.27.0

build(deps): bump github.com/containers/storage from 1.26.0 to 1.27.0",57,49,0,1
"containers/buildah","209337d0e369092fde5fc5a70337e0e77f91195b","openshift-merge-robot","2023-02-17 17:59:53","true","Merge pull request #4595 from flouthoc/clean-stage-without-run

executor: also add stage with no children to `cleanupStages` and ensure no dangling containers are left.",18,73,1,1
"containers/buildah","2f99c2e346d7228dea594d6537747b0ed95c3dab","openshift-merge-robot","2021-04-20 10:45:10","true","Merge pull request #3163 from rhatdan/crun

Do not force hard code to crun in rootless mode",50,51,0,1
"containers/buildah","eea866a186fed1cb410dbd2d1c18140948d6fecd","openshift-merge-robot","2022-01-20 16:09:30","true","Merge pull request #3724 from giuseppe/fix-runtime-lookup

linux: fix lookup for runtime",36,60,1,1
"containers/buildah","1d0dd78c38a2205ea44fe808e0783259832b12c9","marwatk","2022-10-26 21:07:16","false","Fix RUN --mount=type=bind,from=<stage> not preserving rootfs of stage

The lack of the preservation was probably an oversight when --mount was added for RUN.

I added a test that fails without the modification and succeeds with.

Fixes #4375

Signed-off-by: Marcus Watkins <mwatkins@mitre.org>",26,69,1,0
"containers/buildah","12a3abf6faa404d18c82419c4e279c056ad7c5b2","nalind","2017-06-28 15:40:28","false","Update to match newer storage and image-spec APIs

Update to adjust to new types and method signatures in just-updated
vendored code.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #174
Approved by: rhatdan",20,5,0,1
"containers/buildah","58e56e3efcd0b69e7e665e8e42b7fd6f234ee513","nalind","2017-05-15 17:31:54","false","Import container.{Config,HealthCheck},nat.PortSet

Import the container.Config and container.HealthCheck API types, and the
nat.Port and nat.PortSet types from go-connections.  Use the strslice
package from containers/image instead of rolling or importing our own.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #102
Approved by: rhatdan",10,4,0,1
"containers/buildah","77db7f959ee771b675a9ec1ea5eec222cc55b7d2","edsantiago","2019-12-11 23:21:51","false","BATS major cleanup: part 4: manual stuff

This is the manual part of the cleanup.

  - remove most 'buildah rm's from cleanup steps
  - remove unused variables
  - use expect_output when possible, not 'test [ x = y ]'
    - includes fixing some not-what-you-think-it-is uses
      of run_buildah | grep
  - be careful not to leave droppings in current directory

Special attention to:

  - authenticate.bats: create Dockerfile in temp dir, not pwd!
  - push.bats: remove broken output check
  - registries.bats: refactor, remove duplicate tests & code
  - rmi.bats: better checking of messages
  - secrets.bats: use TESTDIR (tmp), not TESTSDIR (/usr/share) !
    We don't want to leave droppings behind if we fail; this has
    bitten us before. And, since there's only one test, there's
    no need to override setup() / teardown(). Do setup inline,
    and take advantage of existing defaults.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2029
Approved by: rhatdan",86,34,0,1
"containers/buildah","d595739e05f827212b09e844cfded5f167fcf979","nalind","2020-10-01 17:39:33","false","ADD: only expand archives at the right time

When ADD was used to ADD a directory, the contents of archives that we
found inside of it were incorrectly being expanded at the destination
for the ADD.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",89,44,0,1
"containers/buildah","c11936323ab9333d0ef17ef4530388ff63b762b8","nalind","2017-06-07 13:39:33","false","Fix inspect/tag-by-truncated-image-ID

Teach inspect and tag about image IDs, truncated and otherwise.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #138
Approved by: rhatdan",13,4,0,1
"containers/buildah","0bbb076df8d67711ab9ac6b84316d62079fbd6b8","nalind","2017-02-24 20:14:52","false","Fix a copy/paste error in an error message

When we encounter an error parsing the target (new) image name during
""commit"", don't use the container's name in the error message where we
meant to mention the image's name.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","e792564b4ae8cc45c86170c0280832e874a2b639","rhatdan","2022-04-04 18:23:54","false","vendor in latest containers/common,image,storage

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",26,62,1,1
"containers/buildah","f6c2a1e24e9e1d8cb4ddb2fb321da17402fd84ef","rhatdan","2017-09-29 15:07:32","false","Make sure pushing ends up with CLI on a fresh new line

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #275
Approved by: rhatdan",31,8,0,1
"containers/buildah","718dac9d2c77e3d37f5bc4301f29c6c0370f7984","rhatdan","2022-08-01 18:38:32","true","Merge pull request #4153 from nalind/copy-paste

buildah-source-pull.1.md: fix a copy/paste error",18,66,1,1
"containers/buildah","d6f11ba7ad3ca8c224fb609cc1b280249fcee4fd","TomSweeneyRedHat","2019-10-10 18:01:38","false","Move runtime flag to bud from common

Move the runtime Cobra flag for the build command to the
command itself and out of the common definitions.  Podman
uses the same definition and there was a collision with that
flag and the one here: https://github.com/containers/libpod/blob/master/cmd/podman/main_local.go#L69

This caused wonky results.  The podman global flag would
think it had been set, but no value was captured, or reversely,
the flag didn't think it had been set, but if you peered inside
you'd see the appropriate value from the user input.
This was all based on whether you did
`podman --runtime=/usr/bin/runc build` or
`podman build --runtime=/usr/bin/runc`

As Podman uses their runtime flag in multiple places, it's
easier to remove it from the common definition here in Buildah
and then add the flag into the bud command.

Once merged and vendored into Podman, this will fix: https://bugzilla.redhat.com/show_bug.cgi?id=1758082

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1904
Approved by: rhatdan",69,32,0,1
"containers/buildah","b893112a90f428014d7cf7c577d27058cca01db8","rhatdan","2017-11-21 14:41:03","true","Merge pull request #328 from TomSweeneyRedHat/dev/tsweeney/baselinetest

Create baseline test script",31,10,0,1
"containers/buildah","ad49b24d0b1c376101e66fd662b18453be713d0d","boaz0","2018-01-23 15:27:32","false","Return a better error message when failed to resolve an image

During the creation of a new builder object there are errors
that are only logged into ""logrus.Debugf"".

If in the end of the process ""ref"" or ""img"" are nil and ""options.FromImage""
is set then it means that there was an issue.
By default, it was assumed that the image name is wrong. Yet,
this assumption isn't always correct. For example, it might fail due to
authorization or connection errors.

In this patch, I am attempting to fix this problem by checking the
last error stored in the ""err"" variable and returning the cause
of the failure.

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>

Closes: #406
Approved by: rhatdan",33,12,0,0
"containers/buildah","75dbed7c0142052bb584352122e3edaa2d1be04b","TomSweeneyRedHat","2019-05-02 23:13:43","false","Bump back to v1.9.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1571
Approved by: rhatdan",54,27,0,1
"containers/buildah","28f7884b7b8082546f1bde014f7e437af9c9c870","TomSweeneyRedHat","2022-02-03 21:27:13","false","Bump to v1.24.1

[NO TESTS NEEDED]

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",32,60,1,1
"containers/buildah","04ea0791308720d032fdf7f1efb55488ac633351","TomSweeneyRedHat","2017-12-01 15:42:57","false","Bump version to 0.9

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #345
Approved by: rhatdan",33,10,0,1
"containers/buildah","949709cd188ff6870e11603c0abbae4e71e11073","mtrmac","2019-02-21 22:35:51","false","Fix confusing variable naming in Pull

The result of ParseImageName(""docker://""...) is not a storageRef.

Should not change behavior.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","6468400446ec7e8f1a913cb50b6008b5849750e9","l0rd","2021-09-09 15:55:17","false","Update 05-openshift-rootless-build.md

Replace buildah ""build"" command with ""build-using-dockerfile""

Signed-off-by: Mario Loriedo <mario.loriedo@gmail.com>",38,55,1,0
"containers/buildah","d46d84e0dbc949eebf668cc807605f71dcafac42","cevich","2021-03-27 14:43:00","true","Cirrus: Make use of shared get_ci_vm container

Depends on:
    https://github.com/containers/automation_images/pull/57
    https://github.com/containers/automation/pull/64
    https://github.com/containers/automation/pull/66
    https://github.com/containers/automation/pull/67
    https://github.com/containers/automation/pull/68

Signed-off-by: Chris Evich <cevich@redhat.com>",51,50,0,1
"containers/buildah","5e40ba546f3856b93cbd75302539594291925fc2","saschagrunert","2020-11-02 09:22:43","true","Use osusergo build tag for static build

We now use the osusergo build tag to not use the glibc functions which
occur in the warnings but them from golang the os/user package.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>",67,45,0,1
"containers/buildah","c1a2d4f46f430dd486728f2f07b6e296129c1d4d","saschagrunert","2019-08-19 09:33:20","false","Fix directory pull image names

This is a breaking change and modifies the resulting image name when
pull from an directory via `oci:...` or `dir:...`.

Without this patch, the image names pulled via a local directory got
prefixed with `docker.io/{library/}`, which is not correct.

We now use either the full path to the image, or the relative path as
image name, but prefixed with `localhost` to indicate that the image is
not being pulled from a remote location.

Fixes: https://github.com/containers/buildah/issues/1797

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1800
Approved by: nalind",53,31,0,1
"containers/buildah","48546919595ca6d9cb1de6a92b145131c62ab583","openshift-merge-robot","2022-03-25 18:10:33","true","Merge pull request #3862 from TomSweeneyRedHat/bump-1.25.0

Bump 1.25.0",29,62,1,1
"containers/buildah","372f17593711f81b070174481ba65c213f3b4391","openshift-merge-robot","2021-11-18 12:39:28","true","Merge pull request #3621 from nalind/tutorials

docs/tutorials: update",28,58,1,1
"containers/buildah","2f4c5172feb96892733c67cc0c8fa8c2c42513dd","openshift-merge-robot","2021-10-06 18:41:03","true","Merge pull request #3548 from flouthoc/buildkit-mount-bind

build: Add support for buildkit like `--mount=type=bind`",43,56,1,1
"containers/buildah","c6ae250906f1d0ebc4d058f7932a5a5cded86a87","openshift-merge-robot","2021-03-16 20:12:58","true","Merge pull request #3077 from rhatdan/containerignore

Add documentation and testing for .containerignore",57,50,0,1
"containers/buildah","2a2ad0c49663dd60b40e0ad5d4ac94e648faded4","openshift-merge-robot","2022-04-07 00:19:35","true","Merge pull request #3902 from rhatdan/bud

Fix error check to work on Podman",24,62,1,1
"containers/buildah","25d7437d1daac853de33468dcfef4356fac78726","openshift-merge-robot","2022-09-13 21:07:53","true","Merge pull request #4241 from edsantiago/test_fix

Minor test fix for podman-remote",19,67,1,1
"containers/buildah","e00845797c9dde5ca37a78faf2da27287ed23bb7","TomSweeneyRedHat","2023-06-30 14:41:44","false","Bump to v1.32.0-dev

As the title says. In preparation for RHEL 8.9./9.3

[NO NEW TESTS NEEDED]

Signed-off-by: Tom Sweeney <tsweeney@redhat.com>",13,77,1,1
"containers/buildah","f7414d9b7d8b803c682103af6d847582aa99ec16","TomSweeneyRedHat","2021-01-27 00:53:51","false","Bump golang.org/x/crypto to the latest

Bump golang.org/x/crypto to the latest version to combat a
low risk CVE-2020-29652.  Will need to be cherry picked into
v1.19 too before vendorded into Podman.

Details:  https://bugzilla.redhat.com/show_bug.cgi?id=1910447

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",94,48,0,1
"containers/buildah","eb17c3364e138c2117ae544892023a2d829627a7","mtrmac","2019-01-02 20:06:52","false","Do not set OCIInsecureSkipTLSVerify based on registries.conf

- OCIInsecureSkipTLSVerify applies only to c/image/layout.Transport and
  c/image/archive.Transport; in both, ImageTransport.DockerReference
  always returns nil, which causes isReferenceSomething, and therefore
  isRegistryInsecure, to always return false; i.e., this code
  was never executed for those transports for which it could make a difference.

- The oci: and oci-archive: transports refer to local filesystems, so matching that
  against docker/distribution hostnames does not really make sense.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1255
Approved by: rhatdan",54,23,0,1
"containers/buildah","520c7815229c9ca470f24d58638a625cd2db5b1a","openshift-merge-robot","2021-02-06 09:34:24","true","Merge pull request #2973 from giuseppe/fix-userns-id-map-user

run: fix check for host pid namespace",92,48,0,1
"containers/buildah","473f89b00d9fdeb5a70cebbf8d31f4be91624893","openshift-merge-robot","2022-09-17 12:08:06","true","Merge pull request #4249 from flouthoc/skip-unused-stages

build: support `--skip-unused-stages` for multi-stage builds.",21,68,1,1
"containers/buildah","1c1fa111e4ccf9c214fa14acf532cb4ed90148a1","openshift-merge-robot","2022-11-23 09:55:48","true","Merge pull request #4432 from ashley-cui/cirrusm1

[CI:BUILD] Cirrus: Migrate OSX task to M1",18,70,1,1
"containers/buildah","5de32ade7ca56c631c275fba79c837868a5bc933","Luap99","2022-04-19 08:55:16","true","use etchosts package from c/common

Use the new etchosts package to generate the hosts file.
This will ensure that we use the same logic in podman and buildah.

New features are:
- no duplicated entries
- adds entries for the network/slirp4netns ips
- configure the host.containers.internal entry in containers.conf
- configure the base hosts file in containers.conf

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",26,63,1,0
"containers/buildah","f3a73b703806d9d0f529abacc7e3bc6038bbd728","dfr","2022-09-21 09:20:18","false","copier: work around freebsd bug for ""mkdir /""

This call to os.Mkdir got missed the first time I tried to add the
workaround for the FreeBSD EISDIR bug since I was only testing with
'buildah run'. Trying to use 'buildah add' triggers the same bug whan
trying to extract an archive into a container's filesystem.

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",21,68,1,0
"containers/buildah","1950ab687e79e76bb4c8dd64e45431cd782742ca","cevich","2023-01-11 16:14:48","true","Fix multi-arch manifest-list build timeouts

As of this commit, the build script runs the process on x86_64 hardware
(4cpus/8gig) using emulation for foreign architectures.  Due to various
delays, inefficiencies, and other emulation-related slowdowns, it's
possible for dnf to timeout and/or mis-measure a minimum repository
download rate.  Bump up the minimum download rate by 10x and timeout
interval by double.  This should allow the builds to complete more
consistently.

Signed-off-by: Chris Evich <cevich@redhat.com>",21,71,1,1
"containers/buildah","57bd81884c8feec3056da319720a24e892bef5dd","TomSweeneyRedHat","2019-12-27 16:02:47","false","Bump to v1.13.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2053
Approved by: rhatdan",97,35,0,1
"containers/buildah","d3c85f4c3a003542028b67539f5b8e1cddfadfe1","TomSweeneyRedHat","2019-05-02 20:08:32","false","Vendor Storage 1.12.6

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1567
Approved by: rhatdan",52,27,0,1
"containers/buildah","5294f0ab79e727d3069495f1151df9366fbf1cd6","TomSweeneyRedHat","2019-10-31 12:20:26","false","Update bud.bats test archive test

After #1955 merged, @edsantiago had suggestions for
tweaks to the test that was part of that merge.
This PR addresses those comments.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",82,33,0,1
"containers/buildah","1f4e75177037143adf91e7921b1391326108b863","EduardoVega","2020-11-18 14:50:53","false","Add U volume flag to chown source volumes

Signed-off-by: Eduardo Vega <edvegavalerio@gmail.com>",76,46,0,0
"containers/buildah","a4fb0ddb4978a908e9ecf33c6876808fb7c882f7","openshift-merge-robot","2022-01-11 20:38:07","true","Merge pull request #3703 from rhatdan/VENDOR

Update containers/image and containers/common",28,59,1,1
"containers/buildah","e53366b825ba96b665e514d2d848d5e60c56f78b","openshift-merge-robot","2022-03-30 17:41:48","true","Merge pull request #3881 from TomSweeneyRedHat/bump-1.25.1

Bump 1.25.1",27,62,1,1
"containers/buildah","c1740aefba891ea0210fc9d4bc40471bb94772f3","openshift-merge-robot","2021-04-22 19:51:28","true","Merge pull request #3179 from lsm5/remove-older-distro-install-steps

[CI:DOCS] Remove older distro docs",49,51,0,1
"containers/buildah","b669e4b50737329ad4a8d78c88b7b7cdbd26378e","openshift-merge-robot","2022-05-04 00:36:02","true","Merge pull request #3954 from rhatdan/VENDOR

Vendor in containers/storage v1.40.2",24,63,1,1
"containers/buildah","7bde7acc46069f372839db24caa26137c30cc354","openshift-merge-robot","2022-05-02 19:30:56","true","Merge pull request #3947 from flouthoc/process-arg-basemap

imagebuildah, executor: process `ARG` variables while populating baseMap",25,63,1,1
"containers/buildah","ee91e6b981299c4ba1db5a2b97012636e78eb78a","rhatdan","2017-08-15 15:55:45","false","Remove export command

We have implemented most of this code in kpod export, and we now
have kpod import/load/save.  No reason to implement them in both
commands.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #245
Approved by: nalind",27,7,0,1
"containers/buildah","4da1d5df5e66638b5f8007bdb7f39f9cb785f8c9","rhatdan","2019-09-05 14:28:10","true","Merge pull request #1838 from rhatdan/tmpdir

Set TMPDIR to /var/tmp by default",59,31,0,1
"containers/buildah","d0846b191409cc39afd2463121d3638ddc919d86","rhatdan","2018-09-27 02:23:37","false","Export buildah ReserveSELinuxLables so podman can use it

We want to make sure that buildah and podman don't use the
same SELinux MCS Labels.  So we need to export this function
so libpod can use it.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1041
Approved by: rhatdan",39,20,0,1
"containers/buildah","296a75255561b0c81065b3c38bfbc4d0115aeebc","rhatdan","2017-09-22 09:42:09","false","Cleanup buildah-rmi code

Part of the general buildah code cleanup.

1. Sort options so they are in alphabet order
2. Remove extra lines of code for options parsing that really do not accomplish anything.
3. Remove variables when they are not necessary, I.E. Don't create a variable to hold an
option that is only used once, use the option instead.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #267
Approved by: <username_without_leading_@>",34,8,0,1
"containers/buildah","cd501c0db281bdf1fd7983a27edbe5f4106462d7","rhatdan","2022-12-19 18:23:46","true","Merge pull request #4468 from flouthoc/ignore-symlink

parse: default `.containerignore` and `.dockerignore` must not point to symlink outside context",18,71,1,1
"containers/buildah","f72fa2ec0df77f4967995758f8cfc15307a07990","rhatdan","2022-10-13 15:51:56","true","Merge pull request #4333 from jlosito/fix-dependabot-ident

Fix ident for dependabot gha block",27,68,1,1
"containers/buildah","fb6da9916a4ae06f7935099452c0abe5422ded08","dfr","2022-08-04 16:15:23","false","Don't try to call runLabelStdioPipes if spec.Linux is not set

On FreeBSD, the Linux section of the spec is not populated. FreeBSD does
have a similar labelling facility in its MAC framework but that would be
better managed via a future addition of a FreeBSD section to the runtime
spec rather than trying to make it look like Linux.

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",18,66,1,0
"containers/buildah","61005c76bc1e4c35f62a0959b3cd26ec9d1c7abb","vrothberg","2022-03-17 08:36:42","false","buildah image: install cpp

Ship `cpp` with the Buildah container images to make sure that
preprocessing .in files works as expected and documented.

Fixes: #3822
Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",31,62,1,1
"containers/buildah","ab0295242d356d62df6ce70022be9299e03c3863","edsantiago","2021-10-04 12:51:32","false","tests: stop pulling php, composer

php and composer images (400MB and 185MB) were being used
unnecessarily. This sometimes caused flakes due to network
hiccups. Use busybox and libpod/testimage instead. (And,
tighten up the copy-from test).

Also -- oops! -- fix a nonworking expect_output. The
presence of '|' in ""blah blah ... <image|stage>""
was causing '=~' to match only 'stage>'. Escape the '|'
in all relevant places, and confirm there are no more.

Fixes: #3494

Signed-off-by: Ed Santiago <santiago@redhat.com>",44,56,1,1
"containers/buildah","23924afa06f7364b8021335ffd0054d8f5d40010","TomSweeneyRedHat","2021-05-19 21:58:27","false","Bump to v1.21.1-dev [NO TESTS NEEDED]

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",55,52,1,1
"containers/buildah","7276a6544cba9d0997db9b60e399630c451a39a5","rhatdan","2020-09-16 11:56:30","false","build(deps): bump github.com/containers/common from 0.21.0 to 0.22.0

Bumps [github.com/containers/common](https://github.com/containers/common) from 0.21.0 to 0.22.0.
- [Release notes](https://github.com/containers/common/releases)
- [Commits](https://github.com/containers/common/compare/v0.21.0...v0.22.0)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",91,44,0,1
"containers/buildah","17696b2aa315e8959bf452f1f62588d57aade2b1","TomSweeneyRedHat","2020-08-04 18:38:33","false","Update buildahimages readme

Updates the buildahimage README.md to document what
the settings of PATH, ENTRYPOINT and WORKDIR are within
the container images that are stored in quay.io.

Addresses: #1693

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",134,42,0,1
"containers/buildah","15e8c080f500b6b5713a0c425d0cd725948d3862","nalind","2020-01-28 18:48:00","false","getDateAndDigestAndSize(): use manifest.Digest

Use the image library's function for digesting manifests, so that we'll
compute and display the right values for docker_schema1 manifests.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #2118
Approved by: rhatdan",107,36,0,1
"containers/buildah","0d8a656f8234c4890b4f6069d03f1c904cba76e6","rhatdan","2018-08-15 19:01:29","false","Document STORAGE_DRIVER and STORAGE_OPTS environment variable

Default settings for storage can be overriden by setting these environment
variables.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #934
Approved by: TomSweeneyRedHat",26,19,0,1
"containers/buildah","1567db3fcb3aae0e4c2ac4eb556a41a9d24cab1a","nalind","2018-05-31 17:34:32","false","Run(): only collect error output from stdio pipes if we created some

If the runtime's ""create"" command fails, we try to collect error
messages from the pipes that we hooked up to its stdio in anticipation
of running a container without a TTY.  We should only bother with that
when the container isn't attached to a TTY, which is the only time those
pipe descriptor slices are populated, so that we don't panic when we try
to read an item from an empty slice.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #740
Approved by: rhatdan",42,16,0,1
"containers/buildah","49095a83f8622cf69532352d183337635562e261","artmello","2018-01-27 21:54:38","false","Add --prune,-p option to rmi command

Allows rmi to remove all dangling images (images without a tag and without a child image)
Add new test case

Signed-off-by: Arthur Mello <amello@redhat.com>

Closes: #418
Approved by: rhatdan",36,12,0,0
"containers/buildah","fd7ae759b9eeb7d6057954f142595e1ff774fe7c","nalind","2020-02-04 18:41:12","false","manifest add: always read the individual image manifest

Always read the manifest of the individual image that we're adding to a
list, so that we also read its MIME type.  When we weren't doing this
before, when we added an individual image from another list, we'd record
the type of that other list as the image's type.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #2140
Approved by: TomSweeneyRedHat",110,36,0,1
"containers/buildah","261e129c83e342c747a9468e7f7f8207839f98d9","nalind","2018-06-13 13:56:28","false","Separate stdio buffering from writing

When relaying stdio data to and from a container, separate the ""reading
and buffering from a read descriptor"" step from the ""relaying to a write
descriptor"" step, so that we can try to flush buffers that have data in
them even when there's no new data to be read.

Treat EAGAIN as a recoverable error when writing, since we're now able
to come back and try again later.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #787
Approved by: rhatdan",34,17,0,1
"containers/buildah","e0008f810f1c2e2600fc9e4cdf6e120293bc06eb","nalind","2017-04-20 14:52:22","false","Bump golang.org/x/text

Update the version of golang.org/x/text that we vendor.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",12,3,0,1
"containers/buildah","b405ca6551576a98fbc79ae8fe701246d1c7a4f0","openshift-merge-robot","2021-03-31 10:36:46","true","Merge pull request #3111 from containers/dependabot/go_modules/github.com/containers/common-0.35.4

build(deps): bump github.com/containers/common from 0.35.3 to 0.35.4",50,50,0,1
"containers/buildah","93d86062e9f51f147c77cf8b113282b36e6303ad","mtrmac","2018-06-11 23:36:23","false","Use the c/image conversion code instead of converting configs manually

Now that we have a types.Image available in Builder.initConfig, we can
let it do the heavy work of converting configs to the v2s2 and OCI formats.

This requires us to cheat a bit with c/image/types.InformationOnly, but it
works out fine.

AFAICS this should have equivalent effect to the previous implementation,
except:
- Conversion from OCI will no longer crash if ""Created"" timestamps are missing.
- Conversion from v2s2 to OCI only uses the Config field, not ContainerConfig.
  Considering the Docker deamon only ever uses Config for populating the
  configuration of newly created containers in (docker create), this seems
  good enough.  But, to be honest, I'm not quite clear on the purpose of the
  Config/ContainerConfig distinction in v2s2.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #776
Approved by: rhatdan",33,16,0,1
"containers/buildah","03b004224313654b7b8cc7f62bebe9a678afec24","rhatdan","2023-10-22 10:31:32","false","Use cutil.StringInSlice rather then contains

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",5,81,1,1
"containers/buildah","9b0dc9b29bf7c7877f57c8ccde3945aac21ed51e","rhatdan","2023-08-22 13:14:01","true","Merge pull request #4975 from nalind/clear-common-build-opts

Clear CommonBuildOpts when loading Builder status",8,79,1,1
"containers/buildah","eb135b8d5c022be3e38c54074201d3e46c62c186","Luap99","2023-06-15 09:48:42","true","vendor: update c/common to latest

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",13,77,1,0
"containers/buildah","fa847b179d88191002127c0344fed0a8258b2960","rhatdan","2023-05-16 14:30:21","true","Merge pull request #4793 from containers/renovate/github.com-openshift-imagebuilder-1.x

fix(deps): update module github.com/openshift/imagebuilder to v1.2.5",13,76,1,1
"containers/buildah","94b723cb5b70948efd282bd62ef07e8c7c04fdaf","TomSweeneyRedHat","2023-01-25 23:12:19","false","Bump to v1.29.0

As the title says.

[NO NEW TESTS NEEDED]

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",19,72,1,1
"containers/buildah","80f7b5f7537e95ed7bdf6fc08f54cc71cbf54e39","giuseppe","2021-12-20 08:10:41","true","build: fix libsubid test

libsubid changes its ABI in version 4.  Account for the different name
in the configure script.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",29,59,1,1
"containers/buildah","dfe404f3de8fef035ecfa1c70271de4a84e196a8","nalind","2021-04-06 21:48:25","false","CLI add/copy: add a --from option

Add a --from option to `buildah add` and `buildah copy`, mirroring the
option for the Dockerfile instruction.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",51,50,0,1
"containers/buildah","62dcf0c40cbfec695985f1dffef70515e3a719f4","giuseppe","2020-08-21 12:11:55","true","run: include stdout in error message

improve the error message by including the command stdout, if any.
Stderr is already handled.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",88,43,0,1
"containers/buildah","56481d2f955fa43ea3c3534f3cba6a01f9fd961c","rhatdan","2020-07-07 14:15:40","false","Rootless Buildah should default to IsolationOCIRootless

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",146,41,0,1
"containers/buildah","4fdcfc4f22aa65f184ee1789648757f1bfa225d7","TomSweeneyRedHat","2020-04-14 13:09:14","false","Add containers.conf to stablebyhand build

Add the containers.conf in the build process of the
""stablebyhand"" Containerfile which is used to build
a particular variant of Buildah by hand for use in quay.io.

The change for that is the ADD of the container.conf in
GitHub.com and emulates @rhatdan 's work in #2284

Also bumped the version to a more recent release while
I was in here.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",121,39,0,1
"containers/buildah","cca09881c31c8ee32ac87b1c8a76ddc6947c46c2","rhatdan","2020-02-07 17:54:18","false","Repair buildah so it can use containers.conf on the server side

In porting containers.conf to libpod, we found that buildah needed
to handle the containers.conf on the server side rather then from
the CLI.

Since the `podman-remote build` would probably not have the same content
as containers.conf on the server, the processesing of the defaults needs
to be handled in imagebuildah.  The CapAdd and CapDrop values need to be
passed in.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",111,36,0,1
"containers/buildah","7ea05189e249f3595d53b9ab75d12790994405f3","rhatdan","2018-09-07 13:35:23","false","Change references to cri-o to point at new repository

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #993
Approved by: TomSweeneyRedHat",36,19,0,1
"containers/buildah","2a962f177cb206dde5fc8e8d251bdfd80e2c9e52","nalind","2019-05-28 23:07:10","false","imagebuildah: fix handling of destinations that end with '/'

Don't lose track of whether or not the specified destination for an ADD
or COPY instruction ends with the path separator, which is important.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1620
Approved by: TomSweeneyRedHat",57,28,0,1
"containers/buildah","376eb73ab9be878a9ab92b17af28c01111fd9f97","rhatdan","2023-02-17 17:49:49","false","Add default list of capabilities required to run buildah in a container

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",18,73,1,1
"containers/buildah","af8fd4a8225af7030d5c38d92d1bdf94f31287b3","rhatdan","2019-06-14 03:05:41","false","Bump to v1.8.4

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",41,29,0,1
"containers/buildah","ae5f11e4512a9c2898ee0941829fc859614bebdb","flouthoc","2023-09-14 09:21:16","true","stage_executor: allow images without layers

`Docker` and `Buildkit` creates no layers when only `FROM scratch` is
used as content for building image, buildah must do the same.

Signed-off-by: Aditya R <arajan@redhat.com>",5,80,1,1
"containers/buildah","e7538b24689782265132e861816e85542eeca073","rhatdan","2023-08-11 08:42:13","true","Merge pull request #4958 from containers/renovate/major-ci-vm-image

chore(deps): update dependency containers/automation_images to v20230807",10,78,1,1
"containers/buildah","725fb9e46a65b951682ed3a5bbe3cdccd63276d7","rhatdan","2023-07-24 14:51:48","true","Merge pull request #4936 from containers/renovate/github.com-opencontainers-runtime-spec-1.x

fix(deps): update module github.com/opencontainers/runtime-spec to v1.1.0",12,78,1,1
"containers/buildah","c0be04e63f58cdbf1cdb75557f3906a40c6850dc","cevich","2022-06-24 14:27:52","true","[CI:BUILD] Install latest buildah instead of compiling

When building the multi-arch ""upstream"" flavor of buildah container
images, it's more optimal to use separate compilation and image
construction steps.  The image-build automation is time-limited,
and operating under a (slow) emulation environment.  So using a
continuously pre-built buildah RPM will also improve build
reliability.

ref: https://github.com/containers/buildah/pull/4062

Signed-off-by: Chris Evich <cevich@redhat.com>",21,65,1,1
"containers/buildah","08bd38f5f826f68b5b5dbd0a56f3caac37024b01","nalind","2022-05-02 22:40:01","false","help output: get more consistent about option usage text

Make more of our usage information in --help output consistent with
itself, i.e., initial lower case.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",24,63,1,1
"containers/buildah","267f3099116744c46b4fd57e5d06eba788b2735f","edsantiago","2022-04-26 13:47:03","false","Rename $TESTSDIR (the plural one), step 1 of 3

...refactor '--signature-policy .../policy.json' to $WITH_POLICY_JSON

Signed-off-by: Ed Santiago <santiago@redhat.com>",24,63,1,1
"containers/buildah","17d4de41af78c150a4ddcdc61636d21e959b5d43","openshift-merge-robot","2022-03-24 17:17:43","true","Merge pull request #3847 from edsantiago/cdo

[CI:DOCS] man pages: sort flags, and keep them that way",31,62,1,1
"containers/buildah","5fbfcf979478f3e1c5cf62120be1235ffd5925be","rhatdan","2021-09-13 20:36:55","false","Bump to v1.24.0-dev

[NO TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",39,55,1,1
"containers/buildah","68fd52cd11cfcc3a5317d94bed6c0a7aa988eb8a","openshift-merge-robot","2021-04-08 10:19:49","true","Merge pull request #3131 from hshiina/test-tls

Add authentication system tests for 'commit' and 'bud'",52,50,0,1
"containers/buildah","5b350b9a3fec8e11d16bc6a76da87b306d3a1c71","rhatdan","2021-02-05 15:20:18","false","Finish plumbing for buildah bud --manifest

Buildah bud --manifest XYZ was not working.

The manifest was never created. This PR Finishes
the plumbing and allows users to create a manifest
while building an image in one single command.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",96,48,0,1
"containers/buildah","2301d148da799e22eb0f5d45c5290cec97e3c9da","vrothberg","2021-02-08 10:59:39","false","--iidfile: print hash prefix

Prefix the image ID with the hash prefix when using `--iidfile` to be
compatible with Docker.  The absence of the hash can cause
docker-compose to error out.

Reported-in: github.com/containers/podman/issues/9260
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",93,48,0,1
"containers/buildah","bf41a3d70786f87f356eb1469d4f14374e70320f","nalind","2020-09-24 15:40:57","false","Makefile: tweak the cross-compile target

What `go tool dist list` says the toolchain supports changes, so this
change removes these attempted cross-compile build targets.
* GOOS=darwin, GOARCH unspecified
* GOOS=darwin, GOARCH=386

Replace our use of slices of
github.com/opencontainers/runc/libcontainer/configs.Device structures
with a locally-defined type alias so that we can avoid importing the
package on non-Unixy systems.  The result is not going to be a very
useful binary on non-Linux systems, but it helps ensure that our
subpackages won't break compilation for other projects who consume us as
a library.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",90,44,0,1
"containers/buildah","cf7de42d2fa07e6eba261a3f05f33d76ef8134a9","vrothberg","2020-09-17 13:14:54","false","tools: update git-validation to the latest commit

On behalf of @cevich who add fixes for the CI.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",92,44,0,1
"containers/buildah","e3da008aea5ddf55e9db937815b681b666881ef1","TomSweeneyRedHat","2020-07-22 21:06:01","false","Don't bind /etc/host and /etc/resolv.conf if network is not present

If there's no network present in the container, don't bind
the /etc/hosts file as any changes to from the caller will
be lost when run exits. Ditto the /etc/resolv.conf file.

Addresses: #2478

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",148,42,0,1
"containers/buildah","7c198d8581709a6cdcdad39b6e7b75bf6cfe7acd","cevich","2020-02-06 21:17:36","true","Cirrus: Add jq package

Signed-off-by: Chris Evich <cevich@redhat.com>",110,36,0,1
"containers/buildah","3b7295df342b732c18c8bbe8a49fca0184d701a6","nalind","2018-10-04 19:41:43","false",".papr.yml: log the podman version

If we're going to run .papr.sh under podman, log its version info.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1069
Approved by: rhatdan",51,20,0,1
"containers/buildah","733cd20dc2934dd7b6882e07c2fb3b1bc1a25bb5","giuseppe","2018-07-04 14:06:52","false","vendor: update containers/storage

Update to version 9cbb6cb3fc2044eae8b8fd8d8da081fe812858c4

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #846
Approved by: rhatdan",28,17,0,1
"containers/buildah","4874ad3365222f7f17f67490d8dd8af392232c53","nalind","2018-05-04 20:16:36","false","Run: set supplemental group IDs

In Run(), when the userspec doesn't specify a group, if the specified
user has supplemental group memberships, pass them along to the runtime.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",52,15,0,1
"containers/buildah","e3036da5f2b2704c19deeafa97cf26a35295b4c2","nalind","2018-04-17 17:00:04","false","Vendor github.com/containernetworking/cni v0.6.0

Vendor libcni, and sort the vendor.conf file.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #704
Approved by: rhatdan",31,15,0,1
"containers/buildah","80ea423b9db9b5f17f5c2607d79056eff9104401","nalind","2017-01-28 05:00:59","false","Add an initial configuration for Travis

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","2da8755d535133c82ea7526e1d54feb47e2356f7","madorn","2019-06-07 02:40:32","false","add -t to podman run

add -t to `podman run` so when user executes this step, they get excited when they see the output of `runecho.sh`.

Signed-off-by: Matt Dorn <mdorn@redhat.com>

Closes: #1651
Approved by: rhatdan",59,28,0,0
"containers/buildah","4b238191897472e1e60be640650b5cd418604545","TomSweeneyRedHat","2017-11-21 15:17:43","false","Touchup test scripts for some minor nits

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #330
Approved by: rhatdan",31,10,0,1
"containers/buildah","9fa477e303a5f5878e176be8c578cd4704910d7e","TomSweeneyRedHat","2017-11-19 19:27:38","false","Create baseline test script

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",30,10,0,1
"containers/buildah","dac78199bf11f426540181cdc8e2c4ebc5ca529c","TomSweeneyRedHat","2018-11-13 13:20:00","false","Bump min go to 1.10 in install.md

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1176
Approved by: rhatdan",62,21,0,1
"containers/buildah","df2a10d43f75eab2e6aae5b6d27e112e9df42a7c","TomSweeneyRedHat","2018-02-09 20:48:52","false","Add limitation to buildah rmi man page

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #464
Approved by: rhatdan",22,12,0,1
"containers/buildah","c1154c2314d8f47292efedd640687daae229607c","openshift-merge-robot","2023-07-05 11:37:05","true","Merge pull request #4907 from lsm5/packit-downstream-fix

[CI:BUILD] Packit: fix pre-sync action for downstream tasks",13,77,1,1
"containers/buildah","e3cdf313555ed794660d11a9100035220769f8ff","openshift-merge-robot","2021-03-17 09:25:57","true","Merge pull request #3079 from containers/dependabot/go_modules/github.com/sirupsen/logrus-1.8.1

build(deps): bump github.com/sirupsen/logrus from 1.8.0 to 1.8.1",58,50,0,1
"containers/buildah","2077dc0d943fde48edfbf8daddc95aa79fb4355b","openshift-merge-robot","2021-03-25 20:41:00","true","Merge pull request #3103 from rhatdan/bump-1.20.0

Bump 1.20.0",51,50,0,1
"containers/buildah","bc718ca758534a69fc35d93a4eab8fd42171d39a","openshift-merge-robot","2021-09-30 07:52:31","true","Merge pull request #3540 from rhatdan/log-level

Plumb the remote logger throughut Buildah",42,56,1,1
"containers/buildah","bc5ac09cefa1c52f81156f6e50e1cce6abd92c7f","openshift-merge-robot","2023-06-15 02:51:04","true","Merge pull request #4868 from containers/renovate/golang.org-x-sync-0.x

fix(deps): update module golang.org/x/sync to v0.3.0",13,77,1,1
"containers/buildah","8b1a490bda90830f71a562b57b7751ab441447e1","flouthoc","2022-10-27 19:28:05","true","test: fix preserve rootfs with --mount for podman-remote

`--quiet` on `podman-remote` will output only image id suppressing the
build output which is needed by the test, following commit makes test
function for `podman-remote`

Fixes: https://github.com/containers/buildah/pull/4380#issuecomment-1293848854

Signed-off-by: Aditya R <arajan@redhat.com>",24,69,1,1
"containers/buildah","37afb5dbc7fda40264c3a6d16432b2f806898136","flouthoc","2023-03-13 09:10:38","true","run: add support for inline --network in RUN stmt

Buildah should allow clients to support inline --network in RUN stmts so users
can create isolate or expose a particular build containers.

```Dockerfile
FROM alpine
RUN --network=host wget google.com
RUN --network=none wget google.com
```

Closes: https://github.com/containers/buildah/issues/4230

Signed-off-by: Aditya R <arajan@redhat.com>",16,74,1,1
"containers/buildah","9df6f62a4cc5c98633badd05b30f25b645d97b4d","anarcat","2017-12-11 16:13:17","false","add headings for different OSes

Signed-off-by: Antoine Beaupré <anarcat@debian.org>

Closes: #354
Approved by: rhatdan",32,10,0,0
"containers/buildah","9c808c76acf404f9f310aa2c2a53d2dab36a0f2e","dfr","2022-06-18 12:04:53","false","Move cleanableDestinationListFromMounts to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","216117c2d835677c99c58532cd48833dbc54840a","Luap99","2022-03-22 18:14:06","true","buildah: actually use containers.conf settings

Buildah ignores the container.conf settings. Commit 05d5d22dc6b7 tried
to fix this but I cannot see how this would have worked, there were also
no test added related to containers.conf.

The code below were we read the default just overwrites everything we
already set so the config settings are ignored.

Also there are many weird places were settings are just overwritten for
no particular reason. The namespaces code path looks like mess to me.
Namespaces are added/changed/removed in many different places and there
is no explanation why. Maybe I am just not familar enough with this code
base but I cannot really understand this. Hopefully a maintainer can
take a closer look to see if my changes are indeed correct.

Fixes containers/podman#13294

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",33,62,1,0
"containers/buildah","beafe558b4158f40de5747f81ee8a07ec5872472","vrothberg","2019-03-12 07:18:59","false","onsi/gomeage add missing files

It looks like the latest `vndr` wants to pull in more files than before.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1390
Approved by: rhatdan",36,26,0,1
"containers/buildah","4e1ca7c3705008cef14cab133599c829fbdc9907","vrothberg","2019-05-24 11:22:50","false","build context: support https git repos

Git repositories can also be cloned via http{s}, so add additional
checks for a "".git"" suffix.

Fixes: #1609
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1611
Approved by: TomSweeneyRedHat",54,28,0,1
"containers/buildah","1c684933e08c31942bde2f530fa1822675ec7403","edsantiago","2022-01-13 22:01:55","false","Enable git-daemon tests

...by bumping up the CI VM ID to ones that include the
git-daemon (Fedora) or git-daemon-run (Ubuntu) packages.

Reason: #3701 rewrote some tests to work around github
closing 'git://' protocol access... but those new tests
were simply being skipped.

Reference: https://github.com/containers/podman/issues/12851

Signed-off-by: Ed Santiago <santiago@redhat.com>",31,59,1,1
"containers/buildah","a35dbb28452367d3e341f460a06cd7679841d3b4","mathiasgredal","2023-03-06 16:28:55","false","Add ""ifnewer"" as option in help message for pull command

[NO NEW TESTS NEEDED]

Signed-off-by: Mathias Gredal <mathiasgredal@icloud.com>",17,73,1,0
"containers/buildah","b5fa96d2d98f3abb1b9593c157258f90e7843fbb","saschagrunert","2019-07-08 09:24:22","false","Improve tests/tools/Makefile parallelism and abstraction

Update the Makefile to be less repeatable in terms of targets to be
built. With that change, a parallel build of all targets is possible as
well, which has been changed in the CI too. A `clean` and `all` target
has to be added for convenience.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1710
Approved by: vrothberg",48,29,0,1
"containers/buildah","e56eb25575c7ecb10caf28eccc3d1d51af29902c","openshift-merge-robot","2023-02-01 19:23:22","true","Merge pull request #4550 from flouthoc/clean-cache-public-wrap

pkg/parse: expose public `CleanCacheMount` API",20,72,1,1
"containers/buildah","433098a0c563c4aeb3a1ecf37653419cb2822a98","openshift-merge-robot","2020-10-28 09:51:31","true","Merge pull request #2725 from giuseppe/fix-unmount-rootless-overlay

overlay: fix umount",66,45,0,1
"containers/buildah","51193932ce7e93bf15ddcc245cd3f340394e4152","openshift-merge-robot","2021-05-12 21:07:46","true","Merge pull request #3213 from cevich/fix_copyp_toctou

Fix copy race while walking paths",54,52,0,1
"containers/buildah","4e14ddfc393b3edeccf993ca906f3a28624b4efa","openshift-merge-robot","2022-11-04 15:08:11","true","Merge pull request #4403 from rhatdan/VENDOR

Update vendor of containers/(common, image, storage)",22,69,1,1
"containers/buildah","85bdc0086c28b13cc59a0d62558db126f4255d26","openshift-merge-robot","2021-04-22 14:47:28","true","Merge pull request #3174 from hshiina/version-test

Add system test of 'buildah version' for packaged buildah",49,51,0,1
"containers/buildah","ed2f047a02ab702c63f0e750e46de4431b0935b3","openshift-merge-robot","2022-12-05 18:52:25","true","Merge pull request #4444 from containers/dependabot/go_modules/golang.org/x/sys-0.3.0

build(deps): bump golang.org/x/sys from 0.2.0 to 0.3.0",17,70,1,1
"containers/buildah","dc3670b31590286da9e739b79722333d1060f3cd","openshift-merge-robot","2021-07-19 18:00:58","true","Merge pull request #3391 from rhatdan/dockerfile

[CI:DOCS] Just restore protections of shadow-utils",42,54,1,1
"containers/buildah","f4151372e5c91e3e3e5c0ed825cf6b5784cf8db8","TomSweeneyRedHat","2017-12-15 19:53:10","false","Create Tutorials menu and add link to README.md

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #367
Approved by: rhatdan",34,11,0,1
"containers/buildah","2e8668b591252606453ecee7f6d1d84527587e47","mtrmac","2021-06-17 17:38:49","false","Fix documentation of the --format option of buildah push

It affects all transports; and without --format, we try several manifest formats.

[NO NEW TESTS NEEDED]

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",40,53,1,1
"containers/buildah","6e48b7fe0e300f218342a97d96a961ff38219bf1","ashley-cui","2019-06-10 17:59:52","false","Add rootless podman with NFS issue in documentation

Signed-off-by: Ashley Cui <ashleycui16@gmail.com>

Closes: #1661
Approved by: vrothberg",43,28,0,0
"containers/buildah","ee1b6e25c8db40a93184b946d0b805fd93466d59","vrothberg","2019-06-17 12:04:06","false","util: remove redundant `return` statement

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",42,29,0,1
"containers/buildah","a72daebf51559352ca5a46066adc77aab5c926da","cevich","2020-01-30 15:58:55","true","Cirrus: Add standardized log-collection

Signed-off-by: Chris Evich <cevich@redhat.com>",106,36,0,1
"containers/buildah","e23314b1725544c4e4dd82afcfe2866e0fd2ddc5","TomSweeneyRedHat","2019-05-02 23:06:09","false","Bump to v1.8.2

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1571
Approved by: rhatdan",54,27,0,1
"containers/buildah","cf079d017a69404fcc29d91fbe23877631fa9a45","dfr","2022-06-23 10:34:29","false","Move setupMounts and runSetupBuiltinVolumes to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",21,65,1,0
"containers/buildah","e71191ef5b90107acebbad27d2bb382e6331fae1","rhatdan","2021-08-23 17:39:25","true","Merge branch 'main' into dependabot/go_modules/github.com/onsi/gomega-1.16.0",39,55,1,1
"containers/buildah","074a498ec0f3aa4d5a00e460d8e1b9d63c9373f3","rhatdan","2018-06-01 12:23:56","false","Print Warning message if cmd will not be used based on entrypoint

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #741
Approved by: TomSweeneyRedHat",42,16,0,1
"containers/buildah","2b57cef2bcc37b3b300cd85dbecc379146a1e8c7","rhatdan","2023-08-24 11:44:41","false","Use buildah repo rather then podman repo

The Podman repo changed and removed a subdir that this tests was relying
on.  Rather then relying on a different repo, it would be better to
stick to buildah repo for github tests.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",9,79,1,1
"containers/buildah","e6815a12a7399f08081e045f85e8462a19d081c3","rhatdan","2019-12-19 16:50:42","true","Merge pull request #2031 from rhatdan/fips-mode

Add support for FIPS-Mode backends",90,35,0,1
"containers/buildah","bf4420f25a2f5c75432598ea45b0f400d4cffd5d","rhatdan","2022-10-28 13:45:33","false","Remove quiet flag, so that it works in podman-remote

Currently podman tests has

skip_if_remote ""FIXME FIXME FIXME: 'Ignoring' warning is never seen"" \
               ""bud with preprocessor error""

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",24,69,1,1
"containers/buildah","f8c152694c1edce4b9b1d80d926f94226caab90c","rhatdan","2021-10-12 19:33:07","false","Add support for host.containers.internal in the /etc/hosts

Also switch default hostname from truncated ContainerID to Container
name.

It makes more sense that a user would know the name of the container
versus the generated id, so we should use this as a default.

Fixes: https://github.com/containers/buildah/issues/3509

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",41,56,1,1
"containers/buildah","c0d5a89a398ab544d5359dafd8a786dd34e58b20","TomSweeneyRedHat","2020-10-08 00:28:34","false","Verify userns-uid-map and userns-gid-map input

The format of the userns-uid-map and userns-gid-map fields must be
the form of a triple `ctrUid:hostUid:length` but we were not validating
that, doing a lot of useless processing, and then not even failing.

Addresses: #2676

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",61,44,0,1
"containers/buildah","1890491539c650249a900419a2505db9fd4b413f","TomSweeneyRedHat","2022-03-25 00:40:44","false","Bump c/storage to v1.39.0 in main

As the title says.  This is in preparation for the Fedora release.

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",31,62,1,1
"containers/buildah","88615e98bef56c6989d06b1ba6ac8a5971a8d623","cevich","2022-09-29 18:34:55","true","[CI:DOCS] Add quay-description update reminder

Signed-off-by: Chris Evich <cevich@redhat.com>",19,68,1,1
"containers/buildah","cbfae6b0f67e895a8792f57f7d3fd78632e9616b","nalind","2017-04-19 19:55:13","false","Bump github.com/docker/docker

Update our version of github.com/docker/docker.  Now that we've got #75
merged, we end up pulling in quite a bit less of it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",11,3,0,1
"containers/buildah","9bff989832444633ef8ec5b4a298bae67bab0642","nalind","2018-01-03 20:40:13","false","Use NewImageSource() instead of NewImage()

Use NewImageSource() instead of NewImage() when checking if an image is
actually there, since it makes the image library do less work while
answering the same question for us.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #381
Approved by: rhatdan",29,11,0,1
"containers/buildah","3707445bc53c916755f692da24e6479e4dabca0b","nalind","2017-02-10 16:50:59","false","Drop auto-GOPATHing, it's too fragile

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,0,0,1
"containers/buildah","23ed59594b94e6716d8cc5ec5427d1545e35dddd","nalind","2019-01-18 20:39:58","false","Add options for empty-layer history entries

Add configuration methods for adding entries which will show up in a
committed image's history, both before and after the new layer that we
add while committing the image.  Expose them from the CLI in the form of
a new --add-history option for the ""add"", ""config"", ""copy"", and ""run""
commands.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1300
Approved by: rhatdan",54,24,0,1
"containers/buildah","9edc2299485b62badb106aba417081d17958c83c","nalind","2017-03-20 20:30:01","false","commit: ""do-not-compress"" -> ""disable-compression""

Rename the ""commit"" ""--do-not-compress"" flag to be called
""--disable-compression"" instead.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","3ac12986e8cfa1d7bc1af4d0549b7f128dc676a3","openshift-merge-robot","2020-10-28 19:31:14","true","Merge pull request #2728 from vrothberg/overlay-ro-mount

overlay.MountReadOnly: support RO overlay mounts",66,45,0,1
"containers/buildah","124ef951ce206fde5a850a810b075764c266839e","edsantiago","2019-11-05 18:22:07","false","Prepwork: new 'skip' helpers for tests

Refactor many cumbersome BUILDAH_ISOLATION and 'which runc'
checks into common 'skip_if_{ chroot, rootless, no_runtime}'
calls.

This is in preparation for the next PR, which introduces
additional cgroups-v2 skips.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1965
Approved by: rhatdan",83,33,0,1
"containers/buildah","188269aaacab8d95c8b7e75773a0405cbd14da5b","edsantiago","2019-12-17 19:12:26","false","WIP: safer test for pull --all-tags

The 'pull --all-tags' test flakes often in CI, e.g.:

   unexpected http code: 500 [...] URL: https://auth.docker.io/...

This is a remote registry error, not one we can resolve
on our end without complex retry-pull logic.

Here is an alternative which I believe provides better
testing anyway: instead of relying heavily on a remote
registry, do all the work using our already-set-up local
one. Pull one image (yes, sigh, from remote registry)
and push it locally with various different tags. Then
pull with --all-tags and make sure we get what we expect.

Advantages:
  + less reliance on network & remote server
  + less reliance on the _setup_ of said server, i.e.
    we don't have to just blindly trust that there
    will be multiple tagged versions of an image
  + better testing: since we know what we push to
    the local registry, we know exactly what we
    should expect to see on pull, and we now
    actually test that instead of a handwavey
    ""oh just hope that there are more than three""
  + better testing of messages, and comparing image IDs

Disadvantages:
  - I've rolled two tests into one. (I'm not sure what the
    purpose was of pull-with-alltags-from-registry. Is the
    behavior that different?
  - In a development environment or some imaginary CI
    environment in which the local registry is persistent
    across runs, if someone were to remove one or more
    tags from the 'tags=(...)' list, tests would fail
    because the registry would include more tagged images
    (saved in a previous run) than the test expects. The
    diagnostic in this case would not be very helpful.

And of course, while I'm at it, improve a few of the other
tests: don't just check for error on non-docker --all-tags
pulls, actually make sure we get the expected message.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2032
Approved by: rhatdan",90,35,0,1
"containers/buildah","4e4ceff6cfc7b1aa9cfdd5dae73fd564688157e3","rhatdan","2017-09-08 11:56:11","false","Merge pull request #244 from rhatdan/unbuntu

Add build information for Ubuntu",33,7,0,1
"containers/buildah","dd98523b8ddcf3cd20a7d7c233655dc2d4849b30","rhatdan","2017-07-14 12:57:26","false","Add flag to remove containers on commit

I think this would be good practice to eliminate wasted disk space.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>
Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #189
Approved by: rhatdan",15,6,0,1
"containers/buildah","bf01a80b2b50061ab7dcb48439ff612f63838069","rhatdan","2017-12-11 18:00:57","true","Merge pull request #349 from TomSweeneyRedHat/dev/tsweeney/baseline2

Touchup baseline and rpm tests",33,10,0,1
"containers/buildah","068b6f5d63c6d9c6ecc7d45f934486b9df05fc60","rhatdan","2019-12-16 21:33:51","true","Merge pull request #2025 from containers/dependabot/go_modules/github.com/containers/common-0.0.5

Bump github.com/containers/common from 0.0.3 to 0.0.5",90,35,0,1
"containers/buildah","d6bf1d85535c72ccb5502b2271d50beb02c81c8f","ypu","2019-11-06 10:20:33","false","Tests: Add container name and id check in containers test steps

Add some checkpoint for checking container name and id inside
the tests.

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #2004
Approved by: rhatdan",82,33,0,0
"containers/buildah","af3dc0ad1b0ec5080aeffaa0b7572cd175296ccf","nalind","2021-04-27 18:52:17","false","bud.bats: fix a bats warning

We had two tests with the same name, and newer bats doesn't like that.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",49,51,0,1
"containers/buildah","1395e1805a1b2be0392e43a0a415923057b19d65","nalind","2018-03-07 23:11:43","false","Read UID/GID mapping information from containers and images

Read UID/GID mapping information when creating or importing containers,
and if there is mapping information, use it when building runtime
configurations.

Mounting sysfs in a user namespace requires that we also have our own
network namespace, so default to creating one for that case.

Switch permissions on files that we bind in so that they're writable
from inside of the container.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",20,13,0,1
"containers/buildah","81dfe0a964cf598459bd09fb7de5ad456a31d752","nalind","2018-01-03 20:40:55","false","When we say we skip a secrets config file, do so

When we warn about not processing a secrets configuration file, actually
skip anything we might have salvaged from it to make our behavior match
the warning.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #380
Approved by: rhatdan",29,11,0,1
"containers/buildah","0b51d4990a912e4f3133d5736375d7164b9a6102","nalind","2017-03-28 07:06:13","false","Add a build-using-dockerfile command

Add a build-using-dockerfile command (alias: bud) which uses
openshift/imagebuilder to wrap parsing and dispatching, and runc (or
another OCI runtime) to handle RUN instructions.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #59
Approved by: rhatdan",14,2,0,1
"containers/buildah","391a5bea0978beaa79a5582c87f4ff952876e9f0","nalind","2019-04-15 16:57:39","false","imagebuildah: only commit images for intermediate stages if we have to

In single-layer mode, if the stage's image isn't going to be used as the
basis for a later stage, and it isn't the final stage, don't bother
committing it.

In multiple-layer mode, if we're handling the final instruction for a
stage, and we've found a suitable image for the stage in the cache, if
the container's root filesystem isn't going to be used as the source for
a COPY --from instruction in a later stage, don't bother rebasing the
working container to match the image.

It turns out that the cache expectation is that we always produce an
image at the end of a stage, so remove the TODO comment that suggested
that we'd be able to skip it in some cases.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1517
Approved by: rhatdan",52,27,0,1
"containers/buildah","90e2caf9e920002c4a3789e2d6769c33bb716a5e","nalind","2019-02-25 18:38:40","false","imagebuildah: fix requiresStart/noRunsRemaining confusion

We were passing an inverted flag to ib.Run().  In practice, this didn't
cause any problems because it's used by imagebuilder to decide when to
start a working container, and we don't actually to do anything when it
asks us to do that.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",59,25,0,1
"containers/buildah","7b0718950f0e3621f58e87577e2b28162c8dfad8","nalind","2022-04-04 21:27:24","false","Remove a stray `\` from .containerenv

Start .containerenv with a blank line rather than a stray backslash.

[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",26,62,1,1
"containers/buildah","0817460525487aecdf181ff57ad7b851096063bd","nalind","2019-08-30 15:47:45","false","Update for manifest-lists API changes in containers/image

Update the blobcache implementation to match API changes to the image
library.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1902
Approved by: rhatdan",56,31,0,1
"containers/buildah","dfc4c676d027fcd702813af94e42b250d17209b5","nalind","2018-04-23 19:55:46","false","Always set mappings when using user namespaces

If we're creating a user namespace, we always need to supply at least
one mapping for the UID and GID maps.  If we're not given any mappings,
map the ranges that are available to us, instead of assuming we can map
all possible values, in case we're already in a user namespace.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",38,15,0,1
"containers/buildah","c48a459ea3d6223f30c0b153899754376c45777b","nalind","2023-10-04 20:59:52","false","Use the parent's image ID in the config that we pass to imagebuilder

When initializing imagebuilder's copy of the working container's
configuration, fill in the ID of the parent image where the type would
have one, instead of the name we used to find that image.

imagebuilder doesn't reference the field in the struct we're passing in,
so this change is really just about tidiness.

[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",6,80,1,1
"containers/buildah","9e129fd653c4a7dc447ce93455bb92c6e612eeb0","nalind","2017-04-12 16:13:00","false","fopenContainerFile: scope filename lookups better

Switch fopenContainerFile from using Stat/Lstat after opening the file
to using openat() to walk the given path, resolving links to keep them
from escaping the container's root fs.  This should resolve #66.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #313
Approved by: rhatdan",14,3,0,1
"containers/buildah","85ed96bb9217ceb3da83f20103622c7680a2cd95","nalind","2021-11-08 15:07:03","false","define.TempDirForURL(): show CombinedOutput when a command fails

When define.TempDirForURL() runs an external command, if it fails,
include the command's output in the error that's handed back to its
caller so that the end-user has some idea of what happened.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",29,57,1,1
"containers/buildah","07fda81df6e5d5206a69b0b0460f26439ce7b7a0","mtrmac","2023-04-22 00:27:25","false","Rename conflict to suffixDigitsModulo

to reflect a bit better what this does.

Should not change behavior.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",13,75,1,1
"containers/buildah","be78a490ac190241cef90b2c3588b002c9969a26","TomSweeneyRedHat","2018-09-25 16:07:23","false","Request podman version for build issues

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",37,20,0,1
"containers/buildah","ebe22cdbb9fd47d19e9978ca9b4a730f28f4794d","TomSweeneyRedHat","2022-02-03 21:38:22","false","Bump back to v1.25.0-dev

[NO TESTS NEEDED}

As the title says.

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",32,60,1,1
"containers/buildah","4131dfa38281fc32082e225e3be2a9255b0bc106","TomSweeneyRedHat","2020-01-26 00:42:54","false","Adjust copy destination for linked tar files in ADD

When we are given a linked tar file as a source file, we were setting the
destination to the original destination plus the name of the link.
This created a directory using the links name and then everything was
copied under that directory.  The link name should not be used as part
of the directory structure.

Fixes: #2102

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2112
Approved by: rhatdan",106,36,0,1
"containers/buildah","88301c85d41467fa038eed7324f7345b310c6a76","jmguzik","2021-02-23 23:14:04","false","buildah add/copy --chmod cli implementation for files and urls

Signed-off-by: Jakub Guzik <jakubmguzik@gmail.com>",62,49,0,0
"containers/buildah","795d43e60e5a1ab283981b79eeda1dd14a65a0bd","umohnani8","2018-11-07 08:48:30","false","Export resolvesymlink function

Didn't realize that ResolveSymlink is used in podman so
had changed it to an unexported function. Reverting these
changes.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>

Closes: #1163
Approved by: TomSweeneyRedHat",61,21,0,1
"containers/buildah","88f232405fbdb7a77a874de29b558b3921adc5ec","umohnani8","2018-05-16 16:37:39","false","Vendor in latest containers/image

Supports pushing images to docker-archive and oci-archive without
an image reference

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #697
Approved by: rhatdan",61,16,0,1
"containers/buildah","0ad0a8cd41f353961724a1602bfe1a4c1267b966","rhatdan","2023-09-14 14:48:48","true","Merge pull request #5043 from rhatdan/tmpdir

GetTmpDir is not using ImageCopyTmpdir correctly",5,80,1,1
"containers/buildah","5b8e7911805759068402fdc3f005414eaa6c8c59","rhatdan","2022-04-06 18:53:09","false","Fix error check to work on Podman

Podman prepends Error: before printing errors so need to ignore
beginning of error message.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",24,62,1,1
"containers/buildah","1deec7cee9aa4144c6a5d0474fb148b867937858","rhatdan","2022-09-30 16:26:50","false","No longer modify buildah.spec

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",20,68,1,1
"containers/buildah","6544c55416def69411d0a4a1e38f86673d06eaef","rhatdan","2019-04-02 17:41:03","false","Fix handling of Slices versus Arrays

Cobra does not allow a "","" in a StringSlice, so we should
be using StringArrays.  This fixes issues with setting
security-opts level flags.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1467
Approved by: TomSweeneyRedHat",50,26,0,1
"containers/buildah","13b03bfccc94f3f92453f20f5230c10a48f50450","rhatdan","2018-10-26 19:43:07","false","vndr in latest containers/storage

This version of containers/storage will allow us to use metadata copyup
in overlay file system.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1131
Approved by: rhatdan",50,21,0,1
"containers/buildah","e3130ea73064efa1e53674be34f76955460043ed","rhatdan","2021-01-25 19:28:57","false","Add Ashley and Urvashi to Approvers

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",94,48,0,1
"containers/buildah","3a6942ec9eb5b2b55d2d6ace893cccd9814e4fc1","rhatdan","2019-01-17 22:15:18","false","Add support for ADD --chown

Currently buildah support COPY --chown in a Dockerfile build,
but it ignores this flag if it is passed into an ADD.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1288
Approved by: vrothberg",51,24,0,1
"containers/buildah","515386e1a78ce8b68cc89cf075cb99fbbdf5422e","TomSweeneyRedHat","2017-10-30 19:23:56","false","Fix for rpm.bats test issue

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #303
Approved by: nalind",30,9,0,1
"containers/buildah","96a136eed8ac48adc2e4d00904b7ec026619b2d0","TomSweeneyRedHat","2019-08-10 18:18:52","false","Touch up go mod instructions in install

Add steps on how to use your own fork to vendor in code using go mod
to the install instructions.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1781
Approved by: rhatdan",53,30,0,1
"containers/buildah","4b658974d0404f0b58d74673a56a64febfa2467d","TomSweeneyRedHat","2022-02-16 17:15:54","false","Bump back to 1.25.0-dev

[NO TESTS NEEDED]

Bump back to 1.25.0-dev

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",27,61,1,1
"containers/buildah","b4b56f43a5424493ec2178670d774f036925ebe4","cevich","2021-05-21 18:39:06","true","Sync. workflow across skopeo, buildah, and podman

Besides adding ***BIG FAT WARNING*** this commit updates the
containers-repo. logic to only (and properly) handle the `stable` image
(both version and `latest` tags).  This change was already discussed at
length with @TomSweeneyRedHat.

Signed-off-by: Chris Evich <cevich@redhat.com>",55,52,1,1
"containers/buildah","c0f0efada218fefd6dae7fe01b90887e83969e92","mtrmac","2023-03-15 19:36:01","false","Update to Go 1.18

It is already required in practice, see
> grep 'func .*]('

This also renders the -compat=1.17 option to (go mod tidy)
unnecessary, so drop it.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",15,74,1,1
"containers/buildah","5c85dd8083a8b41246309fc8612e7d88b92ef40d","mhjacks","2022-06-27 15:37:43","true","Merge branch 'main' into main",21,65,1,0
"containers/buildah","d93c6886ac8646681cb1c40d386cf0b3e808f4f4","umohnani8","2018-07-19 18:25:47","false","Fix rmi to remove intermediate images associated with an image

buildah rmi now removes cached images associated with an image
when the image is removed only if the cached image is not required
by another image.
If an image is a parent and has a name then untag, otherwise return
an error stating the image can't be remoed as it has dependent
child images.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #871
Approved by: rhatdan",32,18,0,1
"containers/buildah","98ca81073e2618f75179d9356c5f7c6d4ad374f6","rhatdan","2017-07-13 13:14:41","false","Improve buildah push man page and help information

This better documents the options available to the user.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #186
Approved by: rhatdan",17,6,0,1
"containers/buildah","939de6f4d99c7696b07d2feebdb075c105fc92e1","rhatdan","2019-03-13 20:03:13","false","Allow rootless users to use the cache directory in homedir

Currently rootless podman attempts to write to /var/lib/containers/cache
and fails. This causes us to repeatedly push images that have already been
pushed.  This cache directory should be relative to the location of containers/storage
and not always stored in the same directory.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1411
Approved by: TomSweeneyRedHat",36,26,0,1
"containers/buildah","eae3415b1e8b334b6447e1dc55e4202689617a82","rhatdan","2022-09-30 16:25:28","false","Bump to v1.28.1-dev

[NO TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",20,68,1,1
"containers/buildah","de7f480a273b80138ab3615919c05f3f53f36019","isimluk","2018-12-11 08:35:52","false","Refactor: Use library shared idtools.ParseIDMap() instead of bundling it

Signed-off-by: Šimon Lukašík <isimluk@fedoraproject.org>

Closes: #1232
Approved by: rhatdan",50,22,0,0
"containers/buildah","5fa3c0bd3fbceca38b6ad2f8a893bc918a8a514a","TomSweeneyRedHat","2018-08-23 17:49:36","false","Restore rootless isolation test for from volume ro test

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1093
Approved by: rhatdan",33,19,0,1
"containers/buildah","168894435e95076bf8bd28b8e6a879d332af35c3","openshift-merge-robot","2021-02-25 19:13:14","true","Merge pull request #3039 from rhatdan/login

buildah login and logout, do not need to enter user namespace",58,49,0,1
"containers/buildah","08de1f95cbaca3d7664a9157dffba022e2bb8ed7","openshift-merge-robot","2022-02-03 21:17:17","true","Merge pull request #3757 from flouthoc/buildkit-platform-attemp-2

stage_executor: Add support for inline `FROM --platform=` within Containerfile/Dockerfile",34,60,1,1
"containers/buildah","25473ec2ba73612b3a2422a87246945b83a96f28","openshift-merge-robot","2023-09-07 18:04:58","true","Merge pull request #5032 from nalind/abspaths

Make sure that pathnames picked up from the environment are absolute",4,79,1,1
"containers/buildah","61de02b0fe407551e17382114fcf82b607732b3a","flouthoc","2023-11-02 05:46:48","true","image: replace GetStoreImage with ResolveReference

replace deprecated GetStoreImage -> ResolveReference

Signed-off-by: Aditya R <arajan@redhat.com>",2,81,1,1
"containers/buildah","e6eb05f757fe6faa72196eb6f0a3fef91d036cc6","flouthoc","2022-11-17 11:10:12","true","mount=type=cache: seperate cache parent on host for each user

`mount=type=cache` creates a common cache directory on host in temporary
directory, split this cache directory for each user invocation in order
to prevent overlapping of cache content when `buildah` is invoked by
different users on same host.

Signed-off-by: Aditya R <arajan@redhat.com>",23,70,1,1
"containers/buildah","7a4702ae256575e9bd466f75745bf10297d2104b","flouthoc","2022-12-15 12:20:03","true","parse: default ignorefile must not point to symlink outside context

Drop support for remote use-cases when .containerignore or .dockerignore is a symlink pointing to arbitrary location on host.

[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",17,71,1,1
"containers/buildah","e6b6c9fc2d8d90f817b17a790a7b077fbe48ef7a","umohnani8","2018-04-29 22:36:35","false","Validate host and container paths passed to --volume

Print proper error message if the host or container paths
are relative paths. Only absolute paths are allowed.
Fix the buildah run documentation for the --volume flag
and add an example.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #643
Approved by: rhatdan",51,15,0,1
"containers/buildah","dfba70e9b98688d140296ec9eafabe934cf4c624","flouthoc","2022-07-29 12:03:37","true","test: manifest inspect should have OCIv1 annotation

Signed-off-by: Aditya R <arajan@redhat.com>",18,66,1,1
"containers/buildah","c06c6dbbb23e049809e92f56ece1dd59b3894512","slp","2022-06-09 11:16:12","false","chroot: use ActKillThread instead of ActKill

Replace libseccomp.ActKill use with libseccomp.ActKillThread, as the
first is going to be deprecated.

Signed-off-by: Sergio Lopez <slp@redhat.com>",22,64,1,0
"containers/buildah","2efb6cc5551d2dc346c4726a9414554d8241e9ff","TomSweeneyRedHat","2021-01-16 17:11:35","false","Reset upstream branch to dev version

Reset back to v1.20.0-dev for the upstream branch.
Any 1.19.* releases should come out of that release branch.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",94,48,0,1
"containers/buildah","ae1b14cd4cc7a7d4d14f6caec429116a360c89fb","TomSweeneyRedHat","2018-08-15 16:07:10","false","Add container PATH retrieval example

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #932
Approved by: rhatdan",25,19,0,1
"containers/buildah","4b22fc5c20e0552ace6b350e50ee57d59e1acc61","openshift-merge-robot","2022-01-08 14:50:47","true","Merge pull request #3590 from flouthoc/buildkit-mount-from

buildkit: add `from=` field to `bind` and `cache` mounts so images can be used as source",27,59,1,1
"containers/buildah","d428d72b83ce23da8959a105d99d5f71b9a269ef","openshift-merge-robot","2022-03-28 12:57:49","true","Merge pull request #3870 from flouthoc/no-cache-and-layers

build: allow `--no-cache` and `--layers` so build cache can be overrided",29,62,1,1
"containers/buildah","80743a7102339597d1fae455b7c3b7105d69bd49","openshift-merge-robot","2022-02-03 22:59:17","true","Merge pull request #3770 from TomSweeneyRedHat/bump-1.24.1

Bump 1.24.1",33,60,1,1
"containers/buildah","e8a1501a4a933c11e20fc24607a67471b3f6e19b","openshift-merge-robot","2021-03-16 11:13:32","true","Merge pull request #3081 from rhatdan/master

Lookup Containerfile if user specifies a directory",58,50,0,1
"containers/buildah","13f58da5ec80dda813317923d407614887adc459","openshift-merge-robot","2022-02-02 02:22:51","true","Merge pull request #3759 from rhatdan/VENDOR

Update vendor of containers/storage and containers/common",35,60,1,1
"containers/buildah","6dbf218fde8e8d48659f7370241ed77ef835093c","openshift-merge-robot","2021-07-27 15:13:44","true","Merge pull request #3403 from containers/dependabot/go_modules/github.com/containers/storage-1.33.0

build(deps): bump github.com/containers/storage from 1.32.6 to 1.33.0",38,54,1,1
"containers/buildah","e62277eabc31d075d4f5b8f303ee7b3950e41953","edsantiago","2021-05-13 21:08:35","false","WIP: tests: new assert()

This is much scarier than I had intended. The intention is to
start migrating from 'expect_output' and to use 'assert'
instead; the reason is that 'assert' allows much more
flexibility, particularly negative tests.

We've long wanted something like ""assert that output does
not contain 'foo'"". I've been too lazy to implement it,
but last week I noticed code in bud.bats that does:

    ! expect_output ""sdfsdfsdf""

This is a really super bad idea: although it works fine when
things are good and tests pass, it's a disaster when tests
fail because the poor person debugging test output now sees
a test failure log, and starts tracking it down, and then
much later realizes that it was an intentional failure but
the '!' was negating it, and all that track-down work was
wasted.

To keep this PR reasonable, I'm keeping all positive uses
of expect_output untouched. We can migrate those (if desired)
over time. All negative uses are now assertions.

Signed-off-by: Ed Santiago <santiago@redhat.com>",55,52,1,1
"containers/buildah","79bc4a3888de4cf88c158c0a012594dfcc2a3276","nalind","2022-07-21 21:29:11","false","Don't bother telling codespell to skip files that don't exist

The Makefile was telling codespell to skip files that have been moved
around or renamed.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",19,66,1,1
"containers/buildah","25d89b42892d9c9bbe4ba5da9e918c892fbf7b12","nalind","2018-08-20 20:04:26","false","Test HEALTHCHECK

Test the HEALTHCHECK Dockerfile instruction, and that we can use
`buildah config` to control those settings.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #943
Approved by: TomSweeneyRedHat",27,19,0,1
"containers/buildah","8f08ca71f9d71a0e5e9514c39d52635e4fd318c0","nalind","2021-04-27 19:11:04","false","imagebuildah: replace archive with chrootarchive

Use the chrootarchive package in places where we where using its
non-chrooted counterpart before.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",49,51,0,1
"containers/buildah","3160f5479e11e87216a68e3f9adb2151a36e00dd","nalind","2018-08-02 18:24:48","false","chroot: make the resource limits name map module-global

Move the resource limits name map out of the setRlimits() function, and
use it to set up a reverse of the same map in init().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #891
Approved by: rhatdan",29,18,0,1
"containers/buildah","3104ddf0ac559047206a383e1de3c973bcc24a0e","nalind","2019-05-30 00:27:06","false","imagebuilder: pass the right contextDir to Add()

When we're adding content, call the builder's Add() method for each
source item in turn, so that we can pass in the appropriate ContextDir
and Excludes values for them.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1626
Approved by: TomSweeneyRedHat",57,28,0,1
"containers/buildah","98c4e0d970b5a2c4fa9852401cdffca83c17886e","nalind","2017-07-10 20:30:06","false","Don't panic if an image's ID can't be parsed

Return a ""doesn't match"" result if an image's ID can't be turned into a
valid reference for any reason.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #217
Approved by: rhatdan",17,5,0,1
"containers/buildah","03fae014c3b39bdad05fd3e708218d8d5430fb44","nalind","2019-02-19 22:14:10","false","imagebuildah: check for unused args across stages

Check for unused arguments across all of the stages of a multi-stage
build.  They can only be passed to us once for the whole build, so we
shouldn't treat it as an error if a given stage doesn't reference all of
them.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1427
Approved by: rhatdan",59,25,0,1
"containers/buildah","0191bc6710f63d885faa2fa88602b4d57e305efd","Luap99","2023-09-12 12:35:12","true","Split GetTempDir from internal/util

With this pkg/parse does not depend on libimage.

[NO NEW TESTS NEEDED]

Based on Miloslav's work: https://github.com/containers/podman/pull/19718

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",5,79,1,0
"containers/buildah","3c65f172332f2567de96974a196754811d49a42b","kolyshkin","2022-01-18 02:34:35","false","tests/e2e/buildah_suite_test.go: fix gosimple warnings

> tests/e2e/buildah_suite_test.go:166:27: S1025: the argument's underlying type is a slice of bytes, should use a simple conversion instead of fmt.Sprintf (gosimple)
> 	fields := strings.Fields(fmt.Sprintf(""%s"", s.Out.Contents()))
> 	                         ^
> tests/e2e/buildah_suite_test.go:173:12: S1025: the argument's underlying type is a slice of bytes, should use a simple conversion instead of fmt.Sprintf (gosimple)
> 	output := fmt.Sprintf(""%s"", s.Out.Contents())
> 	          ^

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","8af2dc4ea4d6dbaa3e787cf045dd084eb4594d98","rhatdan","2023-07-31 17:39:32","true","Merge pull request #4912 from flouthoc/replicate-zstd

manifest, push: implement `--add-compression` to push with compressed variants.",14,78,1,1
"containers/buildah","36298707333a680981338bd05bfaf9683af23d78","rhatdan","2023-07-24 14:50:31","true","Merge pull request #4938 from containers/renovate/github.com-containers-image-v5-5.x

fix(deps): update module github.com/containers/image/v5 to v5.26.1",12,78,1,1
"containers/buildah","9b65b12ae5a622004d6e46cb952ba8cefa48e904","nalind","2023-06-01 14:57:40","false","At startup, log the effective capabilities for debugging

Log the set of effective capabilities at startup, to make
troubleshooting permissions problems in containers just a little easier.

[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",16,76,1,1
"containers/buildah","d4c661a7746fd8e309bfa0b0b5fd7d13d05846ed","rhatdan","2022-11-04 11:04:16","false","Add no-new-privileges flag

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",23,69,1,1
"containers/buildah","eb9f3648bbc2087e9ecadb7c6220eca6ab84eb2d","edsantiago","2022-10-17 12:42:56","false","pr-should-include-tests: allow specfile, golangci

Make the pr-should-include-tests check more consistent with
podman: allow changes to buildah.spec.rpkg and .golangci.yml

Also, remove the check for ""NO TESTS NEEDED"". That was a
workaround for a bad design decision I initially made.
The correct wording is NO **NEW** TESTS NEEDED, and nobody
should ever use NO TESTS NEEDED.

Signed-off-by: Ed Santiago <santiago@redhat.com>",27,69,1,1
"containers/buildah","13e77e13e822546793634c8b4e607c78cd194a11","openshift-merge-robot","2022-06-06 12:08:07","true","Merge pull request #4036 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.5

build(deps): bump github.com/containerd/containerd from 1.6.4 to 1.6.5",23,64,1,1
"containers/buildah","e347e88e02bae77b57a2bafb1431d18cdf92115c","edsantiago","2022-04-26 14:03:44","false","Rename $TESTSDIR (the plural one), step 3 of 3

...rename all remaining instances to $TEST_SOURCES

Signed-off-by: Ed Santiago <santiago@redhat.com>",24,63,1,1
"containers/buildah","a9351b260a18c6fcdbaf9773e16eb8af1ac258e8","abergmeier","2022-01-12 19:14:46","false","Allow processing of id options from FlagSet

In situations where you don't want/need Cobra climbing behavior nor
Cobra at all using FlagSet is the easier sell.

Signed-off-by: Andreas Bergmeier <abergmeier@gmx.net>",30,59,1,0
"containers/buildah","55d25805d333349827b295899f6e474c58860b1f","openshift-merge-robot","2021-08-23 17:31:22","true","Merge pull request #3472 from containers/dependabot/go_modules/github.com/opencontainers/runc-1.0.2

build(deps): bump github.com/opencontainers/runc from 1.0.1 to 1.0.2",39,55,1,1
"containers/buildah","796a04cc1c2f6e966ae3c242444e5b1e60a643c7","zturtleman","2021-03-27 22:08:56","false","Fix URL in demos/buildah_multi_stage.sh

A spelling correction in c7963db changed the URL to a 404 error
page. The actual URL has a typo in it so revert to the misspelling.

Closes #3107

Signed-off-by: Zack Middleton <zack@cloemail.com>",51,50,0,0
"containers/buildah","c13f7e3c7950b8b41e1aba38480fc6e65b74fd19","rhatdan","2021-03-25 17:16:45","false","Bump to v1.20.1-dev

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",51,50,0,1
"containers/buildah","a6eeca7a6510a7fd8ca03e691bd516df3ea47ae3","openshift-merge-robot","2021-02-17 11:52:37","true","Merge pull request #3003 from vrothberg/stale-bot

add stale bot",60,49,0,1
"containers/buildah","52c07811f346f31aff3c3eaab8f5ec7abf9fcc27","nalind","2020-08-19 16:57:18","false","in_podman: don't get tripped up by $CIRRUS_CHANGE_TITLE

We don't handle passing environment values that contain whitespace
through to tests that we run inside of podman, so we need to screen out
$CIRRUS_CHANGE_TITLE from the list of variables we try to pass in via
the command line.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",87,43,0,1
"containers/buildah","aad1fc58785d1334c30942962484d5a782a9c3f4","nalind","2020-07-14 20:22:49","false","CompositeDigester: add the ability to filter tar streams

Rework CompositeDigester so that it can handle type """".
Add a newTarFilterer() inspired by imagebuilder's, that we'll be able to
use to adjust headers before digesting them.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",147,42,0,1
"containers/buildah","3ee85876b105c5f2eebc969fbbecd13a53bda179","TomSweeneyRedHat","2020-04-02 14:06:03","false","Bump back to v1.15.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",113,38,0,1
"containers/buildah","7ca961ea49922cc2a271ea051000a8fd27673da0","nalind","2020-02-19 21:30:54","false","Clear the right variable in buildahimage

These Dockerfiles attempted to ensure that the
_BUILDAH_STARTED_IN_USERNS variable was set to an empty value, but the
variable that we check was changed to _CONTAINERS_USERNS_CONFIGURED some
time ago.

The logic that checks for the variable, though, treats it not being set
and being set to an empty value the same way, so we needn't bother
setting it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",99,37,0,1
"containers/buildah","cb3252e822ef8700eebbce5a1a85af34ea15ec8f","cevich","2020-02-07 20:30:05","true","Bors: Fix no. req. github reviews

I misinterpreted the meaning of this setting.  It's not the number of
different people that need to 'bors r+'.  It's counting the number
of approvals in the github review mechanism.

Signed-off-by: Chris Evich <cevich@redhat.com>",111,36,0,1
"containers/buildah","2959a6b8fc479dd762a28d7b3d5016938edfd136","rhatdan","2019-12-19 13:31:43","true","Merge pull request #2022 from rhatdan/tmpdir

Set the TMPDIR for pulling/pushing image to $TMPDIR",91,35,0,1
"containers/buildah","4e03c80a0bf213fd2d7f9ca0c9934c4fb40ae4d6","nalind","2019-10-31 19:16:38","false","unmarshalConvertedConfig: avoid using the updated image's ref

The image returned by UpdatedImage() doesn't have a reference, so
attempting to include the result's name in an error message causes a
crash.  Assign it to a temporary variable first so that we can use the
name of the un-updated version in an error message.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1960
Approved by: TomSweeneyRedHat",82,33,0,1
"containers/buildah","20f2cb9dbe779c9c25c956c9bcc35deb45662070","nalind","2017-02-10 19:45:06","false","Fix a number of issues flagged by golint

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,0,0,1
"containers/buildah","a0d394af74387fedb862efb933c31a86db40d07e","nalind","2017-02-24 20:18:35","false","Try to import containers that we didn't create

When we're given the name of a container on the command line, make every
command that attempts to open an in-progress build container fall back
to creating a new build configuration file for the specified container
if the container exists but wasn't originally created for a build.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","8ceda286a764e07248e3753b2a919802d5241b6f","nalind","2019-03-19 02:54:29","false","imagebuildah: reorganize stage and per-stage logic

Move the preparation for the first container and the commit of the final
image in a single-stage build into the per-stage Execute() function.

For multi-stage builds, only create a layer for ADD, COPY, RUN, and the
final instruction in a stage, which changes the step counts that we
output.

Stop removing the final image for intermediate stages, since they're
expected to be present as cached images, even if they don't end up as
ancestors of the final image, except for single-stage builds, which we
document as not populating the cache.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1473
Approved by: rhatdan",37,26,0,1
"containers/buildah","0d83d9ebfaae00694112c48c60bc248c93909ab7","nalind","2017-03-17 21:46:21","false","Pull required flag values from the arguments list

When flags that we'd require be specified aren't, if there are command
line arguments, use their values as flag values.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","17205fb88c99a4277c00d1d4ea38518f1f11bb24","rhatdan","2018-09-28 05:38:06","true","Merge pull request #1036 from umohnani8/multi

Clear intermediate container IDs after each stage",39,20,0,1
"containers/buildah","8f61fb2e3b12a5d47d912fbb9027339a33264cbc","siretart","2021-08-29 19:23:27","false","corrected man page section; .conf file to mention its man page

Added as Debian distro patch.

[CI:DOCS]

Original-Author: Dmitry Smirnov <onlyjob@debian.org>
Signed-off-by: Reinhard Tartler <siretart@tauware.de>",35,55,1,0
"containers/buildah","d61c38cb2a6f0af7d7b5eea8eda296d42bc35d96","lsm5","2020-11-17 20:30:29","false","update docs for debian testing and unstable

Buildah is now present on debian testing and unstable so providing Kubic
repos for it can lead to conflicts. Better to mention only the official
repos to avoid confusing end users.
Related: https://github.com/containers/buildah/issues/2797

Also, provide installation steps for Ubuntu 20.10 and newer, and redirect
Raspberry Pi OS users to Debian installation steps to
avoid content duplication.

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",77,46,0,1
"containers/buildah","34275f4a17defa4839383b4051161fc507060847","vrothberg","2019-06-18 11:13:34","false","rmi: avoid redundant branching

We already checked that `image != nil` in line 107, so let's safely
remove the branch and make the code easier to read.

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","5d76b9d2c386e75a580358fdd22f4d1132f3faf4","lsm5","2021-04-23 15:01:03","false","[CI:DOCS] Update steps for CentOS runc users

use dnf --refresh option to set metadata expired before
running the install.

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",50,51,0,1
"containers/buildah","0229dd0c0885d691a97f75cd14cde39d32b24b49","vrothberg","2019-03-07 12:37:02","false","vendor latest openshift/imagebuilder

openshift/imagebuilder had a dependency on a deprecated package that is
now forked into imagebuilder to allow using more recent versions of
docker/docker.

Also vendor the latest docker/docker to a) demonstrate that imagebuilder
does not force using an old version docker/docker and to b) pull in
fixes and updates to our dependencies on docker/docker.

See https://github.com/openshift/imagebuilder/pull/125 for more details
on the imagebuilder change.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1390
Approved by: rhatdan",63,25,0,1
"containers/buildah","45543bf9b296304dc6fd1f1a2070f42ad34e66d4","edsantiago","2020-01-06 15:43:20","false","buildah bud --volume: run from tmpdir, not source dir

PR #2039 broke system tests, because they're installed in /usr:

   # buildah bud -v /usr/share/buildah/test/system:/testdir:rw,z /usr/share/buildah/test/system/bud/mount
   ...
   error building at STEP ""RUN mount"": error resolving mountpoints for container ""173c5e567e95f2604b5ea677f5e5364839d5b455a9081cdb4101f20242997e5e"": relabeling ""/usr/share/buildah/test/system"" failed: relabeling content in /usr is not allowed

Solution: mount a volume from TESTDIR (singular), which is in TMPDIR,
not TESTSDIR (plural), which is our test source dir.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2065
Approved by: vrothberg",100,35,0,1
"containers/buildah","ca65736da931b196596847bd69a0a0483f833875","edsantiago","2022-10-06 12:13:34","false","bud.bats refactoring: $TEST_SCRATCH_DIR, part 1 of 2

Hundreds of instances of scary duplication. All fixed with
this script:

   #!/usr/bin/perl -n -i
   use v5.20;

   our $contextdir;
   #      1   12     3     3                     24                          4
   if (m!^(\s+)(mkdir(\s+-p)?\s+|cp\s+-[aR]\s.*\s)(\$\{TEST_SCRATCH_DIR\}/\S+)\s*$!) {
       $contextdir = $4;
       print ""${1}local contextdir=$contextdir\n"";
       print ""${1}${2}\$contextdir\n"";
       next;
   }
   elsif (/^\}/) {
       $contextdir = undef;
   }
   elsif ($contextdir) {
       s!\Q$contextdir\E!\$contextdir!g;
   }
   print;

...which is imperfect, hence the need for a two-part commit.

Signed-off-by: Ed Santiago <santiago@redhat.com>",27,68,1,1
"containers/buildah","78a13f11190b4542181dfd1c2fd3c25d4e026460","kwshi","2021-06-16 18:21:48","true","man pages: clarify `rmi` removes dangling parents

Signed-off-by: Kye Shi <shi.kye@gmail.com>",39,53,1,0
"containers/buildah","43c7bf7d106592be10fa478d8a3354499222de10","mtrmac","2018-12-04 21:57:04","false","Move saveStream and putBlob near blobCacheDestination.PutBlob

This does not change a single line of the two functions, committed
separately to make reviews of actual changes easier.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1218
Approved by: rhatdan",46,22,0,1
"containers/buildah","1254c5bf5eb93f080f0bf3c8bb98ace18312d5ed","nalind","2018-03-28 18:14:57","false","API cleanup: PullPolicy and TerminalPolicy should be types

Make the PullPolicy field in BuilderOptions structures and the the
Terminal field in RunOptions their own types.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #705
Approved by: rhatdan",24,14,0,1
"containers/buildah","8d772ab21cb28f41891b94a7a7b89df0f24fa748","nalind","2019-03-25 20:28:19","false","CommitOptions: drop the redundant Store field

The Builder object already keeps a pointer to the Store that holds its
container, so a second value that could be different is just confusing.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1444
Approved by: TomSweeneyRedHat",39,26,0,1
"containers/buildah","b537e19e8a8bfdeacad17a43e5a16257393d5033","nalind","2019-06-03 19:55:30","false","bud.bats: add a test for WORKDIR and COPY with absolute destinations

Add an extra test to ensure that we don't mistakenly treat absolute
destination paths for COPY instructions as being relative to WORKDIR.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1638
Approved by: TomSweeneyRedHat",59,28,0,1
"containers/buildah","46c395a44e11f5d26dd078491264d268cf5737ee","nalind","2018-06-26 03:38:03","false","Run(): try to resolve non-absolute paths using $PATH

Try to resolve commands which aren't given as absolute paths using the
$PATH environment variable and the mounted rootfs.  If we don't have a
configured $PATH, add one.

We can't resolve symbolic links with absolute values reliably without
using chroot(), so we just take it on faith that a link, or a non-link
with the execute bit set, will work.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #820
Approved by: rhatdan",28,17,0,1
"containers/buildah","d00be0fbbdd73d60b9fb69ca973cfb984885b17f","nalind","2017-03-23 21:39:00","false","Merge pull request #31 from nalind/copy-file

Teach ""copy"" to allow copying to a destination file",12,2,0,1
"containers/buildah","a74add5b50709864d68db4bb745c6f0cdd4d47d3","flouthoc","2021-12-14 10:53:26","true","stage_executor: re-use all possible layers from cache for squashed builds

Re-use all the layers from cache for squashed case and commit as late as possible

Current implementation of marking for re-use of cache `commits` on every
`stage` when used with `--squashed` however we should try to re-use as
many layers are possible if `--layers` is specified and `commit` only on
`last instruction` of `last stage` to perform final squash.

Also treat all other layers as if they are being written for regular
build and write them cache.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",31,58,1,1
"containers/buildah","a2c8358455f9b6a254c572455af2a0afcfcec544","rhatdan","2018-07-18 15:49:09","false","Vendor in latest containers/image and containers/storage

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #869
Approved by: rhatdan",32,18,0,1
"containers/buildah","6a0b00555b0f263a4f1a839105c1c9a365e85b18","rhatdan","2018-10-12 19:07:20","true","Merge pull request #1074 from TomSweeneyRedHat/dev/tsweeney/1.4

V1.4 Release Announcement",54,20,0,1
"containers/buildah","1f372c08acab1c6aad68a5fd3931c44da862677b","rhatdan","2022-11-04 12:50:40","false","Update vendor of containers/(common, image, storage)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",23,69,1,1
"containers/buildah","708a672f453fc379d66108a2b69dbcc0877ba82a","rhatdan","2023-06-14 11:13:31","true","Merge pull request #4866 from containers/renovate/golang.org-x-crypto-0.x

fix(deps): update module golang.org/x/crypto to v0.10.0",13,77,1,1
"containers/buildah","c80e6a3119f7b11fb5da658b9d8f3991675adf42","rhatdan","2022-05-14 10:58:34","false","Add --cpp-flag flag to buildah build

Allow users to pass in CPP flags to the C Preprocessor.

Fixes: https://github.com/containers/buildah/issues/3816

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",27,64,1,1
"containers/buildah","4cb8e2e67d47d2385d0d8097214ed322123057a3","rhatdan","2019-02-26 22:05:59","false","UPdate gitvalidation epoch

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1372
Approved by: TomSweeneyRedHat",61,25,0,1
"containers/buildah","c6ae5c5a0c5f82d94ec5024c404970065aa9b846","giuseppe","2019-03-19 20:08:02","false","rootless: by default use the host network namespace

if --net is not specified, default to use the host network namespace.

It is still possible to use slirp4netns with --network container.

Closes: https://bugzilla.redhat.com/show_bug.cgi?id=1690209

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1421
Approved by: rhatdan",37,26,0,1
"containers/buildah","460d03fdedc437bbd0135d0184d38cc70533b43b","openshift-merge-robot","2021-04-22 06:06:33","true","Merge pull request #3162 from rhatdan/tag

Output names of multiple tags in buildah bud",50,51,0,1
"containers/buildah","0c953351fb1e5d1a422d23321c4ef6a2aa15f6f4","rhatdan","2022-09-29 18:02:39","true","Merge pull request #4301 from containers/dependabot/go_modules/github.com/opencontainers/selinux-1.10.2

build(deps): bump github.com/opencontainers/selinux from 1.10.1 to 1.10.2",20,68,1,1
"containers/buildah","cfb3372985533411fe91249c5162e6a82a13fe20","openshift-merge-robot","2021-01-12 17:04:02","true","Merge pull request #2903 from nalind/default-bic

Stop overriding the location of the blob info cache",93,47,0,1
"containers/buildah","bed25d00cc65965d85a6bbc6447255a5777635d0","openshift-merge-robot","2022-01-26 00:47:44","true","Merge pull request #3720 from Luap99/networks

buildah build --network add support for custom networks",34,60,1,1
"containers/buildah","42eaf2f0e8db7ce10db12afdb017e65be79b8af5","openshift-merge-robot","2023-09-14 12:27:49","true","Merge pull request #5045 from rhatdan/codespell

Run codespell on code",5,80,1,1
"containers/buildah","9eb048a8b3c02fd5e946a01d72a4facf6c1700bc","openshift-merge-robot","2021-02-09 15:22:32","true","Merge pull request #2983 from containers/dependabot/go_modules/github.com/containers/common-0.34.2

build(deps): bump github.com/containers/common from 0.33.1 to 0.34.2",94,48,0,1
"containers/buildah","ca578b290144d13977699e6823b61d5ef78ca64f","openshift-merge-robot","2022-12-19 20:16:00","true","Merge pull request #4474 from containers/dependabot/go_modules/github.com/docker/docker-20.10.22incompatible

build(deps): bump github.com/docker/docker from 20.10.21+incompatible to 20.10.22+incompatible",18,71,1,1
"containers/buildah","bec005d17d1051771e5dc7ce5763c66829334cda","openshift-merge-robot","2020-12-21 13:36:30","true","Merge pull request #2866 from containers/dependabot/go_modules/github.com/opencontainers/selinux-1.8.0

build(deps): bump github.com/opencontainers/selinux from 1.6.0 to 1.8.0",84,47,0,1
"containers/buildah","70d75de22cd29076aca53aa93a8eb2f87fd4fd5f","openshift-merge-robot","2023-03-02 11:24:38","true","Merge pull request #4578 from flouthoc/copy-arg-process

executor,copy: honor default ARG value while eval stage in `COPY` stmts",19,73,1,1
"containers/buildah","5621727519baaf701b76ebe4c45d2170f18f0837","flouthoc","2023-04-26 12:21:34","true","makefile: increase conformance timeout

increase conformance timeout from `30min` -> `60min`.

[NO NEW TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",12,75,1,1
"containers/buildah","4f272ee498a4bccbe059c43b05d5974412e63931","mtrmac","2022-09-06 23:08:48","false","Update tests for error message changes

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",18,67,1,1
"containers/buildah","5946d06cb4023abe9a4e3dc67e4d98aef55ba137","mtrmac","2019-02-21 23:20:36","false","Use a types.ImageReference instead of (transport, name) strings in pullImage etc.

Use a typed value, to hopefully decrease further temptation to process strings
manually, and to avoid the unnecessary alltransports.ParseImageName which
resolveImage has already called.

This may change the strings used in some error/debug messages, which
now use transports.ImageName instead of the original input; the strings
should by definition have the same semantics.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","e797267a8a13234288602370edbf491592b23bea","openshift-merge-robot","2022-01-14 12:06:17","true","Merge pull request #3711 from edsantiago/enable_git_daemon

Enable git-daemon tests",31,59,1,1
"containers/buildah","669ffddd999061976a98e1c05ebcdd42065188fc","umohnani8","2018-02-22 17:12:59","false","Vendor in latest containers/image

Fixes the naming issue of blobs and config for the dir transport
by removing the .tar extension

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #489
Approved by: rhatdan",18,13,0,1
"containers/buildah","1d331172f9d11cf2a98079d6ab0285bb1509f021","cevich","2020-02-06 18:21:27","true","Cirrus: Fix lint + validation using wrong epoch

Signed-off-by: Chris Evich <cevich@redhat.com>",110,36,0,1
"containers/buildah","dbd5a32d6c110977b9b72eb4869431d01f91a99f","cevich","2021-05-13 14:48:26","true","github: Fix bad repo. ref in workflow config

Signed-off-by: Chris Evich <cevich@redhat.com>",54,52,1,1
"containers/buildah","797e618cbe2f91c84dc416b3de4ebda4f2079cae","mtrmac","2019-10-01 20:03:57","false","Update c/image to v4.0.1

This requires updating all import paths throughout.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1891
Approved by: vrothberg",65,32,0,1
"containers/buildah","bb50b8cb07619b4e0ff68411432674a237b0692b","TomSweeneyRedHat","2018-09-17 12:43:21","false","Add signature policy to push tests

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1020
Approved by: rhatdan",37,20,0,1
"containers/buildah","fcc05b7d6032e8b0d442cab64e504dd107ecc9e4","TomSweeneyRedHat","2019-06-14 22:08:18","false","buildah-run: fix-out-of-range panic (2)

Fix an out-of-range panic in buildah-run by moving the call to
setNonbloc() to the appropriate place (i.e., only when the copyPipes
parameter is set).

Replaces #1672.  Needed to make two smaller functions to make gofmt
happy.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1674
Approved by: rhatdan",41,29,0,1
"containers/buildah","67c2e4de596072fc3c5773a47057d451a6219cff","Luap99","2022-12-15 15:30:08","true","buildah: wrap network setup errors

User may get confusing error messages were it is not clear that they are
related to the network setup, wrap the error to make it more clear that
some network setup failed.

[NO NEW TESTS NEEDED]

Fixes containers/podman#16809

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",17,71,1,0
"containers/buildah","ead5834988da94b397752a87572e7f9d2da99b4c","openshift-merge-robot","2022-10-16 10:39:28","true","Merge pull request #4341 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.9.0

build(deps): bump github.com/fsouza/go-dockerclient from 1.8.3 to 1.9.0",27,69,1,1
"containers/buildah","00fe346f6a6e8a20957eb53b8663472305b50190","Luap99","2022-03-09 14:04:21","true","tests/copy: read correct containers.conf

`DefaultConfig()` from c/common/pkg/config should not be used here.
This only contains the built in defaults but not the actual values from
the files on disk. The correct way is to call `Default()` and since this
already handles the `CONTAINERS_CONF` env var we do not need to handle
it manually.

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",30,61,1,0
"containers/buildah","87f6c19079b53220f91dfe2159b77ae005e6a721","giuseppe","2022-02-14 09:05:35","true","Makefile: build with systemd when available

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",29,61,1,1
"containers/buildah","7d7617670c062842ded6cb2fe2007d5fd10f61fb","kolyshkin","2022-01-20 02:18:14","false","tests/tools: bump go-md2man to v2.0.1

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","8b190feacae7ba692084bb981203571bfbbd0264","kolyshkin","2022-01-20 03:21:12","false",".github/dependabot.yml: add tests/tools go.mod

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",33,60,1,0
"containers/buildah","e62df2b67a402ab4dd7897e6d5a5a6991115ef0e","flouthoc","2021-08-09 19:57:08","false","Adds GenerateStructure helper function to support rootfs-overlay.

Following function generates a permanent overlayfs struct as compared to tempdir.

[NO NEW TESTS NEEDED]

Signed-off-by: flouthoc <flouthoc.git@gmail.com>",37,54,1,1
"containers/buildah","e36bc7bde026573f5325d363da23a6e7e5dc87c3","saschagrunert","2021-08-02 08:06:10","true","Accept repositories on login/logout

We now synchronize the behavior with Podman and accept repositories
during login and logout per default.

[NO NEW TESTS NEEDED]

Signed-off-by: Sascha Grunert <sgrunert@redhat.com>",35,54,1,1
"containers/buildah","b7197a1e100f275621903b182d65efc61f713676","rhatdan","2021-03-03 21:10:38","false","Set upperdir permissions based on source

We are setting the permissions based on the dest dir rather
then the source dir.  Since we want this to work identical to a bind
mount, we need to have the permissions align.

There is also an issue where overlays on existing mounts is blowing up.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",60,49,0,1
"containers/buildah","021ae2f64aaaf1731f9384b064a39a7e2bd59b98","ashley-cui","2021-02-16 21:02:40","true","Merge branch 'master' into history",61,49,0,0
"containers/buildah","d5326efbb28b562bee19ec61134e2a17be1187f8","openshift-merge-robot","2021-02-16 14:17:26","true","Merge pull request #3000 from giuseppe/enable-volatile-containers

buildah: use volatile containers",62,49,0,1
"containers/buildah","181cf84b85187afeed280e4c5381f934be13fc90","rhatdan","2020-09-08 19:15:16","false","Pass timestamp down to history lines

Currently we are not setting the timestamp on the history lines.
Even though this does not effect the image timestamp, these lines
should match the other content in the previously created images.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",84,43,0,1
"containers/buildah","e613e90e321155c26bf34693dbecfa23a71488f1","giuseppe","2020-08-21 11:59:41","true","run: use the correct error for errors.Wrapf

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",88,43,0,1
"containers/buildah","9fc9a222e7c09268aa2f8f002be2054b6b1ccef0","nalind","2020-08-06 17:16:02","false","conformance: add a test for COPY from subdirectory

Make sure we test copying from a subdirectory of the build context to a
new directory.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",89,42,0,1
"containers/buildah","0d7d2a002140872e426a570952704dbf44ec437e","nalind","2020-04-23 18:15:17","false","imagebuildah: stages shouldn't count as their base images

When initializing a build stage, don't assume that the working container
will be useful for COPY instructions in subsequent stages that reference
the image that we're building FROM.

When locating previously-completed stages referenced in COPY
instructions in later stages, be consistent about requiring that those
stages need to have been completed before we can accept them as
alternate contexts for the sources being copied.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",130,39,0,1
"containers/buildah","d9d173e66c86d8b2bf6753086d84d00310e3afd6","lsm5","2020-03-23 17:12:47","false","update install steps for Amazon Linux 2

Fixes: #1921

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",113,38,0,1
"containers/buildah","fa21ea49386c9860b3d1233750f8ef5fa132fda3","rhatdan","2020-03-21 11:20:11","false","Fix .dockerignore with globs and ! commands

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",111,38,0,1
"containers/buildah","31fe9bee9f2240e2243c69e23af8f910457ae477","nalind","2020-02-17 18:56:52","false","getDateAndDigestAndSize(): handle creation time not being set

The image creation timestamp that we get back as part of the result
structure from github.com/containers/image/types/Image.Inspect() can be
unset (i.e., nil), since it's optional in the OCI image spec.  This
means we should check that the creation timestamp isn't a nil pointer
before attempting to dereference it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",101,37,0,1
"containers/buildah","20820d718423f963be33b74d243582dc08c8d872","nalind","2020-02-04 16:40:03","false","manifest push: add --format option

Add a --format option, which takes the same values as the --format
option for `buildah push`, to `buildah manifest push`, for cases where
we need to override the default.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",110,36,0,1
"containers/buildah","a32fc96b10a6e59a5fc35bf12581c7bd86451c1c","rhatdan","2019-09-30 20:06:36","true","Merge pull request #1885 from containers/dependabot/go_modules/github.com/etcd-io/bbolt-1.3.3

Bump github.com/etcd-io/bbolt from 1.3.2 to 1.3.3",65,32,0,1
"containers/buildah","855b85989564342b5e60f0dc29f27e08f962b566","rhatdan","2018-06-27 12:23:46","true","Merge pull request #824 from nalind/caplists

Add Capabilities lists to BuilderInfo",28,17,0,1
"containers/buildah","18f3e8724eba663ecca7b8bb2a3eedc3751588a1","rhatdan","2020-12-18 11:37:59","false","Switch references of /var/run -> /run

Systemd is now complaining or mentioning /var/run as a legacy directory.
It has been many years where /var/run is a symlink to /run on all
most distributions, make the change to the default.

Partial fix for https://github.com/containers/podman/issues/8369

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",82,47,0,1
"containers/buildah","f4a5511e837c9ddd0e5c3d2fb57c9926dff5abc7","rhatdan","2017-07-17 20:19:31","false","Only print heading once when executing buildah images

The current buildah images command prints the heading twice, this
bug was introduced when --json flag was added.

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #195
Approved by: rhatdan",18,6,0,1
"containers/buildah","78205846e49de0848c30e29401ad6ad05b72ae23","rhatdan","2020-11-13 22:06:01","false","Vendor in containers/storage v1.24.0

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",75,45,0,1
"containers/buildah","8da4cb463bc2729e168ac0c4f094952704ef3101","rhatdan","2019-07-18 01:29:07","true","Merge pull request #1726 from nalind/update-runc

Update to runc v1.0.0-rc8",48,30,0,1
"containers/buildah","47d8b19df7bc3567f371be8a182b7579e6d16660","rhatdan","2019-01-17 11:44:50","true","Merge pull request #1284 from TomSweeneyRedHat/bump-1.7-dev

Bump 1.7-dev",50,24,0,1
"containers/buildah","0766b004bbb999462ea4e73065684e078edc9a03","flouthoc","2023-05-26 07:16:10","true","executor: apply label to only final stage

In https://github.com/containers/buildah/pull/4673 we made a change were
we were applying labels to end of each stage, which is different than
what we were doing before i.e applying label at the end of the each
step.

However buildkit does not adds label to any stage or steps it only adds
label at the end of final stage so lets do that.

Closes: https://github.com/containers/buildah/issues/4804

Signed-off-by: Aditya R <arajan@redhat.com>",18,76,1,1
"containers/buildah","3107b50f50aaf4a407ff8ac9cb140acb945e6cb1","openshift-merge-robot","2022-05-17 12:17:52","true","Merge pull request #3998 from flouthoc/fix-secret-reuse

run: allow re-using secret artifact from host in new `RUN` steps.",25,64,1,1
"containers/buildah","6d5d1aed0db9f91a1f4681dffd63214af5a2136f","openshift-merge-robot","2021-06-22 15:49:07","true","Merge pull request #3323 from jacobwgillespie/json-output

Add --json flags to `mount` and `version` commands",36,53,1,1
"containers/buildah","9cdde41b2e26d9cfd82bbe51b4420119bd90b33c","openshift-merge-robot","2021-03-10 09:03:49","true","Merge pull request #3043 from TomSweeneyRedHat/dev/tsweeney/uuid-man

Clarify userns options are usable only as root in man pages",58,49,0,1
"containers/buildah","eb42398a1ca7f54317d354424d0a776323fafd5f","openshift-merge-robot","2021-02-24 11:18:18","true","Merge pull request #3025 from caiges/fix-no-instruction-stages

Fix reaping of stages with no instructions",62,49,0,1
"containers/buildah","a970ffb97e708a966985a221cea4ec021350fd63","openshift-merge-robot","2020-10-15 20:51:55","true","Merge pull request #2694 from rhatdan/wrap

Stop excessive wrapping",61,45,0,1
"containers/buildah","d5c503c86c23efa502b11833f32921586d54f84b","openshift-merge-robot","2021-02-23 21:33:27","true","Merge pull request #3033 from rhatdan/isolation

Isolation strings, should match user input",61,49,0,1
"containers/buildah","47625a9bd43ec8973be3b31ce835bfb43b4764f0","cevich","2021-02-22 19:21:45","true","Cirrus: Temp. disable prior-fedora (F32) testing

In anticipation of F34beta support, preemptively disable testing on
""prior-Fedora"". This will allow development to move forward without
a soon-to-be-EOL distro. holding anything back.

Signed-off-by: Chris Evich <cevich@redhat.com>",61,49,0,1
"containers/buildah","4b7c61d5da39423f659ec6695a34f9b9f6058454","dfr","2022-06-23 10:55:14","false","Make the various run mounts work for FreeBSD

Signed-off-by: Doug Rabson <dfr@rabson.org>",21,65,1,0
"containers/buildah","dbebeb7235671e809e43991aba11bc7d7d076b6e","nalind","2017-04-12 17:31:34","false","Never use host methods for parsing USER values

Drop fallbacks for resolving USER values that attempt to look up names
on the host, since that's never predictable.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #313
Approved by: rhatdan",14,3,0,1
"containers/buildah","fba62fd0a206569a8fb70dd4f6fc352310e91b2e","nalind","2019-10-31 19:18:10","false","Handle configuration blobs for manifest lists

When the base image or an image that we're inspecting is a reference to
a manifest list, resolve it to a runnable image instance, then try to
read the configuration blob from the runnable image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1960
Approved by: TomSweeneyRedHat",82,33,0,1
"containers/buildah","3d3911a1c9e7f86eecc505e2ddce534c2829c12b","nalind","2019-06-05 21:51:14","false","imagebuildah: tighten up cache checking

Tighten up cache checking even further.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1647
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","42c991b1ab48dc09a3bbd8ffd6ccfc7f64d2b7f5","nalind","2018-06-19 19:51:19","false","Add Capabilities lists to BuilderInfo

Add the DefaultCapabilities, AddCapabilities, and DropCapabilities lists
to BuilderInfo structures.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",30,17,0,1
"containers/buildah","3fb7522dc3340579d6e2c438e82f64d19a3a8ff4","giuseppe","2022-02-14 09:05:46","true","run_linux: use --systemd-cgroup

when the configured cgroup manager is set to ""systemd"", use the
--systemd-cgroup option to the OCI runtime.  It is understood both by
crun and runc.

Closes: https://github.com/containers/buildah/issues/3700

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",29,61,1,1
"containers/buildah","34fdd93b2fe38d9c4fe5a655d76ed90ddf2fba46","giuseppe","2019-07-12 08:55:01","false","add: fix slow copy with no excludes

when there are excludes defined (such as from .dockerignore), we take
a slow path and walk each file in the directory.  If the files doesn't
match any exclusion pattern then it is copied into the container.
This is slow as each file requires buildah to re-exec and copy it from
a chroot environment.

When there are no excludes defined we can take a faster path and copy
the entire directory as a single re-exec operation.

Closes: https://github.com/containers/buildah/issues/1714

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1715
Approved by: rhatdan",50,29,0,1
"containers/buildah","ac346461d3e0ed2150cab06f27c4da92a76f1944","giuseppe","2019-06-13 11:32:07","false","chroot: drop unused function call

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1668
Approved by: rhatdan",42,29,0,1
"containers/buildah","68f0f193b1ea9541d6e4140f484be43ed13ad1c1","ypu","2019-10-28 13:11:39","false","Tests: Add some buildah from tests

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #2004
Approved by: rhatdan",80,33,0,0
"containers/buildah","31e7ad1486468dd98432a7315467e49a3418194b","rhatdan","2022-10-17 12:46:47","true","Merge pull request #4340 from containers/dependabot/go_modules/github.com/docker/docker-20.10.19incompatible

build(deps): bump github.com/docker/docker from 20.10.18+incompatible to 20.10.19+incompatible",27,69,1,1
"containers/buildah","cf6b1bcfbac6b95b855b35651026e20e47add020","cevich","2022-05-26 16:10:16","true","Docs: Update multi-arch buildah images readme

Contents updated to more closely resemble the same docs in the podman
repository.  Also, remove the `centos7` compatibility section (and
build context) given it's not been built or maintained in over two
years.

Signed-off-by: Chris Evich <cevich@redhat.com>",25,64,1,1
"containers/buildah","1fe4f0b933603b67fe4cf014eb07aea50127a7cc","edsantiago","2022-02-01 12:49:43","false","System tests: fix accidental vandalism of source dir

The unfortunate TESTDIR (singular) vs TESTSDIR (plural) naming
scheme bit us again, in a new containers_conf test. End result
was that the test could only be run once, and would fail on
subsequent tries. Fix, and fix broken indentation too.

Signed-off-by: Ed Santiago <santiago@redhat.com>",35,60,1,1
"containers/buildah","c6e2a5e87d307ce565a239ed639061fe0e47e5d1","nalind","2021-09-27 21:25:06","false","Replace fmt.Sprintf(""%d"", x) with strconv.Itoa(x)

Replace calls to fmt.Sprintf(""%d"", x) with strconv.Itoa(x), which is
slightly faster.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",38,56,1,1
"containers/buildah","32c68951a4d2bcf994ccf3f79b964cf99e5f8454","nalind","2021-08-10 22:11:15","false","imagebuildah: handle --manifest directly

When we're told to add built images to a manifest list, manipulate the
list ourselves, so that if we're creating a list, we won't have a
partially-populated list if some of the builds fail.

This also lets us include all of the platform information (including
variant info, which we can't sniff out after the fact) that we were
given when we started building the images.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",37,54,1,1
"containers/buildah","764b2810b0cccaa995227641ea8d456a0eba530b","hswong3i","2021-06-03 03:22:33","true","Update nix pin with `make nixpkgs`

  - Bugfix `make nixpkgs` which pin with branch `nixos-21.05`
  - Code lint with `nixpkgs-fmt`
  - Code sync between x86\_64 and aarch64

Signed-off-by: Wong Hoi Sing Edison <hswong3i@pantarei-design.com>",36,52,1,0
"containers/buildah","2e5732bc714f8eb83298707e73bf0908e8e8e576","openshift-merge-robot","2021-04-14 00:43:28","true","Merge pull request #3144 from TomSweeneyRedHat/bump-1.20.1

Bump 1.20.1",52,51,0,1
"containers/buildah","64e95b092646063e7c6538c5c3734051660a3c22","flavio","2020-09-09 08:25:25","true","Uniform some man pages

Small fixes to the man pages:

  * Ensure the explaination of the `--cert-dir` and `--tls-verify` flags
    are consistent across all the commands.
  * Ensure `buildah-login` and `docker-login` man pages are referenced
    by the sub commands that deal with authenticated registries.

Signed-off-by: Flavio Castelli <fcastelli@suse.com>",85,43,0,0
"containers/buildah","ddf7f01876f976b6f4ef477718214289274728ea","giuseppe","2020-07-02 14:29:37","true","linux: skip errors from the runtime kill

fix a race condition where the container process could exit before the
runtime sends the signal, causing the command to fail.

Part of: https://github.com/containers/crun/issues/422

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",146,41,0,1
"containers/buildah","857bef29498419c6c4938e68f8903c1c4b5bbcc2","nalind","2020-07-02 17:17:35","false","imagebuildah: fix inheriting multi-stage builds

When a multi-stage build uses the result of one stage as the base image
for a later stage, make the later stage wait for the earlier stage to
finish building its image before the later stage attempts to access that
image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",146,41,0,1
"containers/buildah","0d2dc1477be71e5539e45f00266b10df1b2b88ef","TomSweeneyRedHat","2018-11-16 22:43:48","false","Handle 'COPY --from' in Dockerfile

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1181
Approved by: vrothberg",64,22,0,1
"containers/buildah","6573a81a383df698ec423b994b000ef850809137","nalind","2018-09-10 18:23:26","false","Add more volume mount tests

Test that when a volume mount is in a location whose parent directory
doesn't already exist in the container, that we create any missing
components in the path for it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #997
Approved by: rhatdan",36,19,0,1
"containers/buildah","6f725996d02442ed58ef5e9fef53c7e4e9a0c7af","TomSweeneyRedHat","2018-06-29 14:37:07","false","Add unused function param lint check

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #837
Approved by: rhatdan",28,17,0,1
"containers/buildah","6d03588e831711137a2826a3154bc3e5b9faf70f","nalind","2017-05-09 20:07:11","false","Don't bother setting redundant image names

When we pull down an image to use as a starting point, we no longer need
to attach any additional names to it, as the image library can now find
it correctly without requiring us to do so.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #99
Approved by: rhatdan",10,3,0,1
"containers/buildah","6e489ae1f081d6b59fb45a885ecbc63f40bff76a","nalind","2017-01-28 05:14:18","false","Add missing github.com/gorilla/context package

The github.com/gorilla/mux package requires github.com/gorilla/context,
so we need to vendor it, too.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","8e9628812b8075ccc2413f81072293f43f29d65a","saschagrunert","2019-06-03 09:23:05","false","Add ability to skip secrets in mounts file

This commit changes the behavior for mounting secrets from a file like
`/etc/containers/mounts.conf`.

Before this commit, lines which do not contain a possible mount (like
comments) where included in the the returned slice of `getMounts()`.
This means that the returned result is not correct and higher level
functions like `addSecretsFromMountsFile()` fail because of that
comment.

Now, invalid lines are simply skipped, which allows the end-user to keep
their additional information within the mounts files.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1632
Approved by: rhatdan",58,28,0,1
"containers/buildah","ae1295b0c9f750d17b41abfa6482fa006cdaf0b6","nalind","2017-03-20 19:51:35","false","Tweak more help usage and descriptions

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","39646896b8f433d956715a8c228d19f798f6d9d1","nalind","2019-10-24 21:49:08","false","Update for ErrUnauthorizedForCredentials API change in containers/image

Replace an equality check with a type assertion when checking for a
docker.ErrUnauthorizedForCredentials in `podman login`.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1902
Approved by: rhatdan",79,33,0,1
"containers/buildah","9516d58c566202c9d60c33fbba5c5323e37c8382","nalind","2017-02-02 23:32:00","false","Start to vendor docker, update other deps

Drop back to a slightly older version of the runtime spec.
Vendor github.com/docker/docker to get type definitions.
Switch to the containers version of storage.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,0,0,1
"containers/buildah","eea9ad4a1f6baf227c4bcb28b7f5c2596f71513b","nalind","2017-02-10 20:34:04","false","Correct a variable naming inconsistency

This was bound to get confusing later.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,0,0,1
"containers/buildah","21a8912ef31f2b5cf1e1203c6610649e0a859df2","nalind","2021-04-01 17:25:27","false","Add a conformance test for COPY --from $symlink

Check that COPY --from doesn't do something different when given a
symbolic link as its source than it would without the --from.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",52,50,0,1
"containers/buildah","c66def9aeb436ed8b7784c7c2894a34f7c9c8c4f","nalind","2018-06-05 17:53:39","false","Run(): provide redirection for stdio

Provide RunOption fields for callers to give us stdio as an
io.ReadCloser and a pair of io.WriteClosers, or nil to use
os.Stdin/os.Stdout/os.Stderr.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #754
Approved by: rhatdan",37,16,0,1
"containers/buildah","7ce41914c983612fa6e0eb8da2949b0b65b40269","nalind","2018-09-17 19:04:48","false","NewImageSource(): only create one Diff() at a time

Update github.com/containers/storage and github.com/containers/image,
and modify containerImageRef.NewImageSource() to account for the change
that the ReadCloser that store.Diff() returns now holds a lock until
it's closed, and because that's the same lock that store.PutLayer()
takes, we can't read more than one layer's contents at a time.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1024
Approved by: nalind",37,20,0,1
"containers/buildah","649f82419315bc963706aeba619bfaca4df065dd","nalind","2021-07-15 14:09:26","true","Merge pull request from GHSA-7638-r9r3-rmjj

chroot: fix environment value leakage to intermediate processes",41,54,1,1
"containers/buildah","8b84d9b8abde7344fa40407a64f823f13a5d52ac","lsm5","2023-06-28 14:14:25","true","[CI:BUILD] Packit: fix pre-sync action for downstream tasks

One of the reasons the last propose-downstream task failed for Fedora
was the `golist` tool wasn't available in the Packit environment.

This commit adds golist to the environment by downloading and extracting
the golist rpm.

This dependency could've been added in packit's upstream config but
there were a few blockers, so it's easiest to add them in our action
script.

Ref: https://github.com/containers/buildah/issues/4904

Also make go-md2man dependency in rpm/buildah.spec more generic

[NO NEW TESTS NEEDED]

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",12,77,1,1
"containers/buildah","7e691dc17065203903ecfb12484b54df1ea95143","kolyshkin","2022-01-18 21:31:23","false",".gitignore: fixups

Commit 3a122aa3c added ignoring any file or directory named result,
which is wrong. What it meant to do is to ignore top-level result
directory. Fix accordingly.

Same for tests/tools -- this is meant to be the top-level directory
only.

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","996c77bf3d22d737738c4407d60c8cc0b655ec5f","rhatdan","2021-02-22 19:14:24","false","build(deps): bump github.com/containers/image/v5 from 5.10.2 to 5.10.3

Bumps [github.com/containers/image/v5](https://github.com/containers/image) from 5.10.2 to 5.10.3.
- [Release notes](https://github.com/containers/image/releases)
- [Commits](https://github.com/containers/image/compare/v5.10.2...v5.10.3)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",61,49,0,1
"containers/buildah","4dcdb4030ecc9e9a89d5ab2cb8e367d0a948d144","rhatdan","2023-04-05 14:02:09","true","Merge pull request #4692 from containers/renovate/github.com-fsouza-go-dockerclient-1.x

fix(deps): update module github.com/fsouza/go-dockerclient to v1.9.7",10,74,1,1
"containers/buildah","c2cf9fa47ab64d1fc480758c4769373b6c3260d5","rhatdan","2022-10-29 15:17:33","true","Merge pull request #4391 from dfr/freebsd-jail-mounts

Don't set allow.mount in the vnet jail on Freebsd",24,69,1,1
"containers/buildah","11ba328e2b945adb25df7c86eaf85998238c938b","Luap99","2023-06-22 13:31:32","true","use slirp4netns package from c/common

This uses the same code as podman for slirp4netns, this means
- ipv6 is enabled by default
- slirp4netns options are read from contianers.conf
- slirp4netns options can now be set on the cli. This required some
small rework on where we parse the network string.

Lastly I updated the --network docs, to document the new slirp4netns
mode. That included fixing up buildah-from and buildah-run pages which
were incomplete in that regard. Now we show the same for all options.

Fixes #3968

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",13,77,1,0
"containers/buildah","c2adbade7c53bcc15aec8bb844bfb3f31f33d5bb","flouthoc","2022-05-10 10:11:37","true","buildkit: supports additionalBuildContext in builds via --build-context

As builds got more complicated, the ability to only access files from one location became quite limiting. With `multi-stage` builds where you can `copy` files from other parts of the Containerfile by adding the `--from` flag and pointing it to the name of another Containerfile stage or a remote image.

The new named build context feature is an extension of this pattern. You can now define additional build contexts when running the build command, give them a name, and then access them inside a Dockerfile the same way you previously did with build stages.

Additional build contexts can be defined with a new `--build-context [name]=[value]` flag. The key component defines the name for your build context and the value can be:

```console

    Local directory – e.g. --build-context project2=../path/to/project2/src
    HTTP URL to a tarball – e.g. --build-context src=https://example.org/releases/src.tar
    Container image – Define with a docker-image:// prefix, e.g. --build-context alpine=docker-image://alpine:3.15, ( also supports docker://, container-image:// )
```

On the Containerfile side, you can reference the build context on all commands that accept the “from” parameter. Here’s how that might look:
```Dockerfile
FROM [name]
COPY --from=[name] ...
RUN --mount=from=[name] …
```

The value of [name] is matched with the following priority order:

* Named build context defined with `--build-context [name]=..`
* Stage defined with `AS [name]` inside Dockerfile
* Remote image `[name]` in a container registry

Added Features

* Pinning images for `FROM` and `COPY`
* Specifying multiple buildcontexts from different projects
  and using them with `--from` in `ADD` and `COPY` directive
* Override a Remote Dependency with a Local One.
* Using additional context from external `Tar`

Signed-off-by: Aditya R <arajan@redhat.com>",24,63,1,1
"containers/buildah","74a15d86454b610053b419039065ed401979f539","openshift-merge-robot","2023-08-03 14:45:34","true","Merge pull request #4940 from flouthoc/layer-label

buildah: add `--layer-label` for setting labels on intermediate images",13,78,1,1
"containers/buildah","ef350cb66987c55af80a54753d8972df1fa0e9ad","openshift-merge-robot","2022-09-29 13:27:09","true","Merge pull request #4295 from lucacome/platform-vars

Check for unset build args after setting TARGET args",20,68,1,1
"containers/buildah","e1e8414ef9003a01ec0f6841bef37a4ab4be8e9e","openshift-merge-robot","2020-11-13 13:13:55","true","Merge pull request #2777 from nalind/private-uts-rootless

Run: don't forcibly disable UTS namespaces in rootless mode",72,45,0,1
"containers/buildah","ffef8a6c0b258c892299aef86405ec4d2377d0c5","openshift-merge-robot","2020-12-23 16:04:31","true","Merge pull request #2864 from jsoref/spelling

Spelling",84,47,0,1
"containers/buildah","e3283ab9c42411b3f3830818b3136de91450487a","openshift-merge-robot","2021-11-04 16:21:02","true","Merge pull request #3614 from giuseppe/rootless-fresh-sys-mount-if-possible

rootless: do not bind mount /sys if not needed",29,57,1,1
"containers/buildah","d47032f5b161da37bea9c5441757bf8cead7c86d","openshift-merge-robot","2021-02-22 13:53:33","true","Merge pull request #3029 from containers/dependabot/go_modules/github.com/containers/common-0.35.0

build(deps): bump github.com/containers/common from 0.34.2 to 0.35.0",62,49,0,1
"containers/buildah","a661629800f7ba0214811a7ec8a08b8b01bf9801","openshift-merge-robot","2022-03-02 15:44:26","true","Merge pull request #3795 from vrothberg/blobcache

use c/image/pkg/blobcache",29,61,1,1
"containers/buildah","2ec0e755a6d1adfa115dddbda81f5b5086e89aa6","openshift-merge-robot","2022-08-17 19:30:21","true","Merge pull request #4189 from nalind/manifest-amend

cmd/buildah: add ""manifest create --amend""",17,67,1,1
"containers/buildah","862c20cb875b9f50153d70a249010a0f4986254d","openshift-merge-robot","2021-12-16 11:57:48","true","Merge pull request #3680 from flouthoc/lock-nix-version

cirrus: remove `static_build`",32,59,1,1
"containers/buildah","98f7b3d82abf45bdb609b69a0028d54f80d0390c","openshift-merge-robot","2021-03-26 18:33:47","true","Merge pull request #3105 from rhatdan/recurse

[NO TESTS NEEDED] Use --recurse-modules when building git context",51,50,0,1
"containers/buildah","ee1d23967e801a2476246a753ab190ea85708f11","openshift-merge-robot","2022-01-08 10:40:48","true","Merge pull request #3691 from rhatdan/proxy

Use config.ProxyEnv",27,59,1,1
"containers/buildah","68395f9beb3039d9c956dd6d7fab47e6fedfe005","cevich","2022-04-26 17:31:19","true","fix staticcheck linter warning for deprecated function

Port of fix from podman-land:
https://github.com/containers/podman/commit/62f4ae98fb73065063c05f45663b1fadbcb269c9

Thanks to pholzing@redhat.com for figuring this out.

[NO NEW TESTS NEEDED]

Signed-off-by: Chris Evich <cevich@redhat.com>",25,63,1,1
"containers/buildah","4c6255679f87f2634958197bd4b2fba5fef7a5fe","rhatdan","2023-09-20 12:13:27","false","vendor of containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",7,80,1,1
"containers/buildah","54eef980baa1767ffbb863965d4bd381d18fbf2c","rhatdan","2022-09-09 10:01:30","true","Merge pull request #4219 from rhatdan/seccomp

Buildah should ignore /etc/crio/seccomp.json",18,67,1,1
"containers/buildah","dc7726c2ff12424b68ec22274c386c1680dab52c","rhatdan","2023-04-08 10:58:54","true","Merge pull request #4720 from containers/renovate/golang.org-x-crypto-0.x

fix(deps): update module golang.org/x/crypto to v0.8.0",11,74,1,1
"containers/buildah","4ae0a694d945304096e3e1e1a1d91b27a10a9f0a","rhatdan","2019-06-08 11:12:05","false","Fix validate complaint

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1654
Approved by: vrothberg",60,28,0,1
"containers/buildah","88c649e60e2c9eeeb1478416e5b045c95e849d73","pixdrift","2018-05-15 12:34:14","false","Add buildah bud CI tests for ENV variables

Signed-off-by: pixdrift <support@pixeldrift.net>",58,16,0,0
"containers/buildah","ed4412b96843f28d6f647c455d8bc6ca1871a4b8","Luap99","2022-05-12 13:42:05","true","use resolvconf package from c/common/libnetwork

Podman and Buildah should use the same code the generate the resolv.conf
file. This mostly moved the podman code into c/common and created a
better API for it so buildah can use it as well.

[NO NEW TESTS NEEDED] All existing tests should continue to pass.

Fixes #3806

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",24,64,1,0
"containers/buildah","9cc5d5e8cab427321a974c3a0a4b100329383d10","lsm5","2023-07-14 14:19:50","true","[CI:BUILD] Packit: remove pre-sync action

The pre-sync action constantly breaks and is currently not possible to
reliably test until the subsequent upstream release due to limitations
in packit.

The lines being added by the action script to the downstream Fedora spec
were only meant to keep Fedora happy. But given that they provide
no tangible benefit as github notifies us of security
issues in libraries mentioned in go.mod and go.sum, along with redhat
prodsec's own magic for creating security alerts, there's absolutely
no point to having the pre-sync action run and add a layer of uncertainty.

This commit removes the pre-sync action and
`rpm/update-spec-provides.sh`.

Ref: https://github.com/containers/podman/issues/19232

[NO NEW TESTS NEEDED]

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",13,78,1,1
"containers/buildah","2a0021c75b6e501698ced4b1300f55f2cd92cd18","nalind","2019-02-12 15:30:28","false","Remove a misleading comment

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1352
Approved by: rhatdan",59,25,0,1
"containers/buildah","803652a8c473ddc5efc29daa7fb29a74f905f3ec","nalind","2019-06-03 21:00:42","false","bud.bats: test additional tags with cached images

Test that when our final image is found in the cache, that we still
apply additional names to it if we were given additional names to add to
it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1639
Approved by: TomSweeneyRedHat",59,28,0,1
"containers/buildah","1119820edd56acfbc052cb4fc6efcb760c5f4615","nalind","2018-07-10 15:47:26","false","build-using-dockerfile: let -t include transports again

When parsing the destination image name using
alltransports.ParseImageName(), if it doesn't return an error, use the
returned ImageDestination.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #858
Approved by: rhatdan",30,17,0,1
"containers/buildah","2b183913847dc96f156ca3ad7ec17ac57adf6f31","nalind","2018-04-24 22:17:46","false","Add tests for namespace control flags

Test that the --ipc, --net/--network, --pid, --userns, --uts options can
be used to control whether or not we create new namespaces of those
types in ""buildah run"".

Test that when ID mappings are not specified, we default to not using a
new user namespace, but when ID mappings are specified, we create a new
user namespace and ID mappings are set correctly in the running
container.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",39,15,0,1
"containers/buildah","6b63a73aeaf29f9d7270fc776502a391c726a027","nalind","2021-04-27 18:52:39","false","conformance: use :Z with transient mounts when SELinux is enabled

When SELinux is enabled, add the :Z mount flag to transient mounts that
we use in the tests that use transient mounts.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",49,51,0,1
"containers/buildah","2c8122afef228aa9e5e010492410cfa0fbc33c9d","QiWang19","2019-04-03 20:32:12","false","fix bug in .dockerignore support

my former PR #1403 didn't take into account the directory path in .dockerignore. `buildah bud` should be able to exclude the whole folder and keep
some files under the folder according to the patterns in .dockerignore.

```
// .dockerignore
test*
!*/test1*
```
should exclude `./testdir/test2.txt` but copy `./testdir/test1.txt`
Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1478
Approved by: rhatdan",53,26,0,1
"containers/buildah","7ab2e438e4c49a82e23272cbbe7c64bd6efe459b","kolyshkin","2022-01-20 02:24:52","false","tests/tools: bump onsi/ginkgo to v1.16.5

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","98b57f75970a29145ec0fb00e6656bc4655ae6e8","rhatdan","2022-10-24 22:00:07","true","Merge pull request #4326 from flouthoc/arg-cache-from

imagebuildah, `cache-from`: pull cache from remote repo after adding content summary",26,69,1,1
"containers/buildah","31dc089c8a717918186050c383e4f73cfcc402e4","rhatdan","2022-09-27 10:15:48","false","Run codespell on code

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",21,68,1,1
"containers/buildah","8ead4d2eca70cb6cf4686e11912148aef7235f84","rhatdan","2018-09-11 14:56:10","false","Retain bounding set when running containers as non root

We need to be able to run sudo commands inside of Dockerfile's
even when containers are setup with non root.

This patch retains the bounding set for containers run with non root user.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1001
Approved by: vrothberg",36,19,0,1
"containers/buildah","4dfb828909e6e74b498f112d758b1d32967e858b","rhatdan","2023-02-09 14:05:03","false","Run codespell on codebase

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",16,72,1,1
"containers/buildah","121973dd50c1ffcdbb139cb4abde4221bbda0788","rhatdan","2017-03-28 21:12:06","false","Fix cut and paste error in buildah images

Closes: #54
Approved by: rhatdan",14,2,0,1
"containers/buildah","47ce18b63c19dfd0dfc9ef5e90ea26ebcacb562e","rhatdan","2020-01-08 11:14:59","false","Don't setup excludes, if their is only one pattern to match

We are always adding .dockerignore to the pattern list, if this is the only pattern
then no patterns we added to the list, and we should return nil.

This is causing a major slowdown in buildah, since it is not using the optimized tar for
copying.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #2070
Approved by: saschagrunert",101,35,0,1
"containers/buildah","5918f5f7c2885f09852f22df3de5a2b36fed4074","rhatdan","2021-04-19 19:50:46","false","Do not force hard code to crun in rootless mode

runc now works with cgroupsV2 so buildah should not hard code crun.

Fixes: https://github.com/containers/buildah/issues/3160

[NO TESTS NEEDED] This would be very difficult and complicated to test.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",50,51,0,1
"containers/buildah","50b9062e12b0239ff70545c3bf87e89c72109023","rhatdan","2023-05-17 15:21:23","true","Merge pull request #4797 from rhatdan/VENDOR

vendor in containers/(common,storage,image)",14,76,1,1
"containers/buildah","85b8ae489db927168addf64f7777983506b34c1f","rhatdan","2020-02-05 19:58:20","true","Merge pull request #2138 from openSUSE/containers-common

Update containers/common to v0.1.4",110,36,0,1
"containers/buildah","1b3d25089960bfb4bbb804ee62f02912f818ae98","giuseppe","2021-03-12 08:20:33","true","copier: ignore sockets

sockets are not supported by tarsplit, ignore them.

Closes: https://github.com/containers/buildah/issues/3074

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",60,50,0,1
"containers/buildah","635141f05da39f351e75f96260bbaafd063bfe2a","openshift-merge-robot","2021-06-18 08:50:23","true","Merge pull request #3311 from mtrmac/format-docs

Fix documentation of the --format option of buildah push",41,53,1,1
"containers/buildah","8f63761c052e5a645c84e1291886044423a41a15","openshift-merge-robot","2021-02-08 22:30:05","true","Merge pull request #2985 from edsantiago/prs_should_include_tests

'make validate': require PRs to include tests",94,48,0,1
"containers/buildah","0969cff0882aabf47ecea82e645d7a7a8a65bb15","openshift-merge-robot","2022-01-12 06:20:17","true","Merge pull request #3702 from rhatdan/secrets

Fix permissions on  secrets directory",28,59,1,1
"containers/buildah","0346b38d8efdda003c852374999786d715cb4948","openshift-merge-robot","2021-09-10 11:59:47","true","Merge pull request #3507 from l0rd/patch-1

Update 05-openshift-rootless-build.md",38,55,1,1
"containers/buildah","89e9d1bd85bf16cbc9b9cd6764ada51f67166b45","baude","2018-04-06 15:22:13","false","Add accessor functions for comment and stop signal

Podman commit needs the ability to set a comment and stop signal
when committing a container to an image.  Adding set/get functions
for each.

Signed-off-by: baude <bbaude@redhat.com>

Closes: #560
Approved by: nalind",26,14,0,0
"containers/buildah","83f48300dad671f9774079c55d63730be762f105","rhatdan","2018-04-26 12:36:27","false","Add description on how to do --isolation to buildah-bud man page

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #637
Approved by: TomSweeneyRedHat",52,15,0,1
"containers/buildah","3f6ad0f055e8da6916a112443bf29d537e353196","rhatdan","2019-09-05 20:31:31","true","Merge pull request #1840 from rhatdan/f30

Bump fedora version from 28 to 30",60,31,0,1
"containers/buildah","f54c96598e077b04719ce93e290ad6843f95ecfc","rhatdan","2019-09-06 19:05:07","true","Merge pull request #1844 from rhatdan/containerenv

Add support for /run/.containerenv",60,31,0,1
"containers/buildah","a6b102c31c580339cf22c524288631622915ae1b","TomSweeneyRedHat","2019-02-22 23:16:00","false","Update CHANGELOG.md with the past changes

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1364
Approved by: rhatdan",59,25,0,1
"containers/buildah","5cc3c510c54711ea32cc84cfb773ac47c191d8c0","Ace-Tang","2017-10-16 16:14:48","false","Fix list images with digest not aligned

Signed-off-by: Ace-Tang <aceapril@126.com>

Closes: #289
Approved by: rhatdan",29,9,0,0
"containers/buildah","3e4e377cbb3fab0c214eaa5f50a8aafed766de80","openshift-merge-robot","2023-07-31 20:40:08","true","Merge pull request #4946 from lsm5/main-packit

CI:BUILD] RPM: define gobuild macro for rhel/centos stream",14,78,1,1
"containers/buildah","885e9c1bb6333b6828c97b7941b22532e8d7d24a","openshift-merge-robot","2021-02-08 23:03:05","true","Merge pull request #2931 from EduardoVega/make-chown-function-reusable

Reuse chown function from containers/common when U volume flag is used",94,48,0,1
"containers/buildah","e67bb0904c7733b5264f9786f950b5cfb0c205b9","flouthoc","2022-09-26 06:39:06","true","refactor: stop using Normalize directly from containerd package

Stop using containerd's `platform.Normalize` instead use libimage's
`NormalizePlatform` which calls containerd's `platform.Normalize` along
with `platform.Parse` internally.

See discussion here: https://github.com/containers/buildah/pull/4286/files#r977389931

Signed-off-by: Aditya R <arajan@redhat.com>",21,68,1,1
"containers/buildah","1880cd847f4bbbbbff3f5cf13643b764dbf4deac","cevich","2021-09-09 13:28:35","true","Cirrus: Increase unit-test timeout

Observed a unit-test typical runtime is around 45m, so a 50m timeout is
cutting things closely given variability in networking and shared vCPU
performance.  Increase the timeout to 1-hour to provide an additional
buffer.

Signed-off-by: Chris Evich <cevich@redhat.com>",38,55,1,1
"containers/buildah","db0bafef39b6c79339ce621fce370a5c403b283c","cevich","2023-03-17 14:15:44","true","Disable dependabot in favor of renovate

Both tools were enabled during a transition period.  While Dependabot
has a repository setting, it will re-enable itself if a config. file
exists in the repo.  Remove the config file so it can be fully disabled.

Ref: https://github.com/containers/buildah/issues/4588

Signed-off-by: Chris Evich <cevich@redhat.com>",15,74,1,1
"containers/buildah","488e8654eab9cf6aba1eb1932ac430e6938bd1c4","Foxboron","2022-01-25 21:56:36","true","docs: Remove Containerfile and containeringore

These where moved to buildah but because they are useful for podman and
the other tooling they are moved back into the common project.

Partially reverts a9e66ec72b55c7d2a854adca9670f8a336f95fc5

Signed-off-by: Morten Linderud <morten@linderud.pw>",33,60,1,0
"containers/buildah","21b4778b359ef7d6efe877c2f90f3df67ad93609","TomSweeneyRedHat","2019-10-28 15:53:47","false","Bump to v1.11.4

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1946
Approved by: rhatdan",80,33,0,1
"containers/buildah","f35369055df75553071190cfe8607a594ba0e68b","rhatdan","2023-05-02 23:20:28","true","Merge pull request #4752 from mtrmac/retry-overflow

Fix an overflow on retries on container name conflicts",13,75,1,1
"containers/buildah","b8f0ee9d7f34be83149536d6eeabfa32d41184e5","openshift-merge-robot","2023-01-31 02:29:43","true","Merge pull request #4546 from flouthoc/update-build-docs

docs: specify order preference for FROM when using multiple `containerfiles`",19,72,1,1
"containers/buildah","9226bd3129596ee63f1f6b8f57ead65a6b8c7a3e","rhatdan","2022-10-15 09:58:52","false","Update vendor containers/(common,image,storage)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",27,69,1,1
"containers/buildah","d08c73c2363eedd102738fb67f4a0230c0c2818c","rhatdan","2022-10-12 13:01:11","true","Merge pull request #4332 from containers/dependabot/go_modules/github.com/onsi/gomega-1.22.1

build(deps): bump github.com/onsi/gomega from 1.20.2 to 1.22.1",27,68,1,1
"containers/buildah","ffce8b366606be32b6abcf90855970305a8f1262","rhatdan","2022-06-22 13:20:14","false","Make sure cpp is installed in buildah images

[NO NEW TESTS NEEDED]

Fixes: https://github.com/containers/buildah/issues/4070

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",23,65,1,1
"containers/buildah","8d57bff978a55be2ce843640c633c23c944ea5cc","giuseppe","2022-05-12 01:45:26","true","vendor: update c/storage and c/image

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",24,63,1,1
"containers/buildah","05d5d22dc6b76efa4fd1b1c1eccec2fbbb2f404a","rhatdan","2021-11-18 19:09:29","false","Grab all of the containers.conf settings for namespaces.

Buildah is mainly building with Host Namespaces, this changes most
namespaces to be private matching Podman and using containers.conf

Fixes: https://github.com/containers/buildah/issues/3634

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",28,58,1,1
"containers/buildah","b76831867402c5de20000cca2d5bbefdda234466","openshift-merge-robot","2021-11-22 20:23:30","true","Merge pull request #3646 from containers/dependabot/go_modules/github.com/containers/image/v5-5.17.0

build(deps): bump github.com/containers/image/v5 from 5.16.1 to 5.17.0",29,58,1,1
"containers/buildah","7a0870c21480c290aace1cd8bcd8feb42b09b889","openshift-merge-robot","2021-10-12 20:25:13","true","Merge pull request #3582 from cevich/manifest_example

[CI:DOCS] Include manifest example usage",41,56,1,1
"containers/buildah","62d4057718c8a84699b26f88ecae12524b248ee3","mtrmac","2023-07-31 15:54:10","false","Add a missing .Close() call on an ImageSource

[NO NEW TESTS NEEDED]

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",14,78,1,1
"containers/buildah","5dd1a5f3c969d601e299336002921fa93cb145bb","TomSweeneyRedHat","2017-11-21 15:17:43","false","Touchup test scripts for some minor nits

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #335
Approved by: rhatdan",31,10,0,1
"containers/buildah","dbe2e070520e3625ac836823dc616c4ff60881e7","rhatdan","2023-05-10 11:20:10","true","Merge pull request #4786 from containers/renovate/github.com-containerd-containerd-1.x

fix(deps): update module github.com/containerd/containerd to v1.7.1",11,75,1,1
"containers/buildah","53b05ae20fdd801f33cad5e01789898dba31029d","rhatdan","2018-09-21 10:44:10","true","Merge pull request #1028 from rhatdan/volumes

Builtin volumes should be owned by the UID/GID of the container",37,20,0,1
"containers/buildah","293e02ac068513a08c38dbe434dea73560f90c25","rhatdan","2021-03-25 17:16:45","false","Bump to v1.20.0

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",51,50,0,1
"containers/buildah","45fa7d898ce0f6652d9bc63c93989a747239d499","rhatdan","2023-05-18 11:37:51","true","Merge pull request #4790 from giuseppe/drop-pdeath-sig

chroot, run: drop Pdeathsig",13,76,1,1
"containers/buildah","bb738d4406cb899a2238d722e9c69873af85eced","rhatdan","2021-07-22 18:46:05","false","Allow dst and destination for target in secret mounts

Fixes: https://github.com/containers/buildah/issues/3396

Patch from @mixedCase

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",41,54,1,1
"containers/buildah","902d579a1fc0c0438a5738bf8d7aef036655936f","rhatdan","2021-06-24 14:49:20","false","Turn stdio back to blocking when command finishes

Fixes: https://github.com/containers/buildah/issues/3152

Sometimes after running buildah run in a terminal, commands executed afterwards which try to read from stdin fail with EAGAIN. This is because it sets O_NONBLOCK on the FD:

[NO TESTS NEEDED] Since I don't know how to test this.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",37,53,1,1
"containers/buildah","ffb00243f17f04183c2db80285b37c6486a74300","giuseppe","2022-10-28 11:56:26","true","chroot: fix mounting of ro bind mounts

a bind mount cannot be made RDONLY in the same mount operation as it
is created.  For that we need a second operation.

Closes: https://github.com/containers/buildah/issues/4203

[NO NEW TESTS NEEDED] it fails in Buildah in a container

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",24,69,1,1
"containers/buildah","3bbfdd13e1c5b847e974ee25f73e4fdeda6ae57c","giuseppe","2018-12-12 12:42:58","false","travis.yml: use the fully qualified name for alpine

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1233
Approved by: rhatdan",49,22,0,1
"containers/buildah","6047edc1d698b05fa5250a2f226520423b719173","nalind","2019-10-29 21:33:07","false","Builder.untarPath(): always evaluate b.ContentDigester.Hash()

Make sure we evaluate b.ContentDigester.Hash() every time the callback
returned by Builder.untarPath() is called, since it may be for a
different digest object than the previous time it was called, or
different even from when the callback was first retrieved.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1955
Approved by: rhatdan",82,33,0,1
"containers/buildah","80d7cb87f14cdc488857adf6011ae98f97a5e501","nalind","2021-09-09 18:11:50","false","Makefile: update cross targets

Update the ""cross"" makefile target to just try building on every Linux,
Darwin, or Windows architecture that the current version of Go supports.

That way, the next time we upgrade Go to a version that supports more
architectures, we won't have to remember to update the list of
cross-compile targets that we try to build in CI to catch
cross-compilation problems.

Marking this as not needing new tests because it directly modifies one
of our CI tests.
[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",38,55,1,1
"containers/buildah","bc2ea080032ad192c8a34d7c0dde64a58be1e5e2","nalind","2018-10-03 14:05:46","false","Make sure we log or return every error

Make sure that when attempting to diagnose an error, if we encounter an
error during the diagnostic attempt, we return the original error rather
than the error encountered in trying to diagnose it.  Log that one.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1072
Approved by: rhatdan",49,20,0,1
"containers/buildah","f6cd687a80a86e9007f7f2d264b6d5a7b0b6d448","nalind","2021-04-28 15:04:38","false","runUsingRuntime: when relaying error from the runtime, mention that

Mention that errors we relay from the runtime are from the runtime, to
hopefully reduce confusion when troubleshooting.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",50,51,0,1
"containers/buildah","5f1066b6741b7106d48d48040e98ebe02fd89458","nalind","2021-04-01 21:26:29","false","Add conformance tests for COPY /...

Add conformance tests that ensure that when we COPY a subdirectory
that's specified as an absolute path, that we don't regress on treating
the absolute path as still being relative to the build context's
location.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",49,50,0,1
"containers/buildah","bf305fac94f2ad2c8fcfb8d12a1d6cf3d730d146","nalind","2020-12-14 22:21:16","false","copier: add PutOptions.NoOverwriteDirNonDir, Get/PutOptions.Rename

Add a flag for controlling overwriting-directories-with-non-directories
behavior in PutOptions, and fields for controlling name mappings to both
GetOptions and PutOptions.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",79,46,0,1
"containers/buildah","42f2b38574c48928e20930587a17e45faf13575e","openshift-merge-robot","2023-01-18 21:47:07","true","Merge pull request #4528 from vrothberg/fix-4520

fix bud-multiple-platform-with-base-as-default-arg flake",22,72,1,1
"containers/buildah","5c081c070271b9929792323935efafaeb5f51f16","openshift-merge-robot","2022-08-09 13:32:06","true","Merge pull request #4177 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.8

build(deps): bump github.com/containerd/containerd from 1.6.6 to 1.6.8",17,66,1,1
"containers/buildah","9eaa91fe6e58ff392bdfbc3b9906c62cf7c1e44a","openshift-merge-robot","2021-03-22 15:52:56","true","Merge pull request #3092 from containers/dependabot/go_modules/github.com/onsi/ginkgo-1.15.2

build(deps): bump github.com/onsi/ginkgo from 1.15.1 to 1.15.2",53,50,0,1
"containers/buildah","a09f0ad2ec35e66515509352de3df3941a62f90c","openshift-merge-robot","2023-05-27 11:12:54","true","Merge pull request #4817 from flouthoc/label-only-last-stage

executor: apply label to only final stage via `--label`",17,76,1,1
"containers/buildah","661cd4ba52da806085381bbf5fe8b560c7fcb70f","openshift-merge-robot","2021-06-23 12:48:55","true","Merge pull request #3334 from dilyanpalauzov/master

buildah bud: spelling --ignore-file requires parameter",37,53,1,1
"containers/buildah","743b89520ebaaec6e2446319ebab52ca69486f2b","openshift-merge-robot","2021-12-14 15:33:02","true","Merge pull request #3673 from containers/dependabot/go_modules/github.com/docker/docker-20.10.12incompatible

build(deps): bump github.com/docker/docker from 20.10.11+incompatible to 20.10.12+incompatible",31,58,1,1
"containers/buildah","057d5bf704a8aa57dab095b2215f22494177de0f","cevich","2019-11-08 15:53:49","true","Cirrus: Temporarily ignore VM testing failures

Signed-off-by: Chris Evich <cevich@redhat.com>",79,33,0,1
"containers/buildah","58c078fc88795630e3751fb4b89eddd786a1bb85","TomSweeneyRedHat","2017-11-01 23:38:08","false","Add go 1.9.x to .travis.yml and fix tip

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",30,9,0,1
"containers/buildah","b02371d69fb0213967eed5a7676bb58a9b8fc03d","TomSweeneyRedHat","2018-10-18 14:47:37","false","Change gofmt so it runs on all but 1.10

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1114
Approved by: rhatdan",55,21,0,1
"containers/buildah","0dfb6f581030f24e7d6b72ac7e76d4f419764ce4","TomSweeneyRedHat","2019-08-09 19:04:14","false","Vendor Storage v1.13.2

Vendor Storage v1.13.2 which features functionality to
Ignore ro mount options in btrfs and windows drivers.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1779
Approved by: vrothberg",52,30,0,1
"containers/buildah","ad24f284b105b09468b18c56885891c931e72ef5","TomSweeneyRedHat","2019-02-01 22:18:25","false","Touch up cli help examples and a few nits

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Picks off a few left over nits from #1303.  Also formats the
description of each help to have a blank line then everything spaced
over by two.  Examples have been added for each too.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1318
Approved by: rhatdan",57,24,0,1
"containers/buildah","9c147ab8a9ca864e6a111145352b0d3d60ab4e79","dfr","2022-08-08 10:29:37","false","chroot: Fix cross build break

Signed-off-by: Doug Rabson <dfr@rabson.org>",17,66,1,0
"containers/buildah","129fb109d55496c8c3b8889ce15ea76e439c697a","rhatdan","2017-12-24 11:42:43","false","Bump to version 0.10

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",32,11,0,1
"containers/buildah","02ae076579835225cedd9ab2d34ce9846ee96dbf","vrothberg","2019-06-21 15:07:34","false","tests/tools: go module for test binaries

Create a dedicated go module in tests/tools to avoid mixing build
dependencies with test dependencies.  This will help facilitate
downstream packaging a bit more.

Also use golangci-lint instead of the old metalinter.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1621
Approved by: rhatdan",44,29,0,1
"containers/buildah","3aa2dccace86cbdb0948fad7f872a95065313a82","jwendell","2018-09-07 17:56:03","false","Push: Allow an empty destination

In this case assume it's the same as source. This makes it
compatible with `docker push`.

Thus `buildah push my_registry/my_image` will behave like
`buildah push my_registry/my_image docker://my_registry/my_image`

Signed-off-by: Jonh Wendell <jonh.wendell@redhat.com>

Closes: #994
Approved by: rhatdan",36,19,0,0
"containers/buildah","00e18e87b181b79b398f9780225d761b7a0cd91a","mtrmac","2019-02-21 22:28:20","false","Fix error reporting when parsing trans+image

Use the right variable to make sure transport and image are
colon-separated in error reports.

Changes user-visible strings.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","618e790d8ea71c036e68e19dc4d9c72c1a465de8","TomSweeneyRedHat","2018-08-07 14:46:12","false","Add Release Announcements directory

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #914
Approved by: rhatdan",24,18,0,1
"containers/buildah","54f12f15648a51e6ec86363496bf78e3a87e3022","umohnani8","2018-09-26 18:34:34","false","Copy ExposedPorts from base image into the config

This ensures that we pass the ports to the imagebuilder and
are not lost during the build process when using --layers.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>",38,20,0,1
"containers/buildah","15081fab2fabef5488918a9fb19f861c846a11f5","openshift-merge-robot","2021-04-20 19:40:37","true","Merge pull request #3167 from nalind/copier-remove

copier: add Remove()",49,51,0,1
"containers/buildah","c7ed4b60f4f298cf2c0ba56dfa1c0c566923109d","openshift-merge-robot","2021-04-17 11:15:50","true","Merge pull request #3150 from hshiina/system-test

Add a few system tests of 'buildah from'",53,51,0,1
"containers/buildah","ee076c0271be8bfc1688a3b2ae35c39d1d671a53","openshift-merge-robot","2022-04-21 15:00:48","true","Merge pull request #3920 from flouthoc/populate-etc-hostname

run: set actual `hostname` in `/etc/hostname` to match docker parity",25,63,1,1
"containers/buildah","dcc7feb6fd9e7aafab48da9a9d4e6b8e47173402","flouthoc","2023-05-15 07:37:13","true","secret: accept required flag w/o value

`Buildkit` and `docker` accepts `required` flag as `true` in
`--mount=type=secret` so let do same for buildah.

Example usage

```Dockerfile
FROM docker.io/nginx:1.23.3

RUN --mount=type=secret,id=nginx-crt,dst=/nginx-repo.crt,required \
    --mount=type=secret,id=nginx-key,dst=/nginx-repo.key,required \
    set -x \
    && . /etc/os-release \
    && stat /nginx-repo.crt \
    && stat /nginx-repo.key
```

Closes: https://github.com/containers/podman/issues/18438

Signed-off-by: Aditya R <arajan@redhat.com>",12,76,1,1
"containers/buildah","a41d117b230d80d565856fa623b12ef9baddac92","hswong3i","2021-04-16 00:19:03","true","Update nix pin with `make nixpkgs`

Signed-off-by: Wong Hoi Sing Edison <hswong3i@pantarei-design.com>",52,51,0,0
"containers/buildah","00f5164ef9a7427de5ba11e6c6cbbdb24dfec8dd","EricHripko","2019-05-22 21:40:27","false","Add a test for ENV special chars behaviour

Signed-off-by: Eric Hripko <ehripko@bloomberg.net>

Closes: #1608
Approved by: rhatdan",53,28,0,0
"containers/buildah","85158674432802ef21d8696cd5ca6866eaa813bd","pixdrift","2018-05-11 17:23:14","false","Re-enable rpm .spec version check and new commit test

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #681
Approved by: rhatdan",56,15,0,0
"containers/buildah","cf933c87c4f76dcbc22143530d4863886381f869","vrothberg","2019-10-01 12:18:49","true","Merge pull request #1879 from containers/dependabot/go_modules/github.com/seccomp/libseccomp-golang-0.9.1

Bump github.com/seccomp/libseccomp-golang from 0.9.0 to 0.9.1",66,32,0,1
"containers/buildah","2edff446a1161670c76f518ed8abc147c8b8be14","vrothberg","2019-02-21 10:40:11","false","vendor containers/image v1.4

This requires some additional changes to the dependencies since the
progress-bar library has been changed to github.com/vbauerster/mpb.

Please refer to the following link for the release notes:
https://github.com/containers/image/releases/tag/v1.4

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1355
Approved by: @TomSweeneyRedHat",59,25,0,1
"containers/buildah","8696bfc7ad74dc526805969f8a19edc4dcd287b9","vrothberg","2021-03-22 12:02:39","false","buildah source - create and manage source images

Add new `buildah source {create,add,push,pull}` commands.  All commands
are marked as experimental.  None of it is meant to be officially
supported at the time of writing.  All code resides in `internal/source`
and is hence not visible to external consumers of Buildah; just to be
on the safe side.

A source container or source image is an OCI artifact, that is an OCI
image with custom config (media type).  There is a longer history behind
source images which are intended to ship the source artifacts of an
ordinary ""executable"" container image.  Until now, source images at
Red Hat are built with github.com/containers/BuildSourceImage.  We had a
growing desire (and always the long-term plan) to eventually replace
BuildSurceImage with something else, in this case Buildah.

This commit adds the initial base functionality along with tests to make
sure we're not regressing.  The new commands do the following:

* `create` - creates an empty and initialized source image
* `add` - tar up a local path and add it as a layer to the souce image
* `push/pull` - intentionally separate commands from `buildah push/pull`
                to allow for an easier usage and prevent the
                implementations from undesired (future) interference

Further note: also vendor in c/image@master which ships a required fix.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",54,50,0,1
"containers/buildah","718f2b44396b2483d882fab84ab5f330b50ba5c1","openshift-merge-robot","2022-01-24 18:44:44","true","Merge pull request #3736 from containers/dependabot/go_modules/github.com/onsi/gomega-1.18.0

build(deps): bump github.com/onsi/gomega from 1.17.0 to 1.18.0",34,60,1,1
"containers/buildah","1a001dee2103247ce60d98c40a0757edffcda1a8","openshift-merge-robot","2023-09-06 20:01:58","true","Merge pull request #5030 from containers/renovate/github.com-cyphar-filepath-securejoin-0.x

fix(deps): update module github.com/cyphar/filepath-securejoin to v0.2.4",5,79,1,1
"containers/buildah","9073afddef701846acbf8f2db3962573f54e851f","nalind","2021-09-20 16:38:09","false","unmarshalConvertedConfig(): handle zstd compression

The Docker manifest format doesn't currently support listing layers
compressed using zstd, so we trigger an error when we try to convert an
in-memory OCI manifest to the Docker format as a preliminary step in
reading the image's config blob in the Docker format.

Instead, first create a temporary copy of the manifest, and then force
the MIME types for all layers in the temporary copy of the manifest to
appear to be compressed using gzip.  Both OCI and Docker formats will
accept the resulting manifest without issue.  We throw the copy away
after we've read the config blob, so the wackiness should be contained.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",39,56,1,1
"containers/buildah","a99d5f0798502662ca5ccdedbe5874cb9953a42b","nalind","2017-11-28 05:07:20","false","Bump the GIT_VALIDATION_EPOCH to a newer version

Bump the GIT_VALIDATION_EPOCH in tests/validate/git-validation.sh to a
later commit.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #340
Approved by: rhatdan",31,10,0,1
"containers/buildah","316e34d26879867e29a1b2bb599e6045cf19fe15","flouthoc","2022-01-20 09:15:48","true","mount: add support for custom upper and workdir with overlay mounts

Allow users to specify non-volatile `upper` and `workdir` with overlay
mounts.

Usage

```console
buildah from alpine
buildah run -v /something/lower:/test:z,O,upperdir=/somewhere/upperdir,workdir=/somwhere/workdir alpine-working-container cat /test/hello
```

Signed-off-by: Aditya R <arajan@redhat.com>",34,60,1,1
"containers/buildah","cddb66e6625c2dfc41ba8ac31847440b3e525caa","QiWang19","2019-10-22 01:59:15","false","Enable --device directory as src device

Enables --device accepte directory path as source device. Add the devices under the source directory to the destination directory.

complete card test criteria: https://jira.coreos.com/browse/RUN-497
related podman issue: https://github.com/containers/libpod/issues/2380

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1937
Approved by: rhatdan",79,33,0,1
"containers/buildah","d2a8181e673756116756c7f427486c47777eb116","openshift-merge-robot","2022-02-15 16:56:40","true","Merge pull request #3782 from flouthoc/silent-predefined-args-if-not-in-args

history, build: add pre-allowed variables e.g `proxy vars` to history if explicitly specified",29,61,1,1
"containers/buildah","d10dbf35450aa2be494cadc9f60cd7e849215b4a","openshift-merge-robot","2021-01-15 09:00:00","true","Merge pull request #2913 from rhatdan/overlay

If destination does not exists, do not throw error",93,47,0,1
"containers/buildah","83d7d100df1c048d34b6efd6ac7b8d0305ad03f1","umohnani8","2018-04-13 15:10:08","false","Modify buildah rmi to account for changes in containers/storage

containers/storage now returns a copy of the image state, so need to
refetch the new state whenever we make a change such as untagging.
Also added more tests for buildah rm.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #578
Approved by: rhatdan",32,15,0,1
"containers/buildah","135d63daa391636365b2778f81dd1cc510633859","openshift-merge-robot","2021-05-10 13:14:55","true","Merge pull request #3212 from rhatdan/error

Fix race condition",54,51,0,1
"containers/buildah","692fe461d1dc6686d7eb174f85402121f1f851b0","openshift-merge-robot","2022-08-08 11:38:26","true","Merge pull request #4175 from flouthoc/fix-cross-build

make,cross: ignore `loong64` from target list",17,66,1,1
"containers/buildah","164672c5bd4edb4db2883a81560a7fcb69d087a4","openshift-merge-robot","2021-05-18 15:16:57","true","Merge pull request #3234 from rhatdan/VENDOR

update vendor of containers/storage v1.31.1",55,52,1,1
"containers/buildah","ced3c7b7fc8ac938bd67d8402880bc0162d233e5","openshift-merge-robot","2021-03-08 13:37:54","true","Merge pull request #3068 from containers/dependabot/go_modules/github.com/onsi/gomega-1.11.0

build(deps): bump github.com/onsi/gomega from 1.10.5 to 1.11.0",57,49,0,1
"containers/buildah","8303587a8c32bcc21c5588cf8a1cc9662de1cf5d","openshift-merge-robot","2022-03-09 14:49:57","true","Merge pull request #3813 from containers/dependabot/go_modules/github.com/docker/distribution-2.8.1incompatible

build(deps): bump github.com/docker/distribution from 2.8.0+incompatible to 2.8.1+incompatible",30,61,1,1
"containers/buildah","215ded7892a3fcb4146ef4315d5a925e3b31d663","nalind","2017-06-02 14:39:26","false","Use errors.New() instead of Wrapf() for new errors

Call errors.New() instead of calling errors.Wrapf() when there's no
error to wrap.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #130
Approved by: rhatdan",12,4,0,1
"containers/buildah","8c14d40c4b6707a45bb8be1c6ed4f5765331b97f","kolyshkin","2022-01-18 03:05:54","false","tests/tools: bump golangci-lint

... and its dependencies.

Also, modify .golangci.yml since new golangci-lint no longer have some
of the linters mentioned. Besides, it is unsafe to enable all linters,
because (1) not all linters are good/useful; (2) new golangci-lint
releases can bring more linters and thus more CI issues. Instead, use
the default set of linters, plus enable a few more:

 * revive (which replaces golint)
 * unconvert

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","0d87e38b6eabb044eb6e0ea7f02aa76553f6eb4a","rhatdan","2023-01-18 23:15:22","false","vendor in latests containers/(storage, common, image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",21,72,1,1
"containers/buildah","357898ff74a88a627f5bb6e6c75a1e84e897459c","rhatdan","2022-09-22 10:28:00","true","Merge pull request #4285 from dfr/freebsd-copy

copier: work around freebsd bug for ""mkdir /""",20,68,1,1
"containers/buildah","e67d2e7356bb763d0ecf80bc867dccc36e15f946","nalind","2017-04-11 19:34:36","false","The ""all"" target shouldn't do any installing

Remove ""install.tools"" as a dependency of the top-level ""all"" target,
and make it a dependency of the ""install"" target.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #62
Approved by: rhatdan",13,3,0,1
"containers/buildah","1ec4983d5041de5e20c2cb336d16b8e603ce43fc","nalind","2021-08-24 19:30:13","false","Replace golang.org/x/crypto/ssh/terminal with golang.org/x/term

The golang.org/x/crypto/ssh/terminal package has been deprecated and
replaced upstream by golang.org/x/term, so switch to that.  It's a
simple 1:1 replacement.

[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",39,55,1,1
"containers/buildah","36e17cbb9bfa6cc30a23f81097902e18e1af0ae8","rhatdan","2021-07-07 11:00:37","false","Fix excludes exception begining with / or ./

Vendor in containers/storage v1.32.6 for the fix

Fixes: https://github.com/containers/buildah/issues/3272

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",38,53,1,1
"containers/buildah","1dbf430563f4e71fe448608c3d57910b5f2b5499","nalind","2021-04-13 18:09:21","false","copier: add GetOptions.NoCrossDevice

Add a NoCrossDevice flag to GetOptions, telling it to ignore
subdirectories on devices different than the top reference directory
that we start from, i.e., ignore the contents of mounted filesystems.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",52,51,0,1
"containers/buildah","3d873faf44048a160a30b4d0ef4afbc2d0a06f9d","nalind","2020-11-12 19:57:35","false","copier.Get(): ignore ENOTSUP/ENOSYS when listing xattrs

When trying to read the list of extended attributes on content that
we're reading, if we get an ENOTSUP or ENOSYS error while attempting to
list the attributes, treat it as if we succeeded and got an empty list
of attributes.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",72,45,0,1
"containers/buildah","5f74a5f26da2fc0ea6549c2c1110923b3f285c18","rhatdan","2020-09-17 10:38:57","false","Merge branch 'master' of github.com:containers/buildah into dependabot/go_modules/github.com/containers/common-0.22.0",92,44,0,1
"containers/buildah","2d57fc6c3f31e3cac4b029da8c95d5d0c1a2fbfb","rhatdan","2020-08-06 12:26:02","false","Shutdown storage on failures

Buildah is leaving storage enabled when commands fail.
Specifically we have seen this with buildah from.
This can lead to a leaked mount point on the system.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",94,42,0,1
"containers/buildah","b4449c693ccfb0c7d8d7bf782fe8594dbb1a6d09","rhatdan","2020-07-02 12:07:51","false","Switch scripts to use containers.conf

Podman no longer uses libpod.conf and has switched to containers.conf.
This change will cause podman to use crun by default, by creating a
/etc/containers/containers.conf file

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",146,41,0,1
"containers/buildah","b163abaa669eac879504262b8d145dce24c7b660","boaz0","2020-05-25 19:46:10","false","fix lighttpd example

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>",135,40,0,0
"containers/buildah","6d798e84fc5ed414d16f182422e4813e80253c8a","rhatdan","2020-02-23 11:24:59","false","Replace unix with syscall to allow vendoring into libpod

unix constants do not work when vendored into libpod, because
libpod can potentially be used on non unix platforms, so
compilation blows up.  Switching to syscall should fix this issue.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",99,37,0,1
"containers/buildah","04e3e090ebe5f845881093129b0b4c07f04fb632","lsm5","2020-02-12 14:54:01","false","include installation steps for CentOS7 and forks

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",113,37,0,1
"containers/buildah","87cb532ab33f1f242a56e362e799f95549519d3b","nalind","2018-10-24 19:15:40","false","runSetupBuiltinVolumes(): break up volume setup

Break setup for built-in volumes into independent steps where we create
the volume's mount point, the directory that will hold its contents, and
if there is content under the mount point, populate the volume with the
mount point's contents.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1126
Approved by: rhatdan",51,21,0,1
"containers/buildah","01a443f7382025264e27ec95ea203ab9314677a2","baude","2018-06-01 19:09:40","false","use absolute path for bundlePath

When running buildah code on Atomic Hosts, we need to make sure
the absolute path for the bundlePath is used or operations
will fail.

Signed-off-by: baude <bbaude@redhat.com>

Closes: #745
Approved by: nalind",38,16,0,0
"containers/buildah","96d15578e46e74c42bc1faa58530690380b1f8fa","nalind","2017-04-03 17:43:34","false","Fixup golint warnings

Fix a number of issues flagged by golint.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #62
Approved by: rhatdan",14,2,0,1
"containers/buildah","18c3ab42abdc0b558ba2f601e8fec8e985b3a09b","nalind","2017-01-28 10:27:34","false","Add a script for use in a lightning talk

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","310b2241988a5111bfb11ed8fe00c87ee01c90a2","rhatdan","2022-04-05 17:11:38","true","Merge pull request #3895 from rhatdan/VENDOR

vendor in latest containers/common,image,storage",25,62,1,1
"containers/buildah","819c227bf277c1bd8859fbc86e5efa6fa693e567","umohnani8","2017-11-21 15:08:12","false","Mention docker login in documentation for authentication

Since we fall back to reading the credentials from $HOME/.docker/config
set by docker login when kpod login doesn't have the credentials

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>

Closes: #331
Approved by: rhatdan",31,10,0,1
"containers/buildah","74603af4106d20944376ec30955716aed1c32200","debarshiray","2019-04-24 11:51:03","false","Fix typo in buildah-pull(1)

'buildah pull' doesn't create a working container. It only pulls an
image from a registry.

Fixes: 834a6c848ceae3c2 (""Create buildah pull command"")

Signed-off-by: Debarshi Ray <rishi@fedoraproject.org>

Closes: #1545
Approved by: rhatdan",53,27,0,0
"containers/buildah","194bf3bf4635ff231581201ee6407004a75da247","mtrmac","2021-09-20 13:44:15","false","Update to github.com/vbauerster/mpb v7.1.5

... to fix https://github.com/vbauerster/mpb/issues/100 .

> go get github.com/vbauerster/mpb/v7@latest
> make vendor

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",39,56,1,1
"containers/buildah","11356996ca5cb2344d710999ea546986f4563b1b","TomSweeneyRedHat","2021-08-12 00:19:33","false","Bump go for vendor-in-container from 1.13 to 1.16

While vendoring c/storage v1.34.0 I was having issues
with io/fs not being able to be vendored via calls in the
latest BurntSushi.  Fortunately I remembered a change to
the Skopeo Makefile that @vrothberg had made recently and
viola, that fixed it.

Also per @nalind's review, I've bumped Go from 1.13 to 1.6 in the
.cirrus.yml file.

[NO NEW TESTS NEEDED]

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",36,54,1,1
"containers/buildah","078efc2197a682842e6b55b3a6d5629cefd41cbd","vrothberg","2021-08-06 09:12:05","false","run: fix nil deref using the option's logger

[NO TESTS NEEDED] since I've no idea how to force it.

Reported-in: containers/podman/issues/11148
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",37,54,1,1
"containers/buildah","1fff9bdbc42a19776ed601adfc96fdff4e3fa5ca","rhatdan","2021-06-02 19:27:04","false","Move to v1.22.0-dev

Since we have a release v1.21.0 going into long term branch, we need to
bump to the next version.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",36,52,1,1
"containers/buildah","b4fa558c4fd2c58154e0af831c5ed507b42dc771","nalind","2021-04-20 14:41:16","false","Restore log timestamps

The rationale for removing them was that they were always zero, but the
examples where that happened all completed in less than one second.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",50,51,0,1
"containers/buildah","7d9b57e9e1287bfc7a5225ed4e377c85e9ba8cf1","rhatdan","2020-12-22 21:12:38","false","Use --arch and --os and --variant options to select architecture and os

Remove --override-os and --override-arch flags.

Also use --platform option if specified when generating the SystemContext.
Conflict --platform option with --os, --arch and --variant options.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",84,47,0,1
"containers/buildah","c1a1805ee855aea1b05c842a80102700aa5de9b4","nalind","2020-09-29 19:01:27","false","add: preserve ownerships and permissions on ADDed archives

When extracting archives that are added using ADD, don't override
permissions and ownership information.  We regressed on this when we
switched to using the copier package to handle them.

Add a conformance test to prevent regressions on this.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",89,44,0,1
"containers/buildah","17bb22f549be8f357edc69d6404c5197e3e06cfe","rhatdan","2020-09-17 13:08:01","true","Merge pull request #2615 from containers/dependabot/go_modules/github.com/containers/common-0.22.0

build(deps): bump github.com/containers/common from 0.21.0 to 0.22.0",92,44,0,1
"containers/buildah","13fda9e3421363945a03181584ffed532915685e","nalind","2020-09-08 16:21:03","false","contrib/cirrus/lib.sh: don't use CN for the hostname

When generating a certificate to be used by a registry server that we're
bringing up, instead of setting a CN value in the subject name to
""localhost"" to pass the name check that a client makes, use a subject
alternative name extension.

The ""compare the hostname we're given with a CN from the subject name
field"" method stops working if the client is built with Go 1.15.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",84,43,0,1
"containers/buildah","d125f8f9cc6babe09035f6920fe0418c4275cea2","rhatdan","2020-08-11 12:21:22","false","Add buildah.IsContainer interface

This interface will allow callers to specify a storage container id
and the store and return whether or not the container is a buildah
container.

We want to add the ability to for Podman to identify containers in storage
that it did not create or were created via podman build command.

Podman will use this information to help user identify where the container
came from.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",86,42,0,1
"containers/buildah","2c6b0da4d8d61f5d5d5c1ac4843c2cb5a0a9ee65","rhatdan","2020-08-04 21:00:47","false","Add BuilderIdentityAnnotation to identify buildah version

Users want an annotation embeded in the image identifying the
version of the tool used to build the images.

We were adding this for buildah commit but not for buildah bud.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",134,42,0,1
"containers/buildah","5bc9748bd4d22f33e51a3b7a7aa86b5e3ba3209c","Vanient","2020-08-03 11:48:46","false","fix spelling mistake in ""info"" command result display

MenFree -> MemFree

Signed-off-by: xiadanni <xiadanni1@huawei.com>",152,42,0,0
"containers/buildah","faa86c4f599fba0e4cefcd3241f54e0925044ab9","rhatdan","2020-07-16 12:59:17","true","Merge pull request #2470 from rhatdan/version

[CI:DOCS] Switch golang 1.12 to golang 1.13",148,42,0,1
"containers/buildah","5361d7a9c1f69fe2f216c558fe0e415bf9c2467a","rhatdan","2020-07-15 12:16:41","true","Merge pull request #2467 from nalind/help-nit

Fix a help string",148,42,0,1
"containers/buildah","84b3a5ee59c503cd657dce0693b63f1c85e518be","rhatdan","2020-07-13 21:12:33","true","Merge pull request #2461 from containers/dependabot/go_modules/github.com/opencontainers/selinux-1.6.0

Bump github.com/opencontainers/selinux from 1.5.2 to 1.6.0",147,42,0,1
"containers/buildah","91ab2e11873bb65c0ccb1042d44c571f634d8786","rhatdan","2020-06-19 11:08:22","true","Merge pull request #2408 from cben/patch-1

CHANGELOG.md: Fix markdown formatting",143,41,0,1
"containers/buildah","de6697fac2f37b26eaa01558173a5848d03e4ec7","nalind","2020-04-08 22:00:10","false","Add preliminary profiling support to the CLI

Add CPU and memory profiling to the CLI, as hidden options.  The picture
they paint doesn't include anything we do in subprocesses, and we use a
lot of those when we're manipulating layers, but it can still be useful
for analyzing our front-end logic.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",117,38,0,1
"containers/buildah","7c8f859dae590f27c8c351c97f3dc512b62b07a9","nalind","2020-02-19 21:01:05","false","Correct a couple of incorrect format specifiers

The fmt package treats %e as a format specifier for floating point
numbers, not errors.  Use %v instead.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",99,37,0,1
"containers/buildah","20b236a8a504f3645555b8c1b267089ad8028aa0","boaz0","2018-08-30 13:54:36","false","Small nitpick at the ""if"" condition in tag.go

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>

Closes: #975
Approved by: rhatdan",33,19,0,0
"containers/buildah","3e8ded864626baf13fd95089c344b33710cff1eb","rhatdan","2017-11-07 22:44:24","false","Add secrets patch to buildah

Signed-off-by: umohnani8 <umohnani@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",30,9,0,1
"containers/buildah","3600057e127939048dd4576b9b38e83b1144e18f","rhatdan","2022-10-27 11:40:00","true","Merge branch 'main' into cached-layer-bind",25,69,1,1
"containers/buildah","df71b8fe6ad8540904165558da44c99369acb082","rhatdan","2017-03-28 18:14:07","false","Update vendor patches

Closes: #51
Approved by: rhatdan",14,2,0,1
"containers/buildah","5ce80091bab2d7fa2e5cec7433845e916e2c059c","rhatdan","2018-03-16 11:57:36","false","Add support for shell

Also vendor in the latest imagebuilder code and all the packages
that come with it.

Note: imagebuilder.NewBuilderForReader has been removed from imagebuilder
so I had to split the function up into two different calls.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #517
Approved by: rhatdan",18,14,0,1
"containers/buildah","7f0b60c6f776c46339bc06a49a00d3703818d4ca","rhatdan","2019-09-05 20:54:40","false","Add support for /run/.containerenv

Container processes want to check for the existence of this file
to determine if they are running inside of a container.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",60,31,0,1
"containers/buildah","ee1c3b71c74f95605a0617e5f7ffb89eca74fd20","lsm5","2021-04-22 18:13:08","false","[CI:DOCS] Remove older distro docs

This commit removes installation steps for older distros:

1. Amazon Linux 2
2. CentOS 7
3. Debian 10
4. Raspbian 10
5. Raspberry Pi OS armhf

We're no longer building new packages for these distros and the
installation steps for older packages are no longer guaranteed to work.
So, these are best removed from the official docs.

Related blog post (also applies to buildah):
https://podman.io/blogs/2021/03/02/podman-support-for-older-distros.html

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",49,51,0,1
"containers/buildah","6306386e072d353b38c0e0020018515b95d3aaf9","nalind","2019-04-24 13:56:15","false","CommitOptions: drop the unused OnBuild field

We don't read the contents of the OnBuild field in CommitOptions, so
drop it from the structure definition.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1539
Approved by: rhatdan",54,27,0,1
"containers/buildah","2358d51e7481b5aa7dc746a0f16fd719d6500567","nalind","2018-09-10 18:27:25","false","chroot: create missing parent directories for volume mounts

When ensuring that the target for a volume mount is present, be sure to
create any leading directories which are also not yet present.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #997
Approved by: rhatdan",36,19,0,1
"containers/buildah","30ab02c681c04c6c73f7646fc70147cf8946c073","nalind","2019-05-29 14:00:48","false","addHelperSymlink: clear the destination on os.IsExist errors

If we fail to create a symbolic link because the destination already
exists, attempt to remove the destination.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1623
Approved by: giuseppe",58,28,0,1
"containers/buildah","e702872667e6a8c0dbe6f0b40076464fe05645ec","rhatdan","2019-01-17 22:44:41","false","Vendor in latest containers/storage

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1289
Approved by: rhatdan",51,24,0,1
"containers/buildah","51415ec68edca7806d6a85fff99fae536b561e5f","TomSweeneyRedHat","2019-08-16 18:03:38","false","Add --digestfile and Re-add push statement as debug

We removed the ""Succesfully pushed ..."" statement from the end of
the `buildah push` command in #1744.  However we've had a request
for that information still so I'm re-adding it as a debug statement
and we can discuss if there's a better way or not.

Also add the --digestfile option.  With it the user will be able
to specify a file to write the digest of the pushed image to for
reference.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1799
Approved by: rhatdan",54,31,0,1
"containers/buildah","fcf94e3982b87702e91df4699ce535c2b548f6a4","TomSweeneyRedHat","2022-03-30 16:03:03","false","Bump to v1.25.1

As the title says

[NO NEW TESTS NEEDED]

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",27,62,1,1
"containers/buildah","a98be4af90513ad4bce448a6e492c0065aade8eb","TomSweeneyRedHat","2018-06-12 10:55:51","false","Touch up images man

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #781
Approved by: rhatdan",33,16,0,1
"containers/buildah","1306a64cddcead1eec0c8f3e473c5540eb51f185","flouthoc","2023-11-01 18:00:32","true","vendor: bump c/image to 373c52a9466f

[NO NEW TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",2,81,1,1
"containers/buildah","17d9a733296dbdb4e2b1e2bb6b5e9c717ee82fcd","TomSweeneyRedHat","2018-01-16 12:31:32","false","Touchup rm and container man pages

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #391
Approved by: rhatdan",31,12,0,1
"containers/buildah","a65e628f2c23eeacd6c8a9546e26494c3407a152","TomSweeneyRedHat","2020-11-16 14:45:35","false","Bump to v1.19.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",77,46,0,1
"containers/buildah","8c250d495de875396c93a38cca135d757141f625","TomSweeneyRedHat","2022-01-22 22:17:38","false","Make pull commands be consistent

Per @edsantiago 's suggestion, make the pull commands consistent, always
accepting a value.  Currently we have:

--pull
--pull=true
--pull=false
--pull-never
--pull-always

With this changes, we will only have pull with a variety of options,
ala:

--pull
--pull=true
--pull=false
--pull=never
--pull=always

For backward compatibility, the --pull-never and --pull-always
options will remain operational, however they are not documented
and are conisdered deprecated.

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",34,60,1,1
"containers/buildah","d972c76b506df41153315ea5725d5bb3c3822ca4","TomSweeneyRedHat","2019-04-25 23:09:46","false","Rework buildahimagegit to buildahimageupstream

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",52,27,0,1
"containers/buildah","aae843123f8d592d34f25db52814e4e49a0fbe2b","TomSweeneyRedHat","2017-12-06 16:14:09","false","Touchup baseline and rpm tests

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",32,10,0,1
"containers/buildah","f5a76e0029c5f33913c1bb45e9c19ae487007af5","umohnani8","2018-03-27 18:06:00","false","buildah bud walks symlinks

After a symlink is created, buildah bud would fail if the symlink was
mounted as a volume.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #541
Approved by: ripcurld",24,14,0,1
"containers/buildah","93a3c899430efb7f0e61bfaa9406b46a558ad1eb","umohnani8","2018-02-13 19:58:56","false","Add the following flags to buildah bud and from

	--add-host
	--cgroup-parent
	--cpu-period
	--cpu-quota
	--cpu-shares
	--cpuset-cpus
	--cpuset-mems
	--memory
	--memory-swap
	--security-opt
	--ulimit

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #477
Approved by: rhatdan",17,13,0,1
"containers/buildah","378cddeebbddfbf9bd04e374601cc7d3bf1b7a53","EricHripko","2019-06-03 21:44:35","false","Fix the handling of symlinks to absolute paths

Signed-off-by: Eric Hripko <ehripko@bloomberg.net>

Closes: #1637
Approved by: rhatdan",59,28,0,0
"containers/buildah","29f306c4b396a03aac8775a221961dfc54af7215","TomSweeneyRedHat","2019-04-07 15:59:09","false","Fix bud-args to allow comma separation

Allow `--bud-args` to take an argument like: `PLUGINS=""plugin1,plugin2,plugin3""`

Fixes #1493

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1495
Approved by: rhatdan",52,26,0,1
"containers/buildah","c0633e38da4134135d35d32b56194790ca8acecd","TomSweeneyRedHat","2019-05-03 22:06:21","false","Handle WORKDIR with dangling target

When the WORKDIR is a symlink and the target directory does not exist, RUN
commands would fail.  If the target doesn't exist, create the directory in
the container.  This also converts the code to use SecureJoin so that if
a symlink is in the middle of a filepath, it will be converted correctly.

Fixes: #1569

Tip of the hat to @karelyatin for the initial fix

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1576
Approved by: rhatdan",55,27,0,1
"containers/buildah","8b4ada202d26570d2d7f8e812eddece08369e8e0","TomSweeneyRedHat","2019-05-01 15:13:29","false","Change image names to stable, testing and upstream

Make the buildahimage names be a bit more concise per @vbatts discussion
in another pr.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1570
Approved by: rhatdan",53,27,0,1
"containers/buildah","a5d9f1cb280006c3cbc4693e682687c559cf5f8a","rhatdan","2021-11-01 20:52:48","false","Add --unsetenv option to buildah commit and build

This option will allow users to remove environment variables from the
final image.

Fixes: https://github.com/containers/buildah/issues/3512

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",31,57,1,1
"containers/buildah","6af847dd2a527de2d35d07dec1286fb81de5622f","rhatdan","2018-02-06 19:01:17","false","Vendor in latest containers/storage

A patch got merged into containers/storage that makes sure SELinux labels
are appliced when committing to storage.  This prevents a failure condition
which arrises from leaked mount points between the time a container is mounted
and it is committed.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #453
Approved by: TomSweeneyRedHat",36,12,0,1
"containers/buildah","28195ac9d947e0abbdc1613b90d9c91184f69ebe","AndASM","2022-09-28 19:24:19","false","Changing shell list operators from `;` to `&&`

As per discussion with @nalid, updating the inconsistent use of
sequential operator (`;`) to the AND operator (`&&`) to avoid ignoring
errors. (Previous commit mimicked existing style.)

Signed-off-by: Andrew Meadows <andrew@befuddled.ca>",21,68,1,0
"containers/buildah","723ed8e183a9ebf8c162a8c9bfc98598d569c4ec","TomSweeneyRedHat","2023-06-30 14:17:02","false","Bump c/common to 0.55.1 and c/image to 5.26.1

As the title says.  This is the last bit of the
vedor dance for Buildah in early prep for RHEL 8.9/9.3

[NO NEW TESTS NEEDED]

Signed-off-by: Tom Sweeney <tsweeney@redhat.com>",13,77,1,1
"containers/buildah","1c85af88fb02f7550bfcd0f8ad9f5be2610df4d7","openshift-merge-robot","2023-09-04 23:22:00","true","Merge pull request #5017 from containers/renovate/golang.org-x-sys-0.x

fix(deps): update module golang.org/x/sys to v0.12.0",7,79,1,1
"containers/buildah","94dd0b637ce03b803d5c9c94cebb856acde12b89","openshift-merge-robot","2023-08-14 13:54:45","true","Merge pull request #4972 from containers/renovate/major-ci-vm-image

chore(deps): update dependency containers/automation_images to v20230809",9,79,1,1
"containers/buildah","e32d5253635945caaf8cf58c6db83b61616ec663","openshift-merge-robot","2022-03-08 16:44:10","true","Merge pull request #3804 from flouthoc/buildah-rootless-cirrus

buildah: test rootless integration",30,61,1,1
"containers/buildah","159b162230cb7faf2d9c6e4ed44d60df2e4e3059","openshift-merge-robot","2020-10-05 16:58:31","true","Merge pull request #2673 from containers/dependabot/go_modules/github.com/containers/common-0.24.0

build(deps): bump github.com/containers/common from 0.23.0 to 0.24.0",86,44,0,1
"containers/buildah","a84b205c5fd4b4a8b846ef6da5496cdb048f70b2","afbjorklund","2018-10-07 12:33:45","false","Allow setting --no-pivot default with an env var

Signed-off-by: Anders F Björklund <anders.f.bjorklund@gmail.com>

Closes: #1071
Approved by: rhatdan",51,20,0,1
"containers/buildah","cb2eee7358bfda17abba58c483720c8e7fa12d77","flouthoc","2023-05-23 17:35:14","true","Merge pull request #4813 from nalind/re-deathsig

Go back to setting SysProcAttr.Pdeathsig for child processes",18,76,1,1
"containers/buildah","2fb1e16542de7afd46d7532ee410175c04afec6c","rhatdan","2019-01-02 14:01:11","false","Fix compiler Warning about comparing different size types

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1253
Approved by: vrothberg",54,23,0,1
"containers/buildah","333899deb62e382c0ae1dd679ef63dccca6cf5be","rhatdan","2017-09-22 09:59:07","false","Merge pull request #264 from lsm5/fix-readme-ubuntu

update README.md to remove Debian mentions",34,8,0,1
"containers/buildah","485412ef0d3d971c6d338f5d48d8641bf6e78b9e","nalind","2018-10-25 16:35:17","false","Wire in a hidden --blob-cache option

Add a hidden --blob-cache option to bud, commit, from, pull, and push,
mainly so that we can exercise the APIs using integration tests.  It's
easy to accidentally get to a place where an image created while using
this option at various times won't be pushable, so for at least now, it
should stay hidden and undocumented.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1149
Approved by: rhatdan",51,21,0,1
"containers/buildah","18063d19b6f59600b0bbd7466c6257d0027f123f","nalind","2018-06-14 19:42:33","false","main: if unprivileged, reexec in a user namespace

If our CLI is invoked as an unprivileged user (uid != 0),
* create a namespace using our own UID and GID as ""0"" followed by the
  ranges matching our name and our primary group's name that we find in
  /etc/subuid and /etc/subgid (the latter by way of using newuidmap and
  newgidmap)
* re-exec ourselves inside of that user namespace, prepending global CLI arguments that:
  * override the driver from storage.conf with ""vfs""
  * override the storage root from storage.conf with a ""containers/storage"" subdirectory
    of $XDG_DATA_HOME, or $HOME/.local/share.
  * override the storage runroot from storage.conf with either ""$XDG_RUNTIME_DIR/run"" or
    ""/var/run/user/$uid/run""
  * set default ID mapping settings to map all of the ranges matching
    our name and our primary group's name that we found in /etc/subuid
    and /etc/subgid
  * can still be overridden using the command line

Add a ""buildah unshare"" CLI that will start an arbitrary command in the
first namespace, so that manual cleanup of locations used by the second
namespace will be possible.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #823
Approved by: rhatdan",30,17,0,1
"containers/buildah","90babdf502a3da1073cec964160fb1a452935ca6","nalind","2018-06-07 17:55:38","false","Update github.com/opencontainers/runc

Update our vendored version of github.com/opencontainers/runc, mainly to
get the libcontainer/apparmor package.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #821
Approved by: rhatdan",31,16,0,1
"containers/buildah","93565800a7348a11daa5ded06c09b2da246e0b1f","rhatdan","2023-08-29 10:37:42","true","Merge pull request #4998 from containers/renovate/github.com-containerd-containerd-1.x

Update module github.com/containerd/containerd to v1.7.5",7,79,1,1
"containers/buildah","9ae09bf72fc4d29b40647646c703564856fb17a1","rhatdan","2022-09-25 12:00:14","false","Set sysctls from containers.conf

Fixes: https://github.com/containers/buildah/issues/4291

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",21,68,1,1
"containers/buildah","b599244cd1fef3e9fee2831b4434f75a640f4f9d","baude","2018-06-26 20:35:43","false","vendor in latest runtime-tools

The latest runtime-tools is aware of other OS's than Linux.  Libpod needs the newer
version to compile on darwin.  Unfortunately, the API for generator.New() changed
and requires a string representation of the OS; furthermore, it also returns a
a generator and an error so code had to be adjusted for this too.

Signed-off-by: baude <bbaude@redhat.com>",28,17,0,0
"containers/buildah","705ecf9f799a73680ec0f8e6926841433d477e57","vrothberg","2019-02-20 13:26:27","false","add hack/tree_status.sh script

This script can later be integrated into the CI and is meant to be run
after a `make vendor` to make sure that all-things-vendor are in sync.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1350
Approved by: TomSweeneyRedHat",60,25,0,1
"containers/buildah","891019918190c3f836f116f890e1bf0220c45108","ipbabble","2017-12-06 21:10:57","false","Add a new tutorial for using Buildah with registries

Signed-off-by: William Henry <whenry@redhat.com>",32,10,0,0
"containers/buildah","9f2a6827800b0d2339faaaa3819ccc994fcc4ab4","saschagrunert","2019-09-05 13:24:40","false","Truncate output of too long image names

Image names longer than 32 characters will now be truncated via `...` in
the default table output. For example this:

```
CONTAINER ID  BUILDER  IMAGE ID     IMAGE NAME                       CONTAINER NAME
579aa959bb4d     *     9b1a5a0c02f5 docker.io/clearlinux/golang:latest golang-working-container
```

Now looks like this:

```
CONTAINER ID  BUILDER  IMAGE ID     IMAGE NAME                       CONTAINER NAME
579aa959bb4d     *     9b1a5a0c02f5 docker.io/clearlinux/golang:l... golang-working-container
```

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1841
Approved by: rhatdan",59,31,0,1
"containers/buildah","2a32f0bacd5ba3a3c5324e001556c62d785d9d02","abergmeier","2022-01-07 22:09:21","false","Allow processing of common options from FlagSet

In situations where you don't want/need Cobra climbing behavior nor
Cobra at all using FlagSet is the easier sell.

Signed-off-by: Andreas Bergmeier <abergmeier@gmx.net>",27,59,1,0
"containers/buildah","b5060e29537ec0283a948f59148a07f0c83d4e92","openshift-merge-robot","2023-03-14 21:07:25","true","Merge pull request #4566 from flouthoc/run-network

run: add support for inline `--network` in `RUN` statements",16,74,1,1
"containers/buildah","1b3dc91924a988459ca3e0d7d7bd3a5433669c07","openshift-merge-robot","2021-01-08 15:32:32","true","Merge pull request #2896 from rhatdan/VENDOR

Update vendor of containers/storage and containers/common",91,47,0,1
"containers/buildah","42d866f88a92dfd8176e70430f2e25eef9b24c69","nalind","2018-03-07 23:10:06","false","containerImageSource: return more-correct errors

Return errors indicating that a containerImageSource doesn't support
manifest lists when methods that take an instance digest are given
non-nil values, instead of the catch-all TODO errors that they used to
return.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #705
Approved by: rhatdan",20,13,0,1
"containers/buildah","d31c5fb272bae51f7dc9f65899bfccd1208f68e1","openshift-merge-robot","2020-11-17 21:31:09","true","Merge pull request #2801 from hshiina/idmapping

Compute diffID for mapped-layer at creating image source",77,46,0,1
"containers/buildah","4ec1e81cc705527b5e0fc988b7a89efd2b67f4c6","openshift-merge-robot","2021-02-23 10:37:26","true","Merge pull request #3028 from containers/dependabot/go_modules/github.com/containers/image/v5-5.10.3

build(deps): bump github.com/containers/image/v5 from 5.10.2 to 5.10.3",60,49,0,1
"containers/buildah","ebadc2a2c82baa43696db63f477688ec7cf91f29","openshift-merge-robot","2023-08-05 02:34:22","true","Merge pull request #4872 from cevich/fix_bad_test_env

Cirrus: container/rootless env. var. passthrough",12,78,1,1
"containers/buildah","1ed6c7123ff620bb5616a10214964f2ff2f0fb30","nalind","2017-05-30 15:51:40","false","Finish wiring --format into build-using-dockerfile

We weren't properly passing the preferred output format to the Commit()
method when committing images that we were building using
build-with-dockerfile.  Fix that.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #127
Approved by: rhatdan",15,4,0,1
"containers/buildah","d08df52c14d216f451861231c38299e7f38755a4","nalind","2021-10-12 18:50:20","false","Expand the godoc for CommonBuildOptions.Secrets

Some of our godoc strings manage to provide no information.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",41,56,1,1
"containers/buildah","51ef0a47da81a9759fbc449e1a09d5eac8bfb6e7","nalind","2021-02-17 18:44:40","false","copier.GetOptions: add NoDerefSymLinks

Add a NoDerefSymlinks flag to force items that are matched to the Globs
we're given to be treated as symlinks, rather than dereferencing them as
we would need to do for sources for ADD or COPY.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",60,49,0,1
"containers/buildah","5c26f717ccf5203faba53decb94144af6aafad62","flouthoc","2022-01-09 12:46:09","true","multi-stage: enable mounting stages across each other with selinux enabled

Stage mounting was not functionl for systems with `selinux` enabled
following commit makes sure we enable it and removes temporary
workaround/hack which was preventing to do it.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",26,59,1,1
"containers/buildah","0e707faa7ba47ee6ed1110b25087263a805250b2","nalind","2023-02-16 20:47:08","false","Ignore the base image's base image annotations

When initializing a stage in a multi-stage build that's based on the
end-result of an earlier stage, don't reset the base image name/digest
annotations.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",18,73,1,1
"containers/buildah","c8032d783b03bf5509a289470fab7ee844f1d449","nalind","2017-03-27 19:35:09","false","Handle ADD/COPY where the destination ends with /

When the destination for an ADD or COPY operation ends with a path
separator, take that as an indicator that the destination should be a
directory, that we should create it if it doesn't already exist, and
that any files we're copying should be placed in the directory.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #56
Approved by: rhatdan",14,2,0,1
"containers/buildah","62c01da3e4af451cd5c09522cf268beed1714c38","nalind","2018-10-02 17:48:45","false","Correctly set DockerInsecureSkipTLSVerify when pulling images

The image library's copy routine doesn't itself consult the registries
configuration in order to decide whether or not to disable TLS
verification when communicating with a registry, so it's on us to use
the name of a source or destination image to decide whether to set the
flag for that behavior.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1056
Approved by: rhatdan",43,20,0,1
"containers/buildah","b2e43c7d6d6a1f24f8ff09dcc6a0c8b1fdefde91","nalind","2018-08-20 19:25:10","false","Support HEALTHCHECK

Handle healthcheck configuration that imagebuilder picks up, and add CLI
flags to `buildah config` that allow the values to be set on the command
line.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #943
Approved by: TomSweeneyRedHat",27,19,0,1
"containers/buildah","75c13530ac882c4a302fbb47f75984a4e59e8cb7","nalind","2017-03-28 15:23:43","false","Update example scripts to use the new CLI syntax

Update the scripts in examples/ to adapt to changes in the CLI.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #48
Approved by: rhatdan",14,2,0,1
"containers/buildah","83a1ec775e50057f9513f2a5eb6d0b73532590d0","nalind","2017-03-16 14:19:05","false","Clarify that we can find containers by name or ID

Clarify that the --name option can also specify a container ID, and the
right things will still happen.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,2,0,1
"containers/buildah","25a0e2c754c5c90a3371665c2ec7eb6f8c2a9bcf","giuseppe","2021-03-12 08:15:41","true","image: propagate errors from extractRootfs

every error from copier.Get was previously lost and not propagated
back.  That caused the caller to believe the operation was successful
and lead to incomplete images on errors.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",60,50,0,1
"containers/buildah","8a23247ce9478d6dadd88e93f8c4d32fd3ed1925","giuseppe","2019-10-30 09:48:28","true","build: drop support for ostree

it is going to be removed from containers/image as well, so no longer
depend on it.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",82,33,0,1
"containers/buildah","37fbff181bb29a94bafa08fbfbbdfe5de6f2d971","openshift-merge-robot","2023-03-29 11:48:05","true","Merge pull request #4686 from NotBobTheBuilder/build-arg-file

build: accept arguments from file with --build-arg-file",13,74,1,1
"containers/buildah","4925e86272121a6e5d83f8a4f594449eae8fdb7a","openshift-merge-robot","2021-01-25 19:15:53","true","Merge pull request #2928 from umohnani8/env

Use build-arg ENV val from local environment if set",95,48,0,1
"containers/buildah","20c5c5c6d8293d44f5bdd31bed6be405918aeed0","flouthoc","2022-06-20 07:29:56","true","build, userns: add support for --userns=auto

Buildah now supports `--userns=auto` which can automatically pick an empty range and create an user namespace for the container.

The `--userns=auto` flag, requires that the user name containers and a range of subordinate user ids that the build container is allowed to use be specified in the /etc/subuid and /etc/subgid files.

Example: `containers:2147483647:2147483648`.

Buildah allocates unique ranges of UIDs and GIDs from the containers subordinate user ids. The size of the ranges is based on the number of UIDs required in the image. The number of UIDs and GIDs can be overridden with the size option.

Valid auto options:

    * gidmapping=CONTAINER_GID:HOST_GID:SIZE: to force a GID mapping to be present in the user namespace.

    * size=SIZE: to specify an explicit size for the automatic user namespace. e.g. --userns=auto:size=8192. If size is not specified, auto will estimate a size for the user namespace.

    * uidmapping=CONTAINER_UID:HOST_UID:SIZE: to force a UID mapping to be present in the user namespace.

Signed-off-by: Aditya R <arajan@redhat.com>",23,65,1,1
"containers/buildah","3fc5274d36aabf73dfc3e6c9287cdf0e50e29388","flouthoc","2023-09-05 04:43:38","true","docs: use valid github repo

[CI:DOCS]
[NO NEW TESTS NEEDED]
Closes: https://github.com/containers/buildah/issues/4814

Signed-off-by: Aditya R <arajan@redhat.com>",7,79,1,1
"containers/buildah","50869a793afe4a79df87eda2c7a236fbef441604","openshift-merge-robot","2021-10-11 07:52:47","true","Merge pull request #3579 from rhatdan/docs

[CI:DOCS] De-dockerize the man page as much as possible",40,56,1,1
"containers/buildah","a0a7899507fabd353f2b4d331ebcfae8f5f36419","PaulUrwin","2019-07-31 17:56:36","false","Fix bug whereby --get-login has no effect

Signed-off-by: Paul Urwin <register@paulurwin.com>",46,30,0,0
"containers/buildah","5e3f26de2f02511e9afefc851700e41450fc3004","TomSweeneyRedHat","2023-01-24 20:35:01","false","Bump c/storagev1.45.3, c/imagev5.24.0, c/commonv0.51.0

Bump the c/storage, c/image and c/common libraries in preparation for
RHEL 8.8/9.2 and Podman v4.4

Just one more vendor dance left!

[NO NEW TESTS NEEDED]

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",19,72,1,1
"containers/buildah","c9ee483604cb1c8cc4d96c5660992bbd7b56ed59","umohnani8","2018-04-12 20:26:47","false","Remove tarball as an option from buildah push --help

pushing to the tarball transport is not supported, so removing
the option from the inline help

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #583
Approved by: rhatdan",33,15,0,1
"containers/buildah","45bd47b4e330b1c7de50dd541121024e109d4648","flouthoc","2022-05-17 09:23:00","true","run: allow resuing secret twice in different RUN steps

If a secret is used in a RUN step it is created on host but we had a
check which expects a secret to not exist on the host however same
secret can be remounted on another step so it can already exists on host
so remove the check since a secret can be mounted again from host in
another RUN step.

Closes: https://github.com/containers/buildah/issues/3993

Signed-off-by: Aditya R <arajan@redhat.com>",25,64,1,1
"containers/buildah","153ee2f0e973724f935ccb7275ce941fda4f121b","TomSweeneyRedHat","2020-03-17 20:00:42","false","Bump to v1.14.3

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",109,38,0,1
"containers/buildah","61ba32647ef79c0fd6881c087d02967d631bc49f","rhatdan","2023-03-18 20:03:12","true","Merge pull request #4660 from danishprakash/img-id-len

imagebuildah: set len(short_image_id) to 12",14,74,1,1
"containers/buildah","6852a0ad4c3a8fb82aec11e3334276680f13fdc8","rhatdan","2022-07-18 18:50:51","true","Merge pull request #4117 from dfr/vendor

bump github.com/opencontainers/runtime-tools",21,66,1,1
"containers/buildah","2ed476d2b72b9b12bb5d84d0de18ac5add23c3a7","kolyshkin","2022-01-20 03:11:57","false","CI: rm git-validation, add GHA job to validate PRs

Currently, git-validation is used to do two things:
1. Check that all commits in a PR has DCO (Signed-off-by)
2. Check that all commits has limited subject length

Nowdays, there are better tools for that. For DCO,
https://github.com/apps/dco can be used, and for subject length check, I
mocked up a GHA CI job (originally in opencontainers/runc -- copied from
there with some minimal changes).

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",33,60,1,0
"containers/buildah","ed413d00802c0ce20841c5453e75cd69b9ff954f","nalind","2021-08-12 17:46:09","false","tests/serve/serve.go: use a kernel-assigned port

When firing up a minimal server to serve up content so that we can
retrieve it using HTTP, make it possible to let the kernel assign us
which port to use, so that the script that's calling us doesn't have to
make a(n occasionally bad) guess.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",36,54,1,1
"containers/buildah","3a5635f90b20d29a6265ece34e218a628843718e","ashley-cui","2021-07-26 06:07:23","false","Implement SSH RUN mount

Allow ssh socket from host or certain ssh keys to be exposed to a
certain RUN instruction, but not any other instructions, as well as not
showing up in the final image.
This is done by spawining a new agent from buildah and mounting
the listening socket inside the run. SSH_AUTH_SOCK inside the container
will be set to the socket mountpoint. The defualt mountpoint is
/run/buildkit/ssh_agent.{i}

Signed-off-by: Ashley Cui <acui@redhat.com>",38,54,1,0
"containers/buildah","6eb5801723b3659d0b30e4ab8c62345328c0af87","giuseppe","2020-12-15 16:21:34","true","pkg, cli: rootless uses correct isolation

when running as rootless, make sure the cli default isolation is set
to ""rootless"" instead of ""oci"".

Closes: https://github.com/containers/buildah/issues/2750

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",80,47,0,1
"containers/buildah","53608cd114a5767dfd56372129534a6d58dbc3b0","vrothberg","2020-06-17 14:25:08","false","vendor github.com/containers/image/v5@v5.5.1

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",144,41,0,1
"containers/buildah","f5033ab2ae03c1870a17b2cf404d89d20fe561d3","umohnani8","2020-04-06 13:57:52","false","Downgrade siruspen/logrus from 1.4.2

The upgrade of logrus forces to update the dependency in go module
consumers as well.

The new locking in logrus 1.5.0 introduces regressions in conjunction to
deadlocks when using custom hooks, which is the case in CRI-O for
example.
Having it point to v1.5.0 here is forcing cri-o to upgrade it as well
when we update c/buildah to v1.14.6.

Let's downgrade logrus till sirupsen/logrus#1122
is fixed.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>",117,38,0,1
"containers/buildah","9c6e52b963971d47271f041509e6b5c00ecf2805","leorochael","2020-02-10 23:53:40","false","Adjust Ubuntu install info to also work on Pop!_OS

Tested on `Pop!_OS` 19.10

Signed-off-by: Leonardo Rochael Almeida <leorochael@gmail.com>",113,37,0,0
"containers/buildah","a3dec025f399e73f1d434651998998590b91f828","boaz0","2020-01-01 14:41:06","false","set HOME env to /root on chroot-isolation by default

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>

Closes: #2057
Approved by: rhatdan",97,35,0,0
"containers/buildah","e54b4809ff6ba18137a57a3df0fb9757a67f715c","vrothberg","2019-04-18 05:27:09","true","Merge pull request #1528 from nalind/cause

Use errors.Cause() when checking for IsNotExist errors",52,27,0,1
"containers/buildah","0c5bfcd4f0fb5c76b49335a52d5f3a3f9ef84305","openshift-merge-robot","2021-01-25 22:02:52","true","Merge pull request #2930 from vrothberg/fix-2836

local image lookup by digest",94,48,0,1
"containers/buildah","a20b5f4689d5bcbe8749850d3f5ecc1fe377490c","openshift-merge-robot","2021-08-26 14:13:08","true","Merge pull request #3482 from rhatdan/timestamp

Add epoch time field to buildah images",38,55,1,1
"containers/buildah","814868e7f9c9db613f3e5bfaf53d071ce7aa44ec","openshift-merge-robot","2021-06-17 19:18:50","true","Merge pull request #3306 from kwshi/document-rmi-parent

man pages: clarify `rmi` removes dangling parents",41,53,1,1
"containers/buildah","ce02da9b9ba5b0cb18756aaa9d27b7f3fe970200","nalind","2018-06-25 15:43:54","false","Run(): don't include any default environment variables

When copying environment variables from the image's configuration to the
spec that we'll pass to the runtime, clear out any defaults that the
generate package might be supplying.  Currently, that's ""$TERM"".

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #820
Approved by: rhatdan",28,17,0,1
"containers/buildah","52d797d63396581897cc9ef69322e452c1e474e7","nalind","2018-10-11 20:58:04","false","imagebuilder.BuildDockerfiles: return the image ID

Return the ID of the built image, and a canonical reference, from
BuildDockerfiles().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1097
Approved by: rhatdan",53,20,0,1
"containers/buildah","e86366519244086efdd96cdf4a0ee0a1f2f45bc9","nalind","2020-11-17 16:16:48","false","imagebuildah: disable pseudo-terminals for RUN

Always handle RUN instructions with no pseudo terminal, which matches
what I see with docker build 19.03.  Interactive 'buildah run' will
still have the same default behavior.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",78,46,0,1
"containers/buildah","a532522624315dd6ae16add16c85d7961e873e8a","nalind","2017-03-28 07:07:14","false","Vendor openshift/imagebuilder

Vendor openshift/imagebuilder and its dependencies, and pick up new
dependencies on golang.org/x/text and github.com/opencontainers/selinux.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #59
Approved by: rhatdan",14,2,0,1
"containers/buildah","38ef1231f25e29f966bd85626798530a81e3c17f","nalind","2018-05-11 17:08:18","false","Add and implement IsolationChroot

Add an IsolationChroot that trades flexibility and isolation for being
able to do what it does in a host environment that's already isolated to
the point where we're not allowed to set up some of that isolation,
producing a result that leans more toward chroot(1) than runc(1) does.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #836
Approved by: rhatdan",56,15,0,1
"containers/buildah","c5244fe0bf4ee86d34111a9cbd612429a532358f","nalind","2019-11-13 14:49:15","false","info: use util.Runtime()

We have a function that decides what our OCI runtime command is, and
duplicating that logic for `buildah info` isn't necessary.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1980
Approved by: vrothberg",79,33,0,1
"containers/buildah","3e1d45a8d65d3c939d3b4639da88e68bde1bb4bf","ypu","2019-11-06 10:42:59","false","Tests: Add inspect test check steps

Add check steps for inspect with container id and image id.

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #2004
Approved by: rhatdan",82,33,0,0
"containers/buildah","78416393ffb5e71c48f0a36616d5c89d95dc57a8","lsm5","2023-03-23 10:33:58","true","[CI:BUILD] Packit: Enable Copr builds on PR and commit to main

This commit adds Packit configuration files which will trigger rpm
builds on copr:`rhcontainerbot/packit-builds` on every PR as well as on
copr:`rhcontainerbot/podman-next` on every commit to main branch.

This commit will ensure main branch is always buildable on all supported
Fedora and CentOS Stream versions for aarch64 and x86_64.
TODO: enable build checks for s390x and ppc64le while ensuring they
don't take too long to build.

The packit builds reuse `buildah.spec.rpkg` present upstream and are
thus independent of Fedora / CentOS dist-git.

This change will remove the need for the current webhook based triggering
of rpm builds on rhcontainerbot/podman-next after commit to main.
That will be instead handled by the `trigger: commit` action added in this
PR. New builds will continue to get posted to the same link so users
don't need to change any existing copr repo configuration.

[NO NEW TESTS NEEDED]

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",12,74,1,1
"containers/buildah","e997a966f8cc0d6eb0db62092025ecbd5f7f2639","lsm5","2023-08-21 13:53:22","true","[CI:BUILD] rpm: spdx compatible license field

The lowercase `and` in the License field isn't compatible with spdx
license format.

This commit replaces all `and` with `AND` in the License field in spec.

[NO NEW TESTS NEEDED]

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",8,79,1,1
"containers/buildah","5ececfad2c604d2ae9c9b0fe2cd639a71b1b20b7","umohnani8","2017-11-09 15:12:58","false","Vendor in latest container/image

Adds support for converting manifest types when using the dir transport

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>

Closes: #321
Approved by: rhatdan",30,9,0,1
"containers/buildah","1826a1a016959c8179174af4f0ac8f124f7bf2ca","openshift-merge-robot","2021-06-23 16:56:29","true","Merge pull request #3333 from vrothberg/docs

[CI:DOCS] push/pull: clarify supported transports",37,53,1,1
"containers/buildah","0951bb2dcadf091d2d49405cc8b268ef7988f8b2","openshift-merge-robot","2023-05-20 10:15:34","true","Merge pull request #4803 from containers/renovate/github.com-onsi-gomega-1.x

fix(deps): update module github.com/onsi/gomega to v1.27.7",14,76,1,1
"containers/buildah","c87de090ad7fe7a4223cde80d00cfb6fe4fe0744","openshift-merge-robot","2022-03-24 17:19:43","true","Merge pull request #3848 from lsm5/main-cve-2022-21698

Bump github.com/prometheus/client_golang to v1.11.1",31,62,1,1
"containers/buildah","b747f5d5e3b2c70a80ce972304f4f725cbd34de7","openshift-merge-robot","2021-04-22 12:00:52","true","Merge pull request #3171 from edsantiago/really_truly_docker

push to docker test: don't get fooled by podman",49,51,0,1
"containers/buildah","3498b7018c1b1f6a85808c9a76e50b9f3e2d4b5b","flouthoc","2022-05-02 05:07:50","true","imagebuildah, executor: process arg variables while populating baseMap

While processing `FROM <token> as final` executor populates baseMap as
it is without resolving or processing for any ARG values. Following
commit ensures that we process resolve any ARG variables with ARG values
while populating baseMap so it can be used later to check if stage is
reused.

Fixes: https://github.com/containers/buildah/issues/3939

Signed-off-by: Aditya R <arajan@redhat.com>",25,63,1,1
"containers/buildah","4899f4f7fbc9c282bef12aa00c53ec64281dae95","nalind","2017-01-27 12:09:31","false","Flesh out v1 image configuration a bit

Basically finish building v1 images.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","4deded7b06b37e59a480ea867dce8bb4194db358","mtrmac","2019-02-08 23:00:51","false","Vendor in latest c/storage and c/image

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1331
Approved by: rhatdan",58,24,0,1
"containers/buildah","8dd593c0925c19a2a164cc387e2d5c14c663193a","cevich","2019-10-29 19:30:49","true","Skip overlay test w/ vfs driver

Signed-off-by: Chris Evich <cevich@redhat.com>",82,33,0,1
"containers/buildah","0b84b23e2ea72fe9c4a806fa107b069886b4b908","cevich","2019-06-05 20:10:06","false","Cirrus: Initial implementation

Based on containers/storage

Signed-off-by: Chris Evich <cevich@redhat.com>

Closes: #1644
Approved by: rhatdan",59,28,0,1
"containers/buildah","96871dfed80c7d824b52368d415fbaa3a74a74e0","cevich","2020-01-16 15:57:47","true","Cirrus: Improve automated lint + validation

+ Increase validation output level when executing under automation
+ Increase linting timeout when executing under automation

Signed-off-by: Chris Evich <cevich@redhat.com>",99,36,0,1
"containers/buildah","d8fe40025af409ef769e4d4f747ea0609f738030","TomSweeneyRedHat","2019-04-16 23:20:32","false","Bump back to 1.8-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1524
Approved by: rhatdan",54,27,0,1
"containers/buildah","aa06a772a12c9bc7b3ad96b82070bad138dc075d","TomSweeneyRedHat","2019-06-04 13:09:00","false","Bump back to v1.9.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1641
Approved by: nalind",59,28,0,1
"containers/buildah","4aa16cf48a88a945a86325c0bf697efcf4993443","TomSweeneyRedHat","2019-04-26 11:33:13","false","Bump to v1.8.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1553
Approved by: rhatdan",51,27,0,1
"containers/buildah","61cb083fde121d26bed79b1936995329a88a6dba","rhatdan","2018-10-09 19:22:42","false","Change from testing with golang 1.9 to 1.11.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1078
Approved by: TomSweeneyRedHat",50,20,0,1
"containers/buildah","b5c130e7dbca3ac43a905b5a5354e240133feb5e","rhatdan","2021-07-12 14:41:28","false","Reuse code from containers/common/pkg/parse

At some point code from buildah/pkg/parse we copied into
containers/common/pkg/parse.  Buildah should use the new code
now, so that we only have to make changes in one place.

[NO TESTS NEEDED] Since there is no new code added.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",39,53,1,1
"containers/buildah","8ecefa978ce56f5716acecf95da6b57866d03c9d","rhatdan","2017-10-09 19:05:56","false","Vendor in changes to support sirupsen/logrus

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",33,8,0,1
"containers/buildah","a172388917f8e0ee477b89418f586b0eea30023e","rhatdan","2022-11-03 21:09:03","false","codespell code

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",24,69,1,1
"containers/buildah","62fc48433c26040a798d3e421ce325d0d53c0dcc","rhatdan","2017-09-21 11:39:39","false","Add support for `buildah run --hostname`

Need to set the hostname inside of a container.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #266
Approved by: nalind",34,8,0,1
"containers/buildah","4674656eb35bf1b43ef92efc2fd03f20269b364f","giuseppe","2018-12-19 15:47:56","false","vendor: update libpod

inherit some bug fixes for rootless containers

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1246
Approved by: rhatdan",52,23,0,1
"containers/buildah","f94159340b0aff831c643042e4227bf6b23f4a94","nalind","2018-08-09 18:15:40","false","Don't bother with --no-pivot for rootless isolation

When running outside of a container, --no-pivot isn't necessary, and
when running inside of a container, it's not enough to solve any of the
difficulties we're seeing there.  It may trigger an EPERM for unshare()
calls inside of the container that we launch, and we don't want that, so
drop it, for now at least.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #921
Approved by: rhatdan",23,18,0,1
"containers/buildah","7a42d3c6d3e24304bce500e34111b647cb329675","nalind","2017-05-17 21:01:06","false","Learn to commit images in multiple formats

Build configuration and manifest data for both output formats that we
support, and select one or the other based on the list of manifest types
that would be accepted as a source image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #118
Approved by: rhatdan",10,4,0,1
"containers/buildah","a4cc906be74725b866a562c2ba44f5d2584028af","nalind","2018-06-14 17:43:54","false","Run(): handle POLLNVAL results

Handle POLLNVAL status from poll() (invalid request, descriptor is not
open) by removing the descriptor from the list that we poll on.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #795
Approved by: rhatdan",30,17,0,1
"containers/buildah","6c84328107b950f774da1b2be3ef59371b68de45","nalind","2017-04-27 17:50:45","false","Bump github.com/containers/storage

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #87
Approved by: nalind",9,3,0,1
"containers/buildah","943191c7c2f507d8b9110fe725674c494a3e599a","nalind","2017-03-24 17:10:23","false","Correctly set tags on the names of pulled images

Correctly set the tag portion of the name that we assign to images that
we've pulled.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #42
Approved by: nalind",14,2,0,1
"containers/buildah","effb375b5a29d1232a1811c3e64caa60c73fc647","nalind","2021-02-16 18:40:23","false","ADD/COPY: create the destination directory first, chroot to it

Always create the destination directory first when ADDing or COPYing
content into a container, then extract contents into it using the
destination directory as the chroot instead of the container's root
directory.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",62,49,0,1
"containers/buildah","21b1a9349daccfdc8abc045ca05c9f0ea7a2e4d4","nalind","2017-06-14 17:32:37","false","Add a -a/--all option to ""buildah containers""

Add a --all option to ""buildah containers"" that causes it to go through
the full list of containers, providing information about the ones that
aren't buildah containers in addition to the ones that are.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #148
Approved by: rhatdan",12,5,0,1
"containers/buildah","3691a23cfb69b8633be1bdd7db59fbe066855e5a","lsm5","2022-03-03 19:21:16","true","[CI:DOCS] remove references to Kubic for CentOS and Ubuntu

The Kubic packages for CentOS and Ubuntu are no longer being updated,
and will likely be deleted from Kubic in the near future.

CentOS and Ubuntu users should switch to using packages provided in their
distro's default repos.

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",29,61,1,1
"containers/buildah","5f80a1033b7151e7d73d8bc70773db115f16413b","TomasTomecek","2017-07-07 04:41:31","false","add a way to disable PTY allocation

Fixes #179

Signed-off-by: Tomas Tomecek <ttomecek@redhat.com>

Closes: #181
Approved by: nalind",18,5,0,0
"containers/buildah","0a1d828dad4617374992f113b9ac4c5d54d9a55b","cevich","2022-05-26 15:52:17","true","Cirrus: Migrate multiarch build off github actions

The github actions workflow for this operation is complex and difficult
to maintain.  For several months now a replacement has been running well
in the podman repository.  It's scripts/components are centralized,
versioned, unit, and integration tested.  Add cirrus tasks to run the
build, and another task to allow test builds in a PR.

This also adds support for a new magic CI string: `[CI:BUILD]`.
With this string in the PR title, automation will only do basic build
verification, and enable testing of the multi-arch build process.

Otherwise, many tasks were updated to not be created when running the
cirrus-cron multi-arch image builds, since this would simply be a waste
of time and invitation for flakes.

Signed-off-by: Chris Evich <cevich@redhat.com>",25,64,1,1
"containers/buildah","5e11770c194ce877f0715adf4c38086b3800441a","Luap99","2022-01-05 15:00:04","true","setup the netns in the buildah parent process

Do not configure the netns in the runtime child process, this removes
the need to send the network options to the child. This will be needed
for the new libnetwork network interface which cannot be transfered as
json.

To synchronize this between the child and parent we use two pipe pairs.

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",27,59,1,0
"containers/buildah","f37a7e8f22423d34f8de704f273a97adc27b2334","hswong3i","2020-09-11 05:40:38","true","Update nix pin with `make nixpkgs`

Also backport changes from https://github.com/cri-o/cri-o/pull/4065/files#diff-1d37e48f9ceff6d8030570cd36286a61R189-R197

Signed-off-by: Wong Hoi Sing Edison <hswong3i@gmail.com>",88,43,0,0
"containers/buildah","0692b2329aa11d7d1b582be7e8c3c093b27773d5","giuseppe","2018-12-12 19:32:52","false","tests: use fully qualified name for centos image

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1233
Approved by: rhatdan",49,22,0,1
"containers/buildah","9d163a50d11499c608ff0d581f47ecc368f43fb7","giuseppe","2018-02-21 19:59:25","false","run: do not open /etc/hosts if not needed

Avoid opening the file in write mode if we are not going to write
anything.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #487
Approved by: rhatdan",19,13,0,1
"containers/buildah","9b9ed1d71caff9ef04ed33aa30fb5f51e323b21d","rhatdan","2019-01-18 20:13:34","false","vndr opencontainers/selinux

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1297
Approved by: TomSweeneyRedHat",54,24,0,1
"containers/buildah","a9c22e10013d5612f45d0030b9c78a46353f234a","rhatdan","2021-05-19 13:05:47","false","Don't blow up if cpp detects errors

Currently the /usr/bin/cpp will blow up if a user adds a
comment to a containerfile that is not a preprocessor.
Since the Containerfile.in could include other Containerfile
which may have comments, begining with `#` this can cause
problems.

If we just warn on these errors, we can successfully process
all of the containerfiles.

Fixes: https://github.com/containers/buildah/issues/3229

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",57,52,1,1
"containers/buildah","0a8ec97272aee3ba2f5e96d6c66a4cd4979ed1fd","rhatdan","2019-03-06 12:57:28","false","Add recommends for slirp4netns and fuse-overlay

We want these packages installed for running buildah in a container
or running buildah as non-root

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1389
Approved by: TomSweeneyRedHat",63,25,0,1
"containers/buildah","6c96dd959e5b2a0fa8bfd28406bcd5df2df7429b","rhatdan","2022-07-18 17:20:43","false","Update vendor of containers/(common, storage, image)

This is the vendor dance.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",22,66,1,1
"containers/buildah","47e4c3ce50da485c67917cd4bb2bb41ab453228b","rhatdan","2021-01-04 17:01:23","false","Only grab the OS, Arch if the user actually specified them

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",91,47,0,1
"containers/buildah","aedf7095304ec2f107697d83512d8484aec881b0","rhatdan","2021-09-16 21:22:41","false","Add flouthoc to OWNERS

[NO TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",40,56,1,1
"containers/buildah","e016fa8a0fae56166f5965f6c4d7ff8e679e638a","rhatdan","2020-11-18 10:59:23","true","Merge pull request #2804 from lsm5/debian-testing-unstable

update docs for debian testing and unstable",76,46,0,1
"containers/buildah","a4c56c2fc350de3ae5cf430d29ce3ad907edf7ce","baude","2018-07-01 17:23:29","false","add optional CI test fo darwin

run gofmt and make for darwin to prevent regressions from new code for a potential
darwin build.

Signed-off-by: baude <bbaude@redhat.com>

Closes: #842
Approved by: rhatdan",27,17,0,0
"containers/buildah","a807dc6fadbebde4792999a188a7a821cf26eafe","rhatdan","2019-06-14 03:19:40","false","Bump back to v1.9.0-dev

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",41,29,0,1
"containers/buildah","c540ceca36e3b6ad0748df4f08bae3461ccbff80","rhatdan","2022-02-02 20:06:00","false","Update vendor of openshift/imagebuilder

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",34,60,1,1
"containers/buildah","aacaf34354ae97e61e7fecf9160b2a76bee1e8c8","nalind","2017-03-24 20:17:02","false","Only attempt to shut down a Store if we opened one

Only attempt to Shutdown() the default storage.Store if we actually
opened it to begin with.  This avoids some unnecessary churn with
storage in cases where argument parsing flags an invocation error.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #41
Approved by: rhatdan",14,2,0,1
"containers/buildah","7c97335f2c49fdb50bc7785ae7ff5e9ac80bc2d6","TomSweeneyRedHat","2019-11-11 18:53:35","false","Bump to v1.11.5

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1978
Approved by: rhatdan",78,33,0,1
"containers/buildah","d9a77b38fc705be50bf7ff2fbb98a5bfdf1563ff","TomasTomecek","2017-06-27 06:07:11","false","readme: link to actual manpages

Signed-off-by: Tomas Tomecek <ttomecek@redhat.com>

Closes: #165
Approved by: rhatdan",17,5,0,0
"containers/buildah","35199cfded748f022573e181c9b149bec4a0417e","openshift-merge-robot","2022-09-28 23:17:32","true","Merge pull request #4290 from AndASM/buildahimage-container-conf-permissions

[ci:docs] Fix buildahimage container.conf permissions regression",21,68,1,1
"containers/buildah","ea2bce5e894dd11b31046a0da37c6f68d0bf4105","openshift-merge-robot","2022-02-03 17:36:22","true","Merge pull request #3766 from rhatdan/caps

caps: fix buildah run --cap-add=all",35,60,1,1
"containers/buildah","aa37929ba3bf716a4c5eb7338e5b49b69ff0337b","openshift-merge-robot","2020-11-15 21:20:55","true","Merge pull request #2789 from rhatdan/VENDOR

Fix testing error caused by simultanious merge",76,46,0,1
"containers/buildah","1e5da2605fd8362619898b8fa23d231fece0f07c","openshift-merge-robot","2020-12-21 12:15:40","true","Merge pull request #2831 from alvistack/master-linux-amd64

Update nix pin with `make nixpkgs`",84,47,0,1
"containers/buildah","7cc1292cbbbeef21702874aaf0d26f857018b2cb","pixdrift","2018-05-30 14:15:13","false","Accept json array input for config entrypoint

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #736
Approved by: rhatdan",44,16,0,0
"containers/buildah","f3e13380fbd6f335f689d961afcda9540d3b54cc","edsantiago","2022-04-26 13:56:21","false","Rename $TESTSDIR (the plural one), step 2 of 3

...refactor $TESTSDIR/bud as $BUDFILES

Signed-off-by: Ed Santiago <santiago@redhat.com>",24,63,1,1
"containers/buildah","36dcedbabdd2a7312e84065dc0877389b2565a5e","saschagrunert","2019-08-15 14:29:14","false","Fix possible runtime panic on bud

The current code triggers a runtime panic in `imagebuildah/build.go:201`
if buildah is specifying a file as build context, which will be
interpreted wrongly as `Dockerfile`.

Reproduce with:
```
> buildah bud <any exinsting file>
panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation code=0x1 addr=0x28 pc=0x561c1706f0a5]

goroutine 1 [running]:
github.com/containers/buildah/imagebuildah.BuildDockerfiles(0x561c17513b00, 0xc0000ba038, 0x561c1751bd60, 0xc00075a360, 0x7ffebb358667, 0x18, 0x0, 0x0, 0x0, 0x0, ...)
        /home/abuild/go/src/github.com/containers/buildah/imagebuildah/build.go:201 +0xd85
main.budCmd(0xc000173400, 0xc0000afce0, 0x1, 0x1, 0xc0006e3da8, 0xc000098f00, 0xc0003b8b40, 0xc000099080, 0xc0003b8ba0, 0x0, ...)
        /home/abuild/go/src/github.com/containers/buildah/cmd/buildah/bud.go:292 +0x12e6
main.init.1.func1(0xc000173400, 0xc0000afce0, 0x1, 0x1, 0x0, 0x0)
        /home/abuild/go/src/github.com/containers/buildah/cmd/buildah/bud.go:50 +0xd8
github.com/spf13/cobra.(*Command).execute(0xc000173400, 0xc0000afca0, 0x1, 0x1, 0xc000173400, 0xc0000afca0)
        /home/abuild/go/src/github.com/containers/buildah/vendor/github.com/spf13/cobra/command.go:762 +0x475
github.com/spf13/cobra.(*Command).ExecuteC(0x561c17a8f700, 0xc000721f18, 0x561c17039a74, 0xc000721f00)
        /home/abuild/go/src/github.com/containers/buildah/vendor/github.com/spf13/cobra/command.go:852 +0x2ff
github.com/spf13/cobra.(*Command).Execute(0x561c17a8f700, 0x1, 0xc000721f88)
        /home/abuild/go/src/github.com/containers/buildah/vendor/github.com/spf13/cobra/command.go:800 +0x2d
main.main()
        /home/abuild/go/src/github.com/containers/buildah/cmd/buildah/main.go:125 +0x42
```

We now check if the file exists before passing the Dockerfile around.
For this we introduce a new function `discoverDockerfile`, which tries
to find a corresponding Dockerfile for a given directory.

All possible integration test scenarios have been added as well.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1795
Approved by: TomSweeneyRedHat",51,31,0,1
"containers/buildah","c6a4a0645405fd49ecb7b59e608641bbe29ba0f4","nalind","2017-03-23 19:48:26","false","Bind mount /etc/hosts, /etc/resolv.conf in Run()

When we run a command in Run(), since it's sharing the host's network
namespace, also have it share the host's DNS settings.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #34
Approved by: rhatdan",12,2,0,1
"containers/buildah","783f0ba1cb6a1c5aed39a770d6312cba9f145095","nalind","2019-03-18 20:10:41","false","imagebuildah: record image IDs and references more often

Have Commit() and Execute() return the IDs and references for images
that they create, to make things easier in a future commit when they
won't always have names.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1442
Approved by: vrothberg",37,26,0,1
"containers/buildah","2c366d1e541110f204a45bf3840b85767d28ad91","MaximUltimatum","2021-11-29 14:12:55","false","Simple README fix

Signed-off-by: MaximUltimatum <mcder018@live.com>",31,58,1,0
"containers/buildah","57a73847e4b58ddbb77047ec306d59a695ec936c","dfr","2022-06-23 10:49:39","false","Move get{Bind,Tmpfs,Secret,SSH}Mount to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",21,65,1,0
"containers/buildah","6c1a4cc0cd9c4ea2e07220e9bcd0e26ca686f4bf","vrothberg","2019-02-25 17:27:23","false","README.md: fix typo

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1367
Approved by: TomSweeneyRedHat",59,25,0,1
"containers/buildah","274e1aff12acb07b328c1169ce1eee45c66116cb","vrothberg","2019-06-18 11:21:29","false","imagebuildah: remove unused `dedupeStringSlice`

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","72c1fe984ad5058db9e2b738cd4a27896eac8556","vrothberg","2018-12-08 14:51:01","false","cli.BudFlags: add `--platform` nop

Add the `--platform` option for Moby/Docker CLI-compat reasons.  This
option allows to control which platform (i.e., Windows or Linux) the
image will be build on and for.  Make this a nop as Buildah supports
only Linux.

Fixes: #629
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1230
Approved by: rhatdan",51,22,0,1
"containers/buildah","0b69f70294b0d3755afe01795bb0cd54efc7cd07","edsantiago","2023-05-22 14:33:16","false","CI: fix test broken by renovatebot

Fixes the damage done by #4737. Renovatebot did something stupid,
and CI broke. Fix, refactor, and add a comment to warn against
this happening again.

Signed-off-by: Ed Santiago <santiago@redhat.com>",17,76,1,1
"containers/buildah","49e35cb98a17a4619c16332a17cfd31832f8b1d6","saschagrunert","2019-12-04 09:24:05","false","Add history names support

The new `buildah images --history` flags shows the history of the names
an image had in the past. If the latest image in the history is equal
the current image's name, then we skip that on from the history for
convenient purposes.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1998
Approved by: rhatdan",85,34,0,1
"containers/buildah","8614456543431b30d6d8683d1b1caa16b11d34ec","openshift-merge-robot","2021-03-04 18:38:52","true","Merge pull request #3049 from rhatdan/image

Check local image to match system context",57,49,0,1
"containers/buildah","9e2421ca3d68b8375fff40b14d91a273b4cf2620","openshift-merge-robot","2022-07-26 17:38:03","true","Merge pull request #4136 from nalind/misc-errors

Minor error message fixes",19,66,1,1
"containers/buildah","2970fc62280aac3f6e934335af2ff4e3f16f792a","openshift-merge-robot","2021-03-24 18:33:11","true","Merge pull request #3091 from containers/dependabot/go_modules/github.com/containers/common-0.35.3

build(deps): bump github.com/containers/common from 0.35.2 to 0.35.3",53,50,0,1
"containers/buildah","eda32d4a2c72c9fedbfda227ef203a7cac20cc20","openshift-merge-robot","2023-05-22 16:07:35","true","Merge pull request #4812 from edsantiago/fix_4737

CI: fix test broken by renovatebot",17,76,1,1
"containers/buildah","9d987b92129dd41bd5e1643efa4914448970d2a4","openshift-merge-robot","2023-01-14 16:13:56","true","Merge pull request #4514 from cevich/fix_multiarch

[CI:BUILD] Fix multiarch manifest-list build failures",21,71,1,1
"containers/buildah","6d877d89dd8625860bef470ceb277b7778573655","flouthoc","2023-04-08 02:26:18","true","Revert ""buildah image should not enable fuse-overlayfs for rootful mode""

This reverts commit 2e25b156f74dfaeb3a44dcad663db1c041a803ef.

Signed-off-by: Aditya R <arajan@redhat.com>",11,74,1,1
"containers/buildah","401b4ad31472d2e0b1682b12d347aca98f64c86f","hswong3i","2021-01-29 04:57:41","true","Update nix pin with `make nixpkgs`

Signed-off-by: Wong Hoi Sing Edison <hswong3i@pantarei-design.com>",93,48,0,0
"containers/buildah","c219669c3f9b0022240b6a472d42ba4288365305","mbargull","2020-11-06 08:14:22","false","Use CPP, CC and flags in dep check scripts

Signed-off-by: Marcel Bargull <marcel.bargull@udo.edu>",65,45,0,0
"containers/buildah","b7e3320fe487ddaa859506df991c365ff2737870","rhatdan","2017-11-16 22:00:38","false","Bump to 0.7

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",30,10,0,1
"containers/buildah","0d3246ffcfa335628aa62887659c9438cc8491d5","flouthoc","2022-05-19 16:01:55","true","retrofit-tests: we skip unused stages so use stages

We skip unused stages to use stages so we don't skip stages for tests
where its not needed.

Signed-off-by: Aditya R <arajan@redhat.com>",25,64,1,1
"containers/buildah","9677691e023105c91f8ef5a50e3246d8549b04f4","openshift-merge-robot","2022-12-01 09:29:33","true","Merge pull request #4441 from nalind/sort-mounts

util.SortMounts(): make the returned order more stable",17,70,1,1
"containers/buildah","19d306538d6bcf049c29f52de8ca35f493c4690f","openshift-merge-robot","2021-05-21 11:03:23","true","Merge pull request #3248 from containers/dependabot/go_modules/github.com/containers/storage-1.31.2

Bump github.com/containers/storage from 1.31.1 to 1.31.2",55,52,1,1
"containers/buildah","0e15552106d3f6107c1e6dc5382c9c7d8f4771eb","openshift-merge-robot","2023-03-07 22:38:02","true","Merge pull request #4644 from flouthoc/cache-from

[CI:DOCS] build: document behaviour of buildah's distributed cache",19,73,1,1
"containers/buildah","fe3d75072404bbe16a4f03581e6a2d8689ad7ea5","openshift-merge-robot","2022-04-21 07:03:00","true","Merge pull request #3919 from rhatdan/VENDOR

Update vendor of containers/(common,storage,image)",25,63,1,1
"containers/buildah","4407875a50dbfa237dde404835278526f68161b4","nalind","2022-09-09 14:21:32","false","Use constants from containers/common for finding seccomp.json

Use values from containers/common for locating seccomp.json.  At the
moment this isn't actually a change, but we don't want to fall out of
step again.

[NO NEW TESTS NEEDED]

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",18,67,1,1
"containers/buildah","cd6b5870e2fc8bb6a218e5077ec250907292174f","nalind","2017-06-15 21:36:27","false","Make shallowCopy() not use a temporary image

Modify shallowCopy() to not use a temporary image.  Assume that the big
data items that we formerly added to the temporary image are small
enough that we can just hang on to them.

Write everything to the destination reference instead of a temporary
image, read it all back using the low level APIs, delete the image, and
then recreate it using the new layer and the saved items and names.

This lets us lift the requirement that we shallowCopy only to images
with names, so that build-using-dockerfile will work without them again.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #150
Approved by: rhatdan",12,5,0,1
"containers/buildah","4bcddb7cbec960f93f4fea229cc45d9192349b17","birdayz","2019-01-18 17:39:49","false","cmd/commit: add flag omit-timestamp to allow for deterministic builds

By default, a field called ""createdAt"" is written into the image manifest.
However, even if my image build process is perfectly deterministic, the image
sha256 hash will be different every time, even if my sources are exactly the
same. In many cases it is desirable that the same input results in the exactly
same output.
This commit introduces the flag --omit-timestamp to the commit command. If set to
true, the timestamp is set to epoch 0, instead of the current timestamp (which
causes different results every time commit is invoked).

Signed-off-by: Johannes Brüderl <johannes.bruederl@gmail.com>

Closes: #1294
Approved by: nalind",53,24,0,0
"containers/buildah","66a54caf778a09604c8677bdc392db8dcf70d523","openshift-merge-robot","2021-07-02 09:10:05","true","Merge pull request #3356 from cevich/conformance_adjustment

Adjust conformance-test error-message regex",38,53,1,1
"containers/buildah","d94b22845cc500d0e68143bfb723b28050e2f08f","nalind","2017-04-19 19:28:07","false","Bump golang.org/x/net

Update the version of golang.org/x/net that we vendor.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",11,3,0,1
"containers/buildah","a6ed6883017fa8f1c7e6bd2ccd19e600107dd675","nalind","2019-02-12 20:40:01","false","unshare: reexec using a memfd copy instead of the binary

When we're unshare()ing, copy /proc/self/exe into a memory FD before
exec()ing it, so that the descriptor which we leak into our child
process's namespace through the /proc/$parent/exe link is one that gets
discarded after the process exits, and seal it against modifications as
soon as we're finished populating it, mimicking patches for other
projects that mitigate CVE-2019-5736.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1334
Approved by: giuseppe",59,25,0,1
"containers/buildah","2099ad769fc9e258a960ed50c19bb60ac2ebdca0","rhatdan","2020-11-20 20:46:20","false","Switch to using containers/common pkg's

pkg/secrets has been moved and slightly been rewrittin
in containers/common, along with pkg/umask.

Convert Buildah to use these packages rather then internal
packages.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",78,46,0,1
"containers/buildah","bdb5494784284cd0ed0f95aaf37c5c6bb56642bc","lsm5","2022-10-17 10:39:38","false","[CI:BUILD] copr: buildah rpm should depend on containers-common-extra

containers-common now has a new `-extra` subpackage which handles
dependencies common to podman and buildah and also depends on
the main package `containers-common` itself.

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",27,69,1,1
"containers/buildah","9d63d1ec1915d7201bbb7f2d287077bf269d48f4","openshift-merge-robot","2022-04-28 05:37:04","true","Merge pull request #3934 from nalind/copier-mkdir-perms

copier.Put(): write to read-only directories",25,63,1,1
"containers/buildah","3908816d5310ac1f7bcd4399d23d75c1da0c2678","openshift-merge-robot","2023-05-01 12:40:43","true","Merge pull request #4765 from flouthoc/fix-platform-docs

parse: filter edge-case for podman-remote",13,75,1,1
"containers/buildah","7699b6e68cd83790df869de905f933b7d12abe43","openshift-merge-robot","2020-10-14 23:53:59","true","Merge pull request #2693 from nalind/bump-imagebuilder

bump(github.com/openshift/imagebuilder) to v1.1.8 and require conformance",62,45,0,1
"containers/buildah","10586d1eadddd01e0e7ec6e6a9d76434b284b698","openshift-merge-robot","2022-05-04 14:15:27","true","Merge pull request #3957 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.4

build(deps): bump github.com/containerd/containerd from 1.6.3 to 1.6.4",23,63,1,1
"containers/buildah","c541c355c004075c5b67f28ce9cba0c9bba6722a","openshift-merge-robot","2023-01-17 17:59:51","true","Merge pull request #4523 from giuseppe/tests-fix-runtime-flag-for-crun

tests: change the runtime-flag test for crun",22,72,1,1
"containers/buildah","b024348fc03b620dafb548b35e6849d26ff475b2","ypu","2018-08-28 13:57:02","false","Update regrex to fit the docker output in test ""run with JSON""

The build command output from docker in ""run with JSON"" is
different in different test env. So update the regrex to fit it.

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #965
Approved by: rhatdan",30,19,0,0
"containers/buildah","d335543a84a2aff8ae84dd77c4f38d08570199be","nalind","2018-06-28 20:03:27","false",".papr.sh: Also test with BUILDAH_ISOLATION=rootless

After the previously-defined tests are run, run the integration tests
again with rootless isolation.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #873
Approved by: rhatdan",28,17,0,1
"containers/buildah","cd4f31eacaf0bdf867c081e57417b059f71cb9f5","nalind","2021-09-22 20:56:55","false","imagebuildah: fix an attempt to write to a nil map

If the build for a single stage fails, we break out of the loop that's
iterating through all of the stages over in its own goroutine, and start
cleaning up after the stages that were already completed.

Because the function that launched that goroutine also calls its cleanup
function in non-error cases, the cleanup function sets the map that's
used to keep track of what needs to be cleaned up to `nil` after the
function finishes iterating through the map, so that we won't try to
clean up (a given thing that needs to be cleaned up) more than once.

Because the loop that's iterating through all of the stages is running
in its own goroutine, it doesn't stop when the function that started it
returns in error cases, so it would still attempt to build subsequent
stages.  Have it check for cases where the map variable has already been
cleared, or if one of the stages that it's already run returned an
error.  If the function that it calls to build the stage, using the map
variable as a parameter, is already running at that point, it'll have a
non-`nil` map, so it won't crash, but it might not be cleaned up
correctly, either.

If such a stage finishes, either successfully or with an error, the
goroutine would try to pass the result back to its parent(?) goroutine
over a channel that was no longer being read from, and it would stall,
never releasing the jobs semaphore.  Because we started sharing that
semaphore across multiple-platform builds, builds for other platforms
would stall completely, and the whole build would stall.  Make the
results channel into a buffered channel to allow it to not stall there.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",40,56,1,1
"containers/buildah","05a7c97f2001b0a6cb99997733d676a1dc1a2a22","nalind","2017-05-22 18:24:57","false","Test that setting configurations values works

Test setting and importing of configuration settings by saving to both
formats, and then checking that the values in both configuration fields
has the right data when we use either image type as a source image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #118
Approved by: rhatdan",15,4,0,1
"containers/buildah","7c0f2253f2a8746a93ece173c3df19e88dd76c72","rhatdan","2022-07-11 14:11:52","false","Vendor in containers/(common, storage, image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",22,65,1,1
"containers/buildah","ed7a2f7f4806e10b00c11b65ae4bc59b494d46c0","rhatdan","2023-01-09 18:21:47","true","Merge pull request #4482 from dandan2000/patch-1

[CI:DOCS] Update buildah-build.1.md",21,71,1,1
"containers/buildah","cb1ab7b8867eb11fac5b0f32be8af5cba8036dd6","rhatdan","2023-02-24 18:04:00","true","Merge pull request #4622 from containers/renovate/github.com-fsouza-go-dockerclient-1.x

fix(deps): update module github.com/fsouza/go-dockerclient to v1.9.5",16,73,1,1
"containers/buildah","1513b82eed96ff62c226a38cc9c8e25fc2911b23","rhatdan","2017-10-10 18:44:28","false","Merge pull request #237 from rhatdan/vendor

Vendor in latest containers/storage and vendor/github.com/sirupsen",32,8,0,1
"containers/buildah","20e92ffe09820ad80e44117f8fae8f4a6b3883e7","rhatdan","2019-10-31 20:47:05","true","Merge pull request #1956 from umohnani8/fips

Add disableFips option to secrets pkg",82,33,0,1
"containers/buildah","3cc021828067be29f01f5fb32c371448f225e0ff","rhatdan","2017-10-22 10:42:48","false","Merge pull request #296 from TomSweeneyRedHat/dev/tsweeney/docfix/17

Add required runc version to README.md",30,9,0,1
"containers/buildah","cd850c6df51d531377f1d78edfa8a21cfdb45753","rhatdan","2021-10-05 13:46:33","true","Merge branch 'main' into dependabot/go_modules/github.com/docker/docker-20.10.9incompatible",43,56,1,1
"containers/buildah","26d0e74ebe54fa8d28f724cb4b8803798fb8f2bf","rhatdan","2018-06-06 22:00:08","true","Merge pull request #758 from TomSweeneyRedHat/dev/tsweeney/disablecontent

Add disable-content-trust noop flag to bud",32,16,0,1
"containers/buildah","e2c33f36f271c7762dff50cb86e642e482828ee8","nakato","2019-09-18 09:25:50","false","Add support for retrieving context from stdin ""-""

Some consumers of the docker command line API expect to be able to pass
a tar or a Dockerfile into the build command via stdin, which causes a
build failure when it hits 'buildah bud' or 'podman build', which calls
buildah.  A good example of this is the `linuxkit pkg build $dir`
command, which will append a `-` to the build command.

To improve compatibility with `docker build` support for `-` is added to
mean ""read from stdin"".
While a user could pass /dev/stdin or /proc/self/fd/0, or a path to some
other character device, as such tricks are common when attempting to get
programs to read from stdin, `docker build` does not support this, thus
this leaves out a bit of complexity while improving 'docker build' cli
compatibility.

Signed-off-by: Sachi King <nakato@nakato.io>

Closes: #1870
Approved by: rhatdan",62,32,0,0
"containers/buildah","24a4c1e2c0476a72ed6212d3f7b20745f71e64e0","pixdrift","2018-05-03 05:00:08","false","Update buildah run to make command required

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #656
Approved by: rhatdan",48,15,0,0
"containers/buildah","d5f65ed56842c80548ee433b5531d74051b98f9f","giuseppe","2018-10-23 10:04:44","false","unshare: support libpod rootless pkg

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1124
Approved by: rhatdan",52,21,0,1
"containers/buildah","6116d6a9bcf7a4e63690f7e2b86fe88a58c3b16c","anarcat","2017-12-11 19:26:34","false","install golang metapackage from backports

`golang-1.8` *is* available in stretch, but /usr/bin/go does *not*
point to it by default, *unless* the `golang` meta-package is
installed from backports.

Signed-off-by: Antoine Beaupré <anarcat@debian.org>

Closes: #354
Approved by: rhatdan",33,10,0,0
"containers/buildah","754efce43a26a8e44b3bddf858b923a4a602637f","QiWang19","2020-02-05 20:14:00","false","fix XDG_RUNTIME_DIR for authfile

fix bug https://bugzilla.redhat.com/show_bug.cgi?id=1798343
log/logout fails after running `unset XDG_RUNTIME_DIR`. This patch calls getStore() to set XDG_RUNTIME_DIR in the code.

Signed-off-by: Qi Wang <qiwan@redhat.com>",110,36,0,1
"containers/buildah","ba1d41b12907a73048c16249f076ca15fedf7e73","openshift-merge-robot","2022-12-20 18:27:31","true","Merge pull request #4475 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.14

build(deps): bump github.com/containerd/containerd from 1.6.12 to 1.6.14",18,71,1,1
"containers/buildah","baae671fb52dda5784be0a4f057116d5bcecde0a","openshift-merge-robot","2021-04-28 22:41:06","true","Merge pull request #3187 from nalind/relay-errors

runUsingRuntime: when relaying error from the runtime, mention that it's from the runtime",49,51,0,1
"containers/buildah","a9f718beb1dfe451a50e7c939c2687d3bf934591","QiWang19","2019-03-11 17:28:47","false","fix bug images use the template to print results

Signed-off-by: Qi Wang <qiwan@redhat.com>",36,26,0,1
"containers/buildah","f05a9b778a7384654664b289a654972c66e06e53","ypu","2019-10-22 13:04:36","false","Tests: Add buildah bud with --quiet test

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #2004
Approved by: rhatdan",79,33,0,0
"containers/buildah","0de7cac5a15f5fd5809d263f6a4c2e3367f85a46","mtrmac","2019-02-21 23:08:02","false","Don't throw away user-specified tag for pull --all-tags

Right now, we (conceptually unnecesarily) require an image with an existing
tag on the remote repository to list all other tags.

Given that, use the user-specified name:tag, if any, instead of discarding the
tag and requiring :latest to exist on the remote registry.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","54ba7bf5f5af8d879075da485daae7eb2cb608bd","rhatdan","2023-04-06 15:25:31","true","Merge pull request #4716 from vrothberg/vendor-common

vendor c/common ff62cdebdd0e",11,74,1,1
"containers/buildah","a49a32f55fe977439aebba1cc1d383d6624bc94e","rhatdan","2017-06-27 20:53:55","false","Add buildah export support

Will export the contents of a container as a tar ball.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #170
Approved by: rhatdan",19,5,0,1
"containers/buildah","95c2a2d99ca6773b5c66ead3222492fa23d06ac0","rhatdan","2017-05-17 15:53:28","false","Vendor in containers/storage and containers/image

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #103
Approved by: nalind",10,4,0,1
"containers/buildah","5f71178e4899610c8fccee9e6665705a64b2df96","rhatdan","2020-02-05 12:26:08","true","Merge pull request #2132 from containers/dependabot/go_modules/github.com/onsi/gomega-1.9.0

Bump github.com/onsi/gomega from 1.8.1 to 1.9.0",110,36,0,1
"containers/buildah","c1ed62120a83deaa5688675e494d116f14f5abe8","ipbabble","2018-05-15 19:22:27","false","Added a bud demo and tidied up

Signed-off-by: William Henry @ipbabble <whenry@redhat.com>

Closes: #694
Approved by: rhatdan",60,16,0,0
"containers/buildah","d5875c5a08c631b969aa54c9239e71a78423e543","rhatdan","2023-11-05 12:11:18","true","Merge pull request #5136 from containers/renovate/golang.org-x-sync-0.x

fix(deps): update module golang.org/x/sync to v0.5.0",1,81,1,1
"containers/buildah","6be719454573a5eb2117ff07060032225013f2d3","rhatdan","2023-09-14 00:46:30","false","Bump vendor containers/(common, storage, image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",5,80,1,1
"containers/buildah","dd3f716f9f4bad27fab6a2bfe6cae83bbbb4e0a4","TomSweeneyRedHat","2023-08-17 15:11:31","true","Merge branch 'main' into feat-loong64",9,79,1,1
"containers/buildah","55b9bcfc63a6f8fde2504c5d84e2db1be8b1184d","openshift-merge-robot","2023-02-01 13:34:35","true","Merge pull request #4552 from flouthoc/seamless-conformance

conformance: use `scratch` for minimal test and unblock CI",19,72,1,1
"containers/buildah","495add9369baa0d3729656e1114ca6b35cc2e11c","flouthoc","2022-06-06 06:33:15","true","build, multiarch: support splitting build logs for --platform

Support splitting build logs for multi-arch builds ( `--platform` ) by
using `--logfile` and `--logsplit` which splits generated log file in the
convention `${file}_${platform_os}_${platform_arch}`.

Closes: https://github.com/containers/buildah/issues/3960

Signed-off-by: Aditya R <arajan@redhat.com>",23,64,1,1
"containers/buildah","b6610792610006c7062f9690f761050d599fc0e5","rhatdan","2021-10-05 13:44:00","true","Merge pull request #3565 from rhatdan/docs

[CI:DOCS] Fix .containerignore link file",44,56,1,1
"containers/buildah","2c4634cef8ac5e872465284ecc9d3a78fb89711e","cevich","2021-04-09 14:15:33","true","Cirrus: Update VMs w/ F34beta

Also add/use variable for NIX container image to reduce duplication.

Signed-off-by: Chris Evich <cevich@redhat.com>",51,50,0,1
"containers/buildah","9b3e7b1f02c13241c853e295814827372abd8df8","nalind","2020-12-16 15:26:59","false","copier: don't assume we can chroot() on Unixy systems

Fall back to non-chroot behavior on Unixy systems when we're not started
as UID 0.  Break the unit tests that exercise chroot functionality into
a separate file so that we don't even try to run those cases on non-Unix
OSes.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",80,47,0,1
"containers/buildah","e2dc7ec6a4e6298a9187f2201309bb46daee7041","nalind","2020-09-08 21:55:07","false","copier.Get(): hard link targets shouldn't be relative paths

When adding a hard link entry to an archive, don't try to make the path
of the link's target name be relative to the link's location in the
filesystem if they're in the same directory, since receivers don't
interpret it that way.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",84,43,0,1
"containers/buildah","6a53ec5d408cdf56ba5e356d6bf5962ab5933b41","nalind","2020-07-17 14:02:58","false","Add dependency on github.com/stretchr/testify/require

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",149,42,0,1
"containers/buildah","2ccd8751d468b7a503d8b34aab2f8a44f6188e05","edsantiago","2020-06-30 18:43:47","false","tests: add auth tests

Add authentication tests using local registry:
 - add output string checking wherever possible; this
   caught a bug in the old tests, a command that was
   failing due to a typo instead of the expected way.

 - new --tls-verify=true tests, if $BUILDAH_AUTHDIR is
   defined by caller. For Cirrus CI, that's hardcoded
   as $HOME/auth and too tricky to change. For Fedora
   and RHEL gating tests, this will require further
   changes beyond the scope of this PR.

 - new buildah-login tests, positive and negative, using
   local registry

Also:
 - remove unused tests in from.bats

 - add ""authenticate: "" prefix to all tests in that file,
   to make it easier for viewer to find the test source file.

 - do not copy autogenerated certs to /etc/certs.d - doing so
   defeats the purpose of testing --tls-verify={true,false}

Signed-off-by: Ed Santiago <santiago@redhat.com>",146,41,0,1
"containers/buildah","8ef28c959209b2b2336e1a87032b1ae6ebf740f9","nalind","2018-05-23 19:41:45","false","Extend the amount of time travis_wait should wait

The travis_wait wrapper should be giving us 20 minutes by default, but
that's for the entire runtime of the command we're running under it.

While an individual 'make rpm' test can take more than 10 minutes, it
shouldn't take _much_ more, so increase the allowed total to three times
a reasonable number (say, 15), plus some time for all of the other tests.

When travis_wait runs out of time, it tries to kill the job, which we're
running under sudo anyway, so things can get weird.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",63,16,0,1
"containers/buildah","8bbc3a5a9c5c9d3e8bd0501427b17debf8bbf3e6","nalind","2017-03-23 17:49:38","false","Tweak copying behavior so that dest can be a file

Change copy behavior so that the destination can be a file rather than a
directory if we're copying a single item.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",12,2,0,1
"containers/buildah","c038712e2a591b44c4beae0feadf0ab76deb6f1a","rhatdan","2017-04-21 13:10:11","false","Add table of buildah commands to readme.md

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #81
Approved by: rhatdan",10,3,0,1
"containers/buildah","61280840d27bdff0ddc17550032d6986970d8231","rhatdan","2019-01-30 13:41:48","false","Add package install descriptions

We need to simply describe how to install a packaged
version of buildah for each distribution, rather then
just describing how to build it.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1310
Approved by: TomSweeneyRedHat",54,24,0,1
"containers/buildah","c00f54891cc35eb8a8e70243f50280746c3e2340","rhatdan","2019-07-30 21:18:31","false","Vendor in containers/storage v1.12.16

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1749
Approved by: TomSweeneyRedHat",46,30,0,1
"containers/buildah","1a2bf4d16d42116519b7d92984d602671a19e2a8","rhatdan","2022-11-11 17:49:46","true","Merge pull request #4410 from containers/dependabot/go_modules/golang.org/x/sys-0.2.0

build(deps): bump golang.org/x/sys from 0.1.0 to 0.2.0",22,69,1,1
"containers/buildah","c7454a557ac84387dbfd252ad346958d32aedcef","vrothberg","2019-06-18 11:01:39","false","imagebuildah: omit comparison to bool

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","53b9abd60c8f12f2652600f5953f64af5024234c","nalind","2019-05-06 20:45:49","false","imagebuildah: recognize cache images for layerless images

Update cache logic to recognize images that don't include any layers.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1580
Approved by: rhatdan",56,27,0,1
"containers/buildah","48454ee12272b2b6e98e82503c219540ffd93eab","nalind","2018-07-18 18:57:54","false","maybeReexecUsingUserNamespace: add a default for root

maybeReexecUsingUserNamespace(): if we're already UID 0, reexec using
the current ID mappings instead of the ranges from /etc/subuid+subgid.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #836
Approved by: rhatdan",32,18,0,1
"containers/buildah","e94c4572e6368aea2f5b155ec8943b92d3db5172","nalind","2019-07-16 17:11:25","false","Update to runc v1.0.0-rc8

Update to runc v1.0.0-rc8.  The libcontainer components that we use
haven't changed, so there's not much to this.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",48,30,0,1
"containers/buildah","46c1a54b151b177bcb8eeabf4b2023868984e965","TomSweeneyRedHat","2018-02-09 18:42:07","false","Revert to using latest go-md2man

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #463
Approved by: rhatdan",24,12,0,1
"containers/buildah","8c1c2c5819e14dc15ea1cd11faa7d0f74d607f61","TomSweeneyRedHat","2019-08-08 15:30:34","false","Bump to v1.10.1

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",51,30,0,1
"containers/buildah","7dc724531fe01e6742b325dc2f67abfdbf55ea65","TomSweeneyRedHat","2021-08-03 00:26:42","false","[CI:DOCS] Fix CHANGELOG.md

For the 1.22.0 release, I'd a duplicate chunk of the CHANGELOG.md, this corrects that.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",36,54,1,1
"containers/buildah","600678658fc01bf19538ba4b4e2e7100a832e528","TomSweeneyRedHat","2019-01-18 17:55:06","false","Bump to v1.7-dev-1

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Redo 1.7-dev after cutting new 1.6.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",53,24,0,1
"containers/buildah","5a3e9fb262d0f0e32049062bce11fd6cdb5e7c19","TomSweeneyRedHat","2019-08-02 15:14:12","false","Bump to v1.10.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",49,30,0,1
"containers/buildah","6e4f7aa3cea235a000f330388c03ea847f17c31d","TomSweeneyRedHat","2019-10-18 22:05:58","false","Add clarification to the Tutorial for new users

This is a partial fix for #1895.  This focuses on (hopefully) helping a
user get into Buildah faster when they first hit the buildah.io site and
click down through the tutorials button.  It also clarifies what's currently
out of scope for Buildah, adds some titles to make links easier and a bit more.

I expect I'll either be adding to this or creating a follow on PR to address more
of the notes in #1895.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",78,33,0,1
"containers/buildah","824450bdb0a19cf845790316dfd5a1a84b3b5878","rhatdan","2021-05-02 09:59:28","true","Merge pull request #3188 from containers/dependabot/add-v2-config-file

Upgrade to GitHub-native Dependabot",49,51,0,1
"containers/buildah","a5997e73f83af2665b6e4efeb7f0cedc786a8e04","hshiina","2021-04-22 13:29:41","true","Merge branch 'master' into bud-test",49,51,0,0
"containers/buildah","e0054a03d88a8a85622f7d22eaf23346a9c0f46a","AndASM","2022-10-03 19:32:24","false","Update contact information

Freenode is no longer used, IRC has moved to
[libera.chat](https://libera.chat). There are also \[matrix\] options
now.

Signed-off-by: Andrew Meadows <andrew@befuddled.ca>

Apply suggestions from code review

LGTM

Co-authored-by: Tom Sweeney <tsweeney@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",24,68,1,0
"containers/buildah","ba5ff64d1cd66f24f3ce438843938b07581cd0a5","dfr","2022-06-15 11:19:02","false","Move runUsingRuntime and runCollectOutput to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","42f133369a9f5a121bacefa69dd19944d5cadc8b","Luap99","2022-01-10 14:27:26","false","Fix platform handling for empty os/arch values

If you run `buildah bud --platform windows/` the os is ignored at the
moment and it uses the host os. We should still use the os from the
platform in this case. This fixes an issue with podman-remote build
where it is possible that only the os is set in the platform string.

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",27,59,1,0
"containers/buildah","95a508906197b3db2d86e55c9355caa36b79c133","mtrmac","2019-02-21 23:25:13","false","Hard-code docker.Transport use in pull --all-tags

The code is already calling docker.GetRepositoryTags
immediately below, so the dependency already exists, and this
removes an unnecessary dependency on alltransports.

Should not change behavior.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","45a9d37e7553d59f473895ee43506e6454f5531c","vrothberg","2018-08-08 05:45:49","false","release v1.3: mention openSUSE

Buildah v1.3 is already in openSUSE Tumbleweed, so let's put it on the
list of Buildah-shipping distributions.

Signed-off-by: Valentin Rothberg <vrothberg@suse.com>

Closes: #915
Approved by: rhatdan",24,18,0,1
"containers/buildah","964b7145e825bfcd378531df3f759352dde87190","cherdt","2020-10-22 15:13:26","false","Use curl to get repo file (fix #2714)

Use curl -o w/ full path

Signed-off-by: Chris Herdt <cherdt@gmail.com>",64,45,0,0
"containers/buildah","9a7ed71b0f65a796f75cb5f872b8f6fcb73337a6","edsantiago","2019-04-05 13:56:11","false","new helper: expect_line_count

The idea is to replace messages of the form:

   #   `[ $(wc -l <<< ""$output"") -eq 3 ]' failed

with:

   # #/vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
   # #| FAIL: buildah images
   # #| Expected 3 lines of output, got 4
   # #| Output was:
   # #| >REPOSITORY                 TAG      IMAGE ID       ...
   # #| ><none>                     <none>   eb6c71a3945f   ...
   # #| >localhost/test             latest   4711b358c2d9   ...
   # #| >docker.io/library/alpine   latest   5cb3aa00f899   ...
   # #\^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Diff generated via:

   perl -pi.BAK -e 's/\[ \$\(wc -l <<< .\$output.\) -eq (\d+) \]/expect_line_count $1/' tests/*.bats

REVIEWING THIS DIFF: look at helpers.bash, but really, don't
spend much effort looking at the individual diffs. They were
all done with the oneliner above. (Industrious reviewers will
look for cases that my oneliner missed, by grepping the sources
for 'wc -l'. I am aware of those, I just prefer to deal with
them in a separate commit later.)

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #1472
Approved by: TomSweeneyRedHat",52,26,0,1
"containers/buildah","b237304dad4df41f2a660b6f9fc134b78832980d","openshift-merge-robot","2021-09-23 10:11:23","true","Merge pull request #3529 from nalind/conformance-allow-buildkit

conformance: allow test cases to specify dockerUseBuildKit",39,56,1,1
"containers/buildah","fb4e2bef48d39c540940b80ece13163759755edb","openshift-merge-robot","2022-10-27 20:06:50","true","Merge pull request #4385 from rhatdan/VENDOR

vendor in latest containers/(storage, common, image)",24,69,1,1
"containers/buildah","24e0eb79f08f2f7ea58bc8b0a7781ef1c6445ab8","openshift-merge-robot","2020-12-29 13:30:01","true","Merge pull request #2874 from containers/dependabot/go_modules/github.com/containers/storage-1.24.4

build(deps): bump github.com/containers/storage from 1.24.3 to 1.24.4",88,47,0,1
"containers/buildah","a0ed0e55007fb0a5e9b88421c948bc102f47e053","openshift-merge-robot","2023-09-20 14:28:21","true","Merge pull request #5057 from rhatdan/VENDOR

vendor of containers/common",7,80,1,1
"containers/buildah","cd202bf2c73eac2be9551e5b7994fdbc21bd607a","openshift-merge-robot","2021-08-28 00:14:53","true","Merge pull request #3485 from nalind/conformance-mtime

conformance: tighten up exception specifications",37,55,1,1
"containers/buildah","f05a4dcded2aec537728a0d84adc642d70653d1e","openshift-merge-robot","2021-12-16 16:59:50","true","Merge pull request #3679 from flouthoc/memory-swap-unlimited

parse: allow parsing anomaly non-human value for memory control group",31,59,1,1
"containers/buildah","3c7c17752906789da5a3ef224b5a5f0e2c84f803","openshift-merge-robot","2022-05-16 10:14:52","true","Merge pull request #3982 from rhatdan/VENDOR

Vendor in latest containers/common",27,64,1,1
"containers/buildah","4d2292227f83186074994fa68f09a19387f1d5b8","openshift-merge-robot","2021-08-30 14:50:32","true","Merge pull request #3489 from siretart/manpages

Install new manpages to correct sections",34,55,1,1
"containers/buildah","92463b577675fd46aeb0dadf50726ac23b4b2120","openshift-merge-robot","2020-11-30 17:57:42","true","Merge pull request #2827 from containers/dependabot/go_modules/github.com/containers/common-0.30.0

build(deps): bump github.com/containers/common from 0.29.0 to 0.30.0",77,46,0,1
"containers/buildah","93474047a2b215c0ad321e452ee6d0e56b37553b","flouthoc","2021-12-15 10:28:31","true","parse: allow parsing anomaly non-human value for memory control group

Memory control group accepts an anomaly value of `-1` for setting `swap` to unlimited.
Buildah must accepts this value if specified.

Reference: https://github.com/opencontainers/runtime-spec/blob/main/config-linux.md#memory

Signed-off-by: Aditya Rajan <arajan@redhat.com>",32,59,1,1
"containers/buildah","01b65b3dd2b5f2362019aeb22e6f4525bb52ea72","flouthoc","2022-05-02 19:44:17","true","test: inline platform and builtinargs behaviour

Following test verifies the behaviour of inline `--platform` with `FROM`
statement and usage of builtinargs with it, specifically the behaviour
of `$TARGETPLATFORM` and `$BUILDPLATFORM`

Signed-off-by: Aditya R <arajan@redhat.com>",24,63,1,1
"containers/buildah","d5b32b0f083a2f6cb5d979a1dc2c34fd26d2beda","flouthoc","2023-05-01 09:26:00","true","manifest, push: use source as destination if not specified

`manifest push <source>` must work as-is if source is actually a valid path and no destination is provided,
buildah must internally choose source as its destination just like `podman push`.

PR is similar to: https://github.com/containers/podman/pull/18395

Signed-off-by: Aditya R <arajan@redhat.com>",13,75,1,1
"containers/buildah","2c5da1be1053535bb21ffa226742acdf4800ef68","TomSweeneyRedHat","2019-08-29 22:26:36","false","Bump to v1.11.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",56,31,0,1
"containers/buildah","1c0e033a35f4090b666f0cedd7eefa536d1172b2","ashley-cui","2021-04-20 20:02:27","false","Rename rhel secrets to subscriptions

rename secrets to subscriptions and remove unused subscription package

Signed-off-by: Ashley Cui <acui@redhat.com>",49,51,0,0
"containers/buildah","13d9142af6181bd843204dffac9149144f14be35","TomSweeneyRedHat","2019-03-28 21:41:19","false","Bump back to 1.8-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1457
Approved by: rhatdan",46,26,0,1
"containers/buildah","85a37b39e8fd415f08f7219a162038f49559361b","umohnani8","2018-01-31 19:26:25","false","Add --format and --filter to buildah containers

buildah containers now supports oretty-printing using a Go template
with the --format flag. And output can be filtered based on id, name, or
ancestor.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #437
Approved by: rhatdan",41,12,0,1
"containers/buildah","2406e4acaa00938b8324a0ef3caadbe5668ec896","umohnani8","2019-01-31 17:19:31","false","Fix bud issue with 2 line Dockerfile

We were checking for single line Dockerfile to ensure
that they are actually built, but the condition was
also applying to two line Dockerfiles causing those
ones to not build properly. Fixed the condition and
now single line as well as 2 or more line dockerfile
build as expected.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>

Closes: #1315
Approved by: rhatdan",55,24,0,1
"containers/buildah","8d4a5248fa625da7e30ab602c9c851c590391256","nalind","2021-04-27 18:51:21","false","imagebuildah: create volume directories when using overlays

Saving a volume cache using VFS had the side-effect of creating the
volume's directory, so have the overlay path for it do so as well.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",49,51,0,1
"containers/buildah","416301306a6de82f1a4616cc6109a8c7c9fdac5f","nalind","2017-06-16 18:21:43","false","Make it possible to run tests with non-vfs drivers

Make the tests use the storage driver named in $STORAGE_DRIVER, if one's
set, instead of hard-coding the default of ""vfs"".

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #162
Approved by: rhatdan",12,5,0,1
"containers/buildah","63e314ea2294956b5d8dba593dc2b15d6137fd85","nalind","2017-10-05 17:48:22","false","Add make targets for unit tests, and run them

Add targets to the top-level Makefile for running unit and integration
tests, and start having Travis run the unit tests.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",31,8,0,1
"containers/buildah","ed2a501c955260ecc412266b889178fc79fcaa86","lsm5","2023-08-09 18:38:51","true","[CI:BUILD] RPM: build docs with vendored go-md2man

[NO NEW TESTS NEEDED]

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",10,78,1,1
"containers/buildah","739ac27875db0a437956dedde7e66b4d1b119bf4","openshift-merge-robot","2023-01-31 15:11:30","true","Merge pull request #4548 from containers/dependabot/go_modules/go.etcd.io/bbolt-1.3.7

build(deps): bump go.etcd.io/bbolt from 1.3.6 to 1.3.7",19,72,1,1
"containers/buildah","413bd1fd9bc770671ea467d80a8a63a08794e34b","TomSweeneyRedHat","2019-09-11 12:37:14","false","Bump to v1.11.1

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",59,31,0,1
"containers/buildah","39c3e2fa6cb4921851051da3cf551cb12fcd12e5","rhatdan","2022-05-04 21:33:54","true","Merge pull request #3963 from nalind/label-compat

Make `buildah build --label foo` create an empty ""foo"" label again",25,63,1,1
"containers/buildah","a0d3ce33eb68ae2ca1138d23c058535c94b41730","giuseppe","2022-01-26 09:42:56","true","overlay: move mount program lookup to separate function

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",34,60,1,1
"containers/buildah","eadb10a12336ea740fde696069d2d6c8a39ec4ea","rhatdan","2021-06-28 17:19:37","false","Switch rusagelogfile to use options.Out

When vendoring into Podman, Buildah is output log-rusage on
the server side of podman-remote.  It is using os.Stdout rather
then options.Out by default.

[NO TESTS NEEDED] This can only be tested on the Podman side,
existing tests should show if this breaks anything.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",39,53,1,1
"containers/buildah","a556d380e7af4bc8448e579ea9853ded2394180c","cevich","2020-10-02 19:57:09","true","Cirrus: Remove bors artifacts

Remove several artifacts necessary for bors functionality. Since bors
was removed/disabled, these items are no-longer necessary.

Signed-off-by: Chris Evich <cevich@redhat.com>",87,44,0,1
"containers/buildah","cf84f3d1eb083601a560f14eb1c157d6dd69e76c","nalind","2020-08-12 14:11:35","false","copier: un-export internal types

The internal types don't need to be exported in order for us to be able
to encode them as JSON; the individual fields need to be, but not their
types.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",86,42,0,1
"containers/buildah","c12711248e3c054b3c2b9e266d533680a5e88127","rhatdan","2018-10-16 12:15:00","false","Vendor in latest containers/storage and opencontainers/selinux

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",52,21,0,1
"containers/buildah","ba976ed3108f01ff3b1fffa9d45f34d8cd43b496","TomSweeneyRedHat","2018-07-24 18:08:04","false","Return policy error on pull

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #881
Approved by: rhatdan",31,18,0,1
"containers/buildah","0bc120edda397236438d705fd0d97ab9bdb3eaaf","ipbabble","2017-10-31 18:10:08","false","Made some edits based on tsweeney feedback.

Signed-off-by: William Henry <whenry@redhat.com>",30,9,0,0
"containers/buildah","b555b7dfc6bfccc497c6eff432a79f7796c75753","edsantiago","2020-01-07 17:23:23","false","docs: fix references to containers-*.5

Fix man page instances of 'registries.conf(5)' et al.
The correct man page is containers-registries.conf(5).

Found via:

  $ for i in registries.conf storage.conf policy.json ; do grep $i.5 docs/*.md | grep -v containers-$i;done

In buildah.md, I simply removed the storage.conf line from
the 'Commands' table because it's not a command.

Signed-off-by: Ed Santiago <santiago@redhat.com>

Closes: #2068
Approved by: TomSweeneyRedHat",101,35,0,1
"containers/buildah","6a0367ff2decfb6e7a4c00f72365f4f5ed362aed","flouthoc","2023-02-01 03:34:07","true","pkg/parse: expose public CleanCacheMount API

PR https://github.com/containers/buildah/pull/4490 added a new API
`CleanCacheMount` which allows cleaning the buildcache and cache generated
on host by --mount=type=cache just like buildkit's prune command.

Following API is needed to tools like podman can utilize this and
integrate it to the commands like `podman system reset`

[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]
Test already added here: https://github.com/containers/buildah/pull/4490

Signed-off-by: Aditya R <arajan@redhat.com>",19,72,1,1
"containers/buildah","f87ac93b1cb6337be2e860c428e02287b4ff7c65","openshift-merge-robot","2022-10-27 15:26:41","true","Merge pull request #4380 from marwatk/cached-layer-bind

Fix RUN --mount=type=bind,from=<stage> not triggering preservation of <stage> rootfs",25,69,1,1
"containers/buildah","e656823f3e9c41707a1266831aac995ac363c9b5","openshift-merge-robot","2021-09-10 09:41:47","true","Merge pull request #3508 from nalind/cross-all

Makefile: update cross targets",38,55,1,1
"containers/buildah","7a9979e279fc9703d107ecd339f8d569d0ad09e7","openshift-merge-robot","2023-04-16 11:12:16","true","Merge pull request #4734 from containers/renovate/centos-8.x

chore(deps): update centos docker tag to v8",12,75,1,1
"containers/buildah","37a523ed2d46f4176b8dcd5deaf9ad14eb6f36f1","openshift-merge-robot","2023-01-26 00:44:59","true","Merge pull request #4542 from TomSweeneyRedHat/bump-1.29.0

Bump 1.29.0",19,72,1,1
"containers/buildah","425caad904270f572abc1cf5d9e5c137351f24b5","bbodiya-akamai","2019-09-03 21:06:48","false","fix label and annotation for 1-line Dockerfiles

Signed-off-by: Brian Bodiya <bbodiya@akamai.com>",58,31,0,0
"containers/buildah","e1927c12bbb94ba42b6376ed82c066f226330655","nalind","2017-01-27 11:28:41","false","Log when we finish reading a layer

Log a debug message when we're finished reading a layer, as we already
did for the configuration blob.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","fdc39985c6dff6a08673953c325fc1c1d132daea","rhatdan","2018-04-24 13:00:13","false","Fail if date or git not installed

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #617
Approved by: TomSweeneyRedHat",38,15,0,1
"containers/buildah","e58b89896225b00a92cac3d36ced55d6b1b4914d","rhatdan","2019-09-12 21:44:50","false","Move devices code to unit specific directory.

This change is required to allow podman for windows to build.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1855
Approved by: TomSweeneyRedHat",61,31,0,1
"containers/buildah","e55a9f3d1be4932cefe8646152ab7e4269b9521a","sjenning","2019-01-02 21:22:06","false","imagebuildah: don't walk if rootdir and path are equal

Signed-off-by: Seth Jennings <sjenning@redhat.com>

Closes: #1256
Approved by: rhatdan",54,23,0,0
"containers/buildah","26b50dc1eb1f855858f83aeb5449de74b6e0acf0","nalind","2020-12-11 18:22:39","false","copier: handle replacing directories with not-directories

Improve handling of cases where extracting an archive requires us to
replace a directory with something that is not a directory, or vice-
versa:
* when replacing a directory with something that isn't a directory,
  remove the directory even if it has contents
* don't fail when replacing something that isn't a directory with a
  directory

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",79,46,0,1
"containers/buildah","3510127924689c91240532328e93406b85eaa047","lsm5","2023-09-22 13:36:00","true","[CI:BUILD] Packit: tag @containers/packit-build on copr build failures

This change will auto-tag @containers/packit-build in a github comment on every copr build failure.

[NO NEW TESTS NEEDED]

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",8,80,1,1
"containers/buildah","ac009e66e832bf6f3099279159a3b3479aae1f9a","rhatdan","2023-02-16 05:24:49","true","Merge pull request #4584 from rhatdan/man

[CI:DOCS] Fix documentation on which Capabilities are allowed by default",19,73,1,1
"containers/buildah","dddd14eb1b9977312789f0c2e48f9d9ab0d12a0f","rhatdan","2023-02-16 05:11:42","true","Merge pull request #4596 from edsantiago/disable_bmpv

Temporarily hard-skip bud-multiple-platform-values test",19,73,1,1
"containers/buildah","60be7f2509c2cd353ac227a1fb090b56d98f81b8","rhatdan","2022-12-21 19:51:59","false","Add support for --group-add to buildah from

Allow containers running under buildah to use
--group-add keep-groups, so that they can inherit
access to the users groups.

Also allow users to add supplimental groups to the container.

Fixes: https://github.com/containers/buildah/issues/4476

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",18,71,1,1
"containers/buildah","75bdc649bec8f4d40628543ea91bf798b52d3492","nalind","2021-05-21 18:53:12","false","containerImageRef(): squashed images have no parent images

Remove the parent image's ID from the config blob when we're squashing
the image, since after squashing, we share no layers or history with
what was once our base image, and leaving it set triggers verification
errors in registries that expect consistency between parent IDs and
perhaps layers and history.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",55,52,1,1
"containers/buildah","b263efe70bd56c227d0d139bf8b2d43d6fccdcc4","nalind","2020-08-25 13:53:59","false","build-using-dockerfile: add a hidden --log-rusage flag

Add a flag to imagebuildah.BuildOptions that will log timing and i/o
information at each step of the build process, and enable it if we're
given the hidden --log-rusage flag in the CLI.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",83,43,0,1
"containers/buildah","39bfdcc73408927ce05db69d6bb271f81d03adb6","rhatdan","2020-04-24 10:38:48","true","Merge pull request #2314 from containers/dependabot/go_modules/github.com/containers/storage-1.19.0

Bump github.com/containers/storage from 1.18.2 to 1.19.0",131,39,0,1
"containers/buildah","d9489e43ccd30de8a7c3bffd24ade8e5093cbb1c","TomSweeneyRedHat","2020-04-07 20:08:17","false","Bump back to v1.15.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",118,38,0,1
"containers/buildah","91c08ff7fc11d5daaf57d13c32fc364d1677e0cf","edsantiago","2020-03-12 20:11:30","false","image with dup layers: we now have one on quay

...and a process to create future ones. Thanks to Nalin for
a short patch to skopeo that allows pushing images with dups.

This commit updates make-v2sN to add ""with-dups"" functionality;
it simply creates a v2s1 image, then uses jq (JSON tool) to
duplicate the first .fsLayers and .history elements. Updated
instructions so others can (we hope) do this in the future
should it ever be necessary (we hope not).

Update the checks that confirm that the image we pull has
dup layers - this is a guarantee that we're testing what
we think we're testing.

Signed-off-by: Ed Santiago <santiago@redhat.com>",108,38,0,1
"containers/buildah","26890f807cfb40ced75be1cc6e3dc9a3e34f8635","rhatdan","2020-03-17 19:37:29","true","Merge pull request #2229 from rhatdan/vendor

Update containers/storage to v1.16.5",109,38,0,1
"containers/buildah","189ebeccd7402374cbe0856d8f9ce070c17521d5","nalind","2018-10-11 20:34:13","false","Update for changes in the containers/image API

Copying an image now returns the manifest of the written image.  Return
the digest of that manifest, and a canonical reference, from our Commit
and Push APIs.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1097
Approved by: rhatdan",53,20,0,1
"containers/buildah","0a8af543b207e0eb3723e749516b3c6cf8339ce0","nalind","2018-10-04 15:48:50","false","chroot: only create user namespaces when we know we need them

When running with chroot isolation, only create a new user namespace
when we have mappings to set.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1069
Approved by: rhatdan",51,20,0,1
"containers/buildah","5638a821e730d77ad38a00205165a83231d57c15","TomSweeneyRedHat","2019-01-19 18:10:07","false","Bump baseline test Fedora to 29

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Bumps the Buildah Baseline Test up to Fedora 29 from 28.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1301
Approved by: rhatdan",54,24,0,1
"containers/buildah","fd9b23a9331978317c86ac76f358585b98c9e2e3","TomSweeneyRedHat","2019-08-08 15:43:54","false","Bump back to v1.11.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",51,30,0,1
"containers/buildah","fa4eec7328d61978790beb0c730d58864f3adda0","TomSweeneyRedHat","2019-10-22 17:14:13","false","Fix git build with branch specified

If the context directory was specified as a git repo with a
branch reference ala

```
buildah bud --layers -t test git://github.com/containers/skopeo#master
```

The internal `git clone` command executed by buildah would fail as the
`#master` branch specification needed to be removed and specified with
the `-b` option like:

```
git clone -b master git://github.com/containers/skopeo /var/tmp/buildah12332
```
rather than:
```
git clone git://github.com/containers/skopeo#master /var/tmp/buildah12332
```

Addresses #1934

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1941
Approved by: rhatdan",78,33,0,1
"containers/buildah","fc458032951dbf666af1a80915dbe3d733e2bc39","AndASM","2022-09-24 02:12:23","false","Fix buildahimage container.conf permissions regression

Signed-off-by: Andrew Meadows <andrew@befuddled.ca>",20,68,1,0
"containers/buildah","72f8603bcc687d324c87f1774d9e71d4112e621f","hswong3i","2020-10-08 03:46:50","true","Update nix pin with `make nixpkgs`

Signed-off-by: Wong Hoi Sing Edison <hswong3i@pantarei-design.com>",61,44,0,0
"containers/buildah","d5a3c52f89882ed9acd34f13092a69fc309ced77","TomSweeneyRedHat","2018-11-22 02:21:26","false","Bump 1.6-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1192
Approved by: rhatdan",64,22,0,1
"containers/buildah","8b99eae5e8c616b73070a8acf3b2d01681695be6","TomSweeneyRedHat","2017-06-20 16:10:29","false","Add runc to required packages in README.md

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #153
Approved by: rhatdan",14,5,0,1
"containers/buildah","0e6980fb658a677cea69db7979775bea70d6ab1d","cevich","2022-01-12 16:26:47","true","Cirrus: Freshen VM images

Signed-off-by: Chris Evich <cevich@redhat.com>",29,59,1,1
"containers/buildah","42762ba94dda5893e789f3671d7a2e7a1c4d5e17","vrothberg","2021-10-14 14:58:24","false","imagebuildah: fix nil deref

Make sure that the CommonBuildOpts field is set when nil.
Found the nil deref while working in Podman.

[NO NEW TESTS NEEDED]

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",37,57,1,1
"containers/buildah","b14ff25b0888da43f5824ecde4829684f4ac2f52","edsantiago","2021-03-30 20:35:49","false","System-test cleanup

Primarily desired for the podman CI setup in which we
run bud.bats tests using podman-build; but these are
all worthwhile changes useful for buildah itself.

bud.bats:
- from-scratch-iid test: use expect_output to confirm
  leading 'sha256' (was: [[ ... ]])

- hardlinks test: add test-name arg to expect_output
  (to help diagnose test failures, such as just happened
  in podman tests)

- build-arg-cache test: add test-name string to expect_output,
  to help someone narrow down which test failed.

- stdin tests: use 'run_buildah <' instead of '| buildah'

- remove trailing whitespace

helpers.bash: reindent, converting tabs to spaces. TL;DR this
is needed for running buildah-bud tests under podman(*). As
of this commit, there are no tab characters in the file.

 * Long version: podman CI runs bud.bats using 'podman build'.
   This requires a few changes to bud.bats and helpers.bash,
   changes which need to be carried in podman itself, not in
   the buildah repo (like grokking 'remote', a concept that
   is meaningless in buildah-land). We use 'git diff', which
   is funny about whitespace, which in turn causes podman
   CI hooks to fail when we try to check in the .diff file.

Signed-off-by: Ed Santiago <santiago@redhat.com>",50,50,0,1
"containers/buildah","39d98c2bbbd5cc2eac623c3b352e0f3407728ee1","nalind","2019-04-24 13:11:03","false","cmd: API cleanup: stores before images

In argument lists that include a storage.Store and a storage.Image or
an image ID, make sure the Store is passed before.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1539
Approved by: rhatdan",53,27,0,1
"containers/buildah","c0a6d24ec23d74532370f6d0cb87d4ca782b7846","nalind","2017-04-03 21:43:57","false","Add a ""validate"" target

Add a ""validate"" target to the top level Makefile that checks formatting
of source files with golint, signed-off-by tags with git-validate, and
for various other warnings with gometalinter.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #62
Approved by: rhatdan",14,2,0,1
"containers/buildah","3e9a075b48ff38e947ffd9309481180b3371a7b7","nalind","2017-07-24 20:59:48","false","Don't leak containers/image Image references

In-memory image objects created using an ImageReference's NewImage()
method need to be Close()d.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #211
Approved by: rhatdan",18,6,0,1
"containers/buildah","46c577c87d5a7ab30ef40cfa695cd2b96b32b117","nalind","2018-10-17 20:58:32","false","ReserveSELinuxLabels(): handle wrapped errors from OpenBuilder

ReserveSELinuxLabels() checks if an error returned by OpenBuilder() is a
does-not-exist error, but OpenBuilder() returns wrapped errors now, and
it wasn't checking the root cause error.

When newBuilder() fails, check the right error value when deciding
whether or not deleting the partially-constructed container failed.

OpenBuildersByPath() shouldn't choke on non-buildah containers, so have
it handle does-not-exist errors the same way OpenAllBuilders() does.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1109
Approved by: rhatdan",55,21,0,1
"containers/buildah","ff6a0c554d45a53812ba5fbdcd97bc397890c032","rhatdan","2018-05-18 20:00:58","false","Handle /etc/hosts and /etc/resolv.conf properly in container

We are currently volume mounting /etc/hosts and /etc/resolv.conf into the
container, SELinux is preventing these files from being written while in the
container.  THis patch will create a temporary hosts and resolv.conf, that
will be labeled correctly and volume mounted into the container.

This will also fix an issue where if you used buildah bud --host it was
modifying the real /etc/hosts file.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",63,16,0,1
"containers/buildah","d29b04dba7fad449e6d3fccad643436b14175a7c","rhatdan","2021-03-31 10:57:18","false","Sort all mounts by destination directory

Currently depending on the sort order of mount points, we can overmount
a volume specified from the user. Podman has a function sortMount that
sorts all mounts based on destination directory to ensure all mounts
show up. This PR moves the function from Podman to Buildah. Once merged
I will change Podman to use the buildah function.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",50,50,0,1
"containers/buildah","a3fef4879e948f017e77c8bb4dab234904c1a91a","rhatdan","2017-09-27 21:46:28","false","Validate options

If an string option is passed in, and it is not followed by a value,
then error out with a message saying the option requires a value.

For example

buildah from --creds --pull dan
option --creds requires a value

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #270
Approved by: rhatdan",34,8,0,1
"containers/buildah","fd5fbe098cf3973fd46d3061f043a930473d831c","rhatdan","2019-07-19 07:34:27","true","Merge pull request #1725 from nalind/unshare-mount

unshare: add a --mount flag",49,30,0,1
"containers/buildah","7f2e17e2f2edde5f46d13d98ea5df4c61efe777e","rhatdan","2022-10-18 12:07:01","true","Merge pull request #4348 from rhatdan/VENDOR

Update vendor containers/(common,image,storage)",27,69,1,1
"containers/buildah","ca0819f64017dd3614df8c9bc269b96fa70b758d","rhatdan","2020-01-17 18:21:44","true","Merge pull request #2092 from TomSweeneyRedHat/dev/tsweeney/fixchanger

Remove cut/paste error in CHANGELOG.md",101,36,0,1
"containers/buildah","79bdccafb916fba9615267da625750aab022580a","rhatdan","2021-05-07 11:37:44","false","Fix race condition

Ed has found situations where the container exits, before we can check
the state causing a failure, where I think we can complete successfully.

Fixes: https://github.com/containers/buildah/issues/3113

[NO TESTS NEEDED] since I have no way to generate this race condition.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",52,51,0,1
"containers/buildah","3fbfb560016bbe9a370d7cde1603ce4a87871fab","rhatdan","2017-09-22 09:41:47","false","Cleanup buildah-mount code

1. Sort options so they are in alphabet order
2. Remove extra lines of code for options parsing that really do not accomplish anything.
3. Remove variables when they are not necessary, I.E. Don't create a variable to hold an
option that is only used once, use the option instead.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #267
Approved by: <username_without_leading_@>",34,8,0,1
"containers/buildah","b2e7110255fcfceef4277d96b04b4c4c4b7142b0","rhatdan","2020-03-31 13:56:18","false","vendor in latest containers/storage 1.18.0 and containers/common v0.7.0

This vendor moves containers/common/pkg/unshare to containers/storage/pkg/unshare

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",112,38,0,1
"containers/buildah","75fbb8483e8265eb35f04d988946accc98e09b6b","nalind","2017-11-03 17:32:19","false","Test that ""run"" fails with unresolvable names

Add a test that makes sure that ""buildah run"" fails if it can't resolve
the name of the user for the container.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #313
Approved by: rhatdan",32,9,0,1
"containers/buildah","6ec6f046f5b73cb2aebea5cc09dfdfb4bcf92927","vrothberg","2023-08-31 07:22:36","false","vendor containers/common@12405381ff45

When pulling from an OCI source, make sure to preseve the optional name.
For instance, a podman pull oci:/tmp/foo:quay.io/foo/bar:latest should
pull the image and name it quay.io/foo/bar:latest.

While at it, also fix a bug when pulling an OCI without the optional
name. Previously, we used the path to name the image which will error in
most cases due to invalid characters (e.g., capital ones). Hence, apply
the same trick as for the dir transport and generate a sha.

Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",8,79,1,1
"containers/buildah","de2c90a0ba9765d71dcd3dcd5df68d9a0ca6391c","rhatdan","2018-06-27 12:22:50","true","Merge pull request #827 from baude/bindimporterrors

bind/mount_unsupported.go: remove import errors",28,17,0,1
"containers/buildah","b58b31aaf2e20e7288eed4aa0fec1d310fb5cac9","rhatdan","2021-04-29 19:36:15","false","Document location of auth.json file if XDG_RUNTIME_DIR is not set

Fixes: https://github.com/containers/buildah/issues/3189

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",50,51,0,1
"containers/buildah","5b4389cf694b0c3606300a5c48c466b162727bb8","boaz0","2018-03-18 14:36:48","false","Show Config/Manifest as JSON string in inspect when format is not set

In https://github.com/projectatomic/buildah/issues/363:
Config and Manifest are displayed as a string representing JSON
only when ""--format"" is set. However, this is necessary too if
""--format"" is not set.

This patch fixes this by using the same technique above
to make the representation of Manifest and Config consistent.

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>

Closes: #522
Approved by: rhatdan",18,14,0,0
"containers/buildah","11dd2197dfffedb40687de1d667e6c9fb0708de9","rhatdan","2019-02-27 15:29:09","false","Hide from users command options that we don't want them to use.

We really want users to use the registries.conf file specified by
the administrator. We also don't want them overriding the signature-policy.
Thes options are mainly their for CI/CD Systems, so they should be hidden
from the user.

Signed-off-by: Daniel J Walsh dwalsh@redhat.com
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1373
Approved by: TomSweeneyRedHat",62,25,0,1
"containers/buildah","237ac533e1bddda430e57babda2b5773d3b56ce3","lsm5","2023-06-19 12:32:41","true","[CI:BUILD] Packit: add jobs for downstream Fedora package builds

Get rid of `buildah.spec.rpkg` in favour of
`rpm/buildah.spec` which gets synced with fedora dist-git on every
upstream release. The version in the new spec file is set to `0` by
default and gets updated by packit automatically on every packit task.

Packit will automatically create a PR on fedora dist-git on every new
upstream release. A sample PR will look like:
https://src.fedoraproject.org/rpms/container-selinux/pull-request/10#

A dry run for this can be triggered using:
`$ packit propose-downstream --local-content`

To run this command locally, you would need to have your packit
user-configuration-file set.
Ref: https://packit.dev/docs/configuration/#user-configuration-file

along with a fedora api key created at:
https://src.fedoraproject.org/settings#nav-api-tab with sufficient ACLs.

This patch incurs zero additional cost to upstream as the downstream
tasks occur only after upstream release and do not block anything
upstream.

[NO NEW TESTS NEEDED]

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",13,77,1,1
"containers/buildah","691266d40ca18cbb0e3be10b5d490b0df6f60b4a","nalind","2017-02-17 18:58:34","false","Handle volumes in ""run""

Default to mounting tmpfs over a container's volume mount points.  Add a
RunOption for adding mounts to a run container, and use it as the
default set, adding any volume mounts and others that don't conflict
with them to it before running the container.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","c94d2afdab4bb126f79c8db8d92d15578281dfe2","nalind","2018-06-06 14:05:17","false","runCopyStdio(): don't close stdin unless we saw POLLHUP

When polling for input on stdin (in Terminal == false cases), don't
close the write end of the pipe that we're using to relay data from
stdin to the container unless poll() tells us that we got a POLLHUP.

Assuming that was the case when POLLIN wasn't set meant that we'd close
it as soon as poll() returned and there was no activity on the
descriptor, and if poll() only returned because we had output from the
container to relay back, we were doing so prematurely.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #756
Approved by: rhatdan",37,16,0,1
"containers/buildah","3ca21d0bc3f78ed4df344070957367db33c5b654","nalind","2017-04-19 12:41:24","false","Bump containers/storage and pick up its new dep

Update to the current containers/storage and vendor its new dependency
on github.com/tchap/go-patricia.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",13,3,0,1
"containers/buildah","1c97dfa69c83ee800158a71ad82ce8787eeb54e2","nalind","2019-03-01 21:41:24","false","imagebuildah.resolveNameToImageRef(): take name as a parameter

Instead of having the resolveNameToImageRef() method resolve a member
value in the object that we set before calling the method, have it
resolve a value that we pass directly to it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1429
Approved by: rhatdan",62,25,0,1
"containers/buildah","db2b3e48ac62c75ca795fa6c27d468e8be667e49","nalind","2019-06-07 22:02:50","false","add: add a DryRun flag to AddAndCopyOptions

Add a DryRun flag to AddAndCopyOptions, so that we can ""copy"" content to
digest it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1792
Approved by: TomSweeneyRedHat",60,28,0,1
"containers/buildah","180ee7d6801770c7087fb228f616fdc3d20f2406","nalind","2019-02-25 18:37:44","false","imagebuildah: use ""useCache"" instead of ""noCache""

Name the field ""useCache"" and flip its meaning to make it easier to read
the logic that uses it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1430
Approved by: vrothberg",59,25,0,1
"containers/buildah","ce311f7038beb376f0ce225465409c5f163e288b","TomSweeneyRedHat","2019-02-20 15:25:24","false","Fix tls-verify polarity

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Fix the polarity of tls-verify, during the Cobra conversion
it was inadvertently flipped.

At least partially addresses: #1332

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1351
Approved by: rhatdan",60,25,0,1
"containers/buildah","7aaa21d70a8d79483e22c17186406cb4eba10903","vbatts","2017-12-04 21:31:23","true","README: better first glance idea

Fixes #347

Make the project's first-glance easier to digest.

Signed-off-by: Vincent Batts <vbatts@hashbangbash.com>",33,10,0,0
"containers/buildah","239b2a877aed97b8ca0166bf09dd69f459a68b53","cevich","2023-06-21 20:07:52","true","Cirrus: container/rootless env. var. passthrough

Fixes: https://github.com/containers/buildah/issues/4838

Resolve a long-standing TODO item (and bug fix apparently) relating to
passing important env. var. values into special testing contexts.
Namely container-based and rootless testing.  These changes mostly come
from the (now battle-tested) work by @edsantiago in the podman CI
scripts.  Some podman-CI specific variables have been stripped out, and
other buildah-specific simplifications made.

Signed-off-by: Chris Evich <cevich@redhat.com>",12,77,1,1
"containers/buildah","135b5a8f0394956fe2ac43075fd921bdb378d46c","rhatdan","2023-05-30 18:30:49","false","Fix transition test to work with latest selinux policy

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",15,76,1,1
"containers/buildah","7cc18838b78996593e6600a88998bfdf3d57cd80","rhatdan","2022-05-20 11:08:55","false","Update vendor of containers/(common, storage, image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",27,64,1,1
"containers/buildah","28a002e91981f3105aae616e26306ae8e2d913cf","rhatdan","2022-05-03 16:57:34","false","Vendor in containers/storage v1.40.2

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",24,63,1,1
"containers/buildah","494ee56f17662a5a3ca079e005f515766dcec1b4","rhatdan","2019-03-12 18:06:24","true","Merge pull request #1398 from QiWang19/1239

fix bug images use the template to print results",37,26,0,1
"containers/buildah","a1dd1b08ee2c0ed9b3d591be375dc0060f4f9cdf","TomSweeneyRedHat","2019-02-26 18:09:08","false","Bump to v1.7.1

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Create v1.7.1 to pull in c/image v1.5 for bug fix.",61,25,0,1
"containers/buildah","e844ed6f70774402868d1833190c221a12faa125","edsantiago","2021-04-19 19:26:36","false","tests: copy.bats: fix infinite hang

The ignore-socket test in copy.bats has to create a UNIX socket
file. As it turns out, mknod won't do that: there are only
horrible kludgy options. The least bad of those is to run 'nc'
and control-C it; we do this hands-off via background job.

Until now, the test then infinite-looped a 'test -e socketfile'.
This failed catastrophically in gating tests, because 'nc' was
not installed (it was not a requirement of the RPM) (it is now).
To make things worse, it took months to track this down because
the gating-test logs aren't flushed. But that's another story.

Here we add a fixed number of retries to the 'test -e' loop,
and abort with a timeout error if the socket isn't created.
This may save someone on a distro where nc hasn't yet been
added as a dependency.

Signed-off-by: Ed Santiago <santiago@redhat.com>",50,51,0,1
"containers/buildah","90f7436ac5419a2fabc838e80b3b7e2dd8c3fb67","edsantiago","2023-06-01 15:07:31","false","intermediate-images inherit-label test: make it debuggable

Test is currently very hard to debug on failure. Fix that
by adding unique test descriptors and a little whitespace.

Also, fix a broken/NOP test (copypaste artifact)

Signed-off-by: Ed Santiago <santiago@redhat.com>",16,76,1,1
"containers/buildah","3f1fe126a17527467aebdff32ae19e737d726e89","flouthoc","2023-02-28 08:41:17","true","Merge pull request #4618 from nalind/base-image-annotations

Ignore the base image's base image annotations",18,73,1,1
"containers/buildah","042a249e7374e0914d3008684645380d3e4eddb5","giuseppe","2019-03-08 14:00:20","true","rootless: honor --net host

when running in rootless mode, do not use slirp4netns if --net host is
specified.

Closes: https://github.com/containers/buildah/issues/1223

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",46,25,0,1
"containers/buildah","8ced1276e54ef32dd6bbf1013ea730a9205ea538","rhatdan","2017-06-01 19:23:02","false","Change functions that use a fmt.Errorf to wrap an err to error.Wrapf

Impove error reporting by wrapping all returned err functions with
error.Wrapf

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #124
Approved by: nalind

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #125
Approved by: nalind",13,4,0,1
"containers/buildah","67cfd284303fd132821c91a01b9b92bc3d0124f1","rhatdan","2020-12-21 22:34:32","false","Drop log message on failure to mount on /sys file systems to info

If you are in a rootless environment using chroot builds, you are
likely to get failures when mounting /sys file systems onto your
container. The problem is certain directories are not able to be
mounted on by rootless users.  Since we are logging at Warn level
now, and users can not do anything to fix this situation, I am
dropping this message to info.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",84,47,0,1
"containers/buildah","ea48aa8272e44385d93adfd7f80ae2186e922196","rhatdan","2019-03-19 20:21:02","false","Do not create empty mounts.conf file

We want to use the shared /usr/share/containers/mounts.conf by default.

Currently the tools create an empty mounts.conf file which causes RHEL
subscriptions to not work.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1422
Approved by: TomSweeneyRedHat",37,26,0,1
"containers/buildah","999fa43623e88fb80f474373e08acace834e1810","rhatdan","2019-10-29 21:22:11","true","Merge pull request #1948 from johrstrom/redirect-doc-fix

fix troubleshooting redirect instructions",82,33,0,1
"containers/buildah","dc03c3e2f63f3f49e75e94456fb28696dbee5fb8","rhatdan","2020-10-31 09:55:16","false","fix MkdirAll usage

This subtle bug keeps lurking in because error checking for `Mkdir()`
and `MkdirAll()` is slightly different wrt `EEXIST`/`IsExist`:

 - for `Mkdir()`, `IsExist` error should (usually) be ignored
   (unless you want to make sure directory was not there before)
   as it means ""the destination directory was already there"";

 - for `MkdirAll()`, `IsExist` error should NEVER be ignored.

This commit removes ignoring the IsExist error, as it should not
be ignored.

[v2: skip patching (*Builder).Run]

For more details, a quote from opencontainers/runc PR #162:

-quote-

TL;DR: check for IsExist(err) after a failed MkdirAll() is both
redundant and wrong -- so two reasons to remove it.

Quoting MkdirAll documentation:

> MkdirAll creates a directory named path, along with any necessary
> parents, and returns nil, or else returns an error. If path
> is already a directory, MkdirAll does nothing and returns nil.

This means two things:

1. If a directory to be created already exists, no error is
returned.

2. If the error returned is IsExist (EEXIST), it means there exists
a non-directory with the same name as MkdirAll need to use for
directory. Example: we want to MkdirAll(""a/b""), but file ""a""
(or ""a/b"") already exists, so MkdirAll fails.

The above is a theory, based on quoted documentation and my UNIX
knowledge.

3. In practice, though, current MkdirAll implementation [1] returns
ENOTDIR in most of cases described in #2, with the exception when
there is a race between MkdirAll and someone else creating the
last component of MkdirAll argument as a file. In this very case
MkdirAll() will indeed return EEXIST.

Because of #1, IsExist check after MkdirAll is not needed.

Because of #2 and #3, ignoring IsExist error is just plain wrong,
as directory we require is not created. It's cleaner to report
the error now.

Note this error is all over the tree, I guess due to copy-paste,
or trying to follow the same usage pattern as for Mkdir(),
or some not quite correct examples on the Internet.

> [1] https://github.com/golang/go/blob/f9ed2f75/src/os/path.go

-end-quote-

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",66,45,0,1
"containers/buildah","5faedde7019a97f3d7770962a10432ae00ed6999","rhatdan","2018-06-27 13:49:38","false","Reduce the complexity of the buildah.Run function

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #831
Approved by: nalind",28,17,0,1
"containers/buildah","6e2eb5ead05ef2cac06b257f4ddca630540c9e8f","openshift-merge-robot","2020-10-01 21:20:51","true","Merge pull request #2665 from nalind/no-more-bors

Remove configuration for bors",87,44,0,1
"containers/buildah","7017fc8d0809c427cf5914aa69f6198e8ad61885","openshift-merge-robot","2021-11-05 10:24:18","true","Merge pull request #3613 from rhatdan/docs

[CI:DOCS] Fix tutorial to specify command on buildah run line",29,57,1,1
"containers/buildah","316f496e48b173c6a6df37b0f6d137cf04ad8e23","openshift-merge-robot","2020-10-24 09:15:38","true","Merge pull request #2718 from nalind/copier-global-error

copier: put: ignore Typeflag=""g""",65,45,0,1
"containers/buildah","272f2418f321e1141f8e620139ad14a585e32c29","openshift-merge-robot","2020-11-14 10:53:48","true","Merge pull request #2786 from rhatdan/VENDOR

Vendor in containers/storage v1.24.0",75,45,0,1
"containers/buildah","e1dfdd31edb4e8f675c52e213356401acbaeaa17","openshift-merge-robot","2021-02-02 11:26:52","true","Merge pull request #2953 from containers/dependabot/go_modules/github.com/containers/ocicrypt-1.1.0

build(deps): bump github.com/containers/ocicrypt from 1.0.3 to 1.1.0",93,48,0,1
"containers/buildah","8341435ee13acfcf6f71b9467e858911c9963a72","openshift-merge-robot","2023-03-17 21:23:37","true","Merge pull request #4662 from mtrmac/go1.18

Update to Go 1.18",15,74,1,1
"containers/buildah","61500faa7c00554eb633b25ecdd6676ee588074c","hshiina","2021-04-23 17:09:50","true","Merge branch 'master' into bud-test",50,51,0,0
"containers/buildah","4d2bd80932f0f8fd537d666d1c63485e96d0026d","dilyanpalauzov","2021-06-18 10:50:37","false","[CI:DOCS] buildah bud: spelling --ignore-file requires parameter

Insisting on “DCO” imposes formalities, that serve self-purpose.  One cannot
assume that the submitter has time or will to read texts about symbolism in
software contributions.  If the system wants to see the text

    nrEAUIEUAIe eanuitdnuae EAIUEAUIAIE »ℓ§444.3.72b)°»°ℓ§euaieauuae

in each commit, people will write this, or any other text, that the system wants to
see.  All such text, which presence is mandated by the system, has the same value.

Signed-off-by: Дилян Палаузов <git-dpa@aegee.org>",40,53,1,0
"containers/buildah","338b23ea3e2a37780fb6104c9074d149ffa5fb4b","TomSweeneyRedHat","2018-08-04 02:57:33","false","Revert pull error handling from 881

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #910
Approved by: rhatdan",22,18,0,1
"containers/buildah","130cf4516f085a5b68611d91cf5c5d1ebde8d635","QiWang19","2019-06-19 18:17:11","false","Add --mount  for buildah run

support mount type of bind and tmpfs

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1673
Approved by: rhatdan",46,29,0,1
"containers/buildah","a30b71db2ce53d0e7d262c6d752b0ce0afb1ce30","flouthoc","2022-09-13 06:35:34","true","build: honor <Containerfile>.containerignore as ignore file

As per buildkit backend documentation when using the BuildKit backend, docker build searches for
a `.dockerignore` file relative to the Dockerfile name. For example, running `docker build -f myapp.Dockerfile .`
will first look for an ignore file named `myapp.Dockerfile.dockerignore`. If such a file is not found, the
`.dockerignore` file is used if present. Using a Dockerfile based `.dockerignore` is useful if a project contains
multiple Dockerfiles that expect to ignore different sets of files.

Following PR introduces this buildkit feature parity.

Closes: https://github.com/containers/buildah/issues/4236

Signed-off-by: Aditya R <arajan@redhat.com>",22,67,1,1
"containers/buildah","eff2bd2cd1ce3e3f0b0db14691039c032506e175","cevich","2021-06-09 20:06:01","true","Cirrus: Install docker from package cache

Installing packages at runtime (from an external source) is problematic
for many reasons.  Specifically in the case of buildah/docker
conformance testing, it means the current ""latest"" pacakges are
always installed.  This is a problem as new release branches are
created, because it presents an opportunity for test-environment changes
to happen after buildah/test code is stabilized.

Fix this by using new/special VM images which cache the required docker
packages.  At runtime then, the required packages may be installed from
this cache instead of reaching out to the repository.  Since images used
by tests on release branches never change, this will also serve to
stabilize the package versions for that specific environment.

Signed-off-by: Chris Evich <cevich@redhat.com>",34,52,1,1
"containers/buildah","fa145b09269eb4109734f198715e6f417f84343b","cevich","2023-03-02 17:00:43","true","Skip conformance test failures with Docker 23.0.1

See issue https://github.com/containers/buildah/issues/4639

Signed-off-by: Chris Evich <cevich@redhat.com>",17,73,1,1
"containers/buildah","c7963db36944a914e554830ea4ab5e703968386a","jsoref","2020-12-21 16:19:56","false","Spelling

Signed-off-by: Josh Soref <jsoref@users.noreply.github.com>",84,47,0,0
"containers/buildah","745cee8aa50151b86aba673006a968e42bbfa8e2","nalind","2021-04-19 22:01:13","false","copier: add Remove()

Add copier.Remove().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",50,51,0,1
"containers/buildah","03cd1357962fb2fd012abe331c44283b2fb67c6b","rhatdan","2023-05-05 01:43:25","true","Merge pull request #4776 from containers/renovate/golang.org-x-term-0.x

fix(deps): update module golang.org/x/term to v0.8.0",8,75,1,1
"containers/buildah","f66a6d660d5397b73cb7197cf1cd64e5153e7c29","rhatdan","2021-03-26 11:53:56","false","[NO TESTS NEEDED] Use --recurse-modules when building git context

If a git repository contains submodules, we need to check them all
out because the Containerfile/Dockerfile at the repo might use them.

Fixes: https://github.com/containers/buildah/issues/3104

It is too complicated to setup a recursive submodules git repo, so
setting no tests needed.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",52,50,0,1
"containers/buildah","59dfec35c392238fded93d7e46ec8f026a2e9471","rhatdan","2017-05-28 10:52:18","false","buildah mount command should list mounts when no arguments are given.

buildah mount should work like the mount command and list all mount points
when no options are specified.

Need buildah umount to remove mount point from the database when a mount point
is umounted.

Also remove Mounts field from the builder object.  We only support a single mount
point so no reason for this field any longer.

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #124
Approved by: nalind",16,4,0,1
"containers/buildah","fb7d2b6bd6a16ffdbe4a69428e3ba5b487719e78","rhatdan","2019-12-17 20:24:29","false","Add support for FIPS-Mode backends

If host is running in fips mode, then RHEL8.2 and beyond container images
will come with a directory /usr/share/crypto-policies/back-ends/FIPS.
This directory needs to be bind mounted over /etc/crypto-policies/back-ends in
order to make all tools in the container follow the FIPS Mode rules.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",90,35,0,1
"containers/buildah","5babd69c45eae5821c32c3f9747a89614cbe13cd","rhatdan","2019-10-16 17:20:31","false","Add OWNERS File to Buildah

Add OWNERS file so that we can move to cirrus/openshift merge bots.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",78,33,0,1
"containers/buildah","2e1b71c3ef6ea43209af55ca3eb7dc51aa3d4ddd","rhatdan","2021-05-07 11:19:16","false","Preserve ownership of lower directory when doing an overlay mount

Overlay mounts should work like volume bind mounts and preserve the
underlyng source directories permissions.

Fixes: https://github.com/containers/podman/issues/9947

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",52,51,0,1
"containers/buildah","504fc77c7fdf6cee88ccf77b445d2c12f2def535","rhatdan","2021-10-03 11:01:15","false","Fix .containerignore link file

Link file was miscreated as .containerfile rather then .containerignore.

We want man .containerignore and eventually man .dockerignore to point
to the containerignore.5.md man page.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",44,56,1,1
"containers/buildah","365b4d0ffccfc79d0974e87247ef782fee23cec4","nalind","2018-06-28 16:39:29","false","Update github.com/opencontainers/selinux

Update github.com/opencontainers/selinux to version
9aade4d3a3b7e6d876cd3823ad20ec45fc035402.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #835
Approved by: rhatdan",28,17,0,1
"containers/buildah","956c5155d53e5e0080d5f2b359928990e0988b2b","edsantiago","2023-02-15 18:50:50","false","Temporarily hard-skip bud-multiple-platform-values test

It is completely broken (see #4396) and is now causing failures
in Fedora gating tests:

   https://artifacts.dev.testing-farm.io/30e7b5bc-d162-4ae7-9a60-896f0186bf73/

Signed-off-by: Ed Santiago <santiago@redhat.com>",19,73,1,1
"containers/buildah","6e4d8835dbf65ebba91ddd879f05f7f7103adfc2","edsantiago","2022-04-19 17:07:22","false","Stop littering

Don't touch the test source dir (I missed one in #3841).

Signed-off-by: Ed Santiago <santiago@redhat.com>",26,63,1,1
"containers/buildah","c54c713f6aeedb52645c863fdcf509ecadf94d54","openshift-merge-robot","2022-05-12 11:22:40","true","Merge pull request #3984 from containers/dependabot/go_modules/github.com/opencontainers/runc-1.1.2

build(deps): bump github.com/opencontainers/runc from 1.1.1 to 1.1.2",24,64,1,1
"containers/buildah","292b429f6c4bf4d12969a91903184f38d7e2bb95","Luap99","2023-09-12 12:08:41","true","copier: remove libimage dependency via util package

This allows podman to import the copier package on the remote client
without needing the full libimage package.

Based on Miloslav's work: https://github.com/containers/podman/pull/19718

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",5,79,1,0
"containers/buildah","ff3e620a29c61723366b5e38d79fe076ff880ae1","openshift-merge-robot","2022-10-14 13:33:48","true","Merge pull request #4335 from containers/dependabot/github_actions/actions/checkout-3

build(deps): bump actions/checkout from 2 to 3",26,69,1,1
"containers/buildah","eb4ec4a9ea88d5b4a01ab9b7ec12940f48eaf4ab","flouthoc","2022-07-19 07:54:17","true","docs, run: show SELinux label flag for cache and bind mounts

Buildah cache and bind mounts already support setting SELinux label on
the mounted destination lets document that.

See: https://github.com/containers/buildah/blob/main/tests/bud/buildkit-mount/Dockerfilecachewrite

[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]
[CI:DOCS]

Closes: https://github.com/containers/podman/issues/14964

Signed-off-by: Aditya R <arajan@redhat.com>",22,66,1,1
"containers/buildah","65832731854aeb8888ce4bbd529ed05e34fc3142","TomSweeneyRedHat","2018-04-07 00:11:17","false","Allow umount to have multi-containers

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #561
Approved by: rhatdan",26,14,0,1
"containers/buildah","7fb01615aa61cc373634cbe22217d27406207156","TomSweeneyRedHat","2018-05-15 13:09:31","false","Update gometalinter to fix install.tools error

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #690
Approved by: rhatdan",59,16,0,1
"containers/buildah","4ccb343cef15074e8732167076d0516bb694b701","ashley-cui","2019-06-12 18:29:03","false","Added '-' syntax to remove volume config option

When using the --volume flag, ojects ending in ""-"" are checked if they exist on disk. If they exist on disk they are added as a volume. Otherwise, if the volume is already config'd, that volume is removed

examples:
if /testvol exists:
""--volume /testvol-"" removes /testvol from the config.

if /testvol- exists:
""--volume /testvol-"" adds /testvol- from the config.

Signed-off-by: Ashley Cui <ashleycui16@gmail.com>

Closes: #1670
Approved by: rhatdan",42,29,0,0
"containers/buildah","c4346ef47f635bdef077b2cebc3dcd3a7cda3f2b","TomSweeneyRedHat","2021-08-02 18:13:23","false","Bump to v1.23.0-dev [NO TESTS NEEDED]

[NO TESTS NEEDED]
As the title says.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",36,54,1,1
"containers/buildah","169b0f7c2363277272aee4ac01570528066b76fb","TomSweeneyRedHat","2018-04-04 21:38:41","false","Imagename is required for commit atm, update manpage

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #554
Approved by: rhatdan",25,14,0,1
"containers/buildah","b0d4af99e037bdab3e8518884c39586ed8fc2b9c","TomSweeneyRedHat","2021-02-27 18:46:43","false","Clarify userns options are usable only as root in man pages

We've had a few BZ's come in recently where users were confused about
using the `--userns*` options for build and from inside of a rootless
container.  It's not allowed, but it's not documented that way.  This
change adds further documenation for them.  This will satisfy this
BZ: https://bugzilla.redhat.com/show_bug.cgi?id=1931261

Once merged, similar changes are necessary in the `podman build`
man pages.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",57,49,0,1
"containers/buildah","deb9c69efe89a0f74582402f8a383ef8d4591186","rhatdan","2022-03-07 20:44:14","false","Add --no-hosts flag to eliminate use of /etc/hosts within containers

Users want to turn off addition of /etc/hosts file while building
container images, this would allow them to customize the /etc/hosts
file within the image.

Fixes: https://github.com/containers/buildah/issues/3808

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",30,61,1,1
"containers/buildah","c95370cd3d8e575074c439043c29b061cd75147d","cbandy","2023-04-02 23:24:10","false","build: pass process environment variables by reference

See: https://github.com/containers/buildah/issues/4688
Signed-off-by: Chris Bandy <bandy.chris@gmail.com>",12,74,1,0
"containers/buildah","f00625551fad66ab199c70c069d855d1ea4b7012","rhatdan","2022-09-29 10:11:58","true","Merge branch 'main' into platform-vars",20,68,1,1
"containers/buildah","fb99d85b7631f7b27af9c73b8c71713d3dcb00ef","rhatdan","2017-11-22 14:42:16","false","Need to block access to kernel files systems in /proc and /sys

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #333
Approved by: TomSweeneyRedHat",30,10,0,1
"containers/buildah","bafcf88ae4cb203bf9278750847f30728aaa36c9","rhatdan","2019-08-07 09:34:23","false","Bump container/storage v1.13.1 and containers/image v3.0.1

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1770
Approved by: nalind",51,30,0,1
"containers/buildah","3f5436f7277ddc05bbc13fa452951218667621d8","nalind","2019-06-07 19:59:39","false","add: teach copyFileWithTar() about symlinks and directories

Teach copyFileWithTar() about symbolic links and directories, and use it
to produce tar data to feed to untar() instead of special-casing them.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1785
Approved by: vrothberg",60,28,0,1
"containers/buildah","74f2c9bdf9117a2b054e5c871ed44647944c47d0","giuseppe","2022-06-21 17:39:19","true","build: fix test for subid 4

libsubid changes its ABI in version 4.  Account for the different name
in the configure script.

Closes: https://github.com/containers/buildah/issues/4063

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",23,65,1,1
"containers/buildah","0b1602610f8ffe6fea5415bf00b9931b31a07152","openshift-merge-robot","2022-05-13 09:34:58","true","Merge pull request #3991 from containers/dependabot/go_modules/github.com/docker/docker-20.10.16incompatible

build(deps): bump github.com/docker/docker from 20.10.15+incompatible to 20.10.16+incompatible",26,64,1,1
"containers/buildah","ae8995568b118dc3e17fb6f410083a11924f8d4e","edsantiago","2022-03-24 12:03:06","false","[CI:DOCS] man pages: sort flags, and keep them that way

Enforce alphabetical ordering of command-line options in
man pages. Not as simple as with podman, because conventions
are different.

Reference: https://github.com/containers/podman/pull/13625

Signed-off-by: Ed Santiago <santiago@redhat.com>",31,62,1,1
"containers/buildah","9b6a02f3afdac9d263e74b619411c7e4e2bdf2cd","nalind","2021-11-16 15:56:04","false","run: ensure that stdio pipes are labeled correctly

Label stdio pipes to ensure that processes we run can read through
/dev/stdin and write through the /dev/stdout and /dev/stderr links.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",27,58,1,1
"containers/buildah","28ea5598b95ea64e9a8f7c70092e0a61d29cecd3","openshift-merge-robot","2021-06-18 15:18:54","true","Merge pull request #3319 from dilyanpalauzov/master

[ci:docs] buildah add/copy: spelling",40,53,1,1
"containers/buildah","2d49f7c3bdad96bebd96491252a938df80783818","rhatdan","2020-11-20 14:52:51","false","Remove copy/paste errors that leaked `Podman` into man pages.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",78,46,0,1
"containers/buildah","94b5a15eb0dd1ebc8c76a044daa35b6dc85ec1e7","openshift-merge-robot","2021-05-18 13:34:56","true","Merge pull request #3232 from containers/dependabot/go_modules/github.com/containers/storage-1.31.0

Bump github.com/containers/storage from 1.30.3 to 1.31.0",55,52,1,1
"containers/buildah","c3a3fe847ee1c7bc5ca7a871020d0140fb9749db","openshift-merge-robot","2021-05-19 09:42:41","true","Merge pull request #3237 from hshiina/remove-security-opt

Remove 'buildah run --security-opt' from completion",57,52,1,1
"containers/buildah","5b867f2d21429b4db278dd41f04b15d50ebc0004","openshift-merge-robot","2020-12-10 00:03:04","true","Merge pull request #2846 from lsm5/update-install-docs

update installation doc to reflect current status",78,46,0,1
"containers/buildah","87f3fa59d88ac789e43146053500d00f5afe60c4","rhatdan","2020-09-08 19:35:56","false","Timestamp gets updated everytime you inspect an image

I don't see a purpose of this field in the History log, removing.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",84,43,0,1
"containers/buildah","1db2cdeaa3fc56aae589a63fd582ad05670f3373","rhatdan","2020-03-30 14:18:39","true","Merge pull request #2241 from containers/dependabot/go_modules/github.com/containers/image/v5-5.3.0

Bump github.com/containers/image/v5 from 5.2.1 to 5.3.1",112,38,0,1
"containers/buildah","2a7d3126cac35e6c7201aaba5e5ec10ed7028acd","TomSweeneyRedHat","2018-10-08 13:38:43","false","V1.4 Release Announcement

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",51,20,0,1
"containers/buildah","f0b79583bfe4ce1d1ff9c49d2249a94a85863083","edsantiago","2020-02-06 17:04:17","false","use alpine, not centos, for various tests

Also: images json test: rewrite to actually check for
keys instead of just number of lines. Reason: when using
older podman to prefetch (in f29), 'history' key is lost,
giving us 26 lines of output instead of 30.

Signed-off-by: Ed Santiago <santiago@redhat.com>",110,36,0,1
"containers/buildah","316bcc457f919f71c7698f9131fc5776e6ab47d8","vrothberg","2019-02-20 14:00:18","false","vendor.conf: remove unused dependencies

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1350
Approved by: TomSweeneyRedHat",60,25,0,1
"containers/buildah","a8f350fc5186311647ab1899a68ccdd14ce6c838","Luap99","2023-06-28 13:20:39","true","rootless: use default_rootless_network_cmd config

Use the `default_rootless_network_cmd` containers.conf options to know
which rootless network program to use as default. This setting is
important so distros and user can actually set a different default if
they wish.

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",12,77,1,0
"containers/buildah","d1f2cc000c6299da3f6db57e6baba44d51b237cf","openshift-merge-robot","2023-01-05 14:34:58","true","Merge pull request #4490 from flouthoc/buildah-prune

buildah: add `buildah prune` command and expose `CleanCacheMount` API",20,71,1,1
"containers/buildah","c03b997abbf03acd704d2f28abb0fd388f308eb0","openshift-merge-robot","2022-01-07 19:22:58","true","Merge pull request #3690 from Luap99/network

use libnetwork from c/common for networking",27,59,1,1
"containers/buildah","1b294fe38db516b28f0e8fe0c9b14b9c03c4197b","openshift-merge-robot","2022-09-19 11:04:46","true","Merge pull request #4256 from edsantiago/fix_broken_completion

Fix broken command completion",19,68,1,1
"containers/buildah","a8f48b80511589412d7b846f499e6a0293cc2411","openshift-merge-robot","2022-04-26 17:33:34","true","Merge pull request #3929 from edsantiago/teststeststestteststest

Tests: rename $TESTSDIR and $TESTDIR",25,63,1,1
"containers/buildah","350a835a0f33fd29f9f49a11eed559b8965df496","openshift-merge-robot","2022-01-25 18:33:43","true","Merge pull request #3735 from TomSweeneyRedHat/dev/tsweeney/fixpull2

Make pull commands be consistent",33,60,1,1
"containers/buildah","033027b3f99e39de45adf01533c5f7de95862f1b","umohnani8","2018-07-31 16:02:06","false","Fix volume cache issue with buildah bud --layers

buildah bud would fail at the next step after a VOLUME command
due to buildah trying to cache the volume contents and restore it
later, but the intermediate container used at the VOLUME step didn't
exist anymore.
Changed functionality to delete successful intermediate containers at
the end of the whole build process.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #892
Approved by: rhatdan",31,18,0,1
"containers/buildah","a3e86446a0ccc3fa0281bf8bcc669a511af713db","TomSweeneyRedHat","2019-09-11 12:50:33","false","Bump back to v1.12.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",59,31,0,1
"containers/buildah","acdf4777aa5dcb77e6d6b8b94f80f4a1609988c6","dfr","2022-06-15 11:01:40","false","Move getNetworkInterface to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","8b0f5be4b85a405084a2af24fd0d91fae78d9a77","nalind","2022-03-17 21:33:50","false","run: set parent-death signals and forward SIGHUP/SIGINT/SIGTERM

Restore setting of the parent-death signal when we're running
subprocesses in Run(), so that if we get killed, the child processes
will also get killed.

While a child process is running, if we receive SIGHUP, SIGINT, or
SIGTERM, forward the signal to our child process unless it's the command
we're executing, which we SIGKILL without mercy, and finish the current
routine, which will then notice that the child process has exited and
return an error to its caller.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",31,62,1,1
"containers/buildah","05aa5279a02d124d516eb5e6bc1fbdff93dcf855","openshift-merge-robot","2020-11-17 11:16:11","true","Merge pull request #2796 from nalind/build-cache-no-such

intermediateImageExists: ignore images whose history we can't read",78,46,0,1
"containers/buildah","b80da50f782d0c1f375efcdf67ee0f73c14c8e20","openshift-merge-robot","2023-04-11 09:25:44","true","Merge pull request #4722 from flouthoc/revert-4699

Revert ""buildah image should not enable fuse-overlayfs for rootful mode""",12,74,1,1
"containers/buildah","917195c9b896c269a24a72c519e842a29832636a","openshift-merge-robot","2021-07-12 14:44:55","true","Merge pull request #3362 from rhatdan/excludes

Fix excludes exception begining with / or ./",39,53,1,1
"containers/buildah","ac96369e6a37571a865227d635b7497a68d2d246","openshift-merge-robot","2020-12-07 19:35:15","true","Merge pull request #2834 from rhatdan/network

Throw errors when using bogus --network flags",79,46,0,1
"containers/buildah","7fbf2ae03b28c154c31f957c8741c3a68ea1ebdd","openshift-merge-robot","2022-04-04 05:21:33","true","Merge pull request #3891 from giuseppe/fix-test-failure-running-as-root

test: skip rootless on cgroupv2 in root env",26,62,1,1
"containers/buildah","de86fabd3195ecce92325d612087c2794c27041a","openshift-merge-robot","2021-12-03 18:56:45","true","Merge pull request #3663 from rhatdan/error

Wire logger through to config",30,58,1,1
"containers/buildah","4c287d162dcfa50eb2f18aab39de1adc2f349553","openshift-merge-robot","2021-09-20 18:44:42","true","Merge pull request #3526 from mtrmac/mpb

Update to github.com/vbauerster/mpb v7.1.5",39,56,1,1
"containers/buildah","525abb0a8b186a956e81aad8fd4be918b2ac6cac","openshift-merge-robot","2021-03-23 18:12:21","true","Merge pull request #3094 from TomSweeneyRedHat/dev/tsweeney/fixmds

[CI:DOCS] Fix rootful typo in docs",54,50,0,1
"containers/buildah","6edea3bc0a684b72edc1ca8e865c66a04af64f96","openshift-merge-robot","2021-05-02 18:01:29","true","Merge pull request #3196 from containers/dependabot/go_modules/github.com/containers/storage-1.30.1

Bump github.com/containers/storage from 1.30.0 to 1.30.1",49,51,0,1
"containers/buildah","1b9ee761441ae586ba2f32fe1095a69369d47ad5","openshift-merge-robot","2021-01-08 13:37:12","true","Merge pull request #2869 from rhatdan/bud

Add support for --manifest option in buildah bud and buildah commit",91,47,0,1
"containers/buildah","f33928d9bcb417ca8568dc7cb26869616e590e76","openshift-merge-robot","2021-07-21 14:26:11","true","Merge pull request #3361 from stevegt/patch-2

Remove specific kernel version number requirement from install.md",41,54,1,1
"containers/buildah","f694eca9cd885bb38518b121534cf11c8e11be4a","openshift-merge-robot","2023-03-17 14:57:56","true","Merge pull request #4670 from cevich/disable_dependabot

[CI:DOCS] Disable dependabot in favor of renovate",15,74,1,1
"containers/buildah","587e617a963958e70e85e4e7027ea274c3e4e82d","openshift-merge-robot","2020-11-25 01:29:59","true","Merge pull request #2821 from rhatdan/containerenv

Add container information to .containerenv",77,46,0,1
"containers/buildah","ae697555cc969b9722a28b97dbe93d4098521205","flouthoc","2023-02-06 07:10:23","true","login: support interspersed args for password

Buildah must support accepting password from stdin agnostic of order
like `podman`

Example with buildah which should work

```console
$ cat password.txt | buildah login docker.io -u user --password-stdin
Error: too many arguments, login takes only 1 argument
```

Example with podman which already works
```console
$ cat password.txt | buildah login -u user --password-stdin docker.io
Login Succeeded
```

Closes: https://github.com/containers/buildah/issues/4557

Signed-off-by: Aditya R <arajan@redhat.com>",20,72,1,1
"containers/buildah","f888b3d84b448f80fb01bee85c37c143ff7de14c","flouthoc","2023-08-02 07:29:19","true","buildah: add --layer-label for setting labels on layers

`--layer-label` allows users to set labels on intermediate labels agnostic
of the labels set on actual image. Since there are use-cases where users
want to perform operation on intermediate images only on the basis of
certain labels.

Closes: https://github.com/containers/buildah/issues/4933

Signed-off-by: Aditya R <arajan@redhat.com>",13,78,1,1
"containers/buildah","4c982a379911527d89a54e3918b9c06e3efbc009","nalind","2017-03-23 20:18:40","false","Strip the image name down more for container names

When computing a default container name from the name of a source image,
drop tags and any leading components from the image name before
attempting to use it as part of a container name.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #33
Approved by: rhatdan",12,2,0,1
"containers/buildah","94f2bf025a4aadb76205701516749377a6322cca","nalind","2017-07-31 14:44:21","false","Replace --registry with --transport

Replace --registry command line flags with --transport.  For backward
compatibility, add Transport as an addtional setting that we prepend to
the still-optional Registry setting if the Transport and image name
alone don't provide a parseable image reference.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #235
Approved by: rhatdan",23,6,0,1
"containers/buildah","ae1fffb3fd642a8321c8780e366fcfe3cd77a997","nalind","2017-03-23 17:47:07","false","Always make sure the working directory exists

Always make sure the working directory exists before attempting to run
anything inside of it, and before attempting to copy contents into it or
one of its subdirectories.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",12,2,0,1
"containers/buildah","3eb89047ec01e44e99a322be4f5204bbd3a029a0","ypu","2018-11-12 08:54:06","false","Add some skip word for inspect check in conformance test

As discussed we will skip some key words in the inspect check step.
Also will accept nil as empty array or map in inspect check.

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #1172
Approved by: rhatdan",62,21,0,0
"containers/buildah","45850d0f866db298274a25ea3a758622eaba178a","openshift-merge-robot","2022-08-01 11:35:44","true","Merge pull request #4150 from vrothberg/vendor-common

vendor c/common@v0.49.1",18,66,1,1
"containers/buildah","b03d30530204163a2e52379b5ea1ed39c5975b18","openshift-merge-robot","2021-04-28 19:45:30","true","Merge pull request #3186 from edsantiago/namespace_refactor

namespaces test - refactoring and cleanup",49,51,0,1
"containers/buildah","50498dfaa0a53a98a228010d5e742d5948d573ec","openshift-merge-robot","2022-01-11 14:14:09","true","Merge pull request #3692 from abergmeier/patch-1

Allow processing of common options via FlagSet",28,59,1,1
"containers/buildah","aac6745ae4f8debbcb6dbf41c26d1df3eca4e225","openshift-merge-robot","2021-05-05 20:32:10","true","Merge pull request #3200 from cevich/new_multi_arch_images

Multi-arch github-action workflow unification",51,51,0,1
"containers/buildah","86b04ac4af9531030ddf14bb1a349a16e7dff53d","openshift-merge-robot","2022-04-26 17:31:59","true","Merge pull request #3927 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.3

build(deps): bump github.com/containerd/containerd from 1.6.2 to 1.6.3",25,63,1,1
"containers/buildah","42722bbed586f63dcf47db6efb8b5f86077a1a83","openshift-merge-robot","2022-11-16 11:41:10","true","Merge pull request #4415 from cevich/gha_fix

[skip-ci] GHA: Reuse both cirrus rerun and check workflows",23,70,1,1
"containers/buildah","2156c5ac3b7f30bcc9ac0e7ac4ccd6888e266456","TomSweeneyRedHat","2019-04-04 00:20:04","false","Touch up intro

Quick touch up of the intro tutorial to bump releasever and change
diff to merged in mount output

Fixes: #1468

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1479
Approved by: rhatdan",53,26,0,1
"containers/buildah","7fc4ca76781f59041e0e3ac5f7035188af7969b3","WanLinghao","2019-06-28 08:43:50","false","Refactor code in package imagebuildah

Signed-off-by: WanLinghao <wanlh.fnst@cn.fujitsu.com>

Closes: #1659
Approved by: rhatdan",44,29,0,0
"containers/buildah","62954c89c0327c9853c234ffae498e70e1493ec9","nalind","2022-07-21 21:21:43","false","Set user namespace defaults correctly for the library

Set the default for user namespaces correctly for callers that don't use
our CLI, e.g. OpenShift or our own tutorials.  When we don't do that,
commands invoked through RUN instructions can see weird things, in this
case an empty /sys/fs/cgroup directory.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",19,66,1,1
"containers/buildah","5574235daf7911f63418a2cefd3ecff34d94ea08","nalind","2018-06-14 19:35:17","false","Run(): don't use a callback when a slice will do

moreCreateArgs() doesn't need to be a function; it can just be a slice.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #797
Approved by: rhatdan",30,17,0,1
"containers/buildah","ba11a4ceeb335b4565fa9805657e425d8ba42593","nalind","2020-11-06 20:31:29","false","imagebuildah: use overlay for volumes when using overlay

When we're using the overlay driver (which means we know overlay is
available), use it to make volumes appear to be writeable during RUN
instructions instead of saving/restoring their contents.

This avoids having to copy the contents of the volume directory before
each RUN instruction, and having to remove and extract the contents
after each RUN instruction, which should be faster, particularly if the
amount of content in that volume location is large.

For empty directories, it will at least avoid adding an ""opaque""
notation for the directory in a layer that might otherwise be empty.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",63,45,0,1
"containers/buildah","1ce11306b4583e89934488cbe5d226e363540196","lsm5","2019-08-14 19:23:36","false","use correct path for ginkgo

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>

Closes: #1793
Approved by: TomSweeneyRedHat",51,31,0,1
"containers/buildah","1cfb5eafb7cd6778f0abc76dd91eacb3054b1cc4","cevich","2022-11-14 18:44:02","true","GHA: Reuse both cirrus rerun and check workflows

Depends on: https://github.com/containers/podman/pull/16503

More features, less to maintain.  Everybody wins.

Signed-off-by: Chris Evich <cevich@redhat.com>",22,69,1,1
"containers/buildah","f5c2b5f21fe49b6928c0d8715986309b5d569a15","nalind","2017-02-23 22:56:48","false","Move our data to a file in the containerdir

Move our data from the container's metadata to a file in the container's
per-container directory, so that we can use any OCI container as our
working container.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","80691e654d068d4487d2ed4ec5a0d10046baae09","nalind","2017-01-27 14:37:15","false","mount: print the mountpoint

After we mount a filesystem, print the root filesystem location.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","239fc6f1126c6390479ee951175d34bd0c1ebc14","nalind","2021-08-30 14:36:14","false","copy: add --max-parallel-downloads to tune that copy option

Add a --max-parallel-downloads flag to allow tuning down from the
default of six blobs at a time, and tune it down to one at a time when
we invoke the helper.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",34,55,1,1
"containers/buildah","be2d536f528170b9b9ad6772e0ce48510b616e4c","nalind","2017-06-28 14:51:30","false","Bump containers/storage and containers/image

Bump containers/storage and containers/image, and pin them to their
current versions.  This requires that we update image-spec to rc6 and
add github.com/ostreedev/ostree-go, which adds build-time requirements
on glib2-devel and ostree-devel.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #174
Approved by: rhatdan",20,5,0,1
"containers/buildah","a500e221048f6f05f29b07efacc8ce04a7e63409","nalind","2017-07-19 18:21:05","false","Update image-spec and runtime-spec to v1.0.0

Update to just-released versions of image-spec and runtime-spec, and the
latest version of runtime-tools.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #201
Approved by: rhatdan",17,6,0,1
"containers/buildah","c35493248e86f972ec25420f07f279def38de7a8","nalind","2018-02-05 21:26:21","false","build-using-dockerfile: set the 'author' field for MAINTAINER

When we encounter the MAINTAINER keyword in a Dockerfile, imagebuilder
updates the Author field in the imagebuilder.Builder structure.  Pick up
that value when we go to commit the image.

Should fix #448.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #450
Approved by: rhatdan",35,12,0,1
"containers/buildah","0a7389cbbf316ae93f32e133aada0e8be47ca4e0","nalind","2018-08-09 16:44:30","false","imagebuildah: provide a way to provide stdin for RUN

Add a field to imagebuildah.BuildOptions that lets us pass in an
io.Reader to be connected to stdin when handling RUN instructions.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #920
Approved by: TomSweeneyRedHat",23,18,0,1
"containers/buildah","edce842f54db8a5988fbe7e9f93a204aabc275f0","nalind","2018-06-14 22:39:19","false","Break out getProcIDMappings()

Break getProcIDMappings() out of run.go and turn it into
util.GetHostIDMappings(), and add util.GetSubIDMappings() and
util.ParseIDMappings().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #796
Approved by: rhatdan",30,17,0,1
"containers/buildah","a5a3a7be11c1938239d23887ab18cc956c39aec7","nalind","2017-10-05 17:49:31","false","Update test for output formatting changes

When we added more spaces between the columns of output from the
""images"" command, we didn't update the test to expect it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",31,8,0,1
"containers/buildah","9865ea3660701f3ef7849243d06b15245d4a6dd5","nalind","2017-05-18 21:38:41","false","Add ImportBuilderFromImage()

Add a function for returning a Builder initialized from an image's
metadata, but which isn't tied to a container, so it can't be saved.

This refactored the existing importBuilder() implementation to split the
bits which locate the image based on the information it's given about a
container from the bits which build the structure using information read
from the image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #109
Approved by: rhatdan",15,4,0,1
"containers/buildah","3f5ba7efc2c55c107df098aac76d38839e30e5fe","openshift-merge-robot","2021-01-18 15:57:05","true","Merge pull request #2920 from containers/dependabot/go_modules/github.com/stretchr/testify-1.7.0

build(deps): bump github.com/stretchr/testify from 1.6.1 to 1.7.0",94,48,0,1
"containers/buildah","b5030fa06b1763ec0f32be8aa5379e58b5115f81","openshift-merge-robot","2020-11-20 20:03:48","true","Merge pull request #2813 from rhatdan/man

Remove copy/paste errors that leaked `Podman` into man pages.",78,46,0,1
"containers/buildah","67470615779c2b2d3235bfd20097d4f2a3c0d216","openshift-merge-robot","2020-12-17 11:22:26","true","Merge pull request #2805 from EduardoVega/add-U-volume-flag

Add U volume flag to chown source volumes",81,47,0,1
"containers/buildah","8781f5e4b7b6363e586533f697f3dc76fc1ecf79","openshift-merge-robot","2021-12-13 11:53:29","true","Merge pull request #3670 from flouthoc/buildkit-refactor-tests

tests: move buildkit mount tests files from `TESTSDIR` to `TESTDIR` before any modifications",34,58,1,1
"containers/buildah","9428d031941449533dde1cd851b329676bb46254","openshift-merge-robot","2021-04-26 12:37:00","true","Merge pull request #3177 from ashley-cui/secrets

Implement RUN secrets for buildah bud",50,51,0,1
"containers/buildah","b0db0214fa7e8b5cfdd28a9c227a74a59e1dba73","openshift-merge-robot","2022-09-13 06:49:57","true","Merge pull request #4237 from Enrico204/fix-install.md-debian-stable

[CI:DOCS] Update install.md: Debian 11 (Bullseye) is stable",22,67,1,1
"containers/buildah","cf58d524859c023795753969c88ac2dc0e059048","openshift-merge-robot","2023-06-06 20:43:34","true","Merge pull request #4849 from cevich/docs_comment_fix

[CI:DOCS] Update comment to remove ambiguity",15,76,1,1
"containers/buildah","d72370f0510b66ca9dc687c0f488e2838715b3cb","openshift-merge-robot","2023-09-06 07:14:55","true","Merge pull request #5025 from nalind/tagging-resolve

Don't try to look up names when committing images",7,79,1,1
"containers/buildah","f5cc643067c45e217f0d09fb338901a1e0f5217b","vrothberg","2019-02-20 13:40:38","false","add missing vendor/github.com/containers/libpod/vendor.conf

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1350
Approved by: TomSweeneyRedHat",60,25,0,1
"containers/buildah","e1444dd71e11e07fe5c464a2ec54fa1120434a79","vrothberg","2020-10-19 08:44:22","false","short-names aliasing

Add support for short-name aliasing.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",61,45,0,1
"containers/buildah","449fd3d2e4f02bdb92dc7559ea0f9602e8b12d50","cevich","2023-04-11 15:21:01","true","Renovate: Ensure test/tools/go.mod is managed

The default list of ignore paths means `test/tools/go.mod` is not
managed by renovate:

```
  ""ignorePaths"": [
    ""**/node_modules/**"",
    ""**/bower_components/**"",
    ""**/vendor/**"",
    ""**/examples/**"",
    ""**/__tests__/**"",
    ""**/test/**"",
    ""**/tests/**"",
    ""**/__fixtures__/**""
  ]
```

Override this configuration so that `test/tools/go.mod` is managed.

Signed-off-by: Chris Evich <cevich@redhat.com>",11,74,1,1
"containers/buildah","2a83637a63feedf6a57514cb2b5894f18cca3640","openshift-merge-robot","2021-05-20 12:52:19","true","Merge pull request #3245 from containers/dependabot/go_modules/github.com/opencontainers/runc-1.0.0-rc95

Bump github.com/opencontainers/runc from 1.0.0-rc94 to 1.0.0-rc95",56,52,1,1
"containers/buildah","e66309ebde8c9d3af085fbb8e81ea0906207f44e","openshift-merge-robot","2022-06-09 22:53:14","true","Merge pull request #4051 from rhatdan/VENDOR

Vendor in latest github.com/sirupsen/logrus",23,64,1,1
"containers/buildah","c7e45ed842f14bd5cade771c61e0c4bfb7129ab3","rhatdan","2021-12-16 18:44:51","true","Merge pull request #3677 from containers/dependabot/go_modules/github.com/spf13/cobra-1.3.0

build(deps): bump github.com/spf13/cobra from 1.2.1 to 1.3.0",29,59,1,1
"containers/buildah","49740138faeec5db3439edd25d04e2fd5471a8e7","rhatdan","2021-08-17 10:19:47","false","build(deps): bump github.com/containers/common from 0.42.1 to 0.43.1

Bumps [github.com/containers/common](https://github.com/containers/common) from 0.42.1 to 0.43.1.
- [Release notes](https://github.com/containers/common/releases)
- [Commits](https://github.com/containers/common/compare/v0.42.1...v0.43.1)

---
updated-dependencies:
- dependency-name: github.com/containers/common
  dependency-type: direct:production
  update-type: version-update:semver-minor
...

Signed-off-by: dependabot[bot] <support@github.com>",39,55,1,1
"containers/buildah","30ed95a73483ad389aabb8545fdee2f74cac0874","openshift-merge-robot","2021-03-10 13:12:51","true","Merge pull request #3066 from jmguzik/cmd-addcopy-enhancements

Remove duplicated code in addcopy",58,49,0,1
"containers/buildah","154a448b659c8f3beda4431d2500f5da69cc376b","openshift-merge-robot","2020-10-21 13:33:14","true","Merge pull request #2697 from containers/dependabot/go_modules/github.com/spf13/cobra-1.1.1

build(deps): bump github.com/spf13/cobra from 1.0.0 to 1.1.1",64,45,0,1
"containers/buildah","437586c237bdbdb82acda59b66494ad2ddf1259e","nalind","2020-08-12 20:40:00","false","StageExecutor.historyMatches: compare timestamps using .Equal

As the time package warns us, we should have used time.Time.Equal() to
compare timestamps in image histories when checking for equality,
instead of trying to compare values using the == operator.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",86,42,0,1
"containers/buildah","c43ab204445141507aabbb2ea8c2e7e7585fc23e","giuseppe","2020-07-14 21:06:59","true","chroot, run: not fail on bind mounts from /sys

some file systems under /sys might not be accessible to an
unprivileged user.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",147,42,0,1
"containers/buildah","08ce44846edd6b0ec9a117139aa408ccc30f1e68","rhatdan","2020-06-15 17:03:38","false","Merge pull request #2406 from containers/dependabot/go_modules/github.com/containers/common-0.13.1

Bump github.com/containers/common from 0.12.0 to 0.13.1

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",143,41,0,1
"containers/buildah","e48ff81bbb60583c3b73cb61201f12f384365337","rhatdan","2020-03-26 09:54:22","true","Merge pull request #2247 from TomSweeneyRedHat/bump-1.14.4

Bump 1.14.4",112,38,0,1
"containers/buildah","bf04bf1361e01aa19f978a463d3cd6254ecbb30a","vrothberg","2019-10-01 11:24:14","true","Merge pull request #1880 from containers/dependabot/go_modules/github.com/mattn/go-shellwords-1.0.6

Bump github.com/mattn/go-shellwords from 1.0.5 to 1.0.6",66,32,0,1
"containers/buildah","35f6558e843efd33fda420dd5a820eb35360df99","mtrmac","2018-06-11 21:43:21","false","Do not ignore any parsing errors in initConfig

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #776
Approved by: rhatdan",32,16,0,1
"containers/buildah","bc97173ac643c20697dfccc15bf6c4c840ef6c83","cevich","2021-07-15 15:11:29","true","Multi-arch image workflow: Make steps generic

Since this workflow is duplicated across three repositories, maintaining
changes becomes onerous if the item contents vary between
implementations in any way.  Improve this situation by encoding the
repository-specific details into env. vars. then referencing those vars
throughout.  This way, a meaningful diff can be worked with to compare
the contents across repositories.

Also included are abstractions for the specific command used to obtain
the project version, and needed details for filtering the output.  Both
of these vary across the Buildah, Skopeo, and Podman repos.

***NOTE:*** This change requires the names of two github action secrets
to be updated: `BUILDAH_QUAY_USERNAME` -> `REPONAME_QUAY_USERNAME`
(and `*PASSWORD`).

Signed-off-by: Chris Evich <cevich@redhat.com>",41,54,1,1
"containers/buildah","fe0256d38fa1a4c1451d9bcb42094bd0967dc010","edsantiago","2023-01-23 12:56:39","false","Flake 3710 has been closed. Reenable the test.

(No, I don't expect the issue to be fixed, but sometimes we need
incentives in order to pay attention to flakes)

Signed-off-by: Ed Santiago <santiago@redhat.com>",19,72,1,1
"containers/buildah","d1c75eabb63e798996317230501a9d018ef07849","vrothberg","2019-03-22 06:14:28","false","bump github.com/containernetworking/cni to v0.7.0-rc2

The {Add,Del}NetworkList APIs were extended with a context parameter,
which require adjustments in the code.

Fixes: #1433
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1434
Approved by: rhatdan",37,26,0,1
"containers/buildah","1c97f6ac2c1f6c0ad99350f9b552dc0a730a943e","TomSweeneyRedHat","2018-02-03 20:31:02","false","Bump Fedora 26 to 27 in rpm test

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #444
Approved by: rhatdan",42,12,0,1
"containers/buildah","b9b3184632e0f2052d340eba4eda0137c281eb12","ashley-cui","2021-10-12 19:21:02","false","Default secret mode to 400

Fixed a bug where buildah bud mounted secrets permissions were incorrect due to a decimal/octal conversion error. buildah bud mounted secrets now have a default permission of 400. Fixes #3557

Signed-off-by: Ashley Cui <acui@redhat.com>",41,56,1,0
"containers/buildah","34bc00afecdd5e992d403db08b2c7155ffd8ba7f","cevich","2022-01-25 19:43:48","true","Github-workflow: Report both failures and errors.

Port of changes from https://github.com/containers/podman/pull/12997 and
https://github.com/containers/podman/pull/13005 to the workflow in this
repository.

Signed-off-by: Chris Evich <cevich@redhat.com>",33,60,1,1
"containers/buildah","cb9b9d4dd5563381160cd95ff22644127e541c48","cevich","2021-09-01 14:50:23","true","Docs: Clarify rmi w/ manifest/index use

Also do some minor re-formatting of the `LIMITATIONS` section.  Reducing
the line-length, and formatting each paragraph into a bullet-item.

Signed-off-by: Chris Evich <cevich@redhat.com>",34,55,1,1
"containers/buildah","faebb9fdb2e01a1ab9e6adfb878ca6181345f403","TomSweeneyRedHat","2022-03-30 16:13:37","false","Bump back to v1.26.0-dev

As the title says

[NO NEW TESTS NEEDED]

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",27,62,1,1
"containers/buildah","5f49ad298c4db08b9da22a4a9dee28354e417f0c","dougsland","2019-03-20 17:18:34","false","docs: 01-intro.md: add missing . in Dockerfile examples

The . is required, otherwise user will get syntax error.

Signed-off-by: Douglas Schilling Landgraf <dougsland@redhat.com>",36,26,0,0
"containers/buildah","78fb869817d04675930818a2263ead54fa39add1","TomSweeneyRedHat","2019-04-30 23:19:04","false","Don't create directory on container

In a prior PR, we were creating the directory from the
translated symlink onto the host container.  Instead
try to create that in the container and if it exists
already, just continue.

Fixes: #1562

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1565
Approved by: rhatdan",53,27,0,1
"containers/buildah","05961173d7a34254fc7600a39512437ff74532b0","TomSweeneyRedHat","2018-09-11 12:14:41","false","Add Podman relationship to readme, create container tools guide

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1000
Approved by: rhatdan",36,19,0,1
"containers/buildah","719b660462c99f1e204fc492d49ed1b1b41a4ae6","flouthoc","2021-10-18 05:51:51","true","buildkit: add from field to bind and cache mounts so images can be used as source

Following commit adds buildkit like support for `from` field to `--mount=type=bind`
and `--mount=type=cache` so images and stage can be used as mount source.

Usage looks like
```dockerfile
RUN --mount=type=bind,source=.,from=<your-image>,target=/path ls /path
```
and
```dockerfile
RUN --mount=type=cache,from=<your-image>,target=/path ls /path
```

Signed-off-by: Aditya Rajan <arajan@redhat.com>",36,57,1,1
"containers/buildah","25f9ff8439b47413b85dfbeef5c92d9244802545","flouthoc","2022-05-19 11:09:59","true","buildkit, multistage: skip computing unwanted stages

While performing mult-stage builds buildah does not needs to computed
and run each and every stage it can skip stages which are not used by
`target` stage.

Following commit adds `dependencyTree/dependencyMap` to executor which
calculates and populates the dependencyTree for all the stages and marks
if a particular stage is used by `Target/Final` stage directly or
indirectly.

```Dockerfile
// buildah should skip this stage
FROM alpine
RUN echo ""unwanted stage""

FROM alpine as one
RUN echo ""wanted stage""

// buildah should skip this stage
FROM alpune
RUN echo ""another unwanted stage""

FROM one
RUN echo ""wanted stage""
```

Signed-off-by: Aditya R <arajan@redhat.com>",25,64,1,1
"containers/buildah","87364fabf970bf253e5c4f96dfde97afa8a4d279","openshift-merge-robot","2021-11-18 08:10:27","true","Merge pull request #3631 from flouthoc/ssh-agent-increase-timout

ssh-agent: Increase timeout before we explicitly close connection",30,58,1,1
"containers/buildah","f621d4760a4c41ef5e5386d2c0fb48bf5dd58f35","openshift-merge-robot","2022-05-04 17:58:09","true","Merge pull request #3961 from TomSweeneyRedHat/bump-1.26.0

Bump 1.26.0",25,63,1,1
"containers/buildah","810658f2e8b13f5714552f0ed4bece879cf8baab","openshift-merge-robot","2022-06-02 11:18:09","true","Merge pull request #4029 from containers/dependabot/go_modules/github.com/containernetworking/cni-1.1.1

build(deps): bump github.com/containernetworking/cni from 1.1.0 to 1.1.1",25,64,1,1
"containers/buildah","2c0f43203ddbe683f686509ca33d6d116262a3a0","openshift-merge-robot","2021-03-23 18:08:20","true","Merge pull request #3099 from edsantiago/shortnames_in_tests

tests: prefetch: use buildah, not podman, for pulls",55,50,0,1
"containers/buildah","018e6f1966e53898cf0e9daf4e2a864b58ac4513","openshift-merge-robot","2021-09-23 10:10:24","true","Merge pull request #3533 from nalind/mid-failure

imagebuildah: fix an attempt to write to a nil map",39,56,1,1
"containers/buildah","857ba5ab06c0c82f69585b23bed5c05023f2259c","openshift-merge-robot","2021-12-14 21:52:56","true","Merge pull request #3594 from rhatdan/group

Allow rootless buildah to set resource limits on cgroup V2",32,58,1,1
"containers/buildah","3b96b1cafb0d15572842f17579542aa3018b6728","rhatdan","2023-10-27 17:10:18","false","Use mask definitions from containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",4,81,1,1
"containers/buildah","f1c022d84b43f7a3660be5ff79939c901b9c8e03","openshift-merge-robot","2022-08-18 20:13:23","true","Merge pull request #4191 from nalind/cause

Drop util/util.Cause()",17,67,1,1
"containers/buildah","fccc78955c059bea84454d5e239ec332f7a0b1ca","nalind","2022-05-04 19:58:45","false","Make `buildah build --label foo` create an empty ""foo"" label again

Restore podman's CLI compatibility with `docker build` by making its
`--label` and `--annotate` options create empty labels and annotations
when they're given a name but no `=` or value.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",25,63,1,1
"containers/buildah","35fbf3b42a535e31c43470fc9c5f7500951ba056","openshift-merge-robot","2022-02-16 20:37:42","true","Merge pull request #3785 from TomSweeneyRedHat/bump-1.24.2

Bump 1.24.2",27,61,1,1
"containers/buildah","5aeecd24549801343407bc573321718a56388fd5","vrothberg","2021-05-12 08:22:17","false","buildah bud: fix containers/podman/issues/10307

Fix a regression in `buildah bud`.  In case of a cache hit or an
intermediate image, the pull policy should be set to ""never"" so that we
enforce a local-only lookup without even attempting to reach out to a
registry.

The regression was detected in Podman which defaults to --layers=true
which ultimately broke when setting --pull or --pull-always.  In case of
a cache hit, the image reference refers to a local image which conflicts
with an ""always"" pull policy.

Also extend an existing bud test to make sure we don't regress on it in
the future.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",53,52,0,1
"containers/buildah","8648050e186371f1e057ebb9b67ed7fbdbc84f02","rhatdan","2020-08-10 12:57:55","true","Merge pull request #2526 from containers/dependabot/go_modules/github.com/opencontainers/runc-1.0.0-rc92

Bump github.com/opencontainers/runc from 1.0.0-rc91 to 1.0.0-rc92",85,42,0,1
"containers/buildah","68389aa4ec8819fdc0fe5568ccde1b8ba728e2c6","rhatdan","2020-07-13 20:18:32","false","Mask out /sys/dev to prevent information leak

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",147,42,0,1
"containers/buildah","a5b8b7a1c017614623f19cae350ee4c835cc4b6d","TomSweeneyRedHat","2020-05-23 18:46:19","false","Bump imagebuilder for ARG fix

Bump imagebuilder to the latest upstream to get the ARG fix from
https://github.com/openshift/imagebuilder/pull/159

Also touched up the install.md with vendoring from a commitId so
I won't have to run all around looking for it next time.

Fixes: https://github.com/containers/buildah/issues/2192
       and probably https://github.com/containers/buildah/issues/2345

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",134,40,0,1
"containers/buildah","7f5c832ac026d7e144943c17512df9b6ef68518e","rhatdan","2020-04-27 18:12:30","false","Don't force tests to use runc

We should default to what buildah info reports else use runc or crun.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",137,39,0,1
"containers/buildah","57b428822bc30a68f9350f108dfb0c5eeebb54d3","TomSweeneyRedHat","2019-05-02 00:55:58","false","Bump to v1.8.1

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1566
Approved by: nalind",52,27,0,1
"containers/buildah","c752783d7ad0b2aed857428811a93d96dd19d367","carbonin","2020-03-25 14:18:59","false","Add .swp files to .gitignore

Signed-off-by: Nick Carboni <ncarboni@redhat.com>",113,38,0,0
"containers/buildah","43ee7faf66fd24044f8bb7b6ece5d508ba3f74b8","rhatdan","2020-03-03 14:53:41","true","Merge pull request #2197 from containers/dependabot/go_modules/github.com/opencontainers/selinux-1.3.3

Bump github.com/opencontainers/selinux from 1.3.2 to 1.3.3",100,37,0,1
"containers/buildah","d9427c15822d53c2c8f4d7d6f70dada361c1bafb","vrothberg","2020-02-14 11:37:12","true","Merge pull request #2164 from lsm5/centos8-doc-update

include installation steps for CentOS 8 and Stream",114,37,0,1
"containers/buildah","431fc912e2153e003fb4b6b3a241191db342430e","rhatdan","2018-11-27 15:00:06","false","Fix completions to print Names as well as IDs

We want to complete based on container and image names as well
as IDs.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1202
Approved by: vrothberg",68,22,0,1
"containers/buildah","363bf9c5bcac44f2802e2f6be38eb2097c56e39c","dfr","2022-08-05 17:03:28","false","chroot: Fix setRlimit build on FreeBSD

On FreeBSD, members of the rlimit structure are signed, not unsigned.

Signed-off-by: Doug Rabson <dfr@rabson.org>",18,66,1,0
"containers/buildah","3faa69848d1a927f0580c5a0aca8f476645b4c11","dfr","2022-05-31 16:46:04","false","Add a simple FreeBSD jail library

This only has enough functionality to support buildah and podman.

Signed-off-by: Doug Rabson <dfr@rabson.org>",27,64,1,0
"containers/buildah","b33b87b28f43e5344fc19aa5e31a80d860f8ecf3","nalind","2019-07-15 21:56:57","false","Build e2e tests using the proper build tags

Tell ginkgo about the build tags that we need to use when building e2e
tests.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1722
Approved by: TomSweeneyRedHat",49,30,0,1
"containers/buildah","9e2b0e2fff3c5fd521cf488224e5b9532150e747","openshift-merge-robot","2022-09-09 23:31:07","true","Merge pull request #4225 from nalind/seccompdefaults

Use constants from containers/common for finding seccomp.json",18,67,1,1
"containers/buildah","7c4446058b547027b90b9f241ee6abfe8dc30438","openshift-merge-robot","2021-04-27 13:33:35","true","Merge pull request #3172 from hshiina/bud-test

Add system tests of 'bud' subcommand",49,51,0,1
"containers/buildah","7389cc7acf753b29a6f7b86968e6b24b3790aac1","openshift-merge-robot","2020-10-13 19:49:38","true","Merge pull request #2689 from zhangguanzhang/build-path-error

Fix build path wrong https://github.com/containers/podman/issues/7993",65,44,0,1
"containers/buildah","ec98ea4ae75fcf0933497b78db2c9eb696f0131e","openshift-merge-robot","2021-06-25 13:36:40","true","Merge pull request #3339 from containers/dependabot/go_modules/github.com/containers/storage-1.32.5

build(deps): bump github.com/containers/storage from 1.32.4 to 1.32.5",37,53,1,1
"containers/buildah","05d489808ba41669da32a2d98b98e765bd50089d","flouthoc","2022-07-18 11:12:57","true","imagebuildah, build: remove undefined concurrent writes

This is refactor commit which aims to remove undefined concurrent writes
from imagebuildah by making sure that fields which we are modifying are
not shared by builds for each platform so there is no undefined
concurrent write

[NO TESTS NEEDED]
[NO NEW TESTS NEEDED]
No new test is needed for this OTOH all the existing tests should pass

Closes: https://github.com/containers/buildah/issues/4079

Signed-off-by: Aditya R <arajan@redhat.com>",23,66,1,1
"containers/buildah","7681de092ff9277dfe1d8a00fe64e617dba0b23e","TomSweeneyRedHat","2019-03-25 18:29:39","false","Resolve symlink when checking container path

When checking the container path, check to see if
the path is a symlink and convert it if necessary
before writing to it.

Fixes: #1439

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1443
Approved by: rhatdan",39,26,0,1
"containers/buildah","04150e062b67d514b39531c6eae1d52be1691379","TomSweeneyRedHat","2019-09-16 23:28:44","false","Vendor c/storage v1.13.3

Vendor in containers/storage v1.13.3
Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1862
Approved by: nalin",61,32,0,1
"containers/buildah","5cca1d605983f4f24fc0f2146789cab507f65bbc","TomSweeneyRedHat","2018-12-05 14:47:27","false","Clarify docker.io default in push with docker-daemon

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1221
Approved by: rhatdan",48,22,0,1
"containers/buildah","5965d9acffad0b70e8760de643b5f488ecadec24","TomSweeneyRedHat","2020-02-06 00:07:04","false","Bump to v1.14.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",110,36,0,1
"containers/buildah","6bb4efdba8c94c9a31ae0aca8ec03aa3fc1cc5d8","dfr","2022-06-15 11:30:40","false","Add FreeBSD support to pkg/chrootuser

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","ab8e351c60882abb0fef21b3ee7abe4df0d3d677","terceiro","2021-02-10 14:33:33","false","Fix caching layers with build args

This fixes a regression introduced in
9b299588c0936376ef9ccd7938f1cef27c831418.

ib.Run() is only really needed in the ARG step. On all the other steps,
it can cause potentially expensive commands to be executed unecessarily.

Closes https://github.com/containers/buildah/issues/2992

Signed-off-by: Antonio Terceiro <antonio.terceiro@linaro.org>
Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>",96,48,0,0
"containers/buildah","47665ad7771709fb5c1dd14a0dd6377055e9a6a7","rhatdan","2017-09-22 09:37:40","false","Cleanup buildah-commit code

1. Sort options so they are in alphabet order
2. Remove extra lines of code for options parsing that really do not accomplish anything.
3. Remove variables when they are not necessary, I.E. Don't create a variable to hold an
option that is only used once, use the option instead.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #267
Approved by: <username_without_leading_@>",34,8,0,1
"containers/buildah","71e1ebf4bc5fe43ee6e161a5597a7faca583ee98","rhatdan","2021-08-26 10:22:39","false","Add epoch time field to buildah images

Currently buildah images does not have an easy way to get the epoch
creation time. This field is available in `podman images` as the
Created field. Adding to buildah images to make it consistent.

Fixes: https://github.com/containers/buildah/issues/3478

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",39,55,1,1
"containers/buildah","cde99f851773992f9b2fd7a0e3d01fa78c57e581","rhatdan","2017-11-07 19:14:13","true","Merge pull request #308 from TomSweeneyRedHat/dev/tsweeney/tip2

Add go tip to build, but allow it to have failures",29,9,0,1
"containers/buildah","a6f7d725a062058df82603a507e229f2c08d7944","rhatdan","2017-07-17 14:42:58","false","Add/Copy need to support glob syntax

This patch allows users to do
buildah add $ctr * /dest

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #194
Approved by: nalind",18,6,0,1
"containers/buildah","2e59c376ab1dbb39c24449d970e24903a28a54f2","openshift-merge-robot","2021-02-11 10:36:35","true","Merge pull request #2994 from rhatdan/docs

[ci:docs] Fix tutorial for rootless mode",75,49,0,1
"containers/buildah","afe00c31ff82b766fc7d0d0fca614d5b2afe8d64","openshift-merge-robot","2021-08-25 12:37:02","true","Merge pull request #3476 from nalind/term

Replace golang.org/x/crypto/ssh/terminal with golang.org/x/term",41,55,1,1
"containers/buildah","4eb83eabb297b191790e94ad9ce7aaf26df55344","openshift-merge-robot","2022-04-27 12:29:51","true","Merge pull request #3928 from containers/dependabot/go_modules/tests/tools/github.com/cpuguy83/go-md2man/v2-2.0.2

build(deps): bump github.com/cpuguy83/go-md2man/v2 from 2.0.1 to 2.0.2 in /tests/tools",25,63,1,1
"containers/buildah","3764c28b9ec535d85f25d5fc31f50c345b0e60b8","openshift-merge-robot","2020-11-10 08:46:34","true","Merge pull request #2749 from rhatdan/bud

Update podman bud man page",66,45,0,1
"containers/buildah","51227358778b6e2ec10f926cc94cec3c4d76ce2a","flouthoc","2023-07-27 08:59:08","true","vendor: bump c/image to v5.26.1-0.20230726142307-8c387a14f4ac

Signed-off-by: Aditya R <arajan@redhat.com>",14,78,1,1
"containers/buildah","bf0a6e07311b4f682fd2a37f9783b2eeddeea641","flouthoc","2022-10-05 06:22:35","true","test: removing unneeded/expensive COPY

Test added in https://github.com/containers/buildah/pull/4310 uses `COPY
. .` which is expensive and unneeded. Also in `podman` test due to
copying files directly from the currect context it hits a
system/environment limit. See https://api.cirrus-ci.com/v1/artifact/task/5960273050730496/html/bud-podman-fedora-36-root-host.log.html#t--00004

Hence remove this uneeded `COPY` and instead use a `RUN echo`.

Closes: https://github.com/containers/buildah/issues/4314

Signed-off-by: Aditya R <arajan@redhat.com>",26,68,1,1
"containers/buildah","ad4976d02ca77bdb8e535a7697f43cf016a8289c","flouthoc","2022-07-26 19:53:30","true","refactor: remove unused CommitOptions from generateBuildOutput

Signed-off-by: Aditya R <arajan@redhat.com>",19,66,1,1
"containers/buildah","37377e68272972665d6023ee5055884571291491","flouthoc","2021-10-27 09:13:35","true","run: honor --network=none from builder if nothing specified

This commit makes sure we honor NetworkDisabled in `runs` if
`--network=none` was specified while building the container and no
configuration was specified in while running the container.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",32,57,1,1
"containers/buildah","d7fb2def2625eac05f2dd6028f230048364cf245","rhatdan","2020-09-16 11:57:10","true","Merge pull request #2608 from alvistack/master-linux-amd64

Update nix pin with `make nixpkgs`",91,44,0,1
"containers/buildah","947714fbd2ac4b3c49c0abcaab59a82595894db2","boaz0","2018-01-28 19:24:49","false","Unescape HTML characters output into the terminal

By default, the JSON encoder from the Go standard library
escapes the HTML characters which causes the maintainer output
looks strange:

""maintainer"": ""NGINX Docker Maintainers \u003cdocker-maint@nginx.com\u003e""
Instead of:
""maintainer"": ""NGINX Docker Maintainers <docker-maint@nginx.com>""

This patch fixes this issue in ""buildah-inspect"" only as this is
the only place that such characters are displayed.

Note: if the output of ""buildah-inspect"" is piped or redirected
then the HTML characters are not escaped.

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>

Closes: #421
Approved by: rhatdan",37,12,0,0
"containers/buildah","b164206a0f354ac90b42406b843b0e2be731987d","rhatdan","2022-12-12 19:41:28","true","Merge pull request #4460 from rhatdan/VENDOR

Update vendor or containers/(image, storage, common)",16,70,1,1
"containers/buildah","1e3e74314043c027aefcffc8167330085b1fa58f","rhatdan","2023-01-31 12:32:38","true","Merge pull request #4545 from containers/dependabot/go_modules/github.com/containerd/containerd-1.6.16

build(deps): bump github.com/containerd/containerd from 1.6.15 to 1.6.16",19,72,1,1
"containers/buildah","69e5e49040e223f5cb5a6e3ff5811d06de0c63ea","rhatdan","2021-07-15 17:20:43","false","Chown with environment variables not set should fail

Fixes: https://github.com/containers/buildah/issues/3380

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",42,54,1,1
"containers/buildah","13b6e4a0bd0d300d8485847ee6f1f33835d06f5e","rhatdan","2023-06-14 11:12:02","true","Merge pull request #4832 from kolyshkin/rm-devmapper

Remove device mapper support",13,77,1,1
"containers/buildah","7d2e0e11500d8c15a5b1a5e56927ca6e0e1e24cc","vrothberg","2019-02-22 14:45:37","false","README.md: rephrase Buildah description

Rephrase the description of Buildah to make some core attributes
(e.g., rootless, Dockerfile-less build, etc.) more obvious.

Addresses: https://github.com/containers/buildah/issues/1349#issuecomment-466096550
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1362
Approved by: @rhatdan",59,25,0,1
"containers/buildah","55ec519635d397efee135c43b3f866253df8c80a","openshift-merge-robot","2021-07-19 17:21:57","true","Merge pull request #3389 from containers/dependabot/go_modules/github.com/opencontainers/runc-1.0.1

build(deps): bump github.com/opencontainers/runc from 1.0.0 to 1.0.1",42,54,1,1
"containers/buildah","b5a8b3afedf8fd55b810d0221f4e76d7503cedce","openshift-merge-robot","2023-08-18 09:02:43","true","Merge pull request #4979 from michalbiesek/feat-loong64

make,cross: restore loong64",9,79,1,1
"containers/buildah","9591a8df9256ab539845dfd9c583117a5f244a5d","openshift-merge-robot","2021-12-26 15:36:08","true","Merge pull request #3678 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.7.6

build(deps): bump github.com/fsouza/go-dockerclient from 1.7.4 to 1.7.6",28,59,1,1
"containers/buildah","7629cbee939064a7b97dfe37664ffc54191f308c","openshift-merge-robot","2022-01-06 14:04:41","true","Merge pull request #3689 from containers/dependabot/go_modules/github.com/containerd/containerd-1.5.9

build(deps): bump github.com/containerd/containerd from 1.5.8 to 1.5.9",27,59,1,1
"containers/buildah","de6c0dab2c63b5dac73538def43ea565ca9015a5","openshift-merge-robot","2021-02-17 00:41:26","true","Merge pull request #2996 from umohnani8/history

Add base image name to comment",61,49,0,1
"containers/buildah","a1fd130f9e819884efebfb849696ddff78eb52da","openshift-merge-robot","2022-09-02 16:40:26","true","Merge pull request #4174 from dfr/freebsd-chroot

Add support for buildah run with chroot isolation",19,67,1,1
"containers/buildah","94b305ced9442901f1b7bee398f2a9fa46d83b92","openshift-merge-robot","2021-10-08 17:34:36","true","Merge pull request #3575 from flouthoc/buildkit-tmpfs-support

buildkit: Add support for `--mount=type=tmpfs` to allow mounting volatile memory instead of persistent storage.",41,56,1,1
"containers/buildah","af10f8cab6906c27e950bb7755233fde3cd33d12","openshift-merge-robot","2020-11-23 11:40:03","true","Merge pull request #2819 from containers/dependabot/go_modules/github.com/containers/common-0.29.0

build(deps): bump github.com/containers/common from 0.27.0 to 0.29.0",79,46,0,1
"containers/buildah","6133ab59ac8b286f3e4c633d1824f8001058012e","openshift-merge-robot","2022-07-29 08:18:13","true","Merge pull request #4144 from rhatdan/error

util, fileExistsAndNotADir: determine a file or directory should print an error",18,66,1,1
"containers/buildah","c302120118910bef98619ca730704dd58fbc4f60","openshift-merge-robot","2021-05-26 12:16:52","true","Merge pull request #3255 from nalind/direct-commit

containerImageRef/containerImageSource: don't buffer uncompressed layers",37,52,1,1
"containers/buildah","5876e9ea6c67a2c6cade55508efb545364768411","42wim","2019-04-17 21:26:58","false","Add BUILDAH_ISOLATION rootless back

Signed-off-by: Wim <wim@42.be>

Closes: #1529
Approved by: rhatdan",50,27,0,0
"containers/buildah","b51f045f5952491a36199391a26ba3e0a742ebf6","vrothberg","2019-06-18 11:07:18","false","imagebuildah/build.go: avoid redundant `filepath.Join()`

`archivedPath` is either overwritten or never used, so let's just
declare it for later use.

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","ac5031de808b694863ac51319b77bf6e63eea845","vrothberg","2019-08-02 16:10:28","true","Merge pull request #1759 from TomSweeneyRedHat/bump-1.10.0

Bump 1.10.0",49,30,0,1
"containers/buildah","898eea8fbefd73993406610311cad8fcab045bad","rhatdan","2021-03-05 10:44:54","false","Make PolicyMap and PullPolicy names align

Currently it is impossible to switch from a PullPolicy type
and PolicyMap via strings.  This PR Makes the types align.

This is required to make passing of PullPolicy in podman-remote
to work.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",57,49,0,1
"containers/buildah","2b1fedcaa794bcc557d59b0ac78c35d5208461b7","nalind","2019-02-14 17:39:17","false","dumpbolt: handle nested buckets

When iterating through a bucket, a key with no value is a sub-bucket.
Dump the contents of those buckets after the non-sub-buckets.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1340
Approved by: rhatdan",59,25,0,1
"containers/buildah","8ce683f4fe3679b916a3c3125b4ec807e35fd9f6","nalind","2017-07-21 21:42:10","false","Build our own libseccomp in Travis

The libseccomp2 in Travis (or rather, in the default repositories that
we have) is too old to support conditional filtering, so we need to
supply our own in order to not get ""conditional filtering requires
libseccomp version >= 2.2.1"" errors from runc.

That version also appears to be happy to translate the syscall name
_llseek from a name to a number that it doesn't recognize, triggering
""unrecognized syscall"" errors.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #202
Approved by: rhatdan",19,6,0,1
"containers/buildah","81f2af5021dc1699a0c117225c22ae370d3caad3","nalind","2021-10-26 21:16:44","true","chroot: don't use the generate default seccomp filter for unit tests

When we link our test helper statically using the external linker, the
hardwired default seccomp filter we get from the runtime-tools generator
triggers a hang in it at startup.

Rather than switch to the internal linker, which seems to work around
this, start using the same seccomp filter for unit tests that we
actually use in real life, leaving analysis of which difference between
the two is responsible for it for another day.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",33,57,1,1
"containers/buildah","933eecf71d1a4f938379419f979ed993cdfb90be","nalind","2017-03-23 21:28:21","false","Merge pull request #30 from nalind/make-working-dir

Always make sure the working directory exists",12,2,0,1
"containers/buildah","9b59b480bf5f4044fd8ef5feb88e49a09b6321da","nalind","2021-05-04 20:34:28","false","imagebuildah: ignore signatures when tagging images

We re-tag images produced for Dockerfiles which contain no instructions
by ""copying"" them from their current names to their destination names,
letting the lower storage libraries deduplicate them into the same image
record.

When the source included signatures, this would break because
containers-storage can't guarantee that the compressed version of the
blob it will produce for a given layer will have the same digest that
the version referenced by the manifest had, so the image library would
refuse to ""copy"" them.

When the source and destination are the same, though, the
RemoveSignatures option doesn't cause the signatures to be deleted, but
it does bypass that check in the image library, so toggling it on works
around the problem.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",49,51,0,1
"containers/buildah","ae27963cb02ddd713980e48031a2a0a6d7e24bb5","nalind","2018-06-08 14:52:52","false","Add(): learn to record hashes of what we add

Add a field to AddOrCopyOptions that can take an io.Writer, more often a
hash.Hash returned by digest.Digester's Hash() method, to calculate a
sum over what we add or copy.

Make the help output summarizing the arguments that ""buildah add"" and
""buildah copy"" accept more closely match their man pages.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #766
Approved by: rhatdan",32,16,0,1
"containers/buildah","7cc517bc2bc8b4a6aae7258ca418500468c5c655","lsm5","2023-08-22 12:55:53","true","Merge pull request #4984 from lsm5/main-spdx-license

[CI:BUILD] rpm: spdx compatible license field",9,79,1,1
"containers/buildah","a9bd02515653efa618352a5baa7a4ff43b1e8025","giuseppe","2019-03-27 16:48:51","false","mount: do not create automatically a namespace

otherwise we cannot catch early the error of mounting overlay without
a mount namespace.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1450
Approved by: TomSweeneyRedHat",42,26,0,1
"containers/buildah","87bd067fb09e38265cc92f69eb7c6aee9e77b439","openshift-merge-robot","2021-04-27 14:34:44","true","Merge pull request #3185 from cevich/update_ubuntu_2104

Cirrus: Update Ubuntu images to 21.04",49,51,0,1
"containers/buildah","0ab8d8cc3ce95dce9a5edb0a4b8cb395af33b12b","openshift-merge-robot","2020-11-09 20:16:25","true","Merge pull request #2765 from containers/dependabot/go_modules/github.com/containers/storage-1.23.9

build(deps): bump github.com/containers/storage from 1.23.8 to 1.23.9",66,45,0,1
"containers/buildah","bb149ea686692011311b80961e14bb8062f4d867","nalind","2022-07-26 19:27:30","false","Use errors.Is() instead of os.Is{Not,}Exist

If errors for which os.IsExist() or os.IsNotExist() would have returned
true have been wrapped using fmt.Errorf()'s ""%w"" verb, os.IsExist() and
os.IsNotExist(), not having been retrofitted to use errors.Is(), will
return false.

Use errors.Is() to check if an error is an os.ErrExist or os.ErrNotExist
error instead of calling os.IsExist() or os.IsNotExist().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",19,66,1,1
"containers/buildah","a2ccec8c43154f24155b4fe979a63c641033ab27","nalind","2017-03-16 14:43:50","false","Catch up to the projectatomic move

Catch up import paths and docs to build correctly now that we're in
projectatomic.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,2,0,1
"containers/buildah","12e582ee1a075ae040d6d9ce8fcdfc70c2f88977","nalind","2017-05-09 15:56:44","false","Report pull/commit progress by default

Have 'from', 'commit', and 'build-using-dockerfile' report progress via
stderr (so that capturing output from 'from' and 'commit' still works as
expected) unless --quiet is used to suppress the reporting.

Closes #94.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #98
Approved by: rhatdan",12,3,0,1
"containers/buildah","cc368cd4ecc2cd365130f6d3800b8fd11e97b7a1","nalind","2019-04-30 18:40:54","false","imagebuildah: don't remove intermediate images if we need them

In multistage builds without caching, if an intermediate stage's image
ended up being the final image (i.e., when the last instruction in the
Dockerfile is a FROM instruction that references a previous stage), we
would remove it when we finished building.  Fix that by modifying the
cleanup logic to compare the ID of an image that it's about to delete to
the final image's ID, if it has one, and skipping it if they match.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1564
Approved by: vrothberg",53,27,0,1
"containers/buildah","fc341c53826f5bf43227cdf889c0423fe65b1b3c","giuseppe","2018-06-25 08:56:52","false","buildah: set the HTTP User-Agent

Closes: https://github.com/projectatomic/buildah/issues/573

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #814
Approved by: rhatdan",30,17,0,1
"containers/buildah","988ed1ea9221a8e20cd36f7b5b71bd911f432e7f","openshift-merge-robot","2023-08-28 09:57:40","true","Merge pull request #5002 from cevich/maybe_fix_discussion_lock

[skip-ci] GHA: Attempt to fix discussion_lock workflow",8,79,1,1
"containers/buildah","5a83012c9397a90c3f0f530813793dd8f9c3d619","cevich","2023-05-31 14:34:18","true","Explicitly ref. quay images for CI

Commit beae5647c075 updated the conformance test references to a
deprecated repository.  However, by pointing at the docker-hub it
inadvertantly introduce a significant possibility for flakes.  This is
because anonymous docker hub access is rate-limited by IP.  We cannot
predict the IP used for CI VMs & Containers, any of which could be at or
close to the limit.  Fix this by pointing explicitly at a
`quay.io/libpod/centos` repo. which is excluesively for use by CI, with
static images.

Signed-off-by: Chris Evich <cevich@redhat.com>",16,76,1,1
"containers/buildah","1052f3ba40cde464447f7dcf1e907357ec7a528d","TomSweeneyRedHat","2018-01-17 17:34:09","false","Create Buildah issue template

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #397
Approved by: rhatdan",30,12,0,1
"containers/buildah","d9b3a185cae463619eb739dd3fea8417fc2041e3","vrothberg","2022-02-22 13:24:48","false","use c/image/pkg/blobcache

Buildah's pkg/blobcache has been moved into containers/image [1] to
consolidate implementations of interfaces such as image destinations
and image sources.

Since there are no functional changes: [NO NEW TESTS NEEDED]

[1] https://github.com/containers/image/pull/1459

Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",30,61,1,1
"containers/buildah","ef74c607cd4ff79c013c976b333c9394168b0030","vrothberg","2019-06-17 12:08:54","false","testreport: fix golangci-lint errors

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",42,29,0,1
"containers/buildah","0832ea2f355d7fe592ee068a5c5d43aa98ce6827","dfr","2022-06-18 13:27:50","false","Move runSetupRunMounts to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","4dec2534623edcbb34efeccab1d4bc3b85bd8435","rhatdan","2023-01-15 12:21:47","false","vendor in latests containers/(storage, common, image, ocicyrpt)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",21,71,1,1
"containers/buildah","984b28c2719181f9557fc9627832ee28199f096b","rhatdan","2022-11-03 18:20:01","true","Merge pull request #4388 from giuseppe/fix-mount-secrets

chroot: fix mounting of ro bind mounts",25,69,1,1
"containers/buildah","f232da006d7fbfe028a6a90d5cab9d4181cd1753","jlosito","2022-10-12 16:30:02","true","Fix ident for dependabot gha block

Signed-off-by: John Losito <lositojohnj@gmail.com>",27,68,1,0
"containers/buildah","3c5f98862782ba209ea020e6ec36b2306526b2b7","rhatdan","2022-09-30 10:34:03","false","Update vendor containers/(common,image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",20,68,1,1
"containers/buildah","a63958d18bb330d5af190b2684efff499576991c","rhatdan","2020-09-16 11:54:02","true","Merge pull request #2625 from cevich/fix_branch_validate

Validate: reference HEAD",91,44,0,1
"containers/buildah","c00b434cd2fc3326911ad3d45d06af0fddf2fb39","rhatdan","2020-07-07 14:00:43","false","Mask over the /sys/fs/selinux in mask branch

This is required so that the mount point shows up when buildah
is vendored into Podman.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",146,41,0,1
"containers/buildah","adbab2033614679a5687ae5799c82406802dc698","vrothberg","2020-07-16 08:47:37","false","vendor golang.org/x/text@v0.3.3

Fixes: CVE-2020-14040
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",147,42,0,1
"containers/buildah","9def9c06cbce0035429625756c9aa9a586cdba34","rhatdan","2020-01-13 15:57:47","true","Merge pull request #2071 from rhatdan/codespell

Add codespell support",101,35,0,1
"containers/buildah","aa1b3500233345f53c869bf47de6515567f0f204","rhatdan","2018-07-13 19:35:52","false","Vendor in lates containers/image

Should fix image handling of older format images

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #860
Approved by: pixdrift",31,18,0,1
"containers/buildah","3f84d99643ebf82851c70d770db4e33722085828","mtrmac","2019-02-21 22:45:30","false","Use reference.WithTag instead of manual string manipulation in Pull

Should not change behavior, except possibly failing early if the server
returns an invalid tag name.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","02f781b354cea78d205951d2bf24cb6838261a57","vrothberg","2023-10-25 12:55:41","false","container.conf: support attributed string slices

All `[]string`s in containers.conf have now been migrated to attributed
string slices which require some adjustments in Buildah and Podman.

[NO NEW TESTS NEEDED]

Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",4,81,1,1
"containers/buildah","e8d11201a98cc0f6239f34c54dbb1844947fc62b","giuseppe","2023-05-16 18:07:22","true","chroot: lock thread before setPdeathsig

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",13,76,1,1
"containers/buildah","2e25b156f74dfaeb3a44dcad663db1c041a803ef","rhatdan","2023-04-01 18:53:08","false","buildah image should not enable fuse-overlayfs for rootful mode

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",12,74,1,1
"containers/buildah","46eea3158840b77fbcd1cbfbd7c115560902e2dc","cevich","2022-11-14 16:22:45","true","Replace io/ioutil calls with os calls

In golang 1.19, `io/ioutil` is fully deprecated preventing Buildah from
compiling.  Replace all calls with equivalent calls from the `os`
package.

Signed-off-by: Chris Evich <cevich@redhat.com>",22,69,1,1
"containers/buildah","b84a2f3f44d051d042763b6bfe6daf030007eef8","openshift-merge-robot","2022-09-30 12:38:59","true","Merge pull request #4302 from cevich/image_readme

[CI:DOCS] Add quay-description update reminder",20,68,1,1
"containers/buildah","36d95b0503960d2268f5aeacec9006de114b3bcf","cevich","2022-07-13 19:08:56","true","Cirrus: Ensure the build-push VM image is labeled

Recently the container image build jobs have been failing with the
cirrus error:

```
Failed to start: INVALID_ARGUMENT: Operation with name
""operation-1657739085511-5e3b475527b8f-779ec7ef-41f9804e"" failed with
status = HttpJsonStatusCode{statusCode=INVALID_ARGUMENT} and message =
BAD REQUEST
```

I was able to track this down to an obsolete
`build-push-c6193881921355776` image.  Fortunately I was able to
un-obsolete the VM image.  Update the time-stamping meta_task to include
this image to prevent this problem in the future.

Signed-off-by: Chris Evich <cevich@redhat.com>",23,66,1,1
"containers/buildah","81ac7f1bd33d7c2042d4c572223f85f4a2f13544","openshift-merge-robot","2022-05-16 12:25:15","true","Merge pull request #3992 from containers/dependabot/go_modules/tests/tools/github.com/golangci/golangci-lint-1.46.1

build(deps): bump github.com/golangci/golangci-lint from 1.46.0 to 1.46.1 in /tests/tools",27,64,1,1
"containers/buildah","bc5080ccdd742f7e24535ba2fc3fbf2acd3ba6b9","openshift-merge-robot","2022-03-23 11:50:40","true","Merge pull request #3835 from Luap99/timeout

network setup: increase timeout to 4 minutes",33,62,1,1
"containers/buildah","7fb3197ed18485e3a57e90a750c2f8da792b9b35","openshift-merge-robot","2022-02-16 15:59:41","true","Merge pull request #3775 from chmouel/increase-subuid-subgid

Increase subuid/subgid to 65536",27,61,1,1
"containers/buildah","5181b9cee76c51262c7e0ea174ddd4ab98790c2b","openshift-merge-robot","2021-06-18 23:27:20","true","Merge pull request #3320 from nalind/copier-xattrs

copier.Put(): set xattrs after ownership",36,53,1,1
"containers/buildah","1192500cf0504f6d46b24f060a869f036958574e","openshift-merge-robot","2021-06-02 10:16:59","true","Merge pull request #3267 from dcermak/add-rusage-logfile-flag

Add rusage-logfile flag to optionally send rusage to a file",38,52,1,1
"containers/buildah","903dc56408acfa10ac7c103cb8873113d7873add","openshift-merge-robot","2021-05-04 13:02:17","true","Merge pull request #3194 from vrothberg/libimage-updates

update to latest libimage",49,51,0,1
"containers/buildah","ef8adfdca2530e68afcf804c2a4f95c8bf49c04f","rhatdan","2020-12-16 10:54:34","true","Merge pull request #2852 from containers/dependabot/go_modules/github.com/onsi/gomega-1.10.4

build(deps): bump github.com/onsi/gomega from 1.10.3 to 1.10.4",80,47,0,1
"containers/buildah","dd26b137459cdd290dc097d1ab87368d69d00b12","openshift-merge-robot","2020-11-25 08:46:16","true","Merge pull request #2807 from rhatdan/ignore

Add --ignorefile flag to use alternate .dockerignore flags",77,46,0,1
"containers/buildah","7a1f8a78764650f5c7d75d50b6615a78c097bebd","cevich","2020-09-17 14:49:30","true","Cirrus: Skip git-validate on branches

Signed-off-by: Chris Evich <cevich@redhat.com>",92,44,0,1
"containers/buildah","d008132404e77c68a16e395886527846475ec134","rhatdan","2017-03-17 13:38:34","false","First pass at bash completions

Closes: #15
Approved by: rhatdan",11,2,0,1
"containers/buildah","b85a3894613f552f6a805cb8dc4ee5852156279c","rhatdan","2023-03-16 13:26:55","false","Vendor in latest containers/(storage, common, image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",14,74,1,1
"containers/buildah","ab8af4a2570792ac211b276f8bc1226fb513e553","QiWang19","2018-10-11 13:59:44","false","Sort CLI flags of buildah bud

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1087
Approved by: rhatdan",52,20,0,1
"containers/buildah","31f918378885d511a8d6f29ec4c0100521356889","ypu","2018-08-27 11:10:57","false","Add buildah bud conformance test

The conformance test for buildah bud is used to check the images
build with buildah against docker. Currently we have two types of
tests:
1. Image build output test for features that support with docker ce
only. Test steps:
    - Prepare Dockerfile
    - Build image with buildah
    - Check the command output
2. General tests. Test steps:
    - Prepare Dockerfile
    - Build image with buildah
    - Push buildah image to docker with podman
    - Check the image id is not changed
    - Build image with docker
    - Check key part of the build command output from buildah and
      docker is the same(optional)
    - Check image info by docker inspect. And compare the output
      from two images. The key items should be the same.
    - Check the files inside the image with container-diff. They
      should be the same.

The tests are written with ginkgo. And request docker, podman and
container-diff installed in the test env.

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #961
Approved by: rhatdan",31,19,0,0
"containers/buildah","8e58ba3cdb978f3e2ed8e2dd357ed60d3be39cd3","saschagrunert","2019-07-18 08:37:38","true","Add unconvert linter and apply fixes

Signed-off-by: Sascha Grunert <sgrunert@suse.com>",48,30,0,1
"containers/buildah","6b795be8bf4f4ffa9cae733893e71ff99341cc38","vrothberg","2019-06-17 12:17:24","false","conformance: bud test: use raw strings for regexes

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",42,29,0,1
"containers/buildah","a98b14df0d0c821c73bd36092e1595968c83f36c","vrothberg","2020-12-05 11:48:51","false","enable short-name aliasing

Short-name aliasing was introduced as an opt-in preview by enabling an
environment variable.  Now, as we're preparing for the Podman 3.0
release, we can enable short-name aliasing by default.  Opting out can
be done by configuring the `registries.conf` config file.

Please refer to the following blog post for more details:
https://www.redhat.com/sysadmin/container-image-short-names

**NOTE**

This *may* justify a major version bump of Buildah.  The default mode is
permissive, so scripts and builds will continue working as before.
However, `buildah pull` will now prompt users.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",79,46,0,1
"containers/buildah","457c75c352ae4a0fca9433c5f8553ee635028d6d","openshift-merge-robot","2021-02-15 11:41:57","true","Merge pull request #3001 from rhatdan/man

Improve messages about --cache-from not being supported",59,49,0,1
"containers/buildah","c66da52c4677b44779324423e0a86d5ff31ce60d","nalind","2019-02-19 20:24:21","false","Simplify checks for leftover args

Avoid trying to modify a slice of strings while iterating through it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1410
Approved by: rhatdan",59,25,0,1
"containers/buildah","1114a8106715793a46d1365bc46a63637de8fc1f","vrothberg","2019-05-29 16:13:42","false","images_test: ignore golangci-lint error

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1624
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","efb3d215962c60e51ccd1a9d3b429b82ac8215ba","vrothberg","2020-10-28 12:51:02","false","overlay.MountReadOnly: support RO overlay mounts

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",66,45,0,1
"containers/buildah","57db70c122792edf58cdef88bf69821f1c7e460b","vrothberg","2019-08-30 15:08:58","false","install.md: mention goproxy

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1829
Approved by: TomSweeneyRedHat",56,31,0,1
"containers/buildah","13c13313058ca12dd5f75db06c12f725a17e7ae4","umohnani8","2018-03-08 20:07:51","false","Vendor in latest containers/image

Adds feature to pull compressed docker-archive files

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #510
Approved by: rhatdan",20,13,0,1
"containers/buildah","5025ffa423676b98b4d70f82b536e744203f1324","TomSweeneyRedHat","2018-06-13 19:38:37","false","Add Multi From Demo

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #790
Approved by: rhatdan",34,17,0,1
"containers/buildah","909e859971fb47b782c6f4d7c87316bde3efdd3b","TomSweeneyRedHat","2018-08-02 23:48:44","false","bud should not search context directory for Dockerfile

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #905
Approved by: rhatdan",22,18,0,1
"containers/buildah","32accb9e30664ff2496645bfa8c86aad9073f5ae","TomSweeneyRedHat","2019-04-11 23:42:14","false","Add Dockerfiles for buildahimages

Add a Dockerfile for each buildah image that we will
be maintaining in quay.io/buildah.  They are stable,
git and testing.  The resulting image names will be
buldaimage, buildahimagegit, buildahimagetesting in
order.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1508
Approved by: vrothberg",59,27,0,1
"containers/buildah","166d4db5972e2ede8311f40a03d300f6ae066e92","rhatdan","2017-10-06 16:54:32","false","Fix validateOptions to match kpod

This patch will allow for the possibility of a valid ""-""
option value.  This is often used for taking from STDIN,
and should future proof us from this breaking if ever added.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",32,8,0,1
"containers/buildah","fdf8c37614ee2d292d2aeb7a6458d0e445ab6516","rhatdan","2023-07-26 17:13:04","true","Merge pull request #4939 from containers/renovate/github.com-onsi-gomega-1.x

fix(deps): update module github.com/onsi/gomega to v1.27.10",13,78,1,1
"containers/buildah","5da3c8cdb76d5f0ff95a47c2fd285e23f4f121bd","rhatdan","2019-07-19 07:35:05","true","Merge pull request #1728 from openSUSE/versions

Fix CNI version retrieval to not require network connection",49,30,0,1
"containers/buildah","ee790699d638b196cc4fe5b998ab2095fee4a605","rhatdan","2019-09-04 19:06:32","false","Set TMPDIR to /var/tmp by default

We have had some issues with users squashing large images or pulling large
content from github, that could trigger crashes based on the size of /tmp.

Docker had an issue with this back in 2016. https://github.com/golang/go/issues/14021

The discussion there was to change the default to /var/tmp.

This change will only effect systems that do not set the TMPDIR environment variable.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",59,31,0,1
"containers/buildah","704adece391a653ecc206512dc84cf0af290cf09","rhatdan","2018-06-28 18:15:51","false","Start using github.com/seccomp/containers-golang

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #833
Approved by: TomSweeneyRedHat",28,17,0,1
"containers/buildah","3b51b1092964758473c57e0cf8044bb19ba881cf","rhatdan","2017-03-29 12:14:59","false","Fix copy and paste error on container-image

Closes: #57
Approved by: rhatdan",14,2,0,1
"containers/buildah","bbfc0abc8b753cf85090bb3b386027dde9eac8df","rhatdan","2023-04-05 13:59:21","true","Merge pull request #4699 from rhatdan/contrib

[CI:DOCS] buildah image should not enable fuse-overlayfs for rootful mode",10,74,1,1
"containers/buildah","09d1c24e3dd4c5c3071a3088dc0d600d929ba8ec","rhatdan","2020-01-14 12:12:56","false","Add support for containers.conf

This is a rework of Qi Wang's patches.
Import package pkg/config from containers/common to read containers.conf
This patch allows users to specify default values stored in containers.conf
that will modify the behaviour of buildah tool.

Signed-off-by: Qi Wang <qiwan@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #2011
Approved by: TomSweeneyRedHat",100,35,0,1
"containers/buildah","e073df11aa75bd20a8e01cad1956e1fabc7c9895","rhatdan","2018-02-12 17:08:24","true","Merge pull request #473 from rhatdan/master

Bump version to 0.12",16,13,0,1
"containers/buildah","7eb4e5972dad47494860cebae2a9de82ea70ab15","saschagrunert","2019-07-18 08:42:09","true","Add goimports linter and apply fixes

Signed-off-by: Sascha Grunert <sgrunert@suse.com>",48,30,0,1
"containers/buildah","c0eed1c463426bf6a7d09523187cec1bcbf0795b","saschagrunert","2020-02-19 11:28:36","true","Improve remote manifest retrieval

Before this patch, it was not possible to retrieve a remote manifest
just by specifying the image name, like:

```
> buildah manifest inspect alpine
Invalid image name ""alpine"", expected colon-separated transport:reference
```

It was possible to get the manifest via:

```
> buildah manifest inspect docker://alpine
…
```

But after pulling the image into the local storage, this works not any
more:

```
> buildah pull alpine
e7d92cdc71feacf90708cb59182d0df1b911f8ae022d29e8e95d75ca6a99776a
> buildah manifest inspect docker://alpine
manifest from image … is of type
""application/vnd.docker.distribution.manifest.v2+json"", which
is not a list type
ERRO exit status 1
```

This means we now collect a list of possible local or remote manifests
and try to resolve them sequentially. This enables us to fallback to the
remote location if the locally fetched manifest is not an actual
manifest. It also enables us to see the remote manifest via:

```
> ./buildah manifest inspect alpine
{
    …
}
```

Signed-off-by: Sascha Grunert <sgrunert@suse.com>",97,37,0,1
"containers/buildah","e1c7a5df101d4248113d64245b51a19fa668683a","cevich","2022-10-06 17:59:23","false","Cirrus CI add flavor parameter

Updates from Chris Evich for CI build script support.

Signed-off-by: Andrew Meadows <andrew@befuddled.ca>",27,68,1,1
"containers/buildah","4a98b552d62c01752329059711b22f3a2b971225","pixdrift","2018-04-23 22:15:58","false","Revert update of entrypoint behaviour to match docker

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #614
Approved by: rhatdan",38,15,0,0
"containers/buildah","7244ef44fb1457e472ef4a57ad04444f2bbb42e3","anarcat","2017-12-11 16:20:47","false","add Debian stable install instructions

Note that the instructions may seem unusual to people used to
`apt-key`, but they conform to the [emerging standard](https://wiki.debian.org/DebianRepository/UseThirdParty) for
third-party repositories in Debian.

We use ostree from backports because it matches the version in the
Ubuntu Flatpak PPA. We also explicitly require golang 1.8, which gives
us a 1.8.1 runtime in stretch. We otherwise use the Project Atomic,
but that's only because of Skopeo and similar tools.

Signed-off-by: Antoine Beaupré <anarcat@debian.org>

Closes: #354
Approved by: rhatdan",32,10,0,0
"containers/buildah","36006c9ac9b42973bb667259b576caa6ee7393ac","nalind","2022-07-26 14:35:08","false","cmd/buildah.pullCmd: complain about DecryptConfig/EncryptConfig

Complain about errors from util.DecryptConfig() and util.EncryptConfig()
using the words ""decryption"" and ""encryption"" instead of ""decrypt"" and
""encryption"".

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",19,66,1,1
"containers/buildah","95ca6c1e1f5c5e8ed3f8f9b22efdad4b90f4bb63","anarcat","2017-12-11 16:22:17","false","run make install as sudo

Explicitly using `sudo` in the `make install` line makes it clear that
the rest of the commands can (and probably should) be ran as non-root.

Signed-off-by: Antoine Beaupré <anarcat@debian.org>

Closes: #354
Approved by: rhatdan",32,10,0,0
"containers/buildah","d03a894969b2f1bfa2409ff87334166174c47030","umohnani8","2018-02-05 21:03:12","false","Fix md2man issues

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #447
Approved by: rhatdan",34,12,0,1
"containers/buildah","3cebe4f2c4de252e707ccaffbc93e30201b05ea5","giuseppe","2018-11-07 11:54:05","false","run: bind mount /etc/hosts and /etc/resolv.conf if not in a volume

change the logic for bind mounting /etc/hosts and /etc/resolv.conf in
the container.  Now they are not bind mounted when they are specified
as volumes, so it is still possible to have them writeable in the
container.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1156
Approved by: rhatdan",61,21,0,1
"containers/buildah","0b7a7f80bbcc6960fc3a0ef47c3a6bbc7e6eac9b","nalind","2023-02-20 19:30:28","false","docs/tutorials/04: add defaults for Run()

In the tutorial, switch to calling `DefaultStoreOptionsAutoDetectUID()`
instead of `DefaultStoreOptions()`, which should figure things out
better.

In the tutorial, add an example of using Run(), where for API backward
compatibility reasons, we can't tell the difference between ""grant no
capabilties by default"" and ""grant the default set of capabilities by
default"".

The default isolation can be set automatically, so start doing that at
run-time, but have the tutorial look it up anyway because the tutorial
on the web will be newer than our current release for at least a while.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",13,73,1,1
"containers/buildah","691451c269a8cb4d7499ab9a22874ae5b5623315","nalind","2018-05-18 18:16:12","false","bud.bats: print ""$output"" before checking its contents

Output the output of a command that we ""run"" before checking it over, so
that if the check fails, we'll see what we actually got.  Also check the
exit status of a couple of 'images -q' runs that we weren't.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #708
Approved by: rhatdan",63,16,0,1
"containers/buildah","165f985fc39bfe87704688da7ca5092776a916a2","nalind","2017-02-13 16:45:13","false","Update vendored deps to match other vendored deps

Get vendored deps to play with a newer version of the runtime spec.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","4bca99369953758728671c26b188faee14f7d092","nalind","2017-02-06 19:40:32","false","Start building a list of commands to add in README

Add a few sample commands to the list that we might add that we have in
the README.  A build command would probably want to have
openshift/imagebuilder handle the file parsing, with us providing an
Executor for one of its Builder objects.  A run command would use runc,
or another OCI-compatible runtime, or maybe bubblewrap.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,0,0,1
"containers/buildah","09b787a0a3bd32d88c5bd27372cffdd1d0ad8ad1","nalind","2020-09-30 14:13:02","false","CI: re-enable several linters

When we carried over the linting configuration from podman, we carried
over the list of checkers that were disabled for podman's sake, even
ones that don't complain about the code in this repository.

Make trivial changes to make gosimple happy.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",88,44,0,1
"containers/buildah","48f1c51acb9f4c36364d2e8baeef0c109730a4ce","nalind","2019-04-02 21:50:36","false","imagebuildah: deduplicate prepended ""FROM"" instructions

We currently prepend a ""FROM"" instruction to the full set of
instructions for any images which are referenced in ""COPY --from""
instructions that we don't create during the build.  Make sure that the
list doesn't include any duplicates.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1474
Approved by: vrothberg",50,26,0,1
"containers/buildah","ad4f235fdf4af2b669e7bc2dfcdbfa58d966294d","nalind","2019-06-05 21:49:20","false","imagebuildah: simplify screening by top layers

We only care about the most recent top layer when we're checking if a
candidate image might be based on the one that's the base for the
current working container, so don't bother tracking more than that.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1646
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","0a064b38c786c559734887f96da599e34672b208","openshift-merge-robot","2021-02-15 16:12:29","true","Merge pull request #2997 from rhatdan/config

Add more support for removing config",59,49,0,1
"containers/buildah","013883e3cbe91d6b0568787d6ffd0d75eef4bf47","openshift-merge-robot","2021-02-15 18:17:28","true","Merge pull request #3005 from containers/dependabot/go_modules/github.com/spf13/cobra-1.1.3

build(deps): bump github.com/spf13/cobra from 1.1.1 to 1.1.3",59,49,0,1
"containers/buildah","9332113a9f7c3d11f0f24001b3f419cac894af42","openshift-merge-robot","2022-04-28 10:37:14","true","Merge pull request #3935 from nalind/copier-113

copier.unwrapError(): update for Go 1.16",25,63,1,1
"containers/buildah","d7d78048222a7f38792fff83e0918ab81d399e0f","openshift-merge-robot","2022-07-26 00:58:16","true","Merge pull request #4118 from flouthoc/support-remote-cache

build,cache: support remote cache sources ( via `--cache-to`, `--cache-from` ) and introduce `cacheKey/layerKey`",21,66,1,1
"containers/buildah","ea81614af3c129fffe1f632b962556d5864bea0f","Luap99","2022-09-19 20:11:56","true","pkg/cli: improve completion test

When we have a bool flag there is zero reason to define a completion
function since this flag takes no argument and the cobra lib will thus
not use it.

Podman checks that already and recently buildah caused the test to fail. [1]
To make sure this does not happen again we should have the same check here.

[1] https://github.com/containers/podman/pull/13808#issuecomment-1250318199

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",19,68,1,0
"containers/buildah","175f8a397d6dc16a3e5ceaeb1aa3523958093ce7","dilyanpalauzov","2021-09-24 17:45:40","false","Makefile: adjust -ldflags/-gcflags/-gccgoflags depending on the go implementation

Insisting on “DCO” imposes formalities, that serve self-purpose.  One cannot
assume that the submitter has time or will to read texts about symbolism in
software contributions.  If the system wants to see the text

  nrEAUIEUAIe eanuitdnuae EAIUEAUIAIE »ℓ§444.3.72b)°»°ℓ§euaieauuae

in each commit, people will write this, or any other text, that the system wants to
see.  All such text, which presence is mandated by the system, has the same value.

[NO TESTS NEEDED]

Signed-off-by: Дилян Палаузов <git-dpa@aegee.org>",40,56,1,0
"containers/buildah","417c60189f544fa3beae30f4db3aced8a4b5b960","dfr","2022-06-15 12:51:32","false","Tidy up - runMakeStdioPipe can't be shared with linux

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","e94b4f98048e7371685731b97eefd6265e2f1fb3","TomSweeneyRedHat","2018-11-21 16:10:09","false","Bump to v1.5

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1190
Approved by: TomSweeneyRedHat",64,22,0,1
"containers/buildah","b2e4f587b11852b5da267b72a9cffae302b79490","TomSweeneyRedHat","2018-06-06 13:37:31","false","Change freenode chan to buildah

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #755
Approved by: rhatdan",37,16,0,1
"containers/buildah","6fc2b10ddfbe4aff79a142dd08593f5373b8365b","openshift-merge-robot","2022-05-16 17:23:44","true","Merge pull request #3994 from rhatdan/cpp

Add --cpp-flag flag to buildah build",26,64,1,1
"containers/buildah","9f8b2a477c948906bb66d3836439f2bfff52ed51","openshift-merge-robot","2022-09-21 05:54:39","true","Merge pull request #4283 from edsantiago/destutter

Fix broken dns test (from merge collision)",21,68,1,1
"containers/buildah","8199cfe42dd50a5f00be5201ed61a3312ae57a6d","rhatdan","2020-07-13 21:12:51","true","Merge pull request #2460 from containers/dependabot/go_modules/github.com/containers/ocicrypt-1.0.3

Bump github.com/containers/ocicrypt from 1.0.2 to 1.0.3",147,42,0,1
"containers/buildah","6841e6cd240f018365723940918c06a85505dc83","nalind","2020-06-25 02:12:07","false","Make imagebuildah.BuildOptions.Architecture/OS optional

Make the Architecture and OS fields in imagebuildah.BuildOptions
optional again.  When API callers didn't set it, we were overwriting
values supplied by the base image with empty values.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",143,41,0,1
"containers/buildah","2054b5df8dcabf74654f89331ce9058b36ed740b","lumjjb","2020-05-19 19:12:29","false","Ammended docs

Signed-off-by: Brandon Lum <lumjjb@gmail.com>",135,40,0,0
"containers/buildah","c1e8a9143af4b2dc1a21dffb9f6d5c55f9f1f168","lumjjb","2020-04-13 20:22:02","false","Update gitignore to exclude test Dockerfiles

Signed-off-by: Brandon Lum <lumjjb@gmail.com>",121,39,0,0
"containers/buildah","2fe61f5bd140dca6f27ee688d0126885d7176e8c","vrothberg","2019-10-01 11:23:40","true","Merge pull request #1881 from containers/dependabot/go_modules/github.com/stretchr/testify-1.4.0

Bump github.com/stretchr/testify from 1.3.0 to 1.4.0",66,32,0,1
"containers/buildah","6e001830ea36bf66a8768568e2e4a1c1de8d8666","rhatdan","2018-11-20 15:53:35","false","Assume user 0 group 0, if /etc/passwd file in container.

While attempting to run buildah in a container without an /etc/passwd, it is
blowing up.  This change will cause buildah to assume that it is running as
root.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1187
Approved by: umohnani8",65,22,0,1
"containers/buildah","25c454a602365f1d09a8c8502826c80c69f50882","ypu","2018-08-28 14:23:26","false","Update the MakeOptions to accept all command options for buildah

The previous version of code only can accept command options for
buildah bud from env. Update this to make it possible to set
command options from env by export BUILDAH_$CMD_OPTIONS.

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #965
Approved by: rhatdan",30,19,0,0
"containers/buildah","617e10b753b619591f1a80f604b39a07b9134359","nalind","2019-02-19 15:59:39","false","bud.bats: log output before counting length

Before checking the length of output, note the output value in the log,
to make troubleshootting easier.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1408
Approved by: rhatdan",59,25,0,1
"containers/buildah","0bb4f3112cc114a99edc618cafae5e94df908432","nalind","2019-08-13 04:23:28","false","pull/commit/push: pay attention to $BUILD_REGISTRY_SOURCES

If $BUILD_REGISTRY_SOURCES is set, expect it to be a valid
github.com/openshift/api/config/v1.Image, and parse its
AllowedRegistries and BlockedRegistries lists when, pulling, committing,
or pushing images.

Override the local signature policy when committing or pushing an image
to ensure that local storage is always allowed.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1787
Approved by: rhatdan",52,30,0,1
"containers/buildah","e0306bb4889744192f8161d237150b1a5ad24a2c","nalind","2019-06-03 20:39:54","false","imagebuildah: apply additionalTags ourselves

When there are additional tags to apply to the final image, and that
image is found in the cache, we don't call Commit() to create it, so
Commit() can't add the names to the image, so we need to do it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1639
Approved by: TomSweeneyRedHat",59,28,0,1
"containers/buildah","e89fac6c9bf8d0b1071769439ab69a65bffbc72a","nalind","2023-07-17 20:27:19","false","Add `buildah mkcw`, add `--cw` to `buildah commit` and `buildah build`

Add a --cw option to `buildah build` and `buildah commit`, which takes a
comma-separated list of arguments and produces an image laid out for use
as a confidential workload:
  type: sev or snp
  attestation_url: location of a key broker server
  cpus: expected number of virtual CPUs to run with
  memory: expected megabytes of memory to run with
  workload_id: a distinguishing identifier for the key broker server
  ignore_attestation_errors: ignore errors registering the workload
  passphrase: for encrypting the disk image
  slop: extra space to allocate for the disk image

At least one of attestation_url and passphrase must be specified in
order for the encrypted disk image to be decryptable at run-time.  Other
arguments can be omitted.  ignore_attestation_errors is intentionally
undocumented, as it's mainly used to permit some amount of testing on
systems which don't have the required hardware.

Add an `mkcw` top-level command, for converting directly from an image
to a confidential workload.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,78,1,1
"containers/buildah","70641ee2f04fd115d86906cf7f588fcdc545b049","nalind","2018-06-01 18:54:45","false","run.bats: check that we can run with symlinks in the bundle path

Make sure that we don't trigger error messages in runc when $TMPDIR,
which affects os.TempDir(), is itself a symbolic link.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #746
Approved by: rhatdan",38,16,0,1
"containers/buildah","dc5df0322dbb91794588d001dc5ec95e45ceceec","nalind","2019-02-20 14:14:43","false","imagebuildah: drop the duplicate containerIDs list

StageExecutors keep their own lists of the IDs of containers that they
create, so we don't need to merge them into a single list in the
Executor that we'll consult during clean up.  As long as we make sure we
only ever try to delete a given stage's containers once, we can just use
their lists directly, and avoid duplicating the information.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1428
Approved by: vrothberg",60,25,0,1
"containers/buildah","b9a1041b1823b556b0fd9c14928055726cc473e5","TomSweeneyRedHat","2018-05-11 17:28:40","false","Update to F28 and new run format in baseline test

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #678
Approved by: rhatdan",56,15,0,1
"containers/buildah","514a3f1a914c73bc7f13d164a3ce0c4a30a8db75","rhatdan","2021-03-01 18:07:58","false","Shrink the vendoring size of pkc/cli

This PR removes the pkg/auth which brings in docker/docker
since it really is not needed, and was only there to help users
discover the settings of where the authfile was, when the environment
variables were set.  Would almost never be of any value.

Move imagebuildah.BuildOptions to define.BuildOptions

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",57,49,0,1
"containers/buildah","56f61d944ac8c20023039f81524b3df27d5826cb","rhatdan","2017-03-25 16:51:10","false","buildah delete should be able to delete multiple containers

Simple change to allow users to specify multiple containers to delete.
This would support cleaning up all containers

buildah delete $( buildah list -q)

Closes: #43
Approved by: rhatdan",14,2,0,1
"containers/buildah","966f32b2aca5f7fb247b07a6a8d8d877fc7dbb40","rhatdan","2017-10-19 21:47:15","false","Add proper SELinux labeling to buildah run

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #294
Approved by: nalind",30,9,0,1
"containers/buildah","791d04b24daaae765c91fef0b765105f88cd4b29","rhatdan","2018-07-14 10:12:26","false","Bump to v1.3-dev

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #862
Approved by: rhatdan",32,18,0,1
"containers/buildah","ccd3b3fedb868d9a6871e3ed8a0ac461cfaf658f","rhatdan","2017-12-09 02:49:49","true","Merge pull request #351 from ripcurld0/small_nitpick

Small nitpick at matches(Since,Before)Image in cmd/buildah/images",33,10,0,1
"containers/buildah","e02e27382084bd23c4fed530c4e34e585b5a868f","giuseppe","2022-01-20 09:52:27","true","linux: fix lookup for runtime

lookup the full runtime path instead of using its name.

Closes: https://github.com/containers/buildah/issues/3721

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",34,60,1,1
"containers/buildah","f32f6662d9306fdb2ec84970c5b33165b2a2c26d","nalind","2017-05-18 15:38:38","false","Improve configuration preservation in imagebuildah

Preserve and pass in more container configuration settings when
initializing and imagebuildah object, and pull more settings back out
when committing an image.  This should fix most of #97.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #102
Approved by: rhatdan",15,4,0,1
"containers/buildah","ecf5b7215b25a5267664a997c96143ff4d8f277a","nalind","2019-08-19 18:15:03","false","tests/bud.bats: add --signature-policy to some tests

Add a --signature-policy flag to some build-using-dockerfile tests, so
that they'll pass in CI.  Check the error messages output for the cases
that we expect to fail to verify that they actually failed for the
intended reasons.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1787
Approved by: rhatdan",54,31,0,1
"containers/buildah","3659e8ea2deee6866327564c07aedf4e598d6226","nalind","2018-07-20 21:58:48","false","tests/run.bats(volumes): use :z when SELinux is enabled

When testing volumes as part of checking that ""run"" is working
correctly, use the "":z"" flag if we detect SELinux support to avoid false
negatives.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #876
Approved by: nalind",33,18,0,1
"containers/buildah","f4322d8792561d7a4778fa2a5798ca88998cf451","nalind","2019-05-29 21:46:33","false","bud.bats: add another .dockerignore test

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1626
Approved by: TomSweeneyRedHat",57,28,0,1
"containers/buildah","03186a33071a56d127617e50a54cd6e7cae534db","chenk008","2021-10-11 03:26:35","false","Support overlayfs path contains colon

In linux, directory can contains colon.
Add support to mount path contains colon.

buildah run --volume /root/a\\:b:/root/test:O

Signed-off-by: chenk008 <kongchen28@gmail.com>",40,56,1,0
"containers/buildah","37d3ab9dca553d2c12bdefb05a9914c7be8b137e","nalind","2017-03-24 16:46:19","false","Merge pull request #26 from rhatdan/link

Remove link from CLI",14,2,0,1
"containers/buildah","0de0d23df4b470619054dc7e01734be02a151169","nalind","2017-08-18 16:51:03","false","Run: don't complain about missing volume locations

Don't worry about not being able to populate temporary volumes using the
contents of the location in the image where they're expected to be
mounted if we fail to do so because that location doesn't exist.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #248
Approved by: rhatdan",28,7,0,1
"containers/buildah","18494668272410cdfd789716e3765583e0c22c36","umohnani8","2018-01-30 17:08:18","false","Fix --runtime-flag for buildah run and bud

The --runtime-flag flag for buildah run and bud would fail
whenever the global flags of the runtime were passed to it.
Changed it to accept the format [global-flag]=[value] where
global-flag would be converted to --[global-flag] in the code.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #431
Approved by: rhatdan",42,12,0,1
"containers/buildah","6db6cf7785be28fceb55594f86ffb1f5c41da954","ashley-cui","2021-01-13 18:10:55","false","Vendor in common 0.33.1

As per title

Signed-off-by: Ashley Cui <acui@redhat.com>",94,47,0,0
"containers/buildah","6adbfeeb4fc2cca89c6b71f393706c4def61d129","flouthoc","2023-06-05 07:01:57","true","GetTmpDir: honor image_copy_tmp_dir from containers.conf

https://github.com/containers/common/blob/main/docs/containers.conf.5.md
contains a field `image_copy_tmp_dir` so `GetTmpDir` must honor that in
case `ENV: TMPDIR` is not found.

Closes: https://github.com/containers/buildah/issues/4787

Signed-off-by: Aditya R <arajan@redhat.com>",17,76,1,1
"containers/buildah","2dee122f2aabc8374382649ceaba1f7363edd408","hswong3i","2021-06-17 06:47:18","true","Update nix pin with `make nixpkgs`

Signed-off-by: Wong Hoi Sing Edison <hswong3i@pantarei-design.com>",39,53,1,0
"containers/buildah","3b0ae62e38a3c6626b9452d331e09836b3857056","rhatdan","2022-06-07 13:21:31","true","Merge pull request #4041 from containers/dependabot/go_modules/github.com/docker/docker-20.10.17incompatible

build(deps): bump github.com/docker/docker from 20.10.16+incompatible to 20.10.17+incompatible",22,64,1,1
"containers/buildah","a10326ec14f0ad64b9867db82e4a3e0d7c4019e2","rhatdan","2022-06-07 13:20:58","true","Merge pull request #4037 from lsm5/include-ubuntu-deps-in-tutorial

[CI:DOCS] Tutorial 04 - Include Debian/Ubuntu deps",22,64,1,1
"containers/buildah","d2927cdd4769a048548d9dd18259644ea19ffb49","giuseppe","2022-03-25 10:32:53","true","install: drop RHEL/CentOS 7 doc

the packages there are too outdated to build properly latest versions
of buildah, e.g. a different go toolchain must be installed manually
as well as gpgme-devel.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",29,62,1,1
"containers/buildah","bbbe10ae89dbcf7c2f689c1df03544b997437172","rhatdan","2021-06-02 19:30:24","true","Merge pull request #3277 from rhatdan/master

Move to v1.22.0-dev",36,52,1,1
"containers/buildah","d1381b4b28af549651a750fdfb99cc2173b809d7","edsantiago","2021-04-12 16:22:36","false","bats helpers.bash - minor refactoring

Almost trivial, but this will greatly simplify my podman-remote
testing of buildah-bats.

Signed-off-by: Ed Santiago <santiago@redhat.com>",52,51,0,1
"containers/buildah","7989518c8fc9cf341147095b581e7c9a2ab4db54","openshift-merge-robot","2021-03-04 00:42:21","true","Merge pull request #3056 from tetchel/smallerUserns

fix: Containerfiles - smaller set of userns u/gids",57,49,0,1
"containers/buildah","d675f49844aec548e4ea3ab2b1f50bf0e0f4e0cc","openshift-merge-robot","2020-11-02 11:51:09","true","Merge pull request #2739 from saschagrunert/osusergo

Use osusergo build tag for static build",67,45,0,1
"containers/buildah","2ba6875237acba651389ef2b7ee75948b66ccaf1","lsm5","2020-09-03 14:51:18","false","fix build on 32bit arches

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",82,43,0,1
"containers/buildah","ad7cfc3e9b39d8e1c8d00dbb0fd062bef5a43dd3","nalind","2020-08-28 16:58:41","false","Heed our retry delay option values when retrying commit/pull/push

Pass our own API values for retry delays to common's retry package when
we use it to handle retrying image pull/commit/push operations.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",83,43,0,1
"containers/buildah","8ef7f25151e1053e1b6ac1071a0c0efc58b970a3","yangfeiyu20102011","2020-04-06 10:43:57","false","Do not skip the directory when the ignore pattern matches

Signed-off-by: yangfeiyu <yangfeiyu20102011@163.com>",116,38,0,0
"containers/buildah","46b36035fea347220b175c913a934664be169676","rhatdan","2020-03-03 15:25:11","false","Bump to containers/storage v1.16.1

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",100,37,0,1
"containers/buildah","39bd7e0a7a73edd68e8346ab2718eb1e82f000be","rhatdan","2020-02-25 11:35:33","true","Merge pull request #2184 from rhatdan/vendor

Replace unix with syscall to allow vendoring into libpod",99,37,0,1
"containers/buildah","043fd2e3005890186b304e03f6b8ffdf9f55a5b7","TomSweeneyRedHat","2018-06-01 23:33:32","false","Add registry errors for pull

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",38,16,0,1
"containers/buildah","a96820bbb7c54b12b1fbf5b39b8d4a06c5811734","rhatdan","2018-05-20 00:03:04","true","Merge pull request #701 from rhatdan/hosts

Handle /etc/hosts and /etc/resolv.conf properly in container",63,16,0,1
"containers/buildah","6135c2a947b00992f837a2358198042d2f288742","nalind","2017-03-20 20:11:30","false","Note that ""scratch"" is an accepted image name

Note that ""scratch"" is an option in the usage text for ""from""'s --image
flag.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","f6138ccdde4824542aff296feacf75f3888da48c","openshift-merge-robot","2020-11-02 11:44:14","true","Merge pull request #2737 from containers/dependabot/go_modules/github.com/containers/common-0.26.3

build(deps): bump github.com/containers/common from 0.26.2 to 0.26.3",67,45,0,1
"containers/buildah","5cd4cfad76881ffa01aeeb753421b62c210570c1","openshift-merge-robot","2021-06-10 20:46:17","true","Merge pull request #3287 from containers/dependabot/go_modules/github.com/mattn/go-shellwords-1.0.12

build(deps): bump github.com/mattn/go-shellwords from 1.0.11 to 1.0.12",34,52,1,1
"containers/buildah","385901360df74e2c86d33300530d29f389f91acb","flouthoc","2022-05-04 04:46:07","true","imagebuildah,build: move deepcopy of args before we spawn goroutine

To prevent concurrent read/write between maps perform deep copy of args
before we spawn a goroutine.

[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",24,63,1,1
"containers/buildah","82eedac4682771794a33c53368715c66a4b68239","flouthoc","2021-08-27 07:31:51","false","tag: Support tagging manifest list instead of resolving to images

Following commit makes sure when `buildah tag` is invoked on a manifest
list, it tags the same manifest list instead of resolving image and
tagiing it.

Signed-off-by: Aditya Rajan <flouthoc.git@gmail.com>",37,55,1,1
"containers/buildah","fcd41ce086a75078dc7c35922d1e5d69e03b5db6","flouthoc","2022-04-05 17:28:15","true","tests: reduce concurrency for flaky bud-multiple-platform-no-run

We have a recorded bug here https://github.com/containers/buildah/issues/3710
but complexity of this bug fix is looking high as of now with fixes
going into multiple components.

See dicsussion here: https://github.com/containers/buildah/issues/3710

Reducing jobs for this test will ensure that we process things in serial
order so instead of skipping this test we can still run it in a serial
manner and with no flakes

Signed-off-by: Aditya R <arajan@redhat.com>",25,62,1,1
"containers/buildah","968b21d17d13153e845d9c8bf27a57e5845e71fd","giuseppe","2019-02-06 12:53:46","false","buildah: force umask 022

an umask more restrictive can break some images.

Closes: https://github.com/containers/buildah/issues/1305

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1325
Approved by: rhatdan",56,24,0,1
"containers/buildah","eb38649a259ee0d3d98276b15aeda3df694fd066","nalind","2022-04-26 22:02:35","false","copier.unwrapError(): update for Go 1.16

Since we started calling into the standard library's io/fs package
directly, we effectively made Go 1.16 our minimum Go version, so we
don't need to keep the workaround for compiling with Go 1.12.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",25,63,1,1
"containers/buildah","abc57f8df2c39b9e782ac751cab555f416248d20","nalind","2023-09-14 17:18:17","false","Bump to v1.33.0-dev

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",5,80,1,1
"containers/buildah","77a9d4ef06ba6409414ba49a699dde3b55acfea1","nalind","2021-03-02 21:06:27","false","copier: add an Eval function

Add copier.Eval(), for expanding paths using symbolic links in a
chrooted scope, without failing if a path component doesn't exist.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",59,49,0,1
"containers/buildah","bc38a745409edf68cd5051a7ac086c1a13e19e1d","nalind","2019-02-02 17:48:25","false","Add an undocumented dumpbolt command

Add an undocumented dumpbolt command that will dump the keys and values
from a bolt database, because I find myself having to dump one from time
to time when troubleshooting.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1320
Approved by: TomSweeneyRedHat",57,24,0,1
"containers/buildah","801391a7a2346f39cf8ae01fff872718bdedc1b4","nalind","2019-05-08 19:59:27","false","imagebuildah: addHelper: handle symbolic links

When filtering copying/adding operations to comply with a .dockerignore
file, we should directly handle copying directories and symbolic links.
This update still returns an error when attempting to copy
non-directory, non-regular items.

Make DockerIgnoreHelper() private, since it's not being used by packages
that use us, and I expect it to be removed when this gets refactored.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1583
Approved by: rhatdan",55,27,0,1
"containers/buildah","7860497e33212ba1fa278212f61dd3f5e1dcf045","nalind","2018-04-27 18:09:32","false","Fix SELinux test errors when SELinux is enabled

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",51,15,0,1
"containers/buildah","9330f6b87e8663d06716b6e9b6782a6caf921cf3","nalind","2017-06-02 14:57:19","false","Mention needing runc at runtime in README.md

Closes #123.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #131
Approved by: nalind",12,4,0,1
"containers/buildah","c691d095397471545de1245b7c38bc5e86f8a7a0","nalind","2019-02-19 16:21:39","false","images: imageReposToMap() already adds <none>:<none>

The imageReposToMap() already adds <none>:<none> to its result if there
are no names attached to the image, so we don't need to do it again.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1406
Approved by: TomSweeneyRedHat",59,25,0,1
"containers/buildah","9333e5369d079f443cf67d2274e3bf8e3372520d","nalind","2017-07-21 18:13:55","false","Switch to running PAPR tests on Fedora 26

Run PAPR tests using Fedora 26 instead of Fedora 25.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #202
Approved by: rhatdan",19,6,0,1
"containers/buildah","e8371b76e0a795ebbaaab946a327468478fb1e24","openshift-merge-robot","2021-11-02 21:19:54","true","Merge pull request #3610 from flouthoc/always-use-generated-md2man

docs: Use guaranteed path for go-md2man",31,57,1,1
"containers/buildah","3408e25b4f3ade8c327caed15035bbad4e74ba15","openshift-merge-robot","2022-04-28 19:54:11","true","Merge pull request #3931 from cevich/f36_update

Cirrus: Update CI VMs to F36",26,63,1,1
"containers/buildah","516a727d9e5a3728dfa9fd8c1c47ee057e729f55","openshift-merge-robot","2021-08-30 12:21:09","true","Merge pull request #3483 from flouthoc/support-tagging-manifest-list

tag: Support tagging manifest list instead of resolving to images",35,55,1,1
"containers/buildah","26bd9a56f2fc545ed5de754d83cb558e98129baf","openshift-merge-robot","2023-08-22 18:32:27","true","Merge pull request #4990 from containers/renovate/github.com-containers-storage-1.x

fix(deps): update module github.com/containers/storage to v1.49.0",8,79,1,1
"containers/buildah","d5d782f3baa900d823ac66a69c4bad903c042897","openshift-merge-robot","2021-03-05 09:29:01","true","Merge pull request #3060 from nalind/copier-ignore-unreadable

copier: add GetOptions.IgnoreUnreadable",57,49,0,1
"containers/buildah","9a49348bebb3ba93285f3a4584fc3e32adab35a1","openshift-merge-robot","2021-09-23 10:12:26","true","Merge pull request #3532 from giuseppe/support-compression-format-level

push: support to specify the compression format",39,56,1,1
"containers/buildah","a237085fe0e9875d99752ad4601d2b1043f7058a","flouthoc","2022-11-01 05:41:28","true","executor: honor default ARG value while eval base name

While PR https://github.com/containers/buildah/pull/3947 added support
for evaluating `--build-args` in base image names for a builds but it
missed processing default value if any. So for scenarios where `ARG`
already has a default value in Containerfile via `ARG key=value` but
was not specified with `--build-arg key=value` the processing ignored
the default value. Following commit just adds support for that.

Makes below Containerfile functional without any external `--build-arg`
value from CLI

```Dockerfile
ARG my_env=a

FROM alpine as stage_a
RUN /bin/true

FROM stage_${my_env} as stage_b
RUN /bin/true
```

Closes: https://github.com/containers/buildah/issues/4312

Signed-off-by: Aditya R <arajan@redhat.com>",24,69,1,1
"containers/buildah","9fa582f3b1581a90907b897157d204e5fe3c15d5","adlermedrado","2019-06-09 22:17:03","false","Fix typo

Patch originally proposed by @adlermedrado but never signed.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1697
Approved by: ashley-cui",43,28,0,0
"containers/buildah","ad3211c2624c9213e3fc771b521c74e26edb85a7","ranjithrajaram","2023-09-29 13:24:07","false","Protocol can be specified with --port. Ex. --port 514/udp

Updating the buildah-config man page to include port/protocol with --port

Signed-off-by: Ranjith Rajaram <rrajaram@redhat.com>",7,80,1,0
"containers/buildah","d58d3a14bee00d923ded1105fbb04f97c6baca98","edsantiago","2023-05-17 15:30:30","false","Revert ""Proof of concept: nightly dependency treadmill""

No longer needed: this functionality is now done by renovatebot.

The nightly cron job has been deleted.

This reverts commit 899ecaaf74c5ef299ccc24bb6bb98eb9aee96ba0.

Signed-off-by: Ed Santiago <santiago@redhat.com>",14,76,1,1
"containers/buildah","6587442468ae7d3472f97ba47abcaa93667939b3","edsantiago","2021-04-29 12:20:32","false","pr-should-include-tests: try to make work in buildah

Looks like this script wasn't working in the buildah environment,
apparently because we're in a shallow git checkout without a
master branch? Let's see if we can use $GITVALIDATE_EPOCH
instead.

And, add a sanity check so we catch this if it happens again.

Signed-off-by: Ed Santiago <santiago@redhat.com>",50,51,0,1
"containers/buildah","ba128004cacdc3fb4b85246b8b1ce2017fe37098","boaz0","2018-01-21 00:15:33","false","Fix ""make validate"" warnings

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>

Closes: #405
Approved by: rhatdan",33,12,0,0
"containers/buildah","dc57eea023d2c1bdc6b8c8d08a5b1f64dc86900c","rhatdan","2020-12-11 01:56:17","false","Allow users to specify stdin into containers

Some commands within a Containerfile, might need input from users.
For example confirmation commands from Apt.

Adding a --stdin flag will allows users to interact with containers
while running inside of buildah bud.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",79,46,0,1
"containers/buildah","d0e1ad1a1a314d42c16ac18e592fead4d2362833","rhatdan","2018-01-27 08:34:51","true","Merge pull request #415 from TomSweeneyRedHat/dev/tsweeney/pwdprompt

Prompt for un/pwd if not supplied with --creds",37,12,0,1
"containers/buildah","fe9e93d97f4424a4fe77b70d2b00665137dfaf8c","boaz0","2018-09-03 10:24:47","false","nitpick: decrease cognitive complexity in buildah-bud

A small nitpick to cmd/buildah/bud.go.

from:

if cliArgs > 0 {
  ... // 5 LOC
} else {
  return error
}

to:

if cliArgs == 0 {
  return error
}
... // 5 LOC

The latter style makes the code flow better than with if-else.

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>

Closes: #983
Approved by: TomSweeneyRedHat",35,19,0,0
"containers/buildah","547afe50a094b35d7b107a98acd4548b684fe509","rhatdan","2017-03-24 19:42:18","false","Remove --destination flag from `buildah add|copy`

We need to match the syntax of Dockerfile, three forms

buildah copy $CID SOURCE
buildah copy $CID SOURCE DESTINATION
buildah copy $CID SOURCE SOURCE SOURCE DESTINATION

Closes: #40
Approved by: nalind",14,2,0,1
"containers/buildah","c9c5f546c671ce2eeda57f0bc869c8fd476dae31","rhatdan","2021-11-18 21:26:32","false","Fix UnsetEnv for buildah bud

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",28,58,1,1
"containers/buildah","46c58b291965b72abc10b15c6f0530665a65e47e","rhatdan","2018-08-23 16:10:17","false","Document BUILDAH_* environment variables in buildah bud --help output

We also want to show the default settings.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #956
Approved by: rhatdan",33,19,0,1
"containers/buildah","b03327d2a4237017e1e493ec2ad0f5b398488f67","kolyshkin","2022-01-18 02:37:08","false","all: fix gosimple warning S1039

AKA ""unnecessary use of fmt.Sprintf (gosimple)""

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",32,60,1,0
"containers/buildah","c806e6e06520631120ab8a58dbcdada102b0b48c","nalind","2018-05-21 21:02:50","false","Implement --squash for build-using-dockerfile and commit

Handle a Squash option when committing images, and make it available as
a flag for ""buildah commit"" and ""buildah build-using-dockerfile"".

Breaks up containerImageRef.NewImageSource to keep the complexity more
manageable.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #714
Approved by: rhatdan",62,16,0,1
"containers/buildah","a885bc6a7c57b99088045b4e73c70a4bb42e2db3","nalind","2018-07-06 15:50:30","false","image filter test: use kubernetes/pause as a ""since""

Use ""kubernetes/pause"", which is not expected to be updated regularly,
as a reference image for the ""since"" filter, instead of ""alpine"", which
is updated regularly, and which therefore can be newer than ""busybox"".

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #855
Approved by: nalind",31,17,0,1
"containers/buildah","406a8b9057b80cb3d8a10ccece3d331051b85a28","nalind","2017-04-20 14:53:47","false","Updated vendored deps

Re-vendor github.com/docker/docker and github.com/opencontainers/runc,
which we now use less of than we did previously.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",12,3,0,1
"containers/buildah","8eb7d6d610a738ab7cf14cb2f8e0ee36a7324b2c","nalind","2017-08-10 20:08:03","false","Run(): create the right working directory

When ensuring that the working directory exists before running a
command, make sure we create the location that we set in the
configuration file that we pass to runc.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #241
Approved by: rhatdan",25,6,0,1
"containers/buildah","7535471ff6950fbff24073ef91c6be89e697823a","carbonin","2020-03-24 01:08:23","false","Don't add args to the RUN environment from the Builder

The correct args are already contained in the RunOptions.
They were resolved by the imagebuilder library's Step
(https://github.com/openshift/imagebuilder/blob/edcddd8483043f9cdb18e8ee365e746637f12b11/builder.go#L311-L317)
function

This was previously adding args that should not have been accessible
in the current stage as they were not first referenced by an ARG
command

Signed-off-by: Nick Carboni <ncarboni@redhat.com>",112,38,0,0
"containers/buildah","0b3e75a23c60b971cecb8fe45375031289197940","cevich","2021-10-25 15:31:12","true","Cirrus: Bump up to Fedora 35 & Ubuntu 21.10

The Fedora 35 cloud images have switched to UEFI boot with a GPT
partition. Formerly, all Fedora images included support for runtime
re-partitioning. However, the requirement to test alternate storage
has since been dropped/removed.  Rather than maintain a disused
feature, and supporting scripts, these Fedora VM images have reverted
to the default: Automatically resize to 100% on boot.

Signed-off-by: Chris Evich <cevich@redhat.com>",34,57,1,1
"containers/buildah","8428dee36c4e3c027edb14e90b40fcb90714c723","michalbiesek","2023-08-15 02:32:26","true","make,cross: restore loong64

Ref: 50a4acb, 5d50a73

Signed-off-by: Michal Biesek <michalbiesek@gmail.com>",9,79,1,0
"containers/buildah","14cd28c262da85146d4fd4bd1465f3d8f0cdc8bd","Luap99","2023-06-15 10:27:28","true","add hostname to /etc/hosts when running with host network

Some tools depend on the hostname being present in /etc/hosts. I would
argue they are broken but its not like we can do anything about that.

This adds the hostname with the local host ip when the host network is
used. For private networking we already add the hostname.

We also now correctly force host networking in chroot mode, it was
silently ignored before thus causing extra confusion here.

Fixes #4446

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",13,77,1,0
"containers/buildah","a80bd8037aacdde458d55f0f7b7bb6e79409a752","rhatdan","2022-11-04 13:34:46","true","Merge pull request #4401 from flouthoc/all-platform-eval-base

imagebuildah: build with `--all-platforms` must honor `userargs` and `headingargs` while evaluating base images",23,69,1,1
"containers/buildah","ecae0e2fe6479d5503a96290468f2715dddc02e6","cevich","2022-06-16 18:24:09","true","Fix building upstream buildah image

Previously, `;` were separating several `RUN` commands.  This is
dangerous, as failure in one won't result in a build failure.  This was
happening due to the `runc` package having a required dependency on
`contaqiner-selinux` which was excluded.  Fix this by using `&&` and
switching to the crun package.

Signed-off-by: Chris Evich <cevich@redhat.com>",23,65,1,1
"containers/buildah","6fc3b062fd48b0912fc131a19285734268a0198f","openshift-merge-robot","2022-03-25 10:58:11","true","Merge pull request #3844 from containers/dependabot/go_modules/github.com/containers/common-0.47.5

build(deps): bump github.com/containers/common from 0.47.4 to 0.47.5",29,62,1,1
"containers/buildah","f434b7282052c71fc3a7af04ec83d8a35305ef0d","openshift-merge-robot","2022-03-19 11:16:40","true","Merge pull request #3825 from vrothberg/fix-3822

buildah image: install cpp",33,62,1,1
"containers/buildah","300d9d1de17c1db971bf7319b0dcf263a3232800","rhatdan","2021-12-01 19:08:25","false","Allow rootless buildah to set resource limits on cgroup V2

First move podman/pkg/cgroups into Buildah.
Only set resources to nil on non cgroupsv2 systems in rootless mode.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",30,58,1,1
"containers/buildah","e271555a12b403bdf2dbffd0d8c46cbfa17a7419","jmguzik","2021-02-24 07:39:17","false","bump github.com/openshift/imagebuilder from 1.1.8 to 1.2.0

Signed-off-by: Jakub Guzik <jakubmguzik@gmail.com>",62,49,0,0
"containers/buildah","ecb444fc98a95178cb3758140edb88090657964b","openshift-merge-robot","2021-06-18 11:04:11","true","Merge pull request #3314 from containers/dependabot/go_modules/github.com/containers/common-0.40.0

build(deps): bump github.com/containers/common from 0.39.0 to 0.40.0",40,53,1,1
"containers/buildah","72ee974e46338398fd8c418210e998461481d019","openshift-merge-robot","2021-05-01 17:58:31","true","Merge pull request #3193 from rhatdan/auth

[CI:DOCS] Document location of auth.json file if XDG_RUNTIME_DIR is not set",50,51,0,1
"containers/buildah","ead115e1a9cf6402e47b2fd6e65069d42e99228c","openshift-merge-robot","2021-04-13 13:16:09","true","Merge pull request #3139 from rhatdan/VENDOR

Bump containers/storage vendor to v1.29.0",52,51,0,1
"containers/buildah","67135367ffa8787759362cb3d4a7c9f7a49b3585","Luap99","2020-10-02 14:11:13","false","Sort build flag definitions alphabetically

Signed-off-by: Paul Holzinger <paul.holzinger@web.de>",87,44,0,0
"containers/buildah","d746fe4509d15159511363f09f22a173d87b219c","nalind","2020-10-09 14:23:38","false","copier: check an error earlier

In copierHandlerGet(), instead of waiting until after we've made another
function call and checked its error result, check the error value that
we're passed right away.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",62,44,0,1
"containers/buildah","a5d61f6c65bfa0663fa34f3bf2ef49b785675139","awerlang","2020-08-25 17:41:17","true","docs: remove outdated notice

Signed-off-by: André Werlang <beppe85@gmail.com>",83,43,0,0
"containers/buildah","5e68ce98585690d421670bb46243bd90b1ec1cc8","TomSweeneyRedHat","2020-06-22 20:06:37","false","docs: clarify the 'triples' format

Replacing #2420 per it's author @markstos.  Adds clarification to what a
triple consists of for uid and and gids.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",143,41,0,1
"containers/buildah","278fb818c403de56121367afccaf0fc3d764850c","cevich","2020-04-09 18:58:55","true","Cirrus: Use pre-installed VM packages + F32

All packages required for building + testing buildah are now included in
VM images shared withthe libpod project's CI system.  Remove former
`setup.sh` and `lib.sh` facilities for installing/updating packages.
Also add in a new function for removing the pre-installed buildah
package files (since we run and test from source).  This mirrors
the same behavior used in libpod's CI setup.

Signed-off-by: Chris Evich <cevich@redhat.com>",120,38,0,1
"containers/buildah","92285646bc8c26fec455e65f2904e9f7732b8e23","rhatdan","2020-04-18 11:09:05","false","cgroup_manager should be under [engine]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",123,39,0,1
"containers/buildah","bb064aed272b232362dd3d286435f29f8766b25f","rhatdan","2020-02-17 18:01:50","true","Merge pull request #2167 from containers/dependabot/go_modules/github.com/containers/common-0.2.1

Bump github.com/containers/common from 0.2.0 to 0.2.1",101,37,0,1
"containers/buildah","b37c328f40bfe453e928d9904216512b86088f52","giuseppe","2020-02-10 10:29:25","false","Merge pull request #2151 from DanielCalvo/patch-1

Fixing formatting & build instructions",112,36,0,1
"containers/buildah","8aff0edda6ee76f03ca17f45b41d87851fd50fb2","vrothberg","2020-02-03 15:42:34","false","vendor github.com/containers/image/v5@v5.2.0

See release notes:
https://github.com/containers/image/releases/tag/v5.2.0

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",110,36,0,1
"containers/buildah","e4ec46aaa015717e52c4d43d7dc348c410f6155b","nalind","2018-08-31 06:28:42","false","stdin: on HUP, read everything

When we're polling to handle stdio for a container, when we detect a HUP
on our stdin, read all that we can from stdin before closing it, instead
of reading only, at most, a single chunk of bytes.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #980
Approved by: rhatdan",34,19,0,1
"containers/buildah","931372925b4cbcd4e399ec4b9433fc21f115b891","nalind","2017-01-28 04:59:37","false","Include our vendored dependencies

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","900d1b680e9397fabb6e2619d13dfec4eddd8807","vrothberg","2019-06-17 12:19:47","false","pkg/unshare: use `...` instead of iterating a slice

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",42,29,0,1
"containers/buildah","e4c4d465bff217c1101b672d9eae0bc507667a35","steveb","2019-02-12 00:41:37","false","Fix buildah commit compress by default

The change to switch over to cobra had the effect of always setting
compress to imagebuildah.Uncompressed for the commit and bud commands.
This is because the conditional to set it to Gzip always returns false
regardless of whether --disable-compression is set or not.

This change makes the compression flag logic in cmd/buildah/bud.go and
cmd/buildah/commit.go consistent with the logic in
cmd/buildah/push.go[1] (which shows the correct behaviour)

Signed-off-by: Steve Baker <sbaker@redhat.com>

Closes: #1333
Approved by: TomSweeneyRedHat",59,25,0,0
"containers/buildah","4b4e25868c2fe46be2c19ef9a0c186f238c90cd1","nalind","2017-12-07 22:12:36","true","Merge pull request #350 from ipbabble/tutorial2

Add a new tutorial for using Buildah with registries",31,10,0,1
"containers/buildah","5c51a20b41fcb25b123faf90d98e5346d7b7482c","rhatdan","2019-04-23 18:42:30","false","Vendor in latest containers/storage

Fixes the use of additional stores, use of devices based on link paths,
properly checks the permissions on /run/usr/UID directory.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1541
Approved by: vrothberg",52,27,0,1
"containers/buildah","c18724ebd7cabbd1c2321489644f36ed699bfa15","rhatdan","2018-07-27 14:48:16","false","Allow Dockerfile content to come from stdin

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #888
Approved by: TomSweeneyRedHat",31,18,0,1
"containers/buildah","5bd5a4f9d77833d7fdfef371b10bc16be00b1510","rhatdan","2022-11-11 19:39:28","false","Vendor in latest containers/(common,image,storage)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",22,69,1,1
"containers/buildah","a8b15f8d451190b67c55305eadab0818d6fee606","rhatdan","2021-10-07 13:10:22","false","Report ignorefile location when no content added

Users have accidently had a .containerignore or .dockerignore
file in their context directly which blocked all content.
Currently we report that no globs matched, but do not
identify where the globs came from.

This change is an attempt to add this data to the error.
Example: https://github.com/containers/buildah/issues/3318

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",42,56,1,1
"containers/buildah","f29314579db4df46f98461d7374f552df2c6b4b6","boaz0","2018-02-08 10:39:06","false","Return multi errors in buildah-rm

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>

Closes: #458
Approved by: rhatdan",34,12,0,0
"containers/buildah","3f056ae6b80b6b7440c730e356a438ab7cde91f3","rhatdan","2019-07-01 20:48:25","false","Update to containers/storage v1.12.13

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1701
Approved by: TomSweeneyRedHat",44,29,0,1
"containers/buildah","52087ca1c51b768bbb9e8876e85850dcaca8d71c","rhatdan","2017-08-23 10:47:13","false","Remove --transport flag

This is no simpler then putting the transport in the image page,
we should default to the registry specified in containers/image
and not override it.  People are confused by this option, and I
see no value.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #234
Approved by: rhatdan",28,7,0,1
"containers/buildah","5cd9be61ef71a518749ccbde5e449adac5e4b8c0","baude","2018-06-29 14:00:38","false","allow buildah cross compile for a darwin target

the goal here is to allow ourselves to cross compile buildah for a darwin
target.  we are doing this to eventually protect from regressions that could
creep into buildah so we don't dig ourselves a deeper hole.

the simplified and non-variable approach to the make darwin was done with
intent to keep this simple until we can exploit things a little more.

once this PR merges, i will create a CI test that will test for regressions
on a make darwin.  we should also be doing a gofmt with a darwin target so the
!linux|darwin tagged files are also checked for completeness.  initially the
test can be optional for passing with the long-term idea that it be made
a firm requirement at the buildah maintainers behest.

Signed-off-by: baude <bbaude@redhat.com>

Closes: #840
Approved by: rhatdan",28,17,0,0
"containers/buildah","8849c087a87ad7e46745bca1dc862169dc2a715a","benelliott","2021-10-06 10:25:26","false","Fix command doc links in README.md

Signed-off-by: Ben Elliott <4996462+benelliott@users.noreply.github.com>",43,56,1,0
"containers/buildah","0d39b40e023d8c72da6fae41c80bfc6ea0ad62d7","wking","2018-09-14 16:25:12","false","pull: Return image-pulling errors from pullImage

Instead of throwing out the upstream error message, save it and return
it if we can't come up with a more-specific suggestion.  This softens
the approach from 043fd2e3 (Add registry errors for pull,
2018-06-01, #747), because that could make debugging harder [1].

[1]: https://github.com/projectatomic/buildah/issues/849

Signed-off-by: W. Trevor King <wking@tremily.us>

Closes: #1014
Approved by: rhatdan",37,20,0,0
"containers/buildah","1ff7741fe20144f5a16318a47fb1ffafa4e45193","edsantiago","2020-12-07 22:36:43","false","Move away from using docker.io

November 2020, docker.io started restricting unauthenticated
image pulls. Try to work around this by using a custom
registries.conf file.

For the most part this means copying images from docker.io
to quay.io, via:

   $ skopeo copy --all docker://docker.io/library/img:tag \
                       docker://quay.io/libpod/img:tag

...for the following values of 'img:tag':

   busybox:musl
   centos:7  centos:8  centos:latest
   composer:latest
   debian:latest       ubuntu:latest
   docker:latest
   php:7.2

For each of those, it was necessary to go into the quay.io
GUI, click the image name, click the settings (gear) icon
at bottom left, click 'Make public', and confirm.

This process did not work in four instances, which required
special-casing:

   commit.bats : openshift/hello-openshift did not match the
                 mirroring rules; I switched to alpine instead.
                 Nalin confirmed on IRC that there was no magic
                 reason for requiring hello-openshift.

   pull.bats   : change a SHA. AFAICT there was nothing magic
                 about the SHA being used, it was just a
                 convenient one for purposes of testing
                 pull-by-sha. I simply switched to the SHA
                 of an image present on quay.

   registries.bats : was assuming that fedora-minimal shortname
                     would be pulled from fedora registry.
                     Unfortunately, we have a copy on quay
                     (for podman tests), so that's what we
                     pull by shortname, and it does not match
                     the SHA of the fedoraproject.org one.
                     Solution: pull by tag (fedora-minimal:32)
                     and hope that nobody ever mirrors that one
                     on quay.

   run.bats    : another pull-by-SHA, but this time I changed
                 the SHA to a named tag, and skopeo copy'd
                 that image from docker.io to the given name
                 on quay. This time there _is_ something
                 magic about that particular SHA (it's an
                 image with a specific volume quirk) but
                 there's no actual reason to reference it
                 by SHA - we simply did so because we have
                 no control over tag names on docker.io.
                 Since we control tag names on quay.io,
                 it's easy and more maintainable to give
                 this image a descriptive tag.

Signed-off-by: Ed Santiago <santiago@redhat.com>",79,46,0,1
"containers/buildah","b3435590fd460a7fa79eb4c864e3fd4adc260e7c","rhatdan","2021-02-12 09:49:08","false","Improve messages about --cache-from not being supported

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",66,49,0,1
"containers/buildah","0be866d85f05eed652aff4f2883f0212f9ed5fce","rhatdan","2018-09-26 01:27:15","true","Merge pull request #1035 from TomSweeneyRedHat/dev/tsweeney/issuepage

Request podman version for build issues",37,20,0,1
"containers/buildah","6bc38cc88392ec7ce52774d36c0b635570aac129","rhatdan","2018-07-15 10:42:33","false","Update vendor for runc to fix 32 bit builds

Current runc builds will not build on 32 bit systems

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",31,18,0,1
"containers/buildah","02f54e4b1e57a0f80a6a3cf87ee548550f138df1","rhatdan","2018-06-25 16:39:57","false","Allow ping command without NET_RAW Capabilities

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #818
Approved by: nalind",28,17,0,1
"containers/buildah","2ad68d816feb2218a8f572d0f70783bb9bf16c6f","cbandy","2023-04-01 19:07:00","false","run: pass process environment variables by reference

See: https://github.com/containers/buildah/issues/4688
Signed-off-by: Chris Bandy <bandy.chris@gmail.com>",12,74,1,0
"containers/buildah","ffe96befdec1a392ff97dfd815b443f7ddd3abf9","rhatdan","2019-07-12 12:11:25","false","Bump to v1.9.2-dev

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",50,29,0,1
"containers/buildah","65f07b77ea70c1e1a5da231058a5295b4512b0f0","rhatdan","2020-09-09 19:22:41","true","Merge pull request #2598 from nalind/copier-relative-hardlink

copier.Get(): hard link targets shouldn't be relative paths",87,43,0,1
"containers/buildah","726e24d5e536d2006ad71db34b97e4142adebf21","boaz0","2019-12-27 11:27:53","false","make --format columnizing consistent with buildah images

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>

Closes: #2052
Approved by: rhatdan",98,35,0,0
"containers/buildah","2cafe1122970c945a16826e51f074b90dabcc16d","rhatdan","2018-08-03 11:19:39","false","unshare: make adjusting the OOM score optional

The OOM score adjustment is an optional field in the runtime spec, so
only try to set it if it's set in the spec.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #906
Approved by: rhatdan",22,18,0,1
"containers/buildah","c29b585eda88697e750f6872f0cbfb6b43f4d277","rhatdan","2019-06-08 10:09:27","false","Update vendor on containers/storage to v1.12.10

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1654
Approved by: vrothberg",60,28,0,1
"containers/buildah","985eec53912a5afaabe3a4abdfa054231f03ce38","rhatdan","2022-03-26 11:48:51","false","Switch most calls to filepath.Walk to filepath.WalkDir

Should speed up most walks escpecially if they don't need to
stat every directory entry.

[ NO NEW TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",29,62,1,1
"containers/buildah","e5aa6c9fc5568b4a4f96f6d3ab5f98a2bfa376dc","anarcat","2017-12-11 18:25:42","false","add install.runc target

We need this for platforms like Ubuntu and Debian that do not ship a
standard (post 1.0rc4) version of runc.

I'm assuming here this is why we're building `runc` on our own here -
but it doesn't make sense to just do that while leaving only a symlink
in $PWD. We want to actually install the thing as well. So we add an
`install.runc` target, similar to `install.libseccomp.sudo` to make
sure we install `runc` in the right location.

An alternative to this would be to change the documentation to do the
`install` command by hand, but this is more error-prone. As runc
trickles down to the Debian distros, we can then just remove the `make
install.runc` call and, eventually, the target itself.

Closes: #355

Signed-off-by: Antoine Beaupré <anarcat@debian.org>

Closes: #354
Approved by: rhatdan",33,10,0,0
"containers/buildah","bbe6b64acd27d671764c370c2addd938cc80b8a9","jfreax","2020-02-20 08:20:20","true","Fix minor spelling errors in containertools README

Signed-off-by: Jens Dieskau <jens@dieskau.pm>",99,37,0,0
"containers/buildah","f0cf07bb600d4bee6ae523997d09013a20390950","nalind","2019-10-25 21:19:30","false","Move to containers/image v5.0.0

Bump to containers/image's 5.0 release.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1902
Approved by: rhatdan",80,33,0,1
"containers/buildah","8b2b56d9b8640aadcf5fc26557fbd7f15ffb2f60","nalind","2017-06-28 21:07:58","false","Update to work with newer image library

Update shallowCopy() to work with the newer version of image.
Remove things from Push() that we don't need to do any more.
Preserve digests in image names, make sure we update creation times, and
add a test to ensure that we can pull, commit, and push using such names
as sources.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #187
Approved by: rhatdan",20,5,0,1
"containers/buildah","b466cbd23ba255f3c6b6bc77c7fd433726b7cadf","nalind","2019-04-16 15:13:31","false","imagebuildah: rework unused-argument detection

Walk the raw parsed tree to try to catch argument values that we're
passed that aren't used in the Dockerfile.  Upper-case the command in
the Step structure in all of the places where we compare it to a known
value.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1535
Approved by: rhatdan",53,27,0,1
"containers/buildah","711f9ea26445e0cf24de17c56bafbd898b683078","silviot","2019-02-07 15:25:49","false","Fix example for setting multiple environment variables

On version `1.6-dev` the current example yields:
```
too many arguments specified
```

Signed-off-by: Silvio Tomatis <silviot@gmail.com>

Closes: #1327
Approved by: rhatdan",56,24,0,0
"containers/buildah","5e302500397efefcdc044a51781da954a480fe16","openshift-merge-robot","2023-05-26 18:43:24","true","Merge pull request #4819 from flouthoc/swap-centos-to-docker

remove `registry.centos.org` since its decommissioned",17,76,1,1
"containers/buildah","5a3f634af32f31708496475c2ae0383e3bd69639","openshift-merge-robot","2022-01-12 21:40:20","true","Merge pull request #3707 from cevich/savetime

Cirrus: Re-order tasks for more parallelism",31,59,1,1
"containers/buildah","e9bc224636ff9106e691c5a79c667aeb5549c481","openshift-merge-robot","2021-09-13 12:59:40","true","Merge pull request #3514 from containers/dependabot/go_modules/github.com/containers/storage-1.36.0

build(deps): bump github.com/containers/storage from 1.35.0 to 1.36.0",40,55,1,1
"containers/buildah","34ac2cc4f63ce8681fc680dc460548e701fbc880","rhatdan","2023-10-27 16:54:18","false","Vendor in latest containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",4,81,1,1
"containers/buildah","3d4e057fe9872847db4f714f7eaaa4cfd5117f69","flouthoc","2023-10-08 04:37:13","true","Merge pull request #5076 from flouthoc/mkcw-binary

mkcw: remove entrypoint binaries",6,80,1,1
"containers/buildah","7dbc5ce82fa3ab6a5307cc540da618a335bcb041","nalind","2022-05-16 16:07:27","false","test helpers: default to being rootless-aware

Make tests/copy/copy.go and tests/imgtype/imgtype.go aware of rootless
defaults, and have them re-exec themselves in user namespaces if they're
run in such an environment.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",27,64,1,1
"containers/buildah","4b8e5d4bc1a8efc569240d6ac62293102198fbeb","openshift-merge-robot","2022-05-18 12:49:00","true","Merge pull request #4003 from containers/dependabot/go_modules/tests/tools/github.com/golangci/golangci-lint-1.46.2

build(deps): bump github.com/golangci/golangci-lint from 1.46.1 to 1.46.2 in /tests/tools",25,64,1,1
"containers/buildah","08613ccd6b4f9889f3fadb4326ac6dc1d05b9d0f","giuseppe","2022-03-23 10:37:57","true","buildah: create WORKDIR with USER permissions

Closes: https://github.com/containers/buildah/issues/3620

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",33,62,1,1
"containers/buildah","0b26014111bb6a7b4f19c7e5bd2b24205f4ca266","geonizeli","2020-11-29 14:01:59","false","inserts forgotten quotation mark

Signed-off-by: João Geonizeli <joao.geonizeli@gmail.com>",77,46,0,0
"containers/buildah","600b4e6f340aa66062c97ccb37db285ab8bce4b6","openshift-merge-robot","2020-10-27 15:27:01","true","Merge pull request #2720 from containers/dependabot/go_modules/github.com/containers/common-0.26.2

build(deps): bump github.com/containers/common from 0.26.0 to 0.26.3",65,45,0,1
"containers/buildah","f833737fb2bbda09aba3432436323dce6d7cafdf","rhatdan","2020-02-22 10:23:50","true","Merge pull request #2180 from rhatdan/vendor

Update to containers/common v0.4.0",99,37,0,1
"containers/buildah","a3f9c3c6525d2b29c64cb9444c592f77954867b3","rhatdan","2020-07-10 11:38:18","false","switch containers/libpod to containers/podman

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",145,41,0,1
"containers/buildah","3a122aa3c84ae6aaa644560a9f2666d3c27d02c4","hswong3i","2020-05-28 04:10:04","true","Add nix derivation for static builds

Signed-off-by: Wong Hoi Sing Edison <hswong3i@gmail.com>",132,40,0,0
"containers/buildah","b5b67117ab31189919dede8cada47b12e0214b94","cevich","2020-01-31 19:02:56","true","Bors-ng: Add documentation and status-icon

Signed-off-by: Chris Evich <cevich@redhat.com>",108,36,0,1
"containers/buildah","9a5a23af959352b8c4636704c05c2a506e27f3c0","vrothberg","2019-05-29 13:22:44","false","imagebuildah.Executor: remove unused onbuild field

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1624
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","e213ed78c3869a74875f2210c1bb77e0077a656c","nalind","2018-10-02 17:50:47","false","Add a blob cache implementation

Add a blob cache reference type which wraps other reference types.  When
used to create source and destination images, it returns wrappers for
source and destination images created by the wrapped references.

The cache reference must be created with a specified directory.

Blobs that are written to a cache image destination are stored as-is on
disk.  When reading a blob from a cache image source, if a blob with the
matching digest (and if specified, a matching size) can be found on
disk, read it directly instead of reading it from the real image source.

If compression or decompression is requested, the cache may return a
related blob instead of an exactly-matching blob.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1149
Approved by: rhatdan",43,20,0,1
"containers/buildah","f16e320b63d1a7131b420ba51a516503adca0f4e","rhatdan","2018-08-08 19:28:10","false","Remove stream options, since docker build does not have it

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #916
Approved by: TomSweeneyRedHat",24,18,0,1
"containers/buildah","dd6a599c513198f21c1113f0c0b94bd71f1ab609","flouthoc","2021-09-14 10:44:27","false","build: Add additional step nodes when labels are modified

Make sure label modification behaviour stays similar to docker i.e
new step is added when labels are modified and leave caching of layers
to executor

Advantages.

* Layers will be automatically cached if needed.
* If Labels are modified , new step will be built and cached if
  configured instead of forcing pre-built cached layers.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",39,56,1,1
"containers/buildah","ffb2f27a86f38a3ff00213862acc485e15231d5c","flouthoc","2022-10-18 10:15:12","true","test: cleaning cache must not clean lockfiles

Use-cases as shown in below containerfile cleans cache between the
builds, in previous commits we have ensured that buildah lockfiles will
not be part of user's cache content hence following use-case must paas

```
FROM quay.io/centos/centos:7

ARG WIPE_CACHE

RUN --mount=type=cache,target=/cache1,sharing=locked \
    --mount=type=cache,target=/cache2 \
    set -ex; \
    ls -l /cache1; \
    if [[ -v WIPE_CACHE ]]; then \
      >&2 echo ""Wiping cache""; \
      find /cache1 -mindepth 1 -delete; \
    fi; \
    echo ""foo"" > /cache1/foo.txt; \
    ls -l /cache1; \
    chmod --recursive g=u /cache1; \
    : ;

RUN --mount=type=cache,target=/cache1,sharing=locked \
    >&2 echo ""Never get here""
```

Closes: https://github.com/containers/buildah/issues/4342

Signed-off-by: Aditya R <arajan@redhat.com>",27,69,1,1
"containers/buildah","9d7ac7583eff59cacecce366bc780ce21110123a","flouthoc","2022-07-07 08:51:56","true","imagebuildah: honor build output even if build container is not commited

For cases like where Containerfile only contains `FROM alpine` or `FROM
<imagename>` buildah will just perform name tagging and will not
actually commit contents of build container since there is actually no
changes made in the build process. However previously we only used to
export build output when we were actually commiting contents so `-o` or
`--output` was ignored for such edge-cases following commit ensures that
we honor `-o` or `--output` in all scenarios.

Example: Should be functional now
```Dockerfile
FROM alpine
```
```console
buildah build -t test -o type=tar,dest=out.tar .
```

Closes: https://github.com/containers/buildah/issues/4094

Signed-off-by: Aditya R <arajan@redhat.com>",23,65,1,1
"containers/buildah","745bf7e56bda740ce7cfc55318da08529e5ed519","umohnani8","2018-08-22 15:50:29","false","Return error immediately if error occurs in Prepare step

The error was not being returned immediately if an error
was occuring during the Prepare step in the build process.
Hence if the image was being failed to pull, a seg fault was
happening when the Execute step started.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #947
Approved by: rhatdan",29,19,0,1
"containers/buildah","15e1054820a0442ce179ca44ddd870b8ff56fa8c","pixdrift","2018-04-11 15:20:56","false","Update entrypoint behaviour to match docker

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #577
Approved by: rhatdan",32,14,0,0
"containers/buildah","fe204e42ee80a3760dd2d4c681bad9eb0e7b046d","pixdrift","2018-05-08 11:25:29","false","Minor fixes to formatting in rpm spec changelog

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #664
Approved by: rhatdan",53,15,0,0
"containers/buildah","bb285e53bd585208fa8d8e24787015aa9b107b82","rhatdan","2022-09-22 09:50:06","false","vendor in latest containers/(common,storage,image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",20,68,1,1
"containers/buildah","f8eb73820a20d8c72af469c0ac4b56ec1d503816","rhatdan","2023-01-03 13:33:18","true","Merge pull request #4452 from flouthoc/relative-mount

build, mount: allow realtive mountpoints wrt to work dir for `--mount=type=cache` and `--mount=type=bind`",23,71,1,1
"containers/buildah","4b1c5e3a94c3dec444b01ed6787658459e6dae3d","cevich","2023-05-03 20:25:42","true","Cirrus: Fix meta task failing to find commit

During the nightly cirrus-cron job on main, this error occured:

```
Using built-in Git...
Limiting clone depth to 1!
Cloning refs/heads/main...
Enumerating objects: 9246, done.
...cut...
Compressing objects: 100% (7182/7182), done.
Total 9246 (delta 1519), reused 6078 (delta 1101), pack-reused 0
HEAD is at f35369055df75553071190cfe8607a594ba0e68b.
Hard resetting to 3908816d5310ac1f7bcd4399d23d75c1da0c2678...
Failed to force reset to 3908816d5310ac1f7bcd4399d23d75c1da0c2678:
object not found!
```

However, the repository code isn't needed or used for the meta task.
Fix this by running `/bin/true` as the `clone_script`.

Signed-off-by: Chris Evich <cevich@redhat.com>",9,75,1,1
"containers/buildah","2e64dea06fb26c2f3f22df450ac81cdd5dc98f6c","TomSweeneyRedHat","2018-09-30 17:20:37","false","Touchup pull manpage

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",42,20,0,1
"containers/buildah","66986d187ea6ed925f74cb16b55977632944aa0f","jskov-jyskebank-dk","2020-07-09 05:37:29","false","Howto for rootless image building from OpenShift

Signed-off-by: Jesper Skov <jskov@jyskebank.dk>",146,41,0,0
"containers/buildah","9a3d0727be9315130687c9e68484b6995b228c8a","rhatdan","2020-11-19 11:55:58","false","Fix crash on invalid filter commands

If users forget to use ""="" sign when doing image filters
buildah was crashing.

Fixes: https://github.com/containers/buildah/issues/2763

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",75,46,0,1
"containers/buildah","e33bb867879de7a3030babf44d68200c6037d8ce","rhatdan","2022-12-20 20:43:55","false","Add documentation for buildah build --pull=missing

Fixes: https://github.com/containers/buildah/issues/3921

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",19,71,1,1
"containers/buildah","254a3d2e1cd9eec52611f01a78cdf6871f8dcd58","rhatdan","2019-07-03 11:42:00","false","On Masked path, check if /dev/null already mounted before mounting

We do not want to mount /dev/null over a masked path, if the path is
already /dev/null.

This prevents an containers running buildah from requiring additional privs
to mount on a /dev/null, when the target is already mounted.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1705
Approved by: TomSweeneyRedHat",46,29,0,1
"containers/buildah","e1876db308ba4ff5d4f8eac382c1fc1add26fae4","rhatdan","2017-06-07 21:03:26","false","Vendor in latest container/storage

container/storage now supports remote shares and having a configuration
file.  We need to merge this to demonstrate using buildah with nfs shares.

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #140
Approved by: nalind",13,4,0,1
"containers/buildah","6554ef4accbdbb244eb1c950c40a4131e27f911f","vrothberg","2019-06-17 12:15:46","false","conformance suite: remove unused func/var

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",42,29,0,1
"containers/buildah","f329bca692d7358dd58f557cc3f9d36ba9dd7dc8","vrothberg","2019-06-18 11:46:40","false","pkg/cli: panic when flags can't be hidden

Panic when hiding the flags does not work.

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","b3a5a5ff15dd3f4497ef2d355525c56569c86c02","nalind","2019-09-19 21:19:34","false","manifests: add the module

Wrap the pkg/manifests API in a version which knows how to load and save
manifest lists and information about where the various instances are
found in local storage.

Add an ImageSource implementation that can use a manifest list and
instance information to create a grab bag of all of the blobs known to
all of the instances.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1902
Approved by: rhatdan",63,32,0,1
"containers/buildah","e3bb278863a71084f0f9ae488444872b4a95df2e","TomSweeneyRedHat","2019-11-07 22:46:01","false","Enhance error on unsafe symbolic link targets

If a COPY target was a symbolic link that resolved at a directory
above the context directory, securejoin gave an error that wasn't clear
to the end user (or this developer):

```
STEP 4: COPY README.md /
error building at STEP ""COPY README.md /"": secure join: too many levels of symbolic links
ERRO exit status 1
```

This change updates that error message to hopefully clear the issue up
for the user.  At the very least it will be easier to find in the code:

```
STEP 4: COPY README.md /
error building at STEP ""COPY README.md /"": forbidden path for ""README.md"", it is outside of the build context ""/root/tsweeney/workspaces/containers/toolbox/images/fedora/f31"": secure join: too many levels of symbolic links
```
Addressed #1952

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1970
Approved by: @rhatdan",83,33,0,1
"containers/buildah","d59af128660c22fdbf85d3f21ae7e64cdf198358","TomSweeneyRedHat","2018-02-13 20:29:38","false","Fix versioning to 0.12

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #478
Approved by: rhatdan",17,13,0,1
"containers/buildah","e9915937ac47f0dba36786ec836fedc3d9f9c661","TomSweeneyRedHat","2018-02-08 20:07:29","false","Rename tutorials.md to README.md in tutorial dir

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #459
Approved by: rhatdan",34,12,0,1
"containers/buildah","bb764444ae1a00e9819ea81388f79563814b03f5","TomSweeneyRedHat","2019-03-08 00:54:09","false","Remove noop from squash help

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Removes noop note from the squash on bud --help.  This will need
to be vendored into Podman to address https://github.com/containers/libpod/issues/2568

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1394
Approved by: @rhatdan",65,25,0,1
"containers/buildah","d3a01d0041789ab5967acd04f5c4501a0ba78f64","TomSweeneyRedHat","2020-11-16 14:16:04","false","Bump to v1.18.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",77,46,0,1
"containers/buildah","2bada5dba9f50f2b0351471543c1735742c38aa8","vrothberg","2019-01-30 17:14:47","false","cleanup vendor.conf

* pin dependencies to commits or releases (where possible) instead of
  branches
* delete unused dependencies
* add a make vendor target to ease dependency management

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1311
Approved by: rhatdan",54,24,0,1
"containers/buildah","d9aa9d1a9ba18ad669ff5248c6aedb156513fb5c","pixdrift","2018-05-06 11:04:45","false","Adding noop for --force-rm to match --rm

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #659
Approved by: rhatdan",52,15,0,0
"containers/buildah","cd27adf0b4b226e7be2a4228490db2568ea30717","nalind","2017-03-07 01:32:55","false","Add another example script

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","d7ccff3edb11256c8e6609cbd976dc9c878a2f46","Luap99","2022-01-10 14:12:24","true","Fix default CNI paths

We need to use the default from containers.conf and not hardcode them in
buildah. This fixes an issue with the cni network backend since it would
try to access /etc/cni/net.d/ even as rootless user. This regression was
introduced in commit f9cff07b8121.

Also hide the cni flags as we do not expect users to change this. The
recommended way is to change them in containers.conf.

[NO NEW TESTS NEEDED]

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",27,59,1,0
"containers/buildah","b64d814325cd6365ab85bfb8cfde8e98a08a38fd","dfr","2022-08-05 16:27:34","false","chroot: Fix runUsingChrootExecMain on FreeBSD

This adds no-op stubs for various things and adds an optional override
for creating the container chroot - on FreeBSD we use a jail to allow
setting the container hostname.

Signed-off-by: Doug Rabson <dfr@rabson.org>",18,66,1,0
"containers/buildah","758eb20144b895cc48ba798d615610b7c7efe948","TomSweeneyRedHat","2021-02-07 01:20:48","false","Don't fail copy to emptydir

When a COPY command was being targeted at an empty new directory,
the copy would fail.  It could be ""worked around"" by putting a dummy
file into the directory.

Addresses:  #2964
Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",92,48,0,1
"containers/buildah","b794edef6abb07d18c8810f1506a5fd907e748ad","TomSweeneyRedHat","2017-10-21 18:41:49","false","Add required runc version to README.md

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",30,9,0,1
"containers/buildah","bed75252b0431b1b3c8c0211e0a9d624c524ad5a","nalind","2017-03-21 20:57:07","false","Use imagebuilder's definition of ""scratch""

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #59
Approved by: rhatdan",11,2,0,1
"containers/buildah","3e7e08be90207202fc0bdce16e9422fd40847c4b","nalind","2017-03-15 21:20:16","false","Add a ""list"" command, for listing active builders

Add a ""list"" command which lists all known buildah working containers.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,2,0,1
"containers/buildah","a4b830a9fc6f1b9809f404d36e8c0aaa0346b108","nalind","2017-10-05 14:27:41","false","images: don't list unnamed images twice

The ""images"" command was erroneously listing images that don't have
names twice, once with no name, and a second time with ""<none>"" as a
placeholder.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #280
Approved by: rhatdan",31,8,0,1
"containers/buildah","9bcd86d87b17e0c9cd47589934bc6d4d077d509b","nalind","2017-05-19 18:35:12","false","Fix a copy/paste error in a man page

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #111
Approved by: nalind",15,4,0,1
"containers/buildah","b9b433517362a7dff336ff6eb9590c7971150627","nalind","2017-03-07 15:41:52","false","Update the copy example script

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","b2baeb25f4c4ea18e5ca17e2136108ffed724dae","nalind","2017-05-31 17:56:25","false","Take a shortcut when writing to local storage

When writing to local storage, take a couple of shortcuts: instead of
recompressing layers to ensure that the values we store in the image
manifest will be correct for content-addressibility, just pretend that
the layer ID is a blob hash value, and that it's a valid layer diffID.

Local storage doesn't generally care if these values are correct, and we
already have to recompute these values when exporting an image, but this
saves us quite a bit of time.

The image library's Copy() routine actually cares about and
sanity-checks these things, so if we're going to take advantage of the
shortcuts, we need to use its higher-level APIs to write a layer, write
the configuration, and write the manifest, then move those items that it
writes to an image with the right set of layers.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #141
Approved by: rhatdan",13,4,0,1
"containers/buildah","d0bba9543696e1f6286124dd0a1637fad9786d1b","nalind","2020-10-20 19:11:40","false","bump containerd, docker, and golang.org/x/sys

Bump github.com/containerd/containerd from v1.3.2 to v1.4.1 and
golang.org/x/sys from v0.0.0-20200810151505-1b9f1253b3ed to
v0.0.0-20201018230417-eeed37f84f13.  Bump github.com/docker/docker to an
unreleased tag to fix compilation with newer golang.org/x/sys.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",63,45,0,1
"containers/buildah","6715edfd1827ca7d899b808c6b3aea4b38f4f20b","nalind","2017-03-27 18:46:35","false","Add some more options for Run

Add options to Run() for passing in additional environment variables,
overriding the default command, user, and working directory, and a flag
for controlling whether or not we attach to the host's network.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #46
Approved by: rhatdan

Closes: #39
Approved by: nalind",14,2,0,1
"containers/buildah","dcc3fc36c03c6611ef3197d7ec5586e033e77301","flouthoc","2021-11-29 08:56:55","true","images: accept multiple filter with logical AND

Already documented but a NOOP currently `buildah images` accepts a
single filter however it should accept multiple filters and perform a
logical `AND` between them while fetching images.

`buildah images --filter <1> --filter <2>`

Signed-off-by: Aditya Rajan <arajan@redhat.com>",31,58,1,1
"containers/buildah","5368ec3211027089489133e1393b5db7bb99f68a","openshift-merge-robot","2020-11-10 21:14:30","true","Merge pull request #2764 from edigaryev/fix-build-dockerfiles-npe

Fix NPE when Dockerfile path contains non-directory entries",68,45,0,1
"containers/buildah","bd8660c6c419c5a66e91b7c3b9100c9037f377f3","openshift-merge-robot","2022-01-27 13:08:53","true","Merge pull request #3750 from giuseppe/chroot-use-mount-program

overlay: always honor mountProgram",34,60,1,1
"containers/buildah","6589be3ba189107e9389c8454951ff38fe9692ab","openshift-merge-robot","2023-06-27 19:08:18","true","Merge pull request #4880 from testwill/pkg-import

chore: pkg imported more than once",12,77,1,1
"containers/buildah","74f211e5ab570640c7b6b66d185b5d5ed9b4d379","openshift-merge-robot","2021-04-20 10:27:10","true","Merge pull request #3164 from edsantiago/systemtest_infinite_hang

tests: copy.bats: fix infinite hang",50,51,0,1
"containers/buildah","765c09d6dbabf7431f47836e153d4fc2319e50d0","mtrmac","2019-06-03 13:14:32","false","Update containers/image to v2.0.0

This adds v2 registries.conf format, including mirror support.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1634
Approved by: rhatdan",58,28,0,1
"containers/buildah","68bd0e306c7eab3b87fb4e35cc5e1630344ed5af","barthy1","2021-03-23 09:52:56","false","Use faster way to check image tag existence during multi-arch build

Use `skopeo list-tags` instead of `docker pull` makes check of image tag
existence during multi-arch image build workflow  much faster.

Signed-off-by: Yulia Gaponenko <yulia.gaponenko1@de.ibm.com>",54,50,0,0
"containers/buildah","92ce0bdf10795027836ae3ff415d5b114b306219","vrothberg","2019-06-21 15:23:28","false","migrate to go modules

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1621
Approved by: rhatdan",44,29,0,1
"containers/buildah","8e36b22a712d5280c27d5d6d42d46378792e3664","nalind","2017-07-12 15:09:33","false","Makefile: ""clean"" should also remove test helpers

Make ""clean"" also remove the imgtype helper.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #216
Approved by: rhatdan

Closes: #216
Approved by: rhatdan",18,5,0,1
"containers/buildah","9b299588c0936376ef9ccd7938f1cef27c831418","umohnani8","2021-01-26 18:36:59","false","Rebuild layer if a change in ARG is detected

Check whether the ARG in the containerfile is changed by
either the --build-arg flag or local environment and use
the cached layer or rebuild the layer accordingly.
Add tests for this use case as well.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>",96,48,0,1
"containers/buildah","fd995e6166b3f8def8f995f8e8a791dedecd2710","TomSweeneyRedHat","2018-01-06 00:20:26","false","Add --all functionality to rmi

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #384
Approved by: rhatdan",29,11,0,1
"containers/buildah","e43b8649526d9494f4d2c7068c7cea8411e88e67","TomSweeneyRedHat","2019-05-15 22:40:15","false","Add default /root if empty on chroot iso

Checks to see if the $HOME envvar has been set
and if not, trys to set it as best as possible.

Fixes: #1592

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1594
Approved by: rhatdan",55,28,0,1
"containers/buildah","c0406fd61c5b70d6d828bd95eaa245973c8bc144","TomSweeneyRedHat","2023-06-30 18:40:29","true","Merge branch 'main' into dev/tsweeney/bumpimage_common",13,77,1,1
"containers/buildah","e23781102c2de51f0c044185ce96977c7145b780","umohnani8","2018-08-21 15:28:19","false","Fix --layers ADD from url issue

When building with layers and using the ADD command to
add a file using a url, the build process would get stuck
in the second round when using the cache. This was happening
because the node traversal code was not moving on to the next
node when a url was detected hence causing an infinite loop.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #947
Approved by: rhatdan",28,19,0,1
"containers/buildah","b0f602fe0415f3b77b9ad062f310ef465d607191","rhatdan","2020-10-29 13:06:53","false","Handle cases where other tools mount/unmount containers

Podman is growing the support to mount and umount storage containers.
This patch will help maintain buildahs internel state and will return
the correct information to the user if they check if buildah containers
are mounted.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",67,45,0,1
"containers/buildah","e2210c3b71ddad071edda4c02a42a4bc9609fc00","flouthoc","2023-03-13 09:10:32","true","vendor: bump imagebuilder to a3c3f8358ca31b1e4daa6

We need commit https://github.com/openshift/imagebuilder/commit/598142f01f0c25b494487b31fc63ad01b0057f1c

Signed-off-by: Aditya R <arajan@redhat.com>",16,74,1,1
"containers/buildah","30d1340adad47cf3b5e516c2dd96e8398e54c5ba","openshift-merge-robot","2022-01-26 12:38:41","true","Merge pull request #3747 from containers/dependabot/go_modules/github.com/containers/image/v5-5.19.0

build(deps): bump github.com/containers/image/v5 from 5.18.0 to 5.19.0",34,60,1,1
"containers/buildah","6b890df143ab62a9ff3ca940a460afe7ce9c9973","openshift-merge-robot","2023-08-06 17:27:32","true","Merge pull request #4953 from containers/renovate/golang.org-x-term-0.x

fix(deps): update module golang.org/x/term to v0.11.0",11,78,1,1
"containers/buildah","cca320309f2a059f5c105cdfb10e94481c385edf","openshift-merge-robot","2020-10-28 10:17:37","true","Merge pull request #2620 from rhatdan/warn

Drop logrus.Errorf to Warnf on warnings about OCI versus Docker format images.",66,45,0,1
"containers/buildah","7deca81e41aaa5574cc93d700969fb9a9d2e4094","afbjorklund","2018-10-05 21:53:23","false","Add the --no-pivot flag to the run command

--no-pivot: ""do not use pivot root to jail process inside rootfs.
  This should be used whenever the rootfs is on top of a ramdisk""

Signed-off-by: Anders F Björklund <anders.f.bjorklund@gmail.com>

Closes: #1071
Approved by: rhatdan",51,20,0,1
"containers/buildah","869c705d4f9de0d49dd146b20da31b743e8d74a3","flouthoc","2022-06-23 05:19:46","true","vendor: c/common to common@7e1563b

Bump c/common to common@7e1563b so buildah could use `pkg/hooks`

Signed-off-by: Aditya R <arajan@redhat.com>",21,65,1,1
"containers/buildah","d1a9347b14bfb8e4f1139046676cf774dd716700","flouthoc","2022-02-03 10:21:29","true","executor: Add support for inline --platform within Dockerfile

Allows end users to configure executor's `OS`, `ARCH`,`VARIANT` via inline
`--platform`.

Usage
```
FROM --platform=linux/arm64 alpine
RUN uname -a
```
While this allows executor to pull base images with custom
`OS`, `ARCH`, `VARIANT` it still allows end-users to tag images with
different format if they need to.

Signed-off-by: Aditya R <arajan@redhat.com>",34,60,1,1
"containers/buildah","50ebc901d643ce5d6451835b50424c0e2e13b48a","openshift-merge-robot","2021-11-08 20:19:31","true","Merge pull request #3619 from nalind/git-clone-error

define.TempDirForURL(): show CombinedOutput when a command fails",29,57,1,1
"containers/buildah","0bd4dd1a7c8796b2e1f2b192f997643f1568bd99","openshift-merge-robot","2021-12-21 19:16:21","true","Merge pull request #3676 from rhatdan/name

Allow callers to replace the ContainerPrefix",29,59,1,1
"containers/buildah","a5b3e41f4c7b657f4cc4f897ac02d3e40180ad95","openshift-merge-robot","2023-04-26 19:37:55","true","Merge pull request #4760 from flouthoc/increase-conformance-timeout

makefile: increase conformance timeout",12,75,1,1
"containers/buildah","9018eef97b865767e981ab71fc1d81aee45404c2","umohnani8","2018-06-13 19:04:31","false","Add --all,-a flag to buildah images

By default buildah will not show intermediate images created during builds.
When the --a flag is set, buildah will output the intermediate images as well.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #789
Approved by: rhatdan",34,17,0,1
"containers/buildah","ed0a329d9e5a9d27b9ac75f6eac8485f7547b05c","TomSweeneyRedHat","2019-11-26 00:52:52","false","Handle missing equal sign in --from and --chown flags for COPY/ADD

When buildah bud runs without layers (default), it hands off the parsing
of the Dockerfile steps to imagebuilder.  However if the the --layers
option is in use, then we start parsing the steps before we hand stuff
off to imagebuilder.

The COPY --chown, ADD --chown, and COPY --from commands in a Dockerfile
were failing if there was not an '=' sign after them like ""COPY --chown=2374:3256"".
This moves the parsing into the code that handles the layer processing.

Fixes: #1984

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1997
Approved by: vrothberg",85,34,0,1
"containers/buildah","c77a8d39f1c1f9eb751fec18dc04df29865850bc","TomSweeneyRedHat","2017-10-18 13:12:49","false","Create Registry in Docker for Travis CI

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #290
Approved by: rhatdan",29,9,0,1
"containers/buildah","0c53cf9460ade1a254490e7bedd8007e06eb8384","giuseppe","2019-03-27 14:38:47","false","buildah: correctly create the userns if euid!=0

we were skipping the creation of the creation of a namespace if the
euid != 0.

regression introduced by 3d7403130100c3558ea14a1c21482559109de043

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1450
Approved by: TomSweeneyRedHat",42,26,0,1
"containers/buildah","4efdd3da7310cc685deccf91a290b03f368bb1d6","ypu","2019-11-06 09:18:48","false","Tests: Add image digest test

Signed-off-by: Yiqiao Pu <ypu@redhat.com>

Closes: #2004
Approved by: rhatdan",82,33,0,0
"containers/buildah","06e4cdf64436701df55af56b2cf6deee3a7f76d5","openshift-merge-robot","2022-05-05 14:15:36","true","Merge pull request #3966 from giuseppe/move-nss-load-to-reexec

copier: move NSS load to new process",24,63,1,1
"containers/buildah","8403b6ebc13d936174dc46a91f5259011dc1cc1c","openshift-merge-robot","2022-12-21 08:25:47","true","Merge pull request #4477 from rhatdan/docs

[CI:DOCS] Add documentation for buildah build --pull=missing",19,71,1,1
"containers/buildah","c6cbbb3730e9654383a921c1c4e3a2e2df3eec9a","openshift-merge-robot","2021-04-08 10:18:48","true","Merge pull request #3128 from containers/dependabot/go_modules/github.com/onsi/ginkgo-1.16.0

build(deps): bump github.com/onsi/ginkgo from 1.15.2 to 1.16.0",52,50,0,1
"containers/buildah","2e1bbc2916523b92479864cc7b2627534ddba544","openshift-merge-robot","2021-01-14 09:18:53","true","Merge pull request #2898 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.7.0

build(deps): bump github.com/fsouza/go-dockerclient from 1.6.6 to 1.7.0",94,47,0,1
"containers/buildah","802fc2608e589e4c6a56973a3e613764e30f2eab","openshift-merge-robot","2023-08-01 09:45:26","true","Merge pull request #4949 from containers/renovate/github.com-containers-storage-digest

fix(deps): update github.com/containers/storage digest to c3da76f",13,78,1,1
"containers/buildah","1f1b960989a9f8f50fcedde433328335fe202c3f","openshift-merge-robot","2021-12-06 11:45:22","true","Merge pull request #3664 from containers/dependabot/go_modules/github.com/opencontainers/runc-1.0.3

build(deps): bump github.com/opencontainers/runc from 1.0.2 to 1.0.3",30,58,1,1
"containers/buildah","e9983d8726b938f8d50af2a873efeb3b6d7db0fe","openshift-merge-robot","2022-03-25 08:33:14","true","Merge pull request #3855 from nalind/test-CVE-2022-27651

Add a test for CVE-2022-27651",30,62,1,1
"containers/buildah","4693117a8d9a36cd24ffc6ecb80b65b7b495a611","nalind","2019-02-19 18:50:09","false","Build: resolve copyFrom references earlier

Resolve a possible copyFrom argument to a location before we possibly
call into the imagebuilder Run() method that might call back to our
Copy() method.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1409
Approved by: TomSweeneyRedHat",59,25,0,1
"containers/buildah","94ea377675740eed6752ef6cd2aa1082146252f6","flouthoc","2022-10-01 07:12:02","true","test: warning behaviour for unset/set TARGETOS,TARGETARCH,TARGETPLATFORM

Test buildah's warning behavious for unset or set TARGETOS, TARGETARCH,
TARGETPLATFORM or TARGETVARIANT args when set or unset directly or
indirectly by the user.

Adds missing test for: https://github.com/containers/buildah/pull/4295

Co-authored-by: Ed Santiago <santiago@redhat.com>
Signed-off-by: Aditya R <arajan@redhat.com>",23,68,1,1
"containers/buildah","ad8c2c3694692cc833c34791aa8f92afbe71aa5b","cevich","2022-01-10 16:34:08","true","Cirrus: Run int. tests in parallel with unit

This is somewhat of a band-aid since these two tasks take 45+ minutes
each.  Running them in parallel improves the overall runtime when
tests are otherwise/generally passing.  If/when unit tests fail, the
status won't update until integration tasks complete, but the failure
will be immediately observable in a PR.  So it's a minor price to pay
for improved runtime in the general case.

Signed-off-by: Chris Evich <cevich@redhat.com>",27,59,1,1
"containers/buildah","6542126b9dd0b1d0344b28a6fde5ec2b64cc9a16","cevich","2021-10-01 18:44:55","true","Cirrus: Fix defunct package metadata breaking cache

During VM image build, a number of packages are downloaded but not
installed, since they may interfere with some testing.  Then at runtime,
where required, the packages are installed from cache and used.
However, between image build and runtime it's possible the repository
contents change, which will invalidate the package cache.  Since the
`--no-download --ignore-missing` options were used, the install will
fail.

Ref: https://github.com/containers/automation_images/issues/95

Fortunately, when it comes to the docker packages, no other dependencies
are required and so `apt-get` isn't required.  Switch to using a simple
dpkg install command on the necessary files.  If this ever breaks due
to new dependencies, the list of files may simply be updated.

Signed-off-by: Chris Evich <cevich@redhat.com>",42,56,1,1
"containers/buildah","b18678656344ed735cb39ec5b46209b44dd86b3b","rhatdan","2017-10-25 19:05:52","false","add CONTRIBUTING.md

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",30,9,0,1
"containers/buildah","292569b931ae1acfae4f97a7dcff27559699e715","nalind","2018-06-14 17:49:39","false","Run(): don't set a Pdeathsig for the runtime

Don't try to set the Pdeathsig attribute on the runtime process when we
call the runtime.  Whether we should try to do that is debatable, and it
seems to cause us to interact badly with strace(1).

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #802
Approved by: rhatdan",30,17,0,1
"containers/buildah","f4be6fdc48a74505c1ea5de63962a726b30a4b4a","nalind","2017-03-17 21:29:57","false","Don't mix ""config"" in with ""run"" and ""commit""

Don't mix ""config"" options in with the ""run"" and ""commit"" commands.  It
might have made sense before ""config"" was a separate command, but it
doesn't any more, and it might suggest that settings changed during
""run"" are temporary, when they are not.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","b36ee74affcb6494fedd30889c29e5922277e83f","edsantiago","2022-04-25 14:37:28","false","Ed's periodic test cleanup

Primarily and most importantly, check error messages. You will
see this material again.
 - subnote, find and fix actually broken tests

Second, fix an invalid use of $TESTSDIR ('S' meaning 'Source')

And a few other fixes

Signed-off-by: Ed Santiago <santiago@redhat.com>",25,63,1,1
"containers/buildah","df1bc383407781b5ddbc3a5fdba73c3ddb6abdc7","flouthoc","2023-08-30 06:32:36","true","push: --force-compression should be true with --compression-format

With discussion from here:
https://github.com/containers/podman/pull/19640, it was decided that
`--force-compression` must be automatically `true` in case when
`--compression-format` is set.

Signed-off-by: Aditya R <arajan@redhat.com>",7,79,1,1
"containers/buildah","1fe27bda72656bc75453507a418c3f0a30829a5b","openshift-merge-robot","2022-10-28 18:07:27","true","Merge pull request #4390 from dfr/freebsd-fflags

copier: Preserve file flags when copying archives on FreeBSD",24,69,1,1
"containers/buildah","6e56beae61fbd5fcb16292bf3bef9ab38ed5132f","openshift-merge-robot","2020-12-21 13:30:03","true","Merge pull request #2865 from containers/dependabot/go_modules/github.com/containers/common-0.31.1

build(deps): bump github.com/containers/common from 0.31.0 to 0.31.1",84,47,0,1
"containers/buildah","66431fbe7c02871170fd5ce2b8f9ae17945b9ac7","openshift-merge-robot","2021-01-14 09:10:11","true","Merge pull request #2631 from cevich/new_images

Cirrus: Use images from automation_images",94,47,0,1
"containers/buildah","aedf4068c0200ded43e2d45e8159277dcdf302e2","openshift-merge-robot","2021-07-21 10:30:08","true","Merge pull request #3383 from rhatdan/chown

Chown with environment variables not set should fail",42,54,1,1
"containers/buildah","ab0c1f7c447bfecca35c5461aba5c94dc7d5255f","openshift-merge-robot","2020-10-24 09:12:15","true","Merge pull request #2715 from cherdt/master

Use curl to get repo file (fix #2714)",66,45,0,1
"containers/buildah","d5dc8a33a07df987e5f0432b3f4471fe9b061856","openshift-merge-robot","2022-11-10 05:52:15","true","Merge pull request #4411 from nalind/sticky

copier.Put(): clear up os/syscall mode bit confusion",22,69,1,1
"containers/buildah","a0d32e7fa044edac010b0d64717c119d8ac41c4c","vrothberg","2019-05-29 13:21:48","false","docker/types.go: remove unused struct fields

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1624
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","4e3b64c14898e0983cc7d0fad4d7f50d9ac617ad","vrothberg","2019-06-18 11:26:20","false","testreport: check json error

Reported by golangci-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1678
Approved by: rhatdan",43,29,0,1
"containers/buildah","84580a69bc6adfdca8ece2adcd3e0d81ab78f21a","lsm5","2022-04-12 13:32:15","true","Bump golang.org/x/crypto to 7b82a4e

Resolves: GHSA-8c26-wmh5-6g9v - CVE-2022-27191

Buildah doesn't seem to be directly affected as the logic in question
is not called.

golang.org/x/crypto@1baeb1ce contains the actual CVE fix. Using the
latest upstream commit to also include support for SHA-2.

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",24,63,1,1
"containers/buildah","11ac333d786e0950099c855f348c74e201bb009a","nalind","2019-07-17 21:55:10","false","run.bats: skip the ""z"" flag when testing --mount

When testing the --mount flag, don't add the ""z"" flag as a mount option
when mounting a tmpfs, since relabeling the ""source"" for that case
isn't supported.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",48,30,0,1
"containers/buildah","ce3505a4d7140c1f366efdf94a18e24f2c83c07e","nalind","2017-04-11 20:25:13","false","Internalize some Docker types

Internalize the type declaration of a Docker image, so that we don't
need to pull in code when we just want to know how to parse out a JSON
object.  Carry a copy of the license that covered the sources from which
the definitions came.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #75
Approved by: nalind",13,3,0,1
"containers/buildah","72253654d5cdae80549a00fb77f928473436c23d","nalind","2017-06-26 14:44:26","false","imgtype: don't log at Fatal level

Logging at Fatal calls os.Exit(), which keeps us from shutting down
storage properly, which prevents test cleanup from succeeding.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #162
Approved by: rhatdan",17,5,0,1
"containers/buildah","6a1f29e343fdc492ab2c0ee67796e09b1cef65ba","nalind","2021-01-12 15:23:47","false","Stop overriding the location of the blob info cache

When it was first introduced, the blob info cache's location didn't
change from the system-wide default location when we were running in
rootless mode, so we started setting its location ourselves to avoid
triggering permissions errors when updating it.

The image library has since started taking into account that it was
running in rootless mode, but its hardwired default isn't the same as
the one we were setting, so we ended up creating a second cache file.

Stop doing that.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",93,47,0,1
"containers/buildah","6eea0b9516498b2db3fb4c2319df3c260705123f","nalind","2021-04-27 18:56:20","false","imagebuildah.StageExecutor.volumeCacheSaveVFS(): set up bind mounts

When building with non-overlay drivers, we archive the contents of
volumes before RUN instructions and restore their contents when the RUN
instruction is finished.

The buildah.Run() (""buildah run"") logic defaults to creating a copy of
the contents of built-in volumes and bind-mounting them when running
subcommands, but does not restore the contents afterward because the
rootfs's contents aren't changed.  The rootfs's contents do get changed
by buildah.Add() (""buildah add/copy""), and the volumes go out of sync
with the rootfs because we don't really know what to do then.

The save/restore logic in imagebuildah for non-overlay paths wasn't
adding mounts to the list used by buildah.Run(), so it was continuing to
set up bind mounts even in cases where our cache was invalidated, which
produced this kind of loss of synchronization.  The overlay path wasn't
affected because it adds overlay mounts to the list we pass to
buildah.Run(), and buildah.Run() doesn't override mount points.  So to
avoid this for the VFS methods, add bind mounts to the rootfs, which
we're updating anyway.  They're basically redundant, but they work
around the problem.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",49,51,0,1
"containers/buildah","f2fc0c7e5f372f04ba4f585cf172fcc1906a8163","nalind","2017-03-17 21:36:09","false","Remove single-character aliases for subcommands

Remove the single-character aliases for subcommands.  They were not
popular.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","4d017d6c30d2bb70b8320dfc599190a771e77f04","saschagrunert","2019-08-01 11:13:37","false","Remove GO111MODULE in favor of `-mod=vendor`

When building buildah outside of the `$GOPATH`, then we should stick to
the `-mod=vendor` approach. Other go versions than 1.11 will build on
the classic way, whereas other targets should not be affected at all.
The documentation has been updated as well.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1752
Approved by: rhatdan",46,30,0,1
"containers/buildah","0183471b9368e18c1da48381416a5e6a568ba4e0","cevich","2022-12-06 15:35:18","true","[skip-ci] GHA/Cirrus-cron: Fix execution order

Fairly universally, the last Cirrus-Cron job is set to fire off at
22:22 UTC.  However, the re-run of failed jobs GHA workflow was
scheduled for 22:05, meaning it will never re-run the last cirrus-cron
job should it fail.

Re-arrange the execution order so as to give plenty of time between the
last cirrus-cron job starting, the auto-re-run attempt, and the final
failure-check e-mail.

Signed-off-by: Chris Evich <cevich@redhat.com>",18,70,1,1
"containers/buildah","7724292a4d7a03d189f406663ae80b1f656fcbaa","TomSweeneyRedHat","2020-11-25 01:04:52","false","Allow FROM to be overriden with from option

These changes will allow the ""FROM"" statement in a Containerfile
to be overridden with a new `--from` option.  If I have this Dockerfile.fedora

```
FROM fedora
```

This command will instead build an alpine image:

```
STEP 1: FROM alpine
Completed short name ""alpine"" with unqualified-search registries (origin: /etc/containers/registries.conf)
Getting image source signatures
Copying blob 188c0c94c7c5 done
Copying config d6e46aa247 done
Writing manifest to image destination
Storing signatures
STEP 2: COMMIT tom
--> d6e46aa2470
d6e46aa2470df1d32034c6707c8041158b652f38d2a9ae3d7ad7e7532d22ebe0
```

Addresses: #2404

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",78,46,0,1
"containers/buildah","c845d9108516c0ac8c0f1f033a332d18803baaa6","TomSweeneyRedHat","2018-07-21 19:48:49","false","Add OnBuild test to baseline test

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #878
Approved by: rhatdan",33,18,0,1
"containers/buildah","2d4d28248164f9f8d9be918e94ab03b51a3076cd","slp","2022-06-09 10:06:13","false","run_unix: don't return an error from getNetworkInterface

While networking is not supported on non-Linux systems, many
operations can still succeed if we allow buildah to proceed without a
NetworkInterface object.

To do so, don't return an error from getNetworkInterface.

Signed-off-by: Sergio Lopez <slp@redhat.com>",22,64,1,0
"containers/buildah","93f5f0395e0998880cc5260e5cd7776e6aba0df6","rhatdan","2019-02-26 17:47:07","true","Merge pull request #1369 from vrothberg/vendor-image

vendor containers/image v1.5",61,25,0,1
"containers/buildah","bcc5e51a948c1847fab1c932f1a343696a96cafd","rhatdan","2019-04-29 13:41:18","false","Add support for Overlay volumes into the container.

Overlay mounts allow buildah bud and buildah from to
specify a directory on the disk that will be mounted
as an overlay into the container, where the overlay can be written to
but when the RUN or buildah run exits, the modified files will dissapear.

The basic idea is to be able to mount cache from the disk for things like yum/dnf/apt
to be able to be used and modified in the contianer on a run command, but to be
kept fresh for each RUN.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1560
Approved by: giuseppe",52,27,0,1
"containers/buildah","b4ab0e184e98b298240a896de81b39759561960b","rhatdan","2023-03-17 12:34:07","true","Merge pull request #4663 from cevich/ignore_renovate

Fix requiring tests on Makefile changes",15,74,1,1
"containers/buildah","50a6a566ca6367e2a372615ce6aa24f79c778c7a","rhatdan","2017-09-22 09:41:32","false","Cleanup buildah-inspect code

1. Sort options so they are in alphabet order
2. Remove extra lines of code for options parsing that really do not accomplish anything.
3. Remove variables when they are not necessary, I.E. Don't create a variable to hold an
option that is only used once, use the option instead.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #267
Approved by: <username_without_leading_@>",34,8,0,1
"containers/buildah","c0ba5be959dca30adc807128cd74ed974f9c7762","rhatdan","2023-02-15 02:36:05","true","Merge pull request #4575 from containers/dependabot/go_modules/github.com/containers/image/v5-5.24.1

build(deps): bump github.com/containers/image/v5 from 5.24.0 to 5.24.1",20,73,1,1
"containers/buildah","8d41b836227df2740fff4969e7890ea16df67be7","boaz0","2019-12-28 20:46:05","false","discard outputs coming from onbuild command on buildah-from --quiet

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>

Closes: #2055
Approved by: rhatdan",98,35,0,0
"containers/buildah","fc438bb932e891cbe04109cfae1dfbe3c99307a5","umohnani8","2018-06-13 18:09:45","false","Add --rm and --force-rm to buildah bud

--rm removes all intermediate containers if the build was successful.
If unsuccessful, the intermediate container at which the failure occured
will persist in the container store.
--force-rm removes all intermediate containers even if the build was
unsuccessful.

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #788
Approved by: rhatdan",34,17,0,1
"containers/buildah","af8cb28f84d81ee1bca04c893142cd790b908c75","TomSweeneyRedHat","2018-10-06 21:05:02","false","Fix up Tutorial 3 to account for format

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1073
Approved by: rhatdan",51,20,0,1
"containers/buildah","3fb625dc78b56510468548560fb5dff6cf7002a3","TomSweeneyRedHat","2018-05-12 23:24:59","false","Update troubleshooting with new run workaround

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #683
Approved by: rhatdan",57,16,0,1
"containers/buildah","41e933432181fcf62012f770ec548d27a50b9c82","rhatdan","2021-02-09 19:36:54","false","Vendor in containers/image v5.10.2

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",95,48,0,1
"containers/buildah","3e3721121794f6c5d148f509ccfb36fa0d61587f","rhatdan","2020-10-27 11:08:03","false","build(deps): bump github.com/containers/common from 0.26.0 to 0.26.2

Bumps [github.com/containers/common](https://github.com/containers/common) from 0.26.0 to 0.26.2.
- [Release notes](https://github.com/containers/common/releases)
- [Commits](https://github.com/containers/common/compare/v0.26.0...v0.26.2)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",65,45,0,1
"containers/buildah","d6a8a1800cd7ec2096d407670de093e98b4d7026","rhatdan","2017-03-24 12:31:36","false","Merge pull request #23 from TomSweeneyRedHat/dev/tsweeney/manpages/1

First of several submits for buildah manpages",13,2,0,1
"containers/buildah","65048c85d03a6c304e2d87ce729b356eb70382b6","rhatdan","2021-05-05 19:56:00","false","codespell cleanup

[NO TESTS NEEDED] Only code cleanup

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",51,51,0,1
"containers/buildah","b35ef919acfb783b621a241a26296aff27077cdb","edsantiago","2021-04-27 16:51:47","false","namespaces test - refactoring and cleanup

Followup to #3173 - just a little further cleanup of idmapping
test. Plus, oops, fix a longstanding error-failure bug

Signed-off-by: Ed Santiago <santiago@redhat.com>",49,51,0,1
"containers/buildah","84195b5d9224c215fee2e5507ebdce7f43806773","rhatdan","2021-03-25 17:17:33","false","Fix release.sh to generate good releases

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",51,50,0,1
"containers/buildah","fb60bc4aa3321b7ef28e13f4d16fccdb07a5b68a","rhatdan","2020-10-21 12:24:11","true","Merge branch 'master' into stdin",64,45,0,1
"containers/buildah","60ca4e69143c49c66d01cfd4c9a7d6a86baece2e","rhatdan","2021-05-18 13:38:11","false","update vendor of containers/storage v1.31.1

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",55,52,1,1
"containers/buildah","5e338aadd1da9726623bfbfa8f3570765ca9045e","necrose99","2022-04-22 14:37:51","false","Fix gentoo install docs

app-containers/podman from app-emulation/

Grabbed fix from @necrose99

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",25,63,1,0
"containers/buildah","218bc1b198a9e86143521f53f591f581a90e089b","TomSweeneyRedHat","2018-09-26 17:14:54","false","Update rmi man for prune changes

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1038
Approved by: rhatdan",38,20,0,1
"containers/buildah","085848d5987f764c030d9f8c8ec28e422e007dc1","TomSweeneyRedHat","2019-02-16 00:00:08","false","Remove global flags from cli help

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Emulate the Podman cli help style and don't show the
global flags when you do something like `buildah rmi --help`.
Show them only with `buildah --help`.

Also adjust the Examples slightly to make them work with the
new template that was also lifted from Podman.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1342
Approved by: vrothberg",59,25,0,1
"containers/buildah","c0ca974348487473ff04333d3369ac8f8418b3d8","TomSweeneyRedHat","2018-09-29 17:21:22","false","Add buildah.io to README.md and doc fixes

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",42,20,0,1
"containers/buildah","295b825cdc0795f7e60349b901880e40e9850f5a","TomSweeneyRedHat","2020-09-03 21:01:34","false","Bump to v1.16.0

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",81,43,0,1
"containers/buildah","34026835e002e5b31ae63a9ee13fe54ea94502fd","dfr","2022-06-19 09:17:01","false","Avoid using cgo in pkg/jail

This just copies a few constants from <sys/jail.h>. The FreeBSD ABI is
extremely stable so this is safe.

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","fc3ae53b70cef8d5979adf17b85801ffbd91106e","rhatdan","2022-09-11 12:01:43","false","buildah bud --network=none should have no network

Fixes: https://github.com/containers/buildah/issues/4227

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",20,67,1,1
"containers/buildah","bc8feee6a4f9b86038d16417a98a3dc274867179","jingxiaolu","2019-12-10 03:13:28","false","install.md: update golang dependency

After commit 92ce0bdf, golang dependency for compiling is 1.12 or
higher.

Signed-off-by: Lu Jingxiao <lujingxiao@huawei.com>

Closes: #2013
Approved by: rhatdan",84,34,0,0
"containers/buildah","d63314d737fa65d55e17f80077991229716064ec","rhatdan","2017-10-25 18:28:51","false","Add logos for buildah

Thanks to Máirín Duffy for building these logos for e Buildah project

Patch also fixes references to the project Buildah to be upper case.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",30,9,0,1
"containers/buildah","e59fd7a19de08fb1a219ae4ef157322801d5d6d0","rhatdan","2018-05-19 08:53:36","false","Vendor in latest container/storage for devicemapper support

container/storage now supports devicemapper options that allow you to
configure it.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #712
Approved by: umohnani8",63,16,0,1
"containers/buildah","e588986fa6108f56a09def9c793744667ce47453","mtrmac","2023-07-31 15:36:20","false","Create only a reference when that's all we need

Don't create an ImageDestination only to call .Reference() on it. copy.Image
manages its own ImageSource/ImageDestination instances.

- On the pull path, this causes two ImageDestination objects to exist concurrently
  for the same directory. That's not really expected to work (because the implementation
  caches a modified top-level index in memory); luckily it currently doesn't matter
  because we don't make any writes through the manually-managed object, but it's
  a risk for future changes.
- On the push path, this creates a local object when the thing to push just doesn't exist.

Note that the code calls the input ""sourcePath"" but it can contain a tag, and that
seems to be intentional.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",14,78,1,1
"containers/buildah","bdd27d39372ba5de7e295c67731d2b754ef81e5a","mtrmac","2023-06-13 17:39:12","false","Add smoke tests for encryption CLI helpers

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",13,77,1,1
"containers/buildah","d469df25af5e4dcce7389f7f51aad6e66ac5abc3","openshift-merge-robot","2021-11-30 17:25:33","true","Merge pull request #3658 from nalind/copier-stat-symlink

copier.Put: check for is-not-a-directory using lstat, not stat",30,58,1,1
"containers/buildah","982717a6c2d8906e1a63f9170cc6b0018a6e39e7","openshift-merge-robot","2021-10-13 05:04:57","true","Merge pull request #3585 from ashley-cui/perms

Default secret mode to 400",41,56,1,1
"containers/buildah","c891ebe41e8e33732c4bb8ca23004e7b4f857cc8","openshift-merge-robot","2021-04-09 07:34:05","true","Merge pull request #3133 from nalind/copy-from

CLI add/copy: add a --from option",52,50,0,1
"containers/buildah","cb0c2bae569678a0e85554a059a76c37ab46169a","openshift-merge-robot","2023-07-14 13:23:44","true","Merge pull request #4923 from containers/renovate/github.com-containers-common-0.x

fix(deps): update module github.com/containers/common to v0.55.2",13,78,1,1
"containers/buildah","c044ad633c3508ce43b45110cd618a3038522948","openshift-merge-robot","2021-10-06 21:31:01","true","Merge pull request #3570 from containers/dependabot/go_modules/github.com/containers/image/v5-5.16.1

build(deps): bump github.com/containers/image/v5 from 5.16.0 to 5.16.1",42,56,1,1
"containers/buildah","245695c19129ae9ce0e12eb579cd530c0f9eb4d2","openshift-merge-robot","2022-09-15 16:19:04","true","Merge pull request #4248 from flouthoc/cache-tll-0s

build: make `--cache-ttl=0` equivalent to `--no-cache`",21,68,1,1
"containers/buildah","62bf2e8b8bb529ab1879a7e717aceb60ab74da2f","openshift-merge-robot","2021-05-05 15:14:10","true","Merge pull request #3203 from containers/dependabot/go_modules/github.com/onsi/ginkgo-1.16.2

Bump github.com/onsi/ginkgo from 1.16.1 to 1.16.2",50,51,0,1
"containers/buildah","e824e748fc2fe66f56a25b885244ee5e2c629638","openshift-merge-robot","2022-10-03 13:38:22","true","Merge pull request #4305 from rhatdan/bump-1.28.0

Bump 1.28.0",24,68,1,1
"containers/buildah","5c216525ce820a1c0078cbd8485e95108a507e1b","flouthoc","2021-11-01 10:58:50","true","docs: Use guaranteed path for go-md2man

Its not guaranteed that host contains go-md2man so use the one which is
built by buildah.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",31,57,1,1
"containers/buildah","36b74ad49bb605fffe55a5796284f3647994182b","flouthoc","2021-09-02 10:38:39","false","vendor: bump c/common to v0.43.3-0.20210902095222-a7acc160fb25

Signed-off-by: Aditya Rajan <arajan@redhat.com>",35,55,1,1
"containers/buildah","505c2cabd14935635b6fdae60d2421f06279faf5","openshift-merge-robot","2021-07-14 18:53:01","true","Merge pull request #3373 from rhatdan/parse

Reuse code from containers/common/pkg/parse",41,54,1,1
"containers/buildah","da4647bde31360eee46992141ea00870689b0d5c","nalind","2022-08-10 18:19:19","false","Scrub user and group names from layer diffs

When generating layer diffs or extracting container contents, scrub the
user and group name fields in tar headers before saving them.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",18,66,1,1
"containers/buildah","44fccd796a7edce3a4055bd82e5e6a10fddcc511","openshift-merge-robot","2022-06-06 16:58:18","true","Merge pull request #4034 from flouthoc/spit-logfile-by-platform

build, multiarch: support splitting build logs for `--platform`",23,64,1,1
"containers/buildah","a45582f1e324078afc6cc5fcd494a7c872181ff3","rhatdan","2022-06-07 13:20:41","true","Merge pull request #4040 from containers/dependabot/go_modules/github.com/stretchr/testify-1.7.2

build(deps): bump github.com/stretchr/testify from 1.7.1 to 1.7.2",22,64,1,1
"containers/buildah","e8f6a6d60e427a026cd07830bd6e6c037e35092b","openshift-merge-robot","2020-10-01 16:11:37","true","Merge pull request #2662 from nalind/moar-linters

CI: re-enable several linters",88,44,0,1
"containers/buildah","54fadb034ae9619934cb00a4398be6616a9a3c0a","rhatdan","2020-09-08 20:36:34","false","build(deps): bump github.com/onsi/gomega from 1.10.1 to 1.10.2

Bumps [github.com/onsi/gomega](https://github.com/onsi/gomega) from 1.10.1 to 1.10.2.
- [Release notes](https://github.com/onsi/gomega/releases)
- [Changelog](https://github.com/onsi/gomega/blob/master/CHANGELOG.md)
- [Commits](https://github.com/onsi/gomega/compare/v1.10.1...v1.10.2)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",84,43,0,1
"containers/buildah","840e7dad513b86f454573ad415701c0199f78d30","TomSweeneyRedHat","2020-03-25 00:10:22","false","Fix potential CVE in tarfile w/ symlink

Stealing @nalind 's workaround to avoid refetching
content after a file read failure.  Under the right
circumstances that could be a symlink to a file meant
to overwrite a good file with bad data.

Testing:
```
goodstuff

[1] 14901

127.0.0.1 - - [24/Mar/2020 20:15:50] ""GET / HTTP/1.1"" 200 -
127.0.0.1 - - [24/Mar/2020 20:15:50] ""GET / HTTP/1.1"" 200 -
no FROM statement found

goodstuff
```

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",113,38,0,1
"containers/buildah","d3804fab067dbf864fd7f937148068eb8d4c09f9","rhatdan","2020-03-27 16:57:44","true","Merge pull request #2252 from TomSweeneyRedHat/bump-1.14.5

Bump 1.14.5",115,38,0,1
"containers/buildah","2eab68169360f4b76d008f538e5f45b6c3774359","rhatdan","2020-03-17 13:47:54","false","Update containers/storage to v1.16.5

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",109,38,0,1
"containers/buildah","1828d1362e94fffbaf98d157fa4c0fe0e159514b","rhatdan","2020-02-10 19:08:49","false","Bump github.com/containers/image/v5 from 5.2.0 to 5.2.1

Bumps [github.com/containers/image/v5](https://github.com/containers/image) from 5.2.0 to 5.2.1.
- [Release notes](https://github.com/containers/image/releases)
- [Commits](https://github.com/containers/image/compare/v5.2.0...v5.2.1)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",112,36,0,1
"containers/buildah","6abc01c0f7604361b7179ae861a0e0b2e4867cf9","slinkydeveloper","2019-09-12 10:19:51","false","Added tutorial on how to include Buildah as library

Signed-off-by: slinkydeveloper <francescoguard@gmail.com>

Closes: #1852
Approved by: rhatdan",59,31,0,0
"containers/buildah","2758c71b2594b9f72385d67295732f20f3cbd484","edsantiago","2019-04-03 13:38:25","false","Workarounds for dealing with travis; review feedback

- 'timeout' : remove '-v' option. This was added in coreutils 8.29
  and it looks like travis has an older version. This makes the
  timeout check more fragile because we now rely only on exit
  code = 124. Added FIXME for when/if travis upgrades.

  - also: bump up TIMEOUT from 120s to 300 due to real timeout
    seen in travis CI

  - also: handle exit status 137 - thanks to Chris for catching that

- is() : switch from expr to '[[ ""$string"" =~ ... ]]'.
  Necessary because some travis runs were failing with:
     expr: Argument list too long
  Unfortunate, because expr is nicer, but [[ is a shell
  builtin hence shouldn't be subject to command-line limits.
  Adjust various test expressions as necessary, most notably
  replacing [[:space:]] with ' '.

- secrets.bats : add a teardown() function for removing
  the directories added in setup(); otherwise a failure
  in the test makes subsequent passes fail.

Signed-off-by: Ed Santiago <santiago@redhat.com>

checkpoint

Closes: #1472
Approved by: TomSweeneyRedHat",53,26,0,1
"containers/buildah","0109d21679a888f79f437c67ed101cded03b9d45","nalind","2017-05-22 18:23:50","false","Initialize the builder's annotations from OCI data

If we're building on an OCI image, initialize the Builder object's
annotations using the annotations from the source image.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #116
Approved by: rhatdan",15,4,0,1
"containers/buildah","828df7b054f82b20855a2e6083e7ee4a29c9b2bf","nalind","2017-05-18 15:36:39","false","imagebuildah: Bail out earlier on bad target parse

When we attempt to commit an image, if we encounter an error parsing the
destination location, return an error before logging that we're in the
COMMIT step.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #102
Approved by: rhatdan",15,4,0,1
"containers/buildah","d2c27ab993a94a2f3394e7c3906400a0553687c6","nalind","2018-05-02 16:31:05","false","Run: use a temporary mount namespace

Move the thread that launches the runtime helper into its own OS thread,
have it create its own mount namespace, and bind mount anything that we
want to eventually bind mount into the container, into a subdirectory of
the bundle directory, before running the helper.

When deciding what to bind mount in, make the volumes specified by the
user our highest priority, in case they've been specified in order to
override our default settings for a given location.  This required
breaking up setupMounts() to keep the complexity tests from complaining.

When we use a user namespace with the host IPC namespace, bind mount
/dev/shm and /dev/mqueue instead of mounting fresh copies.
If we're told to use a user namespace with the host PID namespace,
return an error, because that doesn't work.
When we use a user namespace with the host network namespace, bind mount
/sys instead of mounting a fresh one.
When we use the host UTS namespace, don't try to set a hostname.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",48,15,0,1
"containers/buildah","c94073345b6eb61e20900d1cc01021953e19bb72","nalind","2022-07-26 14:17:13","false","cmd/buildah.commitCmd: don't shadow ""err""

Don't shadow the ""err"" variable from the outer scope, since the inner
scope's ""err"" would otherwise always be `nil` where it's wrapped a few
lines later.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",19,66,1,1
"containers/buildah","c34c6d19a56ec044f9100c4ee091d39fdd51cee8","lsm5","2023-06-27 17:18:00","true","Merge branch 'main' into pkg-import",12,77,1,1
"containers/buildah","e8d73b245a91c7fe1189e41f04e7b2dd04422130","TomSweeneyRedHat","2019-02-18 20:30:00","false","Add --all-tags test to pull

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1346
Approved by: nalind",58,25,0,1
"containers/buildah","bf83bc208d17a0a3fc00b0b559280633297f1a63","TomSweeneyRedHat","2017-07-29 19:09:18","false","Add quiet description and touch ups

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #233
Approved by: rhatdan",24,6,0,1
"containers/buildah","68b2aa5810262f4da2430f998e8e49eba3d0b8e2","giuseppe","2019-10-11 12:53:59","true","Merge pull request #1905 from nalind/commit-error-cause

Commit: check for storage.ErrImageUnknown using errors.Cause()",71,32,0,1
"containers/buildah","3941bc928cce5130d3d9484db3429c23538d3e36","nalind","2019-02-06 20:26:03","false","pull.bats: use the temporary directory, not /tmp

Don't use /tmp for temporary files; use the per-test temporary directory.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1326
Approved by: giuseppe",56,24,0,1
"containers/buildah","395f467c319a1b5a4e76e62f9c58cecab2bdbf52","nalind","2021-04-27 18:46:28","false","imagebuildah: drop resolveSymlink()

resolveSymlink() was parsing the combined stdout and stderr from its
child process, which would include warning messages the storage library
printed to stderr during the child process's init() functions.
Instead of fixing just that, drop resolveSymlink() and replace it with a
call to copier.Eval().

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",49,51,0,1
"containers/buildah","7dc787a9c7fc395d80a2446b479b91ed27d72675","TomSweeneyRedHat","2018-01-24 22:49:37","false","Prompt for un/pwd if not supplied with --creds

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",36,12,0,1
"containers/buildah","b05e313ee6cd0885fa121ef492d4d937f4673574","openshift-merge-robot","2022-10-14 08:22:17","true","Merge pull request #4336 from containers/dependabot/github_actions/actions/stale-6

build(deps): bump actions/stale from 1 to 6",26,68,1,1
"containers/buildah","8b63fa37bfea2a1dded0d9a9b6fd23fd4c48eb70","flouthoc","2023-09-22 17:34:15","true","build,config: add support for --unsetlabel

Just like `--unsetenv` following flag allows to unset image label.

Signed-off-by: Aditya R <arajan@redhat.com>",8,80,1,1
"containers/buildah","77a8dfcbc214ab6162a9038ffb5721074ee42dbf","openshift-merge-robot","2023-05-04 08:05:45","true","Merge pull request #4767 from flouthoc/manifest-push-merge-dest

manifest, push: use `source` as `destination` if not specified",9,75,1,1
"containers/buildah","6d1f711072b82c1c5e852c9d659fb454978413a1","rhatdan","2023-02-01 13:36:14","true","Merge branch 'main' into clean-cache-public-wrap",19,72,1,1
"containers/buildah","5cfc0eee3277d33b8bd6a8c685858554795bffb2","rhatdan","2022-10-14 13:43:35","true","Merge pull request #4339 from containers/dependabot/github_actions/actions/upload-artifact-3

build(deps): bump actions/upload-artifact from 2 to 3",26,69,1,1
"containers/buildah","f671e53ee5646d2f2e3626cf1337bfcc0440a8eb","openshift-merge-robot","2022-05-10 20:12:05","true","Merge pull request #3977 from containers/dependabot/go_modules/tests/tools/github.com/golangci/golangci-lint-1.46.0

build(deps): bump github.com/golangci/golangci-lint from 1.45.2 to 1.46.0 in /tests/tools",25,63,1,1
"containers/buildah","0be4f5ee125a5870001289f41a710bcb50fcc27a","naveensrinivasan","2022-03-29 01:03:03","false","Included the URL to check the SHA

Signed-off-by: naveensrinivasan <172697+naveensrinivasan@users.noreply.github.com>",28,62,1,0
"containers/buildah","d629066b30141df9ce02ef63657a37b50bcb7624","giuseppe","2022-03-24 15:29:25","true","vendor: update github.com/openshift/imagebuilder

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",31,62,1,1
"containers/buildah","5d252d404df19f77d26d6af956f4809103ce079f","rhatdan","2022-03-24 17:21:15","true","Merge pull request #3845 from containers/dependabot/go_modules/github.com/docker/docker-20.10.14incompatible

build(deps): bump github.com/docker/docker from 20.10.13+incompatible to 20.10.14+incompatible",31,62,1,1
"containers/buildah","23e2b79062e0e2c7a357ec8a7929094bf2abe6ab","openshift-merge-robot","2021-05-27 09:43:06","true","Merge pull request #3264 from containers/dependabot/go_modules/github.com/onsi/gomega-1.13.0

build(deps): bump github.com/onsi/gomega from 1.12.0 to 1.13.0",36,52,1,1
"containers/buildah","da5576c594cf12db39c3787ecb986dfb9667fdb7","openshift-merge-robot","2021-04-06 13:11:45","true","Merge pull request #3122 from hshiina/systemtest

Add system tests of ""buildah run""",51,50,0,1
"containers/buildah","aa3128e0bbff8268177cc8a99ce9f56e095a4bfb","rhatdan","2020-09-09 19:23:27","true","Merge pull request #2591 from containers/dependabot/go_modules/github.com/onsi/gomega-1.10.2

build(deps): bump github.com/onsi/gomega from 1.10.1 to 1.10.2",87,43,0,1
"containers/buildah","b715fb86ee1c43518879d828fa275142b2a54e4b","rhatdan","2020-08-26 20:56:57","false","Use --timestamp rather then --omit-timestamp

We recieved feedback on the --omit-timestamp that
users would rather specify the timestamp seconds
rather then just use EPOCH.

This PR removes --omit-timestamp from buildah bud
since this has never been released.

We also hide --omit-timestamp from buildah commit
and allow users to continue to use it, but it conflicts
with --timestamp.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",83,43,0,1
"containers/buildah","544f19962f162c5f1ec95854065ed1f309bc3fc3","mariushoch","2020-07-03 10:59:07","false","Ignore OS X specific consistency mount option

Per https://docs.docker.com/storage/bind-mounts/#configure-mount-consistency-for-macos
this is just another way to specify the already ignored
""cached"" and ""delegated"" mount options.

Signed-off-by: Marius Hoch <hoch.m00@gmail.com>",146,41,0,0
"containers/buildah","9fd14e650469b623a634511ba93a1528574522e9","rhatdan","2020-06-23 10:32:27","true","Merge pull request #2421 from TomSweeneyRedHat/dev/tsweeney/addcolon

docs: clarify the 'triples' format",143,41,0,1
"containers/buildah","2d437a4f2326d12517b7ee659e1ac5729b4af532","giuseppe","2020-05-20 20:54:20","true","vendor: update seccomp/containers-golang to v0.4.1

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",134,40,0,1
"containers/buildah","7d1b6be2052db30b1628363b82baa5a20df8066f","rhatdan","2018-10-22 16:31:51","true","Merge pull request #1102 from rhatdan/vendor

Moving selinux reservations into container storage.",53,21,0,1
"containers/buildah","934ce1e997eeeb0efa39943000797cdab7a09325","TomSweeneyRedHat","2020-03-25 22:19:56","false","Bump to v1.14.4

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",113,38,0,1
"containers/buildah","bccb5abf4952269396c0d8dad7bf56bf68f9dbff","rhatdan","2020-03-13 13:58:48","false","Fix compilation errors on non linux platforms

This fixes a compilation issue when Buildah is vendored
into Podman.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",108,38,0,1
"containers/buildah","fabbaef8fba5c038e2f4c158957fd0b64363fa0e","TomSweeneyRedHat","2020-03-13 21:41:38","false","Update unshare man page to fix script example

The example showing how to use unshare to mount a volume
was no longer working.  Updated to make it work.

Fixes: #2218

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",108,38,0,1
"containers/buildah","6e277a2d8f4af200197d02a126f92351c2b15e21","saschagrunert","2020-01-21 14:53:29","false","Fix build for 32bit platforms

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #2100
Approved by: rhatdan",105,36,0,1
"containers/buildah","a2bb63d1e817721676b197f1207b276996a70a31","rhatdan","2019-10-01 08:50:22","true","Merge pull request #1876 from giuseppe/add-cgroups-info

info: add cgroups2",66,32,0,1
"containers/buildah","0ab77a30cf59deb431f41c38300ad75797f61a36","rhatdan","2018-07-17 17:12:57","true","Merge pull request #863 from rhatdan/vendor

Update vendor for runc to fix 32 bit builds",31,18,0,1
"containers/buildah","8e3d7afde9ff6cd6fc392940f8403bb45bf8a859","vbatts","2018-08-02 17:30:07","false","buildah: no args is out of bounds

```shell
[root@abfcfc8928df /]# buildah
panic: runtime error: index out of range

goroutine 1 [running]:
main.maybeReexecUsingUserNamespace(0xc4200f62c0, 0xc73d00)
        /home/vbatts/src/github.com/projectatomic/buildah/cmd/buildah/unshare.go:63 +0x179a
main.main.func1(0xc4200f62c0, 0xcb1d88, 0xc4202861c0)
        /home/vbatts/src/github.com/projectatomic/buildah/cmd/buildah/main.go:85 +0x9c
github.com/projectatomic/buildah/vendor/github.com/urfave/cli.(*App).Run(0xc4202861c0, 0xc42001e1b0, 0x1, 0x1, 0x0, 0x0)
        /home/vbatts/src/github.com/projectatomic/buildah/vendor/github.com/urfave/cli/app.go:244 +0x738
main.main()
        /home/vbatts/src/github.com/projectatomic/buildah/cmd/buildah/main.go:120 +0xe22
```

Signed-off-by: Vincent Batts <vbatts@hashbangbash.com>

Closes: #903
Approved by: rhatdan",29,18,0,0
"containers/buildah","300a460055514e605865f116b145dd4a12073be2","vrothberg","2021-05-18 08:02:48","false","update c/common

Update containers common to the latest HEAD.  Some bug fixes in libimage
forced us to have a clearer separation between ordinary images and
manifest lists.  Hence, when looking up manifest lists without recursing
into any of their instances, we need to use `LookupManifestList()`.

[NO NEW TESTS NEEDED]

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",54,52,1,1
"containers/buildah","db6e7bbf413ba7c6666979b3b9eed509903e609d","nalind","2019-02-07 21:19:24","false","Make ""images --all"" faster

Computing imageIsParent() for every image can get expensive,
and if --all was specified, it's entirely unnecessary.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1352
Approved by: rhatdan",56,24,0,1
"containers/buildah","002c88e256414df858a1050e6a028aac9d905c77","nalind","2020-11-12 18:56:34","false","Run: don't forcibly disable UTS namespaces in rootless mode

I can't remember why we disabled UTS namespaces for rootless isolation,
but it doesn't look necessary.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",72,45,0,1
"containers/buildah","262b43a86672088ae9e50c51ee8ae8f4984cd7f0","nalind","2017-07-28 21:29:37","false","Improve ""from"" behavior with unnamed references

Fix our instantiation behavior when the source image reference is not a
named reference.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #235
Approved by: rhatdan",24,6,0,1
"containers/buildah","b7e9966fb2637027cf49778a738bf8813087fdfd","nalind","2017-07-24 13:53:19","false","Make sure that we can build an RPM

Add a CI test that ensures that we can build an RPM package on the
current version (as of this writing, 26) of Fedora, using the .spec file
under contrib.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #208
Approved by: jlebon",20,6,0,1
"containers/buildah","95312390d7afac2ee9a5654d5d70c84244681071","nalind","2017-03-21 18:26:00","false","Use chrootarchive to head off tar shenanigans

Use the chrootarchive package instead of the archive package in the
implementation of ""add"", in an attempt to avoid problems with tarballs
with unusual paths in their headers.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",11,2,0,1
"containers/buildah","761597056c8dc2bb1efd67e937a196ddff1fa7a6","nalind","2017-03-29 19:50:32","false","Add a few tests for building images

It's nowhere near exhaustive, but it's a start.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #59
Approved by: rhatdan",14,2,0,1
"containers/buildah","12dcf7176a381bdd792e2f580cec061cf24b9d0b","nalind","2021-11-11 22:10:47","false","""commit"": fix a flag typo

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",28,57,1,1
"containers/buildah","c2e90cd3d2031b6da6d879be2a0139210d412c7d","dilyanpalauzov","2021-06-18 10:50:37","false","buildah add/copy: spelling

Insisting on “DCO” imposes formalities, that serve self-purpose.  One cannot
assume that the submitter has time or will to read texts about symbolism in
software contributions.  If the system wants to see the text

    nrEAUIEUAIe eanuitdnuae EAIUEAUIAIE »ℓ§444.3.72b)°»°ℓ§euaieauuae

in each commit, people will write this, or any other text, that the system wants to
see.  All such text, which presence is mandated by the system, has the same value.

Signed-off-by: Дилян Палаузов <git-dpa@aegee.org>",40,53,1,0
"containers/buildah","74e0b6fde97ee9cad8dfde26dbd0ec2c7a8c2802","vdemeester","2018-11-08 10:31:14","false","Update imagebuild depdency to support heading ARGs in Dockerfile

Signed-off-by: Vincent Demeester <vdemeest@redhat.com>

Closes: #1128
Approved by: TomSweeneyRedHat",62,21,0,0
"containers/buildah","174cf8963fa198a658ef55954670fa79bc78fac3","cevich","2021-04-26 15:33:50","true","Cirrus: Update Ubuntu images to 21.04

Also simplify `lib.sh` after supporting changes incorporated
into automation library 2.x+ (present in all VM and container
images).

* No need to force-load `/etc/profile` and handle it's expectation
  to **not** being in `errexit` mode.
* Slightly re-arrange loading of automation library files for
  clarity.
* Remove dependency on updating `/etc/environment` for GPG.
* Remove redundant showrun() function (now present in automation
  library)
* Update comments.

Signed-off-by: Chris Evich <cevich@redhat.com>",49,51,0,1
"containers/buildah","a9895bd41d742117f3480a620a466a363e3d3165","rhatdan","2018-07-16 18:20:37","false","Update CHANGELOG.md

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #865
Approved by: TomSweeneyRedHat",31,18,0,1
"containers/buildah","3446328c7759d96c78df7126abf61a850081ee29","rhatdan","2021-02-08 23:06:30","false","build(deps): bump github.com/containers/common from 0.34.0 to 0.34.2

Bumps [github.com/containers/common](https://github.com/containers/common) from 0.33.1 to 0.34.2.
- [Release notes](https://github.com/containers/common/releases)
- [Commits](https://github.com/containers/common/compare/v0.33.1...v0.34.2)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",94,48,0,1
"containers/buildah","7a5fee078eed76e3be6d86cf5ac5799fa092b477","rhatdan","2018-06-24 11:44:41","false","Switch from using docker to podman for testing in .papr

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #812
Approved by: giuseppe",29,17,0,1
"containers/buildah","20a33e0791eaeb4f13e23afba5cc73ad3e37bbe7","rhatdan","2019-09-06 19:07:18","false","Add --devices flag to bud and from

Some Dockerfiles (fuse-overlay) require additional devices to be in the
build environment.

This patch allows the user to specify additional devices.

Also I noticed that CapAdd and CapDrop was not working in buildah bud situations,
so this patch also fixes this.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1820
Approved by: @TomSweeneyRedHat",60,31,0,1
"containers/buildah","fd2a215948bd20f3629dfe86c6a2ec8902e77dea","mtrmac","2018-08-04 02:14:03","false","Improve reporting about individual pull failures

Instead of just using multierror to collect the error strings (and hope that they
contain enough context about the attempted image names), explicitly collect pairs of
(attempted image name, error).

Then, report an appropriate error text depending on the failures and environment.

Notably, if there was only one attempt (e.g. a fully-qualified name), just report
the error with minimal context, instead of adding extra ""1 error occurred:\n\n"".

If search registries were used and empty, note that in the error message (now
for real).

Also, make sure we return _some_ error if util.ResolveName ever returned
an empty list for osome reason.

It seems fairly attractive now to split resolveImage into the outer loop
and a separate function for making one attempt, to consolidate the
repetitive failures = append(...) code.  OTOH that would force us to add
another return value as a ""fatal"" indication.  Maybe later.

NOTABLY CHANGES BEHAVIOR:
- Changes the error format.
- Restores more detailed error reporting if we have no search registries,
  but had multiple candidates anyway, which was given up in the previous commit.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #909
Approved by: rhatdan",22,18,0,1
"containers/buildah","39d05822043fd247c5e7b0cc7a93552a71412ed2","KyleRConway","2018-06-07 04:46:10","false","Update 01-intro.md

Adding command to explicitly become root user. I was trying to run commands with ""sudo"" in front and thus had issues following guide (new user) and this would have helped! Thanks!

Signed-off-by: Kyle R. Conway <kyconway@tower.Home>

Closes: #763
Approved by: rhatdan",32,16,0,0
"containers/buildah","5a25fc6f83d56c5ab1b3b526fe4daeed6498d4c9","giuseppe","2022-01-26 10:05:22","true","overlay: move mount program invocation to separate function

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",34,60,1,1
"containers/buildah","c3b1ec6be721097a04b5d817c72f9c452faebc72","nakato","2019-09-19 23:06:23","false","Fix travis-ci on forks

When attempting to run travis-ci on a fork of this repo, due to the
organisation name changing the CI job will fail with a rather
bewildering error about ""no go files""

Looking closely it becomes apparent that the path being used is not
GOROOT/src/github.com/containers/buildah but
GOROOT/src/github.com/FORKNAME/buildah, which results in the inability
to run the tests.

To solve this issue the travis-ci go_import_path can be set to ensure
the checkout path is correct, resulting in the ability to ensure CI will
succeed before making a PR.  As this sets the path to be the same as
the primary repository it has no effect on the primary repository.

https://docs.travis-ci.com/user/languages/go/#go-import-path

Signed-off-by: Sachi King <nakato@nakato.io>

Closes: #1866
Approved by: rhatdan",63,32,0,0
"containers/buildah","fcb2f13aef4b577470469b91b77993af33030bf4","openshift-merge-robot","2021-04-29 19:11:49","true","Merge pull request #3191 from cevich/update_f34

Cirrus: Update F34beta -> F34",50,51,0,1
"containers/buildah","75ae8be258fa689e2aa79f8c40d5b59620e4740a","openshift-merge-robot","2020-12-02 20:21:13","true","Merge pull request #2824 from QiWang19/add-local-manifest

Not use local image create/add manifest",79,46,0,1
"containers/buildah","d0af90d891af25f05e25dfa1584de4aaeeec7b08","openshift-merge-robot","2021-02-01 11:41:53","true","Merge pull request #2950 from alvistack/master-linux-amd64

Update nix pin with `make nixpkgs`",94,48,0,1
"containers/buildah","e6d29d29f9b1b4ad820a24590b64755367c2a1eb","cevich","2021-06-15 19:49:54","true","[CI:DOCS] Fix links to c/image master branch

Signed-off-by: Chris Evich <cevich@redhat.com>",37,53,1,1
"containers/buildah","be9ef3b6023778edc65b86d5b5b18ae51da619ad","TomSweeneyRedHat","2022-06-04 22:23:42","false","[CI:BUILD] WIP Cleanup Image Dockerfiles

Cleans up the Dockerfiles for the buildah images that land on quay.

A number of readability changes, and an adjustment to sed to
handle storage.conf.

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",23,64,1,1
"containers/buildah","cdcaaf51b37d14cd160c046a8eaf02201699eb74","TomSweeneyRedHat","2022-03-25 13:50:49","false","Bump to v1.25.0

[NO NEW TESTS NEEDED]

As the title says.

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",28,62,1,1
"containers/buildah","b89fca69cbb167f30682ba1dbff6437f2900f237","nalind","2018-10-11 20:51:18","false","bump(github.com/containers/image)

Update github.com/containers/image to version
5e5b67d6b1cf43cc349128ec3ed7d5283a6cc0d1, which returns the new image's
manifest when we copy an image from one place to another.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1097
Approved by: rhatdan",53,20,0,1
"containers/buildah","2a3a956cbb9b6f1c29082b1033b090ad7cfe9c4f","nalind","2023-10-04 21:07:30","false","chroot.setupChrootBindMounts: pay more attention to flags

Pay better attention to dev/nodev/exec/noexec/suid/nosuid/ro/rw flags on
bind, overlay, and tmpfs mounts when any of them are specified.  Stop
quietly adding ""nodev"" when it isn't asked for.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",6,80,1,1
"containers/buildah","80bdad0ec3233d5af97df1f6923e19ce8f49bd44","rhatdan","2023-06-08 11:13:12","true","Merge pull request #4857 from containers/renovate/github.com-onsi-gomega-1.x

fix(deps): update module github.com/onsi/gomega to v1.27.8",15,76,1,1
"containers/buildah","11a1f66a62707f3815d1937a9ef67d3e67f650c8","openshift-merge-robot","2023-05-10 11:14:10","true","Merge pull request #4785 from containers/renovate/golang.org-x-crypto-0.x

fix(deps): update module golang.org/x/crypto to v0.9.0",11,75,1,1
"containers/buildah","9133547b7b95e756c696729332df57a21b4b325d","rhatdan","2023-01-25 13:24:26","true","Merge pull request #4539 from containers/dependabot/go_modules/github.com/onsi/gomega-1.26.0

build(deps): bump github.com/onsi/gomega from 1.25.0 to 1.26.0",19,72,1,1
"containers/buildah","4f8706bb3e15a18a64567e7fc3feb9a37bc2e1a4","openshift-merge-robot","2023-01-18 12:05:08","true","Merge pull request #4517 from rhatdan/regex

vendor in latests containers/(storage, common, image, ocicyrpt)",22,72,1,1
"containers/buildah","b290c861720dbd0dbb5e2805888220c6ffe83960","dfr","2022-06-15 11:12:08","false","Move fileCloser, waitForSync and contains to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","85d98412bdec390838217dd1da7edf349673300e","openshift-merge-robot","2021-08-20 09:36:23","true","Merge pull request #3464 from containers/dependabot/go_modules/github.com/containers/image/v5-5.15.2

build(deps): bump github.com/containers/image/v5 from 5.15.1 to 5.15.2",39,55,1,1
"containers/buildah","2412e804bcf936c35c4a607a2f6dc4f283b9807e","openshift-merge-robot","2021-06-18 15:17:31","true","Merge pull request #3317 from rhatdan/excludes

buildah copy and buildah add should support .containerignore",40,53,1,1
"containers/buildah","e9a875b7692e7166f7649e3ac4835f0a289fc4c0","rhatdan","2021-05-26 18:16:25","false","Add volumes to make running buildah within a container easier

[NO TESTS NEEDED] Since this is just changing Dockerfiles for use on
quay.io.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",37,52,1,1
"containers/buildah","4ae183bec4c3990537b78236142b88f1f8f76608","barthy1","2021-02-03 15:48:33","false","Add multi-arch image build

Add Github Action to do multi-arch build for 4 architectures(amd64,
s390x, ppc64le, arm64) from 2 sources - contrib/buildahimage/stable and
contrib/buildahimage/upstream.
The multi-arch image build is done via emulation (no real hardwarer is
required).
New images are built after each push to master branch and once in a day
on schedule.
stable image is pushed to `quay.io/buildah/stable:v..` and `quay.io/containers/buildah:v..`
upstream image is pushed to `quay.io/buildah/upstream:master`
`CONTAINERS_QUAY_USERNAME` and `CONTAINERS_QUAY_PASSWORD`, as well as
`BUILDAH_QUAY_USERNAME` and `BUILDAH_QUAY_PASSWORD` should be created in
advance.

Signed-off-by: Yulia Gaponenko <yulia.gaponenko1@de.ibm.com>",96,48,0,0
"containers/buildah","777256bd518f726319ac30fa200c3953035e4ac9","giuseppe","2020-10-27 14:31:35","true","overlay: use fusermount for rootless umounts

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",65,45,0,1
"containers/buildah","ba64ef0e903b8128c5e75b68aeed2b2eac76bebb","rhatdan","2020-09-16 11:54:23","true","Merge pull request #2617 from containers/dependabot/go_modules/github.com/containers/storage-1.23.5

build(deps): bump github.com/containers/storage from 1.23.4 to 1.23.5",91,44,0,1
"containers/buildah","9c508d8f39320ed96025fbbb6d663c66cca2b5bf","rhatdan","2020-08-25 11:15:43","true","Merge pull request #2563 from containers/dependabot/go_modules/github.com/containers/common-0.20.3

build(deps): bump github.com/containers/common from 0.19.0 to 0.20.3",83,43,0,1
"containers/buildah","69f735be1f5452ea8d148ec97aeac86e0284ba0a","rhatdan","2020-08-04 17:54:08","false","Add documentation for .dockerignore

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",134,42,0,1
"containers/buildah","36f4b8f7faa78f012302ebc29d8c47108f62b43e","nalind","2020-07-14 20:34:07","false","Add the ""copier"" package

Add new primitives for reading and writing data, represented as tar
streams, from and to possibly-chrooted directories via subprocesses.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",147,42,0,1
"containers/buildah","25e7813ea7179994848b84306cea0c4f4877c538","rhatdan","2020-02-19 12:51:00","true","Merge pull request #2148 from cevich/minor_bors_fix

Cirrus+Bors: Simplify temp branch skipping",97,37,0,1
"containers/buildah","e7be041dad55c8c8209fcd4b1e22cc5f0de48b5a","vrothberg","2020-01-07 09:53:02","false","update openshift/api

Update the openshift/api dependency to the latest commit. Several users
have reported that the go.mod couldn't be parsed, which should now be
fixed.

Fixes: #2042
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #2066
Approved by: rhatdan",100,35,0,1
"containers/buildah","4ce6fbaea4c2e028a3dcb59475d05a68c6e6cef1","rhatdan","2019-09-13 10:19:53","false","Add some cleanup code

Missing cleanup for buildah.darwin and test program.
Also it is common to have random Dockerfiles in homedir so gitignore them.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1855
Approved by: TomSweeneyRedHat",61,31,0,1
"containers/buildah","d3cbd41fcb171936b8e5f15da218e7d498ed15fc","flouthoc","2022-05-02 19:41:31","true","vendor: bump imagebuilder to master/009dbc6

Use imagebuilder which sets correct behaviour for default builtinargs
while processing inline `FROM --platform=` after openshift/imagebuilder#224

Signed-off-by: Aditya R <arajan@redhat.com>",24,63,1,1
"containers/buildah","fc69aa68c23b32df5ab73726dcee88bf1add72c6","flouthoc","2021-10-07 08:27:17","true","buildkit: add support for mount=type=cache

Following PR inroduces a new mount type=cache in parity to buildkit
which allows users to share persistant cache between different builds.

Allowing users to cache content generated by bussiness logic or enhance
build performance by caching components across builds.

Signed-off-by: Aditya Rajan <arajan@redhat.com>",42,56,1,1
"containers/buildah","bf372e30621d47e038b40e701f142f2f2fc1b2ab","openshift-merge-robot","2021-07-12 14:45:55","true","Merge pull request #3372 from containers/dependabot/go_modules/github.com/containers/storage-1.32.6

build(deps): bump github.com/containers/storage from 1.32.5 to 1.32.6",39,53,1,1
"containers/buildah","36995bc48cf503460c7883b9ef6e2c092dd62ff5","openshift-merge-robot","2022-01-10 19:09:08","true","Merge pull request #3696 from vrothberg/vendor-common

vendor c/common",28,59,1,1
"containers/buildah","43a025ebf98f77224ea4ffd58d0716be2f4470af","mairin","2017-12-12 15:48:09","false","updating logo reference in README

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Removing old 'underwear hat' logo, replacing with updated logo artwork

Closes: #359
Approved by: rhatdan",32,10,0,0
"containers/buildah","724fa97c13b2c863cb287e2c015cba2b0e0d569f","saschagrunert","2020-02-04 14:46:34","true","Update containers/common to v0.1.4

This fixes the 32 bit build issue.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>",110,36,0,1
"containers/buildah","99e9744a8ff1561629c80bf7f4fce7383b3b1a33","cevich","2020-02-06 15:23:55","true","Stop using fedorproject registry

Also drop registry.access.redhat.com since it should no longer be used.

Signed-off-by: Chris Evich <cevich@redhat.com>",110,36,0,1
"containers/buildah","fc9255f56c065b39e0faaa9b7d399258bce42ba1","cevich","2022-07-01 13:38:25","true","GHA: Allow re-use of Cirrus-Cron fail-mail workflow

Github-actions has (finally) added a mechanism for re-using workflows
from other repositories.  Rather than duplicate the Cirrus-Cron failure
notification workflow everywhere, allow re-using it from here.  As per
the docs, it's required to declare all the incoming secret variable
names which are supplied by the caller.  Do that.

Signed-off-by: Chris Evich <cevich@redhat.com>",22,65,1,1
"containers/buildah","40325d3e31cae9b2332a7e61d715c0687b4ce8fa","pixdrift","2018-05-18 13:49:49","false","Additional bud CI tests

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #702
Approved by: rhatdan",62,16,0,0
"containers/buildah","fc7329d7c821796924616af1dbaebd6eba5019f1","aaerrolla","2023-08-05 07:15:28","true","Update install.md

updated Debian install instructions  to reflect current stable Debian version and name which is  Debian 12 Bookworm

Signed-off-by: Anjaneyulu Aerrolla <aaerrolla@gmail.com>",11,78,1,0
"containers/buildah","36fca902320953664c940cb398144d811695dcc8","openshift-merge-robot","2021-04-22 17:34:28","true","Merge pull request #3148 from vrothberg/new-image-package

use new containers/common/libimage package",49,51,0,1
"containers/buildah","c60c57a058f1d886f9c08cc3cb5d108284ad8cd7","cevich","2020-01-16 16:41:51","true","Allow passing options to golangci-lint

Signed-off-by: Chris Evich <cevich@redhat.com>",99,36,0,1
"containers/buildah","99f733350dcc0d1d411f656005f8a390f0e1f3bb","TomSweeneyRedHat","2021-04-13 21:56:58","false","Bump to v1.20.1

As the title says.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",52,51,0,1
"containers/buildah","3d4f4a398c9d5ebd2be97ed696eb7b01d2e9ff02","openshift-merge-robot","2023-08-12 03:06:51","true","Merge pull request #4971 from lsm5/main-rpm

[CI:BUILD] RPM: fix buildtags",9,78,1,1
"containers/buildah","1accccec61c3166abf6a2f84f3587787fc1cf25a","rhatdan","2018-06-27 09:16:55","false","Vendor in latest imagebuilder

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #830
Approved by: nalind",28,17,0,1
"containers/buildah","80ca77674cb4d6ac13f0fde6465a19252f313426","nalind","2017-05-23 22:04:13","false","Tweak volume handling in Run()

Make sure that we don't mount a tmpfs in volume locations where Run()
has been told to mount something else.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #121
Approved by: rhatdan",15,4,0,1
"containers/buildah","01a148a00b53181b7fd5cbb10b4f0d84000a0e89","nalind","2017-03-07 20:54:51","false","Fixup cleanliness in tests

Clean up the tests so that data files that we generate don't get dropped
in the root directory of the host, or in a part of ${TMPDIR} that we
won't clean up.  Add tests to exercise ""add""'s extracting logic.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",7,1,0,1
"containers/buildah","da7be327375a75d33b58df1ac979da051a94b39e","nalind","2018-06-15 16:28:03","false","Use the right formatting when adding entries to /etc/hosts

Append address+""\t""+hostname to the hosts file instead of the
""hostname:address"" format that we picked up from the command line.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #798
Approved by: rhatdan",30,17,0,1
"containers/buildah","eca2a67a47c8a17501a28cf6e8d74b1a88b615a9","nalind","2017-01-27 11:29:37","false","Rough out the beginnings of v1 config updates

Rough out simple image configuration edits, though apparently there's
more out there than just OCI v1.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,0,0,1
"containers/buildah","78dcf2fdaf14b9cbf2f5131b2c779452c36de151","QiWang19","2019-06-10 19:31:50","false","fix bug --cpu-shares parsing typo

close #1464

fix the paring typo cpu-shared of --cpu-shares.
fix expect value in from.bats

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1662
Approved by: TomSweeneyRedHat",43,28,0,1
"containers/buildah","da00c99dbe4aa25bb6d45b00e76a7080c535a09c","openshift-merge-robot","2022-01-18 11:42:06","true","Merge pull request #3718 from containers/dependabot/go_modules/github.com/opencontainers/runc-1.1.0

build(deps): bump github.com/opencontainers/runc from 1.0.3 to 1.1.0",32,60,1,1
"containers/buildah","ecbb6519b4c6a7b11a0c4949ed055f2a84e2f2dc","openshift-merge-robot","2021-03-13 10:47:40","true","Merge pull request #3075 from giuseppe/fix-squash-with-sockets

copier: ignore sockets",60,50,0,1
"containers/buildah","794c609a54f3b8451db87ab05fcfd4dbad3ee81e","openshift-merge-robot","2022-07-27 09:45:03","true","Merge pull request #4141 from cevich/main_latest_imgts

Cirrus: Use the latest imgts container",19,66,1,1
"containers/buildah","ed9e71d6cbd3479e640faa1f1e00243791b21435","openshift-merge-robot","2022-05-18 12:46:59","true","Merge pull request #3978 from flouthoc/buildkit-add-support-for-additional-context

buildkit, build: add support for `additionalBuildContext` in builds via `--build-context`",25,64,1,1
"containers/buildah","a1a49bcca6cb6a7f330387ab12d203e2f3716606","openshift-merge-robot","2023-03-30 10:39:01","true","Merge pull request #4683 from containers/renovate/actions-stale-8.x

[skip-ci] Update actions/stale action to v8",12,74,1,1
"containers/buildah","467acc3184c4fb9267e023529c6cd974a897ae41","openshift-merge-robot","2020-10-21 13:36:36","true","Merge pull request #2700 from containers/dependabot/go_modules/github.com/containers/common-0.26.0

build(deps): bump github.com/containers/common from 0.25.0 to 0.26.0",64,45,0,1
"containers/buildah","6bc611d34be6a8a2d729e62556fb2d02ebe0792f","openshift-merge-robot","2021-06-24 14:53:10","true","Merge pull request #3329 from mheon/add_defaultnet

Add support for default network creation",37,53,1,1
"containers/buildah","a5e1775864de5bb98b6119b66cbd048719ffceaa","flouthoc","2023-01-04 04:31:37","true","vendor: bump c/storage to a747b27

CI in other projects which uses podman is blocked because of missing containers/storage#1455 Update c/storage to a747b27 so it contains patch from containers/storage#1455

[NO NEW TESTS NEEDED]
[NO TESTS NEEDED]

Closes: https://github.com/containers/buildah/issues/4494

Signed-off-by: Aditya R <arajan@redhat.com>",21,71,1,1
"containers/buildah","d88807e4a662f5b1413530a9279d018382ceb05f","vrothberg","2018-12-20 12:41:30","false","blobcache.bats: adjust explicit push tests

Remove error-prone parts of the explicit push tests that push to a
directory without using the blob-cache.  The proneness relates directly
to the fact that the layers of pulled images (i.e., the busybox base
image) are compressed with another gzip library the blobs in Buildah's
cache, which now use pgzip.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",53,23,0,1
"containers/buildah","40de922dd7bf5b169c77cf223a65a03e4a5b4de7","nalind","2018-05-04 18:17:12","false","Update github.com/projectatomic/libpod

Update and pin github.com/projectatomic/libpod to version
e686269da34ed4208f4ed517c0587ab38e8eaf2c, which adds
SecretMountsWithUIDGID to its secrets package.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #704
Approved by: rhatdan",51,15,0,1
"containers/buildah","b37c4ee438795ec6f380354767074e53e89b47f1","flouthoc","2023-04-25 09:46:47","true","build: --platform must accept only arch

Make error message for `--platform` more clear and use
`platforms.Parse(` so `--platform` can automatically detect `OS` if not
specified.

Closes: https://github.com/containers/podman/issues/18194
Closes: https://github.com/containers/buildah/issues/4756

Signed-off-by: Aditya R <arajan@redhat.com>",12,75,1,1
"containers/buildah","784a8c4ce26f2911dd3812bd8cf36d5db9814c24","flouthoc","2022-05-13 07:15:49","true","build: accept branch and subdirectory when context is git repo

When using `build -t <tag> <some-url-to-git-repo>` buildah does not
accepts syntax `url#branch:subdir` following commit allows end users to
switch context to any subdirectory in the git repo.

Usage
```console
buildah build -t test 'https://github.com/containers/podman.git#main:contrib/hello'
```

Signed-off-by: Aditya R <arajan@redhat.com>",27,64,1,1
"containers/buildah","6dd0b043f5409bb8205fb4b2a7e88319de157676","umohnani8","2018-10-10 17:00:33","false","Vendor latest containers/image

Catches more errors when checking for login credentials.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>

Closes: #1082
Approved by: rhatdan",53,20,0,1
"containers/buildah","5eb356bb8b7d3c4464c387848dce3950c4d31c12","kolyshkin","2023-06-02 23:31:09","false","docs/Makefile: don't show sed invocations

When running `make`, about 99% of the output looks like this:

sed -e 's/\((buildah[^)]*\.md\(#.*\)\?)\)//g' \
 -e 's/\[\(buildah[^]]*\)\]/\1/g' \
 -e 's/\[\([^]]*\)](http[^)]\+)/\1/g' \
 -e 's;<\(/\)\?\(a\|a\s\+[^>]*\|sup\)>;;g' \
 -e 's/\\$/  /g' buildah-unshare.1.md  | \
../tests/tools/build/go-md2man -in /dev/stdin -out  buildah-unshare.1
sed -e 's/\((buildah[^)]*\.md\(#.*\)\?)\)//g' \
 -e 's/\[\(buildah[^]]*\)\]/\1/g' \
 -e 's/\[\([^]]*\)](http[^)]\+)/\1/g' \
 -e 's;<\(/\)\?\(a\|a\s\+[^>]*\|sup\)>;;g' \
 -e 's/\\$/  /g' buildah-version.1.md  | \
../tests/tools/build/go-md2man -in /dev/stdin -out  buildah-version.1

As much as I love sed, this is not what I would want to stare at in
CI logs etc.

Signed-off-by: Kir Kolyshkin <kolyshkin@gmail.com>",17,76,1,0
"containers/buildah","a0d803e4b057887d6109a130f00d94520bbcd689","rhatdan","2018-08-01 12:07:11","false","Vendor in latest github.com/containers/{image;storage}

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #894
Approved by: TomSweeneyRedHat",31,18,0,1
"containers/buildah","a792674240dc57abeffe0d3f310f540bf5f87cdc","rhatdan","2022-09-19 17:02:08","true","Merge pull request #4205 from rhatdan/stutters

Fix stutters",19,68,1,1
"containers/buildah","d340004e61b12f160255ebec0677b8bf34a39e14","rhatdan","2022-11-04 10:15:45","true","Merge pull request #4394 from containers/dependabot/go_modules/github.com/onsi/gomega-1.24.0

build(deps): bump github.com/onsi/gomega from 1.23.0 to 1.24.0",23,69,1,1
"containers/buildah","092591620ba70db93c28e496f4039e259c1dbfa9","TomSweeneyRedHat","2018-01-16 15:57:46","false","Show ctrid when doing rm -all

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #392
Approved by: rhatdan",31,12,0,1
"containers/buildah","b23a20ee6442e19c5e90045fb9674004e5221509","dfr","2022-05-06 14:39:54","false","copier: work around freebsd bug for ""mkdir /""

On FreeBSD, os.Mkdir can return EISDIR if the target is the root. As a
workaround, treat EISDIR as a non-error similarly to EEXISTS.

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",24,63,1,0
"containers/buildah","5d705ffcb720e20120f10ac9eb7f72de7677a5cb","nalind","2019-05-21 23:44:22","false","SetEnv: we only need to expand v once

We only need to expand the passed-in value once, not once for every variable
that is set in the environment.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1607
Approved by: TomSweeneyRedHat",56,28,0,1
"containers/buildah","c4599c53efd3f807ac915ed440b2f3d96ccfe9c3","nalind","2018-04-26 19:19:01","false","Makefile: list new pkg/ subdirectoris as dependencies for buildah

Make sure we force the main binary to be rebuilt if sources in our new
pkg subdirectories get updated.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #705
Approved by: rhatdan",50,15,0,1
"containers/buildah","77804bf256f01fee1ec4fbf5f196c8b427210cb7","nalind","2017-12-05 18:40:28","true","Merge pull request #348 from vbatts/readme

README: better first glance idea",33,10,0,1
"containers/buildah","1b6331fe4368ed89bc9201d6e479a9dc8fbe2b9a","nalind","2018-06-28 19:58:40","false",".travis.yml: run integration tests with BUILDAH_ISOLATION=chroot

Run integration tests with both BUILDAH_ISOLATION=oci and
BUILDAH_ISOLATION=chroot.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #836
Approved by: rhatdan",28,17,0,1
"containers/buildah","7b5fed15ae50a9a41fca7a9a7a1de9de6e7aa8a6","nalind","2017-06-06 18:20:55","false","Don't overwrite parent information when reading

Don't overwrite an image configuration's information about the source
image unless we're intending to create a new working container.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #141
Approved by: rhatdan",12,4,0,1
"containers/buildah","b4c49261f083210ddeb9cfc85b17a7f64f943f0f","nalind","2022-03-10 15:22:37","false","integration tests: learn to start a dummy registry

When a test needs to talk to a registry server, launch one as part of
the test rather than depending on it having been started by someone
else.

Use run_buildah where we used to use 'run buildah' without checking the
return code, and in a few cases where we did check it.

In the ""from with non buildah container"" test, use ""podman create"" with
host networking, in an attempt to avoid messing with networking in cases
where we're running on a system with a version of podman that will
create a bridge with CNI that we'll also create with netavark.  We're
not sharing storage between the two invocations, so the logic that tries
to detect this problem won't detect it.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",32,61,1,1
"containers/buildah","55fa8f5a46a7871c453faa760ee3b8e08662238a","nalind","2020-01-08 16:04:57","false","copyFileWithTar: close source files at the right time

Close source files after we've finished reading from them, rather than
leaving it for later.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #2072
Approved by: giuseppe",101,35,0,1
"containers/buildah","ebd6246d5a32770646b8bf5b0a3490b8d91889d8","mtrmac","2019-02-21 22:26:40","false","Remove 'transport == """"' handling from the pull path

This case was originally here for options.Transport, which
no longer exists; and the previous commit has made it impossible
for transport == """" to reach this code path.

Should not change behavior.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","788fddb1dd5b7f1f03246da0ddcff9adc407fcd3","mtrmac","2022-09-06 22:39:19","false","Update c/image after https://github.com/containers/image/pull/1299

> go get github.com/containers/image/v5@main
> make vendor

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",18,67,1,1
"containers/buildah","3598ffb1676fb0213dd2582db2a7aa7087382c4a","umohnani8","2021-03-17 01:58:31","false","Check for symlink in builtin volume

Check if a builtin volume is a symlink. If it is,
follow the symlink and ensure that the destination
exists.
Add tests for symlink and no symlink case.

Signed-off-by: Urvashi Mohnani <umohnani@redhat.com>",58,50,0,1
"containers/buildah","d1bfccf220c476ee1165b1c69f993595bd8ca0f4","nalind","2023-11-07 22:32:25","false","createConfigsAndManifests: clear history before cw-specific logic

Clear the docker-format rootfs and history information before we clear
other fields in the config for confidential workload cases, so that it's
easier to track that it exactly parallels what we're doing with the OCI
format data.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",0,81,1,1
"containers/buildah","9f3506de35d89b2049dbf1527eddac7bd0bd945e","openshift-merge-robot","2023-07-06 05:25:02","true","Merge pull request #4905 from flouthoc/image-set-config-build

contrib/buildahimage: set config correctly for rootless `build` user",13,77,1,1
"containers/buildah","dcd7b789a19c04d752d73177c2aea87e89cc3dd3","flouthoc","2023-03-15 05:24:51","true","stage_executor: inline network add default string

Inline `RUN --network=default` should do nothing. This matches
buildkit's behaviour here: https://github.com/moby/buildkit/blob/master/frontend/dockerfile/docs/reference.md#run---networkdefault

Also added to podman's document here: https://github.com/containers/common/pull/1366

Signed-off-by: Aditya R <arajan@redhat.com>",15,74,1,1
"containers/buildah","946395494238954e49123a567f09cb40a26dc31e","rhatdan","2023-03-28 21:48:33","true","Update docs/buildah-build.1.md

Co-authored-by: Nalin Dahyabhai <nalin@redhat.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",13,74,1,1
"containers/buildah","39dfa738929571c05dd595d3fb9804de583769cc","openshift-merge-robot","2023-01-16 16:28:19","true","Merge pull request #4519 from vrothberg/readme

[CI:DOCS] README: drop sudo",21,72,1,1
"containers/buildah","1c0a08e3c5c4830e515e536db960bb2741619435","dfr","2022-04-21 14:15:40","false","Add run support for FreeBSD

This duplicates over a thousand lines of code from run_linux.go.
Subsequent commits will move this code to a new file run_common.go.

Signed-off-by: Doug Rabson <dfr@rabson.org>",25,63,1,0
"containers/buildah","95a18737a6fa5a6eec340f31c531add9ec0d0b40","dfr","2022-06-15 12:18:28","false","Move runAcceptTerminal to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","72e2225cd403bcb3df1ebbd02dfb3ec6024b2667","vrothberg","2022-03-17 08:44:31","false",".in support: improve error message when cpp is not installed

[NO TESTS NEEDED]

Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",31,62,1,1
"containers/buildah","37fe4e86c284486c0ede084d579122c48ffe5dc1","rhatdan","2021-09-13 20:36:55","false","Bump to v1.23.0

[NO TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",39,55,1,1
"containers/buildah","1b3f9cdeeb0a1076ee5a0a66f03a65a96fcea1f9","rhatdan","2021-08-21 12:00:05","true","Merge pull request #3442 from rhatdan/define

Move DiscoverContainerfile to define directory, so podman can use it",40,55,1,1
"containers/buildah","6e1affc1cd09c87f5d8feb0030409473d874a5da","flavio","2020-09-07 13:28:25","true","Update `manifest add` man page

Ensure the freshly added flags are mentioned by the man page.

Signed-off-by: Flavio Castelli <fcastelli@suse.com>",85,43,0,0
"containers/buildah","55451c22176416b758bc2d849296aecd37933bfc","rhatdan","2018-03-20 10:51:10","false","If the user overrides the storage driver, the options should be dropped

Since the driver options are configured in storage.conf based on the selected
driver then the user overrideing them should cause the options to drop.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #528
Approved by: rhatdan",19,14,0,1
"containers/buildah","00ba17b37aabf06791e54b7ead8d5c91ca5668a2","rhatdan","2021-09-24 19:06:08","false","Plumb the remote logger throughut Buildah

Users are not seeing Warnings when doing podman --remote build.
We need to wire the logrus messages all the way through the system.

Fixes: https://github.com/containers/buildah/issues/3537

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",39,56,1,1
"containers/buildah","95cb0612fb05875bc911a3439316c042e08b5786","rhatdan","2019-08-08 15:20:42","true","Merge pull request #1771 from rhatdan/vendor

 Bump containers/image to v3.0.2 to fix keyring issue",51,30,0,1
"containers/buildah","b9b2a8a7ef87833a1db600ed2a3d5295644b2f1c","rhatdan","2017-07-20 18:05:26","false","Vendor in latest containers/image and bump to version 0.3

OCI 1.0 Image specification is now released so we want to bump
buildah version to support 1.0 images.

Bump to version 0.3

Signed-off-by: Dan Walsh <dwalsh@redhat.com>

Closes: #203
Approved by: rhatdan",17,6,0,1
"containers/buildah","ff39bf0b80c5afc43d88e4be6fd5dc697f6c443d","rhatdan","2017-09-22 09:40:00","false","Cleanup buildah code

1. Sort options so they are in alphabet order
2. Remove extra lines of code for options parsing that really do not accomplish anything.
3. Remove variables when they are not necessary, I.E. Don't create a variable to hold an
option that is only used once, use the option instead.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #267
Approved by: <username_without_leading_@>",34,8,0,1
"containers/buildah","973ff95ef7d3c0fbc1e14376656f1b02fd8c2a01","l0rd","2021-09-10 09:32:48","true","Merge branch 'main' into patch-1",38,55,1,0
"containers/buildah","420107991b3a91d95ee8c9ac399692b2b7dc22f6","dfr","2022-06-15 10:22:13","false","Move etc file generation utilities to run_common.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","0dba767afe5e658a0877f474ce2b9cf507ce171c","tvendelin","2021-01-21 18:23:02","false","Added required devel packages

Signed-off-by: Toomas Vendelin <toomas.vendelin@gmail.com>",96,48,0,0
"containers/buildah","3748b31c04b8010950037dbbff56127830fabc1c","nalind","2017-05-23 22:03:19","false","Defaul to the configured hostname in Run()

If Run() isn't passed a hostname to set, but we have one that was set
directly or inherited from the source image, use that value.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #121
Approved by: rhatdan",15,4,0,1
"containers/buildah","673a26fbce0739d2e465a8b7a14d5b25ae84be88","nalind","2020-10-20 20:56:52","false","Remove docs that refer to bors, since we're not using it

Remove the bits of our documentation that referred to bors, its bot, and
its configuration file, since we switched to a different merge bot.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",63,45,0,1
"containers/buildah","36634cec4e83852b6d9cf6ab2ef50904a8c17a9d","nalind","2019-09-23 17:34:17","false","pkg/supplemented: add a package for grouping images together

Add pkg/supplemented, which can stitch together multiple image
references, typically one which contains a manifest list or image index,
and one or more single-image references to which the list or index
refers, into one big grab bag full of instances and blobs.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1902
Approved by: rhatdan",63,32,0,1
"containers/buildah","1e6a70c1c2f7fd442331f2287d0b794c9b7328ea","nalind","2019-11-19 20:23:14","false","commit(docker): always set ContainerID and ContainerConfig

For the sake of the Docker output format, always set the ContainerID
field, and if we have a non-nil Config, set ContainerConfig to the same
values.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1989
Approved by: rhatdan",81,34,0,1
"containers/buildah","3bf8547fe78ebba5a8a00446401d002c86388f24","nalind","2019-05-16 17:00:22","false","Avoid fmt.Printf() in the library

Avoid calling fmt.Printf() to print things in library logic, which can't
be controlled or suppressed by callers.  Prefer returning values and
printing them in our CLI wrapper, as callers would.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1596
Approved by: rhatdan",55,28,0,1
"containers/buildah","0cb316d737d1aa48a9d3031fb0bb7d9f8723cdc8","nalind","2017-02-02 20:24:02","false","Refine the libdm_no_deferred_remove tag check

Refine the test for the ""libdm_no_deferred_remove"" build tag so that we
actually check if we can link with the deferred removal function.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,0,0,1
"containers/buildah","514ff3dc1cb43cdd34d2bf33337790a2165dab39","lsm5","2022-08-26 19:31:33","true","Cirrus: use image with fewer downloaded dependencies

The latest cirrus image bump will use fewer downloaded dependencies in
favor of installation from copr / distro repos.

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",16,67,1,1
"containers/buildah","6714a79eb05bd4061fa8cbf31e7c003aa414a031","rhatdan","2023-05-18 20:28:21","false","Make cli.EncryptConfig,DecryptConfig, GetFormat public

We want to share these functions with Podman, Podman currently
has a slightly different version which is correct, so use correct
version in Buildah and vendor it into Podman.

Fixing: https://github.com/containers/podman/issues/18196

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",13,76,1,1
"containers/buildah","6fa2f7409e242cece0203f3a75c3428c36762e5b","giuseppe","2018-10-23 10:06:06","false","unshare: do not override the configuration

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #1124
Approved by: rhatdan",52,21,0,1
"containers/buildah","147d106c362f295c2b457d72cd81678376518042","rhatdan","2019-11-05 13:51:46","false","Only output image id if running buildah bud --quiet

We should be outputing just the imageID when doing a buildah bud quiet.
Currently the stdout from containers is showing up on the screen.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1963
Approved by: TomSweeneyRedHat",82,33,0,1
"containers/buildah","33a33ef050e1187daa5659ffd46b9bb675c6e0ae","rhatdan","2023-04-06 11:45:45","true","Merge pull request #4711 from rhatdan/VENDOR

vendor in latest containers/(storage, image)",11,74,1,1
"containers/buildah","8f2bb8876f3f8a744415ca22b4c487ded1a26131","rhatdan","2022-04-23 10:26:55","true","Merge pull request #3925 from navidys/pkg_parse_errmsg_str

using consistent lowercase 'invalid' word in returned err msg",25,63,1,1
"containers/buildah","b014f1a888bdbf9414d8481ed0f0e90f2f9510e1","rhatdan","2023-03-17 12:34:48","true","Merge pull request #4664 from containers/renovate/major-ci-vm-image

chore(deps): update dependency containers/automation_images to v20230314",15,74,1,1
"containers/buildah","16a33bd7cf5f925885c63b9eac982a6767fdf381","rhatdan","2018-06-25 12:53:47","false","Fix ARGS parsing for run commands

Currently we are not adding the ARGS passed in via Dockerfile
or --build-args into the running container as environment variables.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #816
Approved by: umohnani8",29,17,0,1
"containers/buildah","d68d9a237ce230038c5a2bb65703fb0515da23c8","flouthoc","2023-08-11 18:17:11","true","buildah/push/manifest-push: add support for --force-compression

Adds support for `--force-compression` which allows end-users to force
push blobs with the selected compresison in `--compression` option, in
order to make sure that `blobs` of other compression on registry are not
reused.

Is equivalent to: `force-compression` here: https://docs.docker.com/build/exporters/#compression
Closes: https://github.com/containers/buildah/issues/4613

Also Implements:
`--compression-format` and `--compression-level` for `manifest push` just like
`podman`'s `manifest push`

Signed-off-by: Aditya R <arajan@redhat.com>",10,78,1,1
"containers/buildah","d8bfe4f5340cd45ac1ca162f15a906b3388a3836","mtrmac","2023-02-15 20:22:50","true","Merge pull request #4587 from containers/renovate/github.com-openshift-imagebuilder-digest

fix(deps): update github.com/openshift/imagebuilder digest to 86828bf",19,73,1,1
"containers/buildah","e7b9429e19b16f96d89622e89929abd998af86ae","vrothberg","2019-08-19 11:12:47","false","README: mention that Podman uses Buildah's API

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",53,31,0,1
"containers/buildah","65c1c9327a9d6b711a6f396a1dbbaff17b53db14","cevich","2023-06-21 19:38:08","true","Cirrus: Remove duplicate env. var. definitions

These are pre-defined by the common automation library sourced near the
top of the file.

Signed-off-by: Chris Evich <cevich@redhat.com>",12,77,1,1
"containers/buildah","5672097146be4cd1aa2c68e9fee806dc8ad93ead","cevich","2021-01-05 15:47:59","true","Cirrus: Make tests pass with new VM Images

Also, utilize the common library functions from containers/automation.
This library is now pre-installed into the VM images. There are some
minor API differences to a few frequently used functions.  Otherwise
the behaviors are largely identical.

Signed-off-by: Chris Evich <cevich@redhat.com>",89,47,0,1
"containers/buildah","14837e2441915b9ed04241f116c52db1164b71c1","pixdrift","2018-05-07 22:14:44","false","CI tests and minor fix for cache related noop flags

Signed-off-by: pixdrift <support@pixeldrift.net>

Closes: #667
Approved by: ripcurld",52,15,0,0
"containers/buildah","6fd4d61b6acb899dbceb382fc827b5eb5e922ec0","mtrmac","2019-02-21 22:22:38","false","Clean up ""pulls"" of local image IDs / ID prefixes

When ResolveName has already determined that the value is an
ID (prefix), and returned the full ID, rely on that knowledge
and don't try at all to pull the image from a 'remote transport """"';
also, don't try to match strings that are already known not to be
ID prefixes, or that are known to use a different transport, against
local storage.

Should not change behavior, except possibly in theoretical
inconsistency cases when store.Image(knownImageID) fails; the code
now does not report other unrelated errors on the transport == """"
path below.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","a855573b92795894be933b8f748f622832f6b5ec","nalind","2018-04-24 18:23:17","false","Make ""run --terminal"" and ""run -t"" aliases for ""run --tty""

I swear I can never remember which one it is.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #706
Approved by: rhatdan",39,15,0,1
"containers/buildah","bc24d60a9173671c5813d793570d040c76e0dcdd","nalind","2018-08-02 21:02:45","false","Update containers/image to 216acb1bcd2c1abef736ee322e17147ee2b7d76c

Update containers/image to 216acb1bcd2c1abef736ee322e17147ee2b7d76c,
which gets us its new sysregistriesv2 package.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #904
Approved by: rhatdan",22,18,0,1
"containers/buildah","68337bf9c69ce6060cd81f618edb9a98f69f2db6","nalind","2023-05-22 21:15:30","false","Go back to setting SysProcAttr.Pdeathsig for child processes

Restore SysProcAttr.Pdeathsig values for child processes that we start,
so that they get a SIGKILL when we exit for whatever reason.  Lock the
calling goroutine to a native thread while that's happening, like we
should always have done.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",17,76,1,1
"containers/buildah","0df1c44b1293df785ec9a6bf4cb94d64310eebe2","nalind","2017-11-07 22:19:51","false","tests: check $status whenever we use run

Always be sure to check $status after using the run helper.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #313
Approved by: rhatdan",29,9,0,1
"containers/buildah","e4fe5e01c19db874100438cb8c4ce93967277296","vrothberg","2019-02-20 13:31:08","false","make vendor: always fetch the latest vndr

Always fetch the latest vndr from upstream before firing off
`make vendor` and execute $(GOPATH)/bin/vndr.  This reduces
the risk that a locally installed vndr diverges too much from
the ones used in the CI.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1350
Approved by: TomSweeneyRedHat",60,25,0,1
"containers/buildah","51c3d1d4b43fc338ff90191e23888447aefea701","mtrmac","2019-02-21 22:48:21","false","Don't try to parse imageName as transport:image in pullImage

Both callers now consistently pass the transport in the ""transport""
parameter, so parsing imageName could only be incorrect.

This could possibly fix cases like pulling docker://dir:localpath,
and the debug log will no longer say
""error parsing image name %q, trying with transport %q: %v"" on every pull attempt.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1361
Approved by: rhatdan",59,25,0,1
"containers/buildah","7aa34b86fb2e6282f29f78e64537f5f2683d605f","edsantiago","2022-10-26 11:58:14","false","Define and use a safe, reliable test image

The ubi8 image changed some architecture string yesterday and
broke all our CI on all branches, including podman because
it too runs bud.bats tests.

Solution: use a safe, reliable, trustworthy test image (the
one built and used for podman). Because that image does not
have the same labels, confirm pull using .Architecture
instead.

We should stop using ubi8 and registry.redhat (#4318). They
are unreliable. This PR doesn't fix that; it's just an
emergency patch for one specific CI break. We can use
this as a basis for future removals of ubi8.

Signed-off-by: Ed Santiago <santiago@redhat.com>",26,69,1,1
"containers/buildah","7682c985d8a4d16caf0f451911ae3bfbd65fb1d1","boaz0","2018-09-17 15:07:00","false","nitpick: parse.validateFlags loop in bud cli

Signed-off-by: Boaz Shuster <boaz.shuster.github@gmail.com>

Closes: #1021
Approved by: rhatdan",37,20,0,0
"containers/buildah","120c37fef29bbcb006caa35868b395b37be11016","rhatdan","2019-10-20 11:41:34","true","Merge pull request #1930 from TomSweeneyRedHat/dev/tsweeney/fixtut1sttime

Add clarification to the Tutorial for new users",78,33,0,1
"containers/buildah","049fdf4e1bd32e900819097fa1e7b7645ffca736","rhatdan","2019-10-21 18:19:08","true","Merge pull request #1933 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.5.0

Bump github.com/fsouza/go-dockerclient from 1.4.4 to 1.5.0",77,33,0,1
"containers/buildah","57ec39d2756ca34f86eaececbadfd471f6655e0b","rhatdan","2019-02-19 13:37:39","false","Make sure buildah pull --all-tags only works with docker transport

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1319
Approved by: rhatdan",59,25,0,1
"containers/buildah","aca2c96602ebf8df3aa3997ff5bc365ceb28c7c5","rhatdan","2017-09-22 09:41:03","false","Cleanup buildah-config code

1. Sort options so they are in alphabet order
2. Remove extra lines of code for options parsing that really do not accomplish anything.
3. Remove variables when they are not necessary, I.E. Don't create a variable to hold an
option that is only used once, use the option instead.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #267
Approved by: <username_without_leading_@>",34,8,0,1
"containers/buildah","57a0f38db68d6354ef65379c48aef91c85ae852e","rhatdan","2017-09-22 09:40:32","false","Cleanup buildah-images code

1. Sort options so they are in alphabet order
2. Remove extra lines of code for options parsing that really do not accomplish anything.
3. Remove variables when they are not necessary, I.E. Don't create a variable to hold an
option that is only used once, use the option instead.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #267
Approved by: <username_without_leading_@>",34,8,0,1
"containers/buildah","230ef7ac35b5d9558c6af8b5755516a6183c8b53","rhatdan","2020-02-04 18:16:35","false","Close tarSource when finished using it

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",110,36,0,1
"containers/buildah","b9a1426111e0000dab3e7e708a218f34e560f60f","rhatdan","2017-03-29 19:06:36","false","buildah should be install in /usr/bin not /usr/sbin

Closes: #60
Approved by: rhatdan",14,2,0,1
"containers/buildah","e8dee408325106a792c5e4d8fda3242e68a56ff9","rhatdan","2023-03-18 11:56:19","false","fix(deps): update module github.com/fsouza/go-dockerclient to v1.9.6

Signed-off-by: Renovate Bot <bot@renovateapp.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",14,74,1,1
"containers/buildah","be13566e0503ee0e632bcbb95ec7c928daea3944","openshift-merge-robot","2023-09-24 23:13:02","true","Merge pull request #5031 from flouthoc/empty-layer

stage_executor: allow images without layers",9,80,1,1
"containers/buildah","91999d8ad805ec513504f930aa2ac4ca670aae5c","openshift-merge-robot","2023-05-17 13:59:50","true","Merge pull request #4798 from containers/renovate/github.com-sirupsen-logrus-1.x

fix(deps): update module github.com/sirupsen/logrus to v1.9.1",14,76,1,1
"containers/buildah","fda936d44a47c887af16ae757f00d8c323eb9311","openshift-merge-robot","2020-11-05 12:41:59","true","Merge pull request #2735 from rhatdan/mkdirall

Attempt to test `fix MkdirAll usage #2361`",68,45,0,1
"containers/buildah","2ab877eb79e8d521262bfdc6afc0b0cc6954bbed","openshift-merge-robot","2021-05-17 17:33:22","true","Merge pull request #3215 from rhatdan/bud

Send logrus messages back to caller when building",55,52,1,1
"containers/buildah","c5e11e3d449cdb60a71c4b91e4cb91f787cc4874","openshift-merge-robot","2022-08-19 11:17:28","true","Merge pull request #4190 from flouthoc/race-free-commit

commit: use race-free `RemoveNames` instead of `SetNames` for pruning names",17,67,1,1
"containers/buildah","f4e6ca72332b7ca4d1bfb3a250354af105b6ac60","nalind","2017-04-27 17:51:52","false","Bump github.com/containers/image

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #87
Approved by: nalind",9,3,0,1
"containers/buildah","be51b9bd245b5ec331cc92cfa34924c49a9330fd","nalind","2019-07-16 14:47:25","false","Update to match updated runtime-tools API

Some method argument types changed in runtime-tools. Compensate.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1720
Approved by: vrothberg",48,30,0,1
"containers/buildah","62d2cfeef6e2d1ec1a6368f2894dea85d0683086","nalind","2019-01-17 16:09:19","false","imagebuildah: make EnsureContainerPath() check/create the right one

Update EnsureContainerPath() to check for the existence of the passed-in
path relative to the working container, and to create it if it doesn't
exist.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",51,24,0,1
"containers/buildah","50a92faef6741cdcee46aa5835f524b8994f157c","rhatdan","2021-01-08 14:23:15","false","Update vendor of containers/storage and containers/common

Preparing for buildah v1.19 we want to make sure we have the latest
containers code.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",91,47,0,1
"containers/buildah","c147bb2b9a4940a31d92de8891f964812351120f","flouthoc","2022-04-21 07:35:56","true","run: set actual hostname in /etc/hostname to match docker parity

Following commit ensure the buildah run populates /etc/hostname with
actual hostname instead of `localhost`. This matches parity with docker.

See discussion here: https://github.com/containers/buildah/issues/3914
Closes: https://github.com/containers/buildah/issues/3914

Signed-off-by: Aditya R <arajan@redhat.com>",25,63,1,1
"containers/buildah","c8727b403349a454d0dff5bb7186e2b3198f735d","mtrmac","2019-02-23 02:08:09","false","Fix a few issues found by tests/validate/gometalinter.sh

For some reason, the CI does not report any of these; on macOS
I see many more reports (including complaints about the standard
library), this only cleans up the trivial cases.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1365
Approved by: rhatdan",59,25,0,1
"containers/buildah","a429bbddd51d33d9d9be511ccf78232d57cfd11c","rhatdan","2022-11-03 18:24:38","true","Merge pull request #4366 from flouthoc/multi-stage-name-heading-args

executor: honor default `ARG` values while evaluating base image name.",24,69,1,1
"containers/buildah","eebbba2585c260c128e80f07c346bd314628d2fc","rhatdan","2018-12-22 12:36:19","false","Add aliases for buildah containers, so buildah list, ls and ps work

This adds a little more consistency with the podman and docker commands
for listing containers.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1249
Approved by: TomSweeneyRedHat",52,23,0,1
"containers/buildah","5a63d7f61903b1da22343bc021a7f7d64c1c2895","openshift-merge-robot","2023-02-18 09:36:18","true","Merge pull request #4602 from nalind/cache-slices

imagebuildah.StageExecutor: suppress bogus ""Pushing cache []:..."" messages",17,73,1,1
"containers/buildah","117e97d9c607e3f600027a2b811b026f1ba4e357","openshift-merge-robot","2022-11-18 11:10:57","true","Merge pull request #4421 from flouthoc/cache-user-base

`mount=type=cache`: seperate cache parent on host for each user",21,70,1,1
"containers/buildah","2e0ee65e922720662be7959a3dd5d88b9d1257f1","openshift-merge-robot","2022-10-06 03:42:45","true","Merge pull request #4320 from edsantiago/oops_test_scratch_dir_is_not_what_i_thought

System test cleanup: document, clarify, fix",27,68,1,1
"containers/buildah","8be2b62372f64428c6c027e49d097bc6fe704646","nalind","2018-07-06 14:49:55","false","Fix handling of --registries-conf

Instead of ignoring the global --registries-conf option and using only
$REGISTRIES_CONFIG_PATH, use it for the option default.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #854
Approved by: rhatdan",31,17,0,1
"containers/buildah","8920b0ff2f31c717115e072b322fce1c79f15d43","rhatdan","2020-10-21 12:26:28","false","build(deps): bump github.com/containers/common from 0.25.0 to 0.26.0

Bumps [github.com/containers/common](https://github.com/containers/common) from 0.25.0 to 0.26.0.
- [Release notes](https://github.com/containers/common/releases)
- [Commits](https://github.com/containers/common/compare/v0.25.0...v0.26.0)

Signed-off-by: dependabot-preview[bot] <support@dependabot.com>
Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",64,45,0,1
"containers/buildah","8e4979e814b26dcb57cb4782fa9040294bdd3405","rhatdan","2022-11-11 17:51:38","false","build(deps): bump github.com/onsi/gomega from 1.24.0 to 1.24.1

Bumps [github.com/onsi/gomega](https://github.com/onsi/gomega) from 1.24.0 to 1.24.1.
- [Release notes](https://github.com/onsi/gomega/releases)
- [Changelog](https://github.com/onsi/gomega/blob/master/CHANGELOG.md)
- [Commits](https://github.com/onsi/gomega/compare/v1.24.0...v1.24.1)

---
updated-dependencies:
- dependency-name: github.com/onsi/gomega
  dependency-type: direct:production
  update-type: version-update:semver-patch
...

Signed-off-by: dependabot[bot] <support@github.com>",22,69,1,1
"containers/buildah","59bb73af7f6ee1b466666c1d65d1f5e6b4c43206","rhatdan","2023-04-27 14:30:45","true","Merge pull request #4744 from containers/renovate/github.com-docker-docker-23.x

fix(deps): update module github.com/docker/docker to v23.0.5+incompatible",13,75,1,1
"containers/buildah","b3798a170601968f352382091b8ade213f19b6e9","rhatdan","2022-01-10 19:46:09","true","Merge pull request #3699 from cevich/parallel_int

Cirrus: Run int. tests in parallel with unit",28,59,1,1
"containers/buildah","0c3234f226232a9ca72bfac1fad30c105ca14bd5","TomSweeneyRedHat","2020-01-18 20:43:05","false","Fix COPY in containerfile with envvar

If a Containerfile had lines like:

```
FROM alpine
ENV VERSION=0.0.1
COPY file-${VERSION}.txt /
```

Buildah would not resolve the VERSION variable in the copy statement.
If the 'ENV' in the above Containerfile was changed to ARG, then this
would work.

A recent change to the handling of variables now only looks at variables
set by 'ARG' and not the ones set by the 'ENV' command.  This PR
adds the the variables set by the `ENV` to the list of `ARG` variables
when those variables are being resolved by the code.

This also includes added test to guard against this regression in the future.

Addresses:  https://github.com/containers/libpod/issues/4878

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #2095
Approved by: giuseppe",102,36,0,1
"containers/buildah","60485e6d778d9adf77d978e3c23e7685483addee","TomSweeneyRedHat","2018-10-27 19:47:03","false","Handle directories better in bud -f

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1132
Approved by: vrothberg",50,21,0,1
"containers/buildah","308ad3d7fc63ee34ed213c2ffa6b345441600b8f","rhatdan","2018-08-04 08:00:35","false","Bump to v1.4-dev

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #911
Approved by: rhatdan",22,18,0,1
"containers/buildah","fa67ecb27af4ca6faad5509d9837e05c32ed63cb","rhatdan","2019-05-29 20:34:17","false","Cleanup Overlay Mounts content

There is a chance that buildah crashed and left overlay
content.  This patch will remove any left over content
before creating the overlay mounts.

Also the previous patch would not be able to handle multiple
overlay volume mounts.  This patch fixes this issue as well.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1625
Approved by: TomSweeneyRedHat",57,28,0,1
"containers/buildah","18309de5b7f0134cb68c4d63b716b9b0315137c0","rhatdan","2018-10-26 19:35:04","false","Allow cgroups to be passed into chroot, read/only

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1130
Approved by: rhatdan",50,21,0,1
"containers/buildah","963c1d95c0a1a2e40b86cdda7259b17c08ede588","rhatdan","2018-02-23 18:49:47","true","Merge pull request #494 from umohnani8/secrets

Fix secrets patch for buildah bud",17,13,0,1
"containers/buildah","49ba901ad76f1f50156e296efa3201c353cc85ca","rhatdan","2023-04-08 03:24:29","true","Merge branch 'main' into bind-mount-relabel",11,74,1,1
"containers/buildah","3a30a6f8d8860d789ad47ea668501f47bd41e45c","rhatdan","2019-05-03 20:45:01","false","Export buildah validate volume functions so it can share code with libpod

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1560
Approved by: giuseppe",55,27,0,1
"containers/buildah","979c9456744396fe27914d28063fb66dec896744","boaz0","2017-12-18 14:12:16","false","Display Config and Manifest as strings

Builder has the Config and the Manifest fields which are []byte.
The type is []byte because it's eaiser to serialize them that way.
However, when these fields are displayed in the following way:

buildah inspect -f '{{.Config}} {{.Manifest}}' IMAGE

they might be shown as a byte slice.

This patch suggests to use a struct that wraps Builder's exposed
fields such as Config, Manifest and Container as strings and
thus make them readable when inspecting specific field.

Signed-off-by: Boaz Shuster <ripcurld.github@gmail.com>

Closes: #368
Approved by: rhatdan",34,11,0,0
"containers/buildah","973976a6623aa1691476fd7305ed645940e4335d","rhatdan","2021-10-09 12:26:55","false","De-dockerize the man page as much as possible

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",40,56,1,1
"containers/buildah","9e088bd41df831e5c51499b4974cb02ca6e5bc7e","rhatdan","2017-08-16 09:04:02","false","Add information on buildah from man page on transports

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #234
Approved by: rhatdan",27,7,0,1
"containers/buildah","02b914b1c424c151d0a32192876a37daf5927981","openshift-merge-robot","2021-01-06 19:45:04","true","Merge pull request #2868 from rhatdan/override

Use --arch and --os options to select architecture and os",91,47,0,1
"containers/buildah","18c5ab79a1b421fcd289b5ac4302377ac100ef69","openshift-merge-robot","2021-04-02 12:14:09","true","Merge pull request #3117 from rhatdan/mounts

Sort all mounts by destination directory",49,50,0,1
"containers/buildah","46d18e0a9d35cbe9dff01d0909e540d024a0e0f8","openshift-merge-robot","2022-04-05 12:23:43","true","Merge pull request #3877 from flouthoc/manifest-add-allow-override

manifest-add: allow overriding `--arch` and `--variant` while adding custom image to manifest list",26,62,1,1
"containers/buildah","d56c2e1b9b22b8cf5f25ffc5fa9f0e983a6fc350","openshift-merge-robot","2022-04-06 10:36:51","true","Merge pull request #3900 from flouthoc/no-run-jobs-one

tests: set `--jobs=1` for flaky `bud-multiple-platform-no-run`",25,62,1,1
"containers/buildah","3888d45c2d4dc8037cd8961f69a8e222781f1081","openshift-merge-robot","2022-04-29 17:44:07","true","Merge pull request #3823 from flouthoc/buildkit-custom-output

buildkit: add support for exporting build output with `--output` or `-o`",27,63,1,1
"containers/buildah","ddde75a4bdf3f2d844e1104648e65caeedd48a4f","openshift-merge-robot","2021-10-05 16:50:06","true","Merge pull request #3559 from containers/dependabot/go_modules/github.com/containers/storage-1.37.0

build(deps): bump github.com/containers/storage from 1.36.0 to 1.37.0",43,56,1,1
"containers/buildah","61469c5f16871fb4bc08e35ea907d49628c194d3","TomSweeneyRedHat","2019-08-29 22:40:07","false","Bump to v1.12.0-dev

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",56,31,0,1
"containers/buildah","cac2dd4dd8ce51c90a9df77ef78d31b87d1fa46e","TomSweeneyRedHat","2017-10-02 13:44:49","false","Make inspect try an image on failure if type not specified

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #277
Approved by: rhatdan",31,8,0,1
"containers/buildah","b1ae9c1f3a185e67a27db083eafdc4fa292d6cd2","EduardoVega","2021-01-25 14:32:56","false","Use chown function for U volume flag from containers/common repository

Signed-off-by: Eduardo Vega <edvegavalerio@gmail.com>",95,48,0,0
"containers/buildah","b652a0175b1cbb258cbf299360290a084732235d","nalind","2019-06-06 20:22:47","false","bud.bats: add a test verying the order of --build-args

Build args are kept in a map, so there's no guarantee of ordering when
iterating through its items, so try switching things up to make sure
that cache-checking logic doesn't get tripped up by that.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1647
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","f51e9c08697cf6144f3ac13ffe571824c7695e6f","mtrmac","2018-08-04 01:04:04","false","Simplify handling of the ""tried to pull an image but found nothing"" case in newBuilder

resolveImage already either returns an image, or an error; never (nil, nil, nil),
so this is dead code; drop it.

Should not change behavior.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #909
Approved by: rhatdan",22,18,0,1
"containers/buildah","a0853c3b5a93e69961d80723bb9305835c78276c","openshift-merge-robot","2021-05-11 19:19:54","true","Merge pull request #3219 from containers/dependabot/go_modules/github.com/opencontainers/runc-1.0.0-rc94

Bump github.com/opencontainers/runc from 1.0.0-rc93 to 1.0.0-rc94",54,51,0,1
"containers/buildah","c536048cac91bdf9673ecef93e1212ff5bc15a48","vrothberg","2023-10-24 06:58:31","false","vendor c/common: appendable containers.conf strings, Part 1

This change is the first step of integrating appendable string arrays
into containers.conf and starts with enabling the `Env`, `Mounts`, and
`Volumes` fields in the `[Containers]` table.

Both, Buildah and Podman, read (and sometimes write) the fields of the
`Config` struct at various places, so I decided to migrate the fields
step-by-step.  The ones in this change are most critical ones for
customers.  Once all string slices/arrays are migrated, the docs of
containers.conf will be updated.  The current changes are entirely
transparent to users.

[NO NEW TESTS NEEDED]

Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",5,81,1,1
"containers/buildah","3078dec531ce5fa3cb7e48a38223a79ed93f489c","rhatdan","2022-10-13 15:52:12","true","Merge pull request #4329 from flouthoc/ssh-agent-socket-label

sshagent: `LockOSThread` before setting `SocketLabel`",27,68,1,1
"containers/buildah","198b4c360b84725fd13c81fc2984fb6b73da12aa","lsm5","2022-03-14 17:34:39","false","buildah.spec.rpkg: initial addition

This specfile along with a webhook will trigger auto rpm builds on the
`rhcontainerbot/podman-next` copr after every upstream PR merge.

Useful for those who want to fetch the latest upstream buildah without
having to build from source.

This commit also gets rid of `contrib/rpm/buildah.spec` and
`tests/version.bats`.

Known issue: Currently fails to build for EL8 envs.

[NO NEW TESTS NEEDED]

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",30,62,1,1
"containers/buildah","ee3d131db7c157945dffb40145a3eaab0c37ed76","Luap99","2022-05-12 13:00:29","true","update c/common to latest main

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",24,64,1,0
"containers/buildah","33eaa173356827f7cd17a29d36d92bac1edc8dd5","openshift-merge-robot","2022-05-06 10:02:54","true","Merge pull request #3941 from hshiina/test-not-reuse-encrypt-layer

Add test for prevention of reusing encrypted layers",24,63,1,1
"containers/buildah","e42259320d034a662f7ed5cfbad345dbca62281f","cevich","2020-08-10 15:54:51","true","Cirrus: Use newly built VM images

Specifically for buildah, these images include golang `1.13`
on Ubuntu 19 and 20.

Signed-off-by: Chris Evich <cevich@redhat.com>",85,42,0,1
"containers/buildah","2e050a184e5488103537c67c5fc8ec1281822d44","cevich","2019-11-08 17:35:01","true","Cirrus: Update to F31 + Use cache images

Signed-off-by: Chris Evich <cevich@redhat.com>",79,33,0,1
"containers/buildah","982b3652806cb6209cb468a1cd50250b52a40c14","mtrmac","2020-04-08 18:25:37","false","Run (go mod tidy) before (go mod vendor) again

We switched the order because (go mod tidy) seemed not to work
before, but the reason why it didn't work was only tangentially
the ordering, and now that all commands do work, modifying the set
of modules makes more sense before updating the vendor directory.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>",117,38,0,1
"containers/buildah","83960a0a607c1b76ef50dba91ddc0f52dc1867eb","cevich","2020-02-27 19:28:54","true","Cirrus: Temporarily disable Ubuntu 19 testing

Due to some unknown problem with package repositories, all ubuntu 19
testing is failing.  This commit temporarily disables that part of the
matrix until a fix can be discovered and implemented.

Signed-off-by: Chris Evich <cevich@redhat.com>",97,37,0,1
"containers/buildah","49ad3bf9381f31c8c343edca1bde47e8d4aef7e8","giuseppe","2020-01-28 14:46:20","false","buildahimage: specify fuse-overlayfs mount options

tweak the storage.conf file to use fuse-overlayfs specific mount
options.  In particular, disable any sync operation on the files on
fuse-overlayfs.

sync is an expensive operation and there is no gain in sync'ing files
when doing a build as if the build fails we don't store the
intermediate result.

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>

Closes: #2117
Approved by: rhatdan",107,36,0,1
"containers/buildah","83b881eefded3327d06b0d13c9cc967366c5eb22","tylarb","2019-10-15 21:22:33","false","Silence ""using cache"" to ensure -q is fully quiet

  + Add a helper function inside of `(s *StageExecutor) Execute()` to
handle ""using cache"" messages

Signed-off-by: Tyler Ramer <tyaramer@gmail.com>

---
Addresses https://github.com/containers/buildah/issues/1897",76,33,0,0
"containers/buildah","103a2baf3d68be83fc765f32e1655ce39463a58e","rhatdan","2018-12-18 17:29:27","false","vendor: use faster version instead compress/gzip

Update vendoring of containers/storage and containers/image to improve
pulls and pushes compression speeds.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",53,23,0,1
"containers/buildah","cebbdd6cf77e6e13d6ead93696831e2dea1d8b1d","rhatdan","2018-10-01 21:55:13","true","Merge pull request #1053 from TomSweeneyRedHat/dev/tsweeney/pullmanfix

Touchup pull manpage",42,20,0,1
"containers/buildah","3531a2dfb59e4b14afdd7aa7075ed741f2d73fd0","rhatdan","2019-02-20 12:03:28","false","Remove quiet option from pull options

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1319
Approved by: rhatdan",60,25,0,1
"containers/buildah","50fa09528f4c2415cfb73ee223a99a27f622ff0d","nalind","2017-04-19 12:57:41","false","Pin gopkg.in/cheggaaa/pb.v1

Update and pin the version of gopkg.in/cheggaaa/pb.v1 that we vendor.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #79
Approved by: nalind",13,3,0,1
"containers/buildah","0ab0890e4e81e6e7f7421b2e27e8d1fd6722d7fa","nalind","2017-02-10 16:48:15","false","Massive refactoring

Pull most of the core logic from the CLI into a package that should be
easier to consume as a library.  Add a ""config"" command that updates the
builder object's configuration.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",8,0,0,1
"containers/buildah","d326f3a39252d3d4f66a49e71fedabaaf9f9091f","nalind","2018-05-22 20:02:34","false","Run(): break out creation of stdio pipe descriptors

Break out creation of our stdio descriptors to keep the complexity down.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #700
Approved by: rhatdan",62,16,0,1
"containers/buildah","94560581d5bd21e1d2425d79bbf1d3b19704cb07","rhatdan","2022-11-21 20:33:45","false","Update vendor of containers/(common, storage, image)

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",20,70,1,1
"containers/buildah","59b1ada898b1c566e9d8bedbe168c1f525d96bd9","rhatdan","2018-08-01 19:31:39","false","Only test rpmbuild on latest fedora

Our tests are taking forever, this should cut a decent amount of
time off of the testing, will little lost in testing.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #898
Approved by: TomSweeneyRedHat",30,18,0,1
"containers/buildah","4ad488ab5f243ba3de597729c42c68b90a8025c5","rhatdan","2020-11-18 10:58:47","true","Apply suggestions from code review

Co-authored-by: Tom Sweeney <tsweeney@redhat.com>",76,46,0,1
"containers/buildah","a316b9abf6c874a6f59a5fade40590164b8dc15b","rhatdan","2023-09-14 01:40:48","true","Merge pull request #5006 from cevich/remove_multiarch_cron

Cirrus: Remove multi-arch buildah image builds",5,80,1,1
"containers/buildah","63a7435736f685ca998d6823948c5714c78a71c6","rhatdan","2023-05-08 13:49:49","true","Merge pull request #4781 from pixdrift/patch-1

[CI:DOCS]: Update the demos README file to fix minor typos",10,75,1,1
"containers/buildah","d576388798952af76d4f8f255d6b19e82a525f3e","vrothberg","2023-04-06 13:00:52","false","vendor c/common ff62cdebdd0e

Commit d45916350d420 bumped common to v0.51.2 which was actually going
back in time. v0.51 is a table branch.

Hence, vendor again fro c/common@main to unblock the treadmill PR.

Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",11,74,1,1
"containers/buildah","8428bc87b0d82fdc9f1fdd3520e84cd10e902eb8","rhatdan","2022-12-05 15:46:48","false","Vendor in containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",17,70,1,1
"containers/buildah","a486cf31c7e13210c2c03e4f87c2bb0fd1f974da","rhatdan","2022-01-26 15:52:43","false","Update vendor of containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",34,60,1,1
"containers/buildah","1ff0071ba0dba7404d950c1b81a294fac1f0b7ec","ashley-cui","2020-09-15 18:29:15","false","Warn when setting healthcheck in OCI format

healthcheck only works in Docker format, so when healthcheck is set in OCI format, warn user that it will be discarded

Signed-off-by: Ashley Cui <acui@redhat.com>",91,44,0,0
"containers/buildah","69eb476aedb75be16ed98b3f7437cb793573bf6c","rhatdan","2020-05-28 20:55:40","false","Vendor in containers/common v0.12.0

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",131,40,0,1
"containers/buildah","f7ff4c11083084d3f9f07b5be2a8e063a24badcb","rhatdan","2020-04-09 17:55:30","true","Merge pull request #2296 from TomSweeneyRedHat/bump-1.14.8

Bump 1.14.8",120,38,0,1
"containers/buildah","3812432dc21c32d609aa96474bed44e4f4be6b0b","TomSweeneyRedHat","2020-04-07 20:01:45","false","Bump to v1.14.7

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",118,38,0,1
"containers/buildah","f50b55df9abdebb1badb9a59e6d612e75af13a3f","TomSweeneyRedHat","2019-09-27 23:56:14","false","Fix --build-args handling

When passing an environment variable to a Containerfile using an `ARG` command,
the dry-run processing  for `COPY` and `ADD` isn't resolving the environment
variable for the source and is causing a failure.

Now convert the source if it's an environment variable to its value and then
proceed on.  The destination doesn't have a similar issue at this point
but we'll convert it too just in case.

Addresses: #1871

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1874
Approved by: nalind",64,32,0,1
"containers/buildah","aff92e565cc862129a41807790b8aaaf92caca3f","nalind","2017-04-13 19:42:04","false","Miscellaneous man page updates

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #67
Approved by: rhatdan",14,3,0,1
"containers/buildah","065b9559978cba28a193e43f6946fa957477d260","lsm5","2023-08-11 14:07:30","true","[CI:BUILD] RPM: fix buildtags

buildtags mentioned as $(hack/foobar.sh) need double quotes to get
correctly read.

Fixes: #4944

[NO NEW TESTS NEEDED]

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",10,78,1,1
"containers/buildah","9588a829c8993fd66637f99b1f397658d2078096","rhatdan","2019-12-20 15:46:59","false","Fix buildahimage builds for buildah

1 We need to update all packages in the buildah image to make sure they are
up2date.
2 reinstall shadow-utils.  For some reason the fedora base image does not
include the file capabilities assigned to /usr/bin/newuidmap and
/usr/bin/newgidmap.  Reinstalling shadow-utils, brings them back.
3 Add a default user `build` to the system. This will create the
/etc/subuid and /etc/subgid maps get created correctly.

Once we have this we should be able to build a container starting with a non
privileged user

podman run -ti --user build --device=/dev/fuse -v ./Dockerfile:/Dockerfile:z quay.io/buildahi/stable buildah bud /

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #2038
Approved by: baude",90,35,0,1
"containers/buildah","8dc85073600b670260efb4db77f81d4c072e9f78","rhatdan","2021-05-19 14:39:19","false","Vendor in containers/common v0.38.4

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",57,52,1,1
"containers/buildah","2ca263ad1ef9a7544ec08f17e6142e05562931e8","rhatdan","2017-03-22 15:18:41","false","Default --root option to ENV BUILDAHROOT

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",12,2,0,1
"containers/buildah","2935999581a6c5746f5cc63b9d44e5fca8d88020","rhatdan","2023-06-14 11:14:50","true","Merge pull request #4745 from mtrmac/explicit-decrypt

Add smoke tests for encryption CLI helpers",13,77,1,1
"containers/buildah","8148edf47d8e561bf4c1bfb1c19ad49afb9553d1","nalind","2021-08-16 17:51:46","false","executor: make sure imageMap is updated with terminatedStage

When the terminatedStage map has its entry for a stage set, make sure
that we set the corresponding entry in the imageMap while holding the
mutex for it, eliminating the sliver of time when the first is set but
the second isn't, which could bite StageExecutor.Execute(), which waits
for the first and then reads the second.

Make terminatedStage record the error if a stage doesn't complete
successfully, and have waitForStage() return that error if it's set.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",37,55,1,1
"containers/buildah","d0f43a0b554bf3576c709590eaa4075f70484bd4","TomSweeneyRedHat","2020-09-15 21:46:38","true","Merge pull request #2610 from rhatdan/codespell

Fix up code based on codespell",91,44,0,1
"containers/buildah","5bdb8c70db8603f1f4d08552bb7f053a73b85835","martinpitt","2023-08-08 08:12:57","false","packit: Build PRs into default packit COPRs

Building all PRs of all container projects into the same COPR does not
properly isolate PRs from each other: E.g. a podman PR currently runs
against whichever buildah PR was opened/updated last; in other
words, sending a broken buildah PR will instantly break tests for
all subsequent podman runs.

To avoid that, change the copr_build configuration to use the packit
default COPRs, which are specific to the particular PR, and disappear
after a few weeks. Depending projects like podman should only run
against what landed in buildah/main, i.e. the podman-next COPR.

Note that this does not preclude testing a podman PR against an
buildah PR: This can be explicitly requested [1]. But most PRs
don't change the API and thus should default to isolation.

[1] https://packit.dev/posts/testing-farm-triggering

[NO NEW TESTS NEEDED]

Signed-off-by: Martin Pitt <mpitt@redhat.com>",11,78,1,0
"containers/buildah","1d11851c2ebd16fb810b3a258229c4b077d30f58","QiWang19","2019-06-19 18:59:24","false","fix --volume splits comma delimited option

Signed-off-by: Qi Wang <qiwan@redhat.com>

Closes: #1686
Approved by: rhatdan",46,29,0,1
"containers/buildah","518fe809753e4b2d3f3c62b42e4d45b5b6db0821","flavio","2020-09-09 10:47:54","true","Fix bash completion of manifest flags

Ensure the `tls-verify` flag is handled as a boolean flag.

Signed-off-by: Flavio Castelli <fcastelli@suse.com>",85,43,0,0
"containers/buildah","d05957a6f6def7d43458f4cca8bce8305c23d1f9","rhatdan","2020-08-04 14:13:17","false","Change namespace handling flags to better match podman commands

Podman namespaces flags handle the options slightly differently.

Specifically namespace flag `container` is very different.
Replace the `container` option with `private` to better match podman
but continue to support `container`

Similarly Podman expects --network ns:/PATH to allow the indication of a
path to a precreated network namespace.  Buildah just supported
--network /PATH, buildah will now support both formats, but document
ns:/path.

Finally use Aliases for fix some duplicated code in buildah.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",143,42,0,1
"containers/buildah","88e882eb088395704410556f950d618159951fea","rhatdan","2020-04-06 14:13:53","false","Remove warning for systemd inside of container

Change the default cgroup_manager to cgroupfs to change the warning
inside of the containers on systemd not being supported.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",117,38,0,1
"containers/buildah","fb36c5f57beb7482debf7f11a7e608243c343876","rhatdan","2020-03-17 17:18:36","false","Cleanup go.sum

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",109,38,0,1
"containers/buildah","633f1f417f687ae522f4c33dc7fc484eeb7e46d4","rhatdan","2018-08-30 20:59:54","false","Fix examples to include context directory

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #977
Approved by: TomSweeneyRedHat",33,19,0,1
"containers/buildah","d54f0eaf30c233e4e2623bef56314d9a362cbbb6","nalind","2018-09-05 14:44:28","false","run: clear default seccomp filter if not enabled

When seccomp is not enabled, make sure to clear any default setting
which runtime-tools supplied for us.  Likewise, if SELinux is not
enabled, don't set a process label or a mount label.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #988
Approved by: rhatdan",35,19,0,1
"containers/buildah","c3b0048788542e3bfe35d46b263e4c9ba99f6241","nalind","2019-01-18 20:48:54","false","Make CLI help descriptions and usage a bit more consistent

Start with capital letters; a description ends with a period; usage
doesn't.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1299
Approved by: TomSweeneyRedHat",54,24,0,1
"containers/buildah","ce87a52ef4681094d51b61ef4e12e000acfc1443","nalind","2017-04-12 21:20:42","false","bud: Add flags for specifying the runtime command

So long as it's possible to have an incompatible version of runc
installed, we're going to want to easily point to another version, as we
already allow for with the ""run"" command.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #76
Approved by: nalind",14,3,0,1
"containers/buildah","898b18ebddf899fa96a8a9ccc6b8e648ed255945","nalind","2018-06-14 20:41:40","false","Run(): rename 'copyStdio' to 'copyPipes'

Rename a variable.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #795
Approved by: rhatdan",30,17,0,1
"containers/buildah","8651267bde508b6be336933cf9cfac84cbf4342d","nalind","2021-10-28 13:50:13","false","Clarify that manifest defaults to localhost as the registry name

Clarify that --manifest also prepends localhost if no registry name is
included in the value, and check for duplicate values between tags and
the manifest name, which doesn't end well.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",31,57,1,1
"containers/buildah","59d2a895720e70528258da0d5527142addde02ef","nalind","2018-07-24 21:47:41","false","Increase the deadline for gometalinter during 'make validate'

Boost the deadline for running gometalinter as part of 'make validate',
to avoid timeouts in PAPR.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #836
Approved by: rhatdan",31,18,0,1
"containers/buildah","646de34999ef222d5b959953fa1964f589d55dc6","nalind","2021-04-23 14:21:45","false","Add compabitility wrappers for removed packages

Add compatibility wrappers for manifests, pkg/manifests, and
pkg/supplemented, which were moved to containers/common.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",50,51,0,1
"containers/buildah","53f12844b2f3672576842bc0c028ae0485447b3b","nalind","2017-03-28 15:16:46","false","Accept commit targets which are just store refs

Accept commit target names which don't include a transport name by
checking if they parse as valid containers-storage references after they
fail to parse as a general reference.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #49
Approved by: rhatdan",14,2,0,1
"containers/buildah","1156cf0759cae39fb462ca7c7ea188d86e75f238","cevich","2021-09-14 15:14:46","true","Update VM Images + Drop prior-ubuntu testing

These images contain a workaround for:
     https://github.com/containers/podman/issues/11123

Ref: https://github.com/containers/podman/issues/11070
     https://github.com/containers/automation_images/pull/88

Signed-off-by: Chris Evich <cevich@redhat.com>",39,56,1,1
"containers/buildah","644558fe1b8d23f45bd5437d24ad7d61166346dd","vrothberg","2019-08-30 10:03:41","false","Makefile: use go proxy

Use GOPROXY=https://proxy.golang.org to speed up fetching dependencies.
Setting it makes `make vendor` ten times faster in my local env.

For details please refer to https://proxy.golang.org/.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",56,31,0,1
"containers/buildah","7234f342e4adf91802c449fe71813310f17a801b","vrothberg","2019-05-29 13:38:15","false","chroot/run_test.go: check errors

Reported by golangc-lint.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1624
Approved by: TomSweeneyRedHat",58,28,0,1
"containers/buildah","2fd926b105cfad473ee317f29e47adb297f7bd3e","rhatdan","2022-09-28 23:23:43","true","Merge pull request #4292 from rhatdan/main

Set sysctls from containers.conf",21,68,1,1
"containers/buildah","1c67aad88fb38328a1473ee08741255e97eda99f","rhatdan","2022-01-07 19:29:52","false","Use config.ProxyEnv from containers/common

This table is being used in multiple different places, so consolidating
it in containers/common

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",27,59,1,1
"containers/buildah","bc134bfc342ea032e56ae0397e6b84ca475f1d69","rhatdan","2021-02-24 14:05:45","false","buildah login and logout, do not need to enter user namespace

Currently we are entering the user namespace to be able to login
and logout, since this is not required, we should not enter.

This also would allow these commands to execute within a docker
container by default.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",59,49,0,1
"containers/buildah","1d3db1774872ca1ac0011e48fece95fc455aea69","rhatdan","2019-10-21 14:42:00","true","Merge pull request #1932 from containers/dependabot/go_modules/github.com/openshift/imagebuilder-1.1.1

Bump github.com/openshift/imagebuilder from 1.1.0 to 1.1.1",77,33,0,1
"containers/buildah","4dc36e85b4425e77fd7ee862a5588feaf797e5eb","rhatdan","2021-09-08 17:14:26","false","Add support for rootless overlay mounts

This patch sets the userxattr field when run in rootless mode.

Fixes: https://github.com/containers/buildah/issues/3503

Patch came from @flouthoc  Aditya Rajan <arajan@redhat.com>

[NO TESTS NEEDED] Since this can not be tested in CI/CD system yet.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",37,55,1,1
"containers/buildah","4e78f9f3468f79b9e5ab32e02fca2007da85aa65","rhatdan","2019-06-15 09:45:50","false","Bump to v1.9.1-dev

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",42,29,0,1
"containers/buildah","43440ec6e43a36bc04a6c23acbf9d4896a26ac80","rhatdan","2023-04-13 11:02:33","false","Clarify the need for qemu-user-static package

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",10,75,1,1
"containers/buildah","ddbd1e2cdbe4e1121d585b451548cf52098856bc","saschagrunert","2019-09-03 15:40:37","true","Enable interfacer linter and fix lints

This fixes a single issue where the interface could be an `io.Reader`
instead of an `io.ReadCloser`.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>",58,31,0,1
"containers/buildah","ee383ec9cfafd1b43fa4df9bea22928426f30c87","TomSweeneyRedHat","2018-02-13 19:25:24","false","Add redis test to baseline

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #476
Approved by: nalind",18,13,0,1
"containers/buildah","1b02a7edef7cdd0e4b6d0eca244a167a36b7d8c7","TomSweeneyRedHat","2019-02-18 15:25:44","false","Bump c/Storage to 1.10

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Bump to v1.10 for container/storage.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1344
Approved by: @rhatdan",57,25,0,1
"containers/buildah","6750810f7408978c1cadf2f4869e9e578ea664ff","TomSweeneyRedHat","2022-05-04 16:27:16","false","Bump to v1.27.0-dev

As the title says
[NO NEW TESTS NEEDED]

Signed-off-by: tomsweeneyredhat <tsweeney@redhat.com>",24,63,1,1
"containers/buildah","00b8e9fdf2aa192d5f1a50e96e21e4992de33dd6","openshift-merge-robot","2020-12-29 13:36:28","true","Merge pull request #2875 from containers/dependabot/go_modules/github.com/containers/common-0.31.2

build(deps): bump github.com/containers/common from 0.31.1 to 0.31.2",88,47,0,1
"containers/buildah","2fb04d5a4ef22bdd00e339849e83cade60210c64","openshift-merge-robot","2021-07-22 15:43:20","true","Merge pull request #3395 from hshiina/cgroupsv2

Add a few tests on cgroups V2",41,54,1,1
"containers/buildah","147632eb999d6e56d2a86a3e17d28029922d0e8d","openshift-merge-robot","2020-11-09 08:12:03","true","Merge pull request #2757 from nalind/util-id

util: digging UID/GID out of os.FileInfo should work on Unix",67,45,0,1
"containers/buildah","18c0b33f2c5a72323998790adfd4184bf65d8d6a","openshift-merge-robot","2020-11-10 11:46:20","true","Merge pull request #2770 from hshiina/pull-test

Add a few tests for `pull` command",67,45,0,1
"containers/buildah","9934b17365083ce966b44c5ce3c7e052f516e255","flouthoc","2022-08-24 03:12:23","true","run: add container gid to additional groups

When container is created with specific uid and gid also add container
gid to supplementary/additional group.

Signed-off-by: Aditya R <arajan@redhat.com>",16,67,1,1
"containers/buildah","f0250fb90e768ec4d6ba3ff1b1e2e4bc0f3b3226","openshift-merge-robot","2022-02-10 14:39:55","true","Merge pull request #3777 from TomSweeneyRedHat/dev/tsweeney/bumpcommon

Bump c/common to v0.47.4",30,60,1,1
"containers/buildah","eb0e5698e9988aec58e809e39f797f63462f25f8","openshift-merge-robot","2020-11-16 15:12:03","true","Merge pull request #2790 from containers/dependabot/go_modules/github.com/containers/common-0.27.0

build(deps): bump github.com/containers/common from 0.26.3 to 0.27.0",77,46,0,1
"containers/buildah","fc1e256f5051898cfabf924fa26f89a1d327d1d1","openshift-merge-robot","2021-08-24 09:53:55","true","Merge pull request #3471 from containers/dependabot/go_modules/github.com/onsi/gomega-1.16.0

build(deps): bump github.com/onsi/gomega from 1.15.0 to 1.16.0",39,55,1,1
"containers/buildah","9e20c3d948c218fa8b2fa5300e95e4d6ddcc90fa","TomSweeneyRedHat","2018-02-11 01:38:24","false","Don't drop error on mix case imagename

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #468
Approved by: rhatdan",18,13,0,1
"containers/buildah","a913dc56a08f8a974fa6289ce1550098488560eb","flouthoc","2023-04-28 08:44:42","true","parse: filter edge-case for podman-remote

podman-remote has a bug where it sends `/` when no platform is set,
patch is there to make sure older clients still work if backend is
updated

Closes: https://github.com/containers/buildah/issues/4763

Signed-off-by: Aditya R <arajan@redhat.com>",13,75,1,1
"containers/buildah","16c2ab48b3b4dfc57b0437628f022584e15ad060","openshift-merge-robot","2022-08-01 13:15:53","true","Merge pull request #4151 from containers/dependabot/go_modules/tests/tools/github.com/golangci/golangci-lint-1.47.3

build(deps): bump github.com/golangci/golangci-lint from 1.46.2 to 1.47.3 in /tests/tools",18,66,1,1
"containers/buildah","b14804b5652864ae50aef15254a0ea3d216b226a","openshift-merge-robot","2021-05-28 09:50:42","true","Merge pull request #3266 from containers/dependabot/go_modules/github.com/containers/storage-1.32.1

build(deps): bump github.com/containers/storage from 1.32.0 to 1.32.1",36,52,1,1
"containers/buildah","00e49484f4dbbc9ce02ec93a36972431f4e7f743","openshift-merge-robot","2021-07-21 17:03:34","true","Merge pull request #3393 from nalind/prepare

imagebuildah.stageExecutor.prepare(): remove pseudonym check",41,54,1,1
"containers/buildah","79ad56907e59abf01dea8bfc11e4c431dc553822","openshift-merge-robot","2021-09-09 17:27:15","true","Merge pull request #3506 from cevich/bump_unit_timeout

Cirrus: Increase unit-test timeout",38,55,1,1
"containers/buildah","f9693d0a5c3b7d3e145144452e135e9093f312fe","dfr","2022-10-20 17:11:22","false","Makefile: Fix install on FreeBSD

The '-D' option to install differs between Linux and FreeBSD. On Linux,
it creates missing directories but on FreeBSD, it removes a destdir
prefix from an optional 'metalog'. This makes the directory creation
explicit using 'install -d'.

[NO NEW TESTS NEEDED]

Signed-off-by: Doug Rabson <dfr@rabson.org>",24,69,1,0
"containers/buildah","3e1f4aeb982e9fbfeab6011786d0b41e97ca041b","TomSweeneyRedHat","2018-05-29 21:26:24","false","Touchup tutorial for run changes

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #734
Approved by: rhatdan",44,16,0,1
"containers/buildah","648b92503a2f8fee54437d867fd11898763bac5c","saschagrunert","2019-06-03 10:25:48","false","Add support for file secret mounts

The current implementation supports only specified directories within a
mounts file like `/etc/containers/mounts.conf`. We now separate the code
paths to pre-check if it's a file or directory and create only the
secret file if necessary.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1633
Approved by: rhatdan",58,28,0,1
"containers/buildah","96becabe0a8d577e49959373f2b0a5590d9018f2","openshift-merge-robot","2022-02-21 18:37:37","true","Merge pull request #3788 from Luap99/test-time

speed up combination-namespaces test",31,61,1,1
"containers/buildah","e92358c8dce7455c4191baeb9b8cf5ce200b18f7","nalind","2020-07-28 20:36:39","false","copier: split StripSetidBits into StripSetuidBit/StripSetgidBit/StripStickyBit

For the sake of conformance tests, callers need to be able to strip
setuid and setgid bits from contents being copied from the build context
while leaving the sticky bit intact.  Split the StripSetidBits option
for copier.Get() into three separate flags (StripSetuidBit /
StripSetgidBit / StripStickyBit).

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",151,42,0,1
"containers/buildah","2777cf86924cc4cb90277d7ed5b26e7570c84ca8","nalind","2020-05-18 15:35:20","false","Fix a help string

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",135,40,0,1
"containers/buildah","a8ac807dbb3463943855c1d0d55f6e87b69149f3","rhatdan","2020-07-07 19:23:45","true","Merge pull request #2438 from nalind/jobs-fixes

imagebuildah: fix inheriting multi-stage builds",146,41,0,1
"containers/buildah","da530c0ed5818b5f97add851f59a4af0d0cce8ef","QiWang19","2020-04-09 19:57:07","false","Use c/common/pkg/auth in login/logout

use shared code for login/logout from c/common

Signed-off-by: Qi Wang <qiwan@redhat.com>",120,38,0,1
"containers/buildah","9ad0d219308ec6714842893bd4c695529804b711","TomSweeneyRedHat","2020-02-27 17:59:12","false","Bump to v1.14.1

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",97,37,0,1
"containers/buildah","9b35b5e3d2334529f9f3f53c50cd81c70eddf55f","nalind","2020-01-08 16:02:05","false","Check for .dockerignore specifically

When generating the list of exclusions to process .dockerignore
contents, don't include .dockerignore if we don't have a .dockerignore
file in the context directory.  That way, if the file doesn't exist, and
the caller didn't pass in any patterns, we get no patterns instead of
just one "".dockerignore"" pattern, and we can hit the faster copy path.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #2072
Approved by: giuseppe",101,35,0,1
"containers/buildah","99e512e3f20fef2b5ecbfb3f19976c43d6733723","rhatdan","2017-10-09 20:20:56","false","Merge pull request #282 from nalind/unit-tests

Run unit tests in CI",33,8,0,1
"containers/buildah","00d46292ca8af80e6ce4b79a3fc6a69f1bb39295","rhatdan","2022-05-20 11:03:03","false","Remove util.StringInSlice because it is defined in containers/common

[NO NEW TESTS NEEDED] Since this is just a code cleanup

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",27,64,1,1
"containers/buildah","49bf6fc095d5124125014176e1a4baa0928c13b3","rhatdan","2017-10-26 22:23:55","false","Merge pull request #298 from rhatdan/contributing

Add CONTRIBUTING.md document from skopeo",30,9,0,1
"containers/buildah","5ca91c0eb777aabcf5ece6ee86ddbcd7bb76d69d","rhatdan","2018-02-20 10:39:04","false","Vendor in latest containers/storage

This fixes a large SELinux bug.  Currently if you do the following
commands

ctr=$(buildah from scratch)
mnt=$(buildah mount $ctr)
dnf install --installroot=$mnt httpd
buildah run $ctr touch /test

The last command fails.  The reason for this is the SELinux labels are getting applied
to the mount point, since it was not being mounted as an overlay file system.

Containers/storage was updated to always mount an overlay even if the lower layer is empty
This then causes the mount point to use a context mount, and changes dnf to not apply
labels.  This change then allows buildah run to create confined containers to run code.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #486
Approved by: TomSweeneyRedHat",19,13,0,1
"containers/buildah","e94e07e3838a2666a758a66243f97d8860c42de1","rhatdan","2022-01-11 19:07:53","false","Fix permissions on  secrets directory

The permission on this directory will prevent user namespaces from using
secrets.  Should be world searchable

[NO TESTS NEEDED]

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>",28,59,1,1
"containers/buildah","3c5dc4fd7e9afb5c49cb967eff6887f7b7c82fdd","rhatdan","2018-08-01 13:41:25","false","Add support for multiple Short options

Also vendor in lates urfave/cli

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #896
Approved by: TomSweeneyRedHat",32,18,0,1
"containers/buildah","5c068beb859e5ddddc94157df8fa3b3bf18f3105","nalind","2019-04-24 13:12:01","false","makeImageRef: pass in the whole CommitOptions structure

Instead of passing in an increasing number of the fields of
CommitOptions to makeImageRef(), just pass the whole thing.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1539
Approved by: rhatdan",53,27,0,1
"containers/buildah","be5bcd549d5395ba6c02d9a9b310671b32a42fde","nalind","2017-07-20 20:37:26","false","Bump containers/storage and containers/image

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #227
Approved by: rhatdan",17,6,0,1
"containers/buildah","9913b9f55afe8fa502b098bb5d9504270e85b3b9","openshift-merge-robot","2020-10-13 13:57:07","true","Merge pull request #2684 from baude/refactor2

refactor pullpolicy to avoid deps",62,44,0,1
"containers/buildah","32543998a20ccfb8f8f4c691bd0335aae41b7142","mtrmac","2018-12-04 21:59:04","false","Inline blobCache.putBlob into blobCacheDestination.PutBlob

It's now the only caller.

Signed-off-by: Miloslav Trmač <mitr@redhat.com>

Closes: #1218
Approved by: rhatdan",46,22,0,1
"containers/buildah","79bab77a7e2d1fb84a07d78b2a29585ef558e3fb","slp","2021-01-25 13:01:01","false","run_unix: return a valid DefaultNamespaceOptions

On non-Linux systems return a valid DefaultNamespaceOptions with all
namespaces disabled. This allows buildah to still perform most image
operations even on systems without support for namespaces.

[NO NEW TESTS NEEDED] This only has an impact to the ""darwin"" target

Signed-off-by: Sergio Lopez <slp@redhat.com>",95,48,0,0
"containers/buildah","a8bbc9f5f159afc1dbdfea8c30c723dab99a6df2","cevich","2023-08-22 20:12:30","true","GHA: Closed issue/PR comment-lock test

Lock discussions on closed PRs and Issues after 90-days of inactivity.

Ref:
     https://github.com/containers/podman/discussions/19012
and
     https://github.com/containers/podman/pull/19691
and
     https://github.com/containers/podman/pull/19700

Signed-off-by: Chris Evich <cevich@redhat.com>",8,79,1,1
"containers/buildah","50183aa00ca1d480253ce72604446238eab76777","vrothberg","2022-08-01 09:50:17","false","vendor c/common@v0.49.1

Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",18,66,1,1
"containers/buildah","db8693932728624ef80b6f2f17287df63794c525","vrothberg","2019-02-20 14:09:57","false","Travis: execute make vendor and hack/tree_status.sh

Currently it will be executed for the entire matrix.  If there's a way
to execute it only once, we'll change the behaviour in the future.

Signed-off-by: Valentin Rothberg <rothberg@redhat.com>

Closes: #1350
Approved by: TomSweeneyRedHat",60,25,0,1
"containers/buildah","ba3bd6ccec028a6e6e2a5000e8f7f6698775f14f","abergmeier","2022-01-11 20:29:28","false","Allow processing of network options from FlagSet

In situations where you don't want/need Cobra climbing behavior nor
Cobra at all using FlagSet is the easier sell.

Signed-off-by: Andreas Bergmeier <abergmeier@gmx.net>",28,59,1,0
"containers/buildah","43392231c3e773569d598c48d4ac14512e009002","rhatdan","2018-04-08 13:32:29","false","Vendor in latest imagebuilder, to get mixed case AS support

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #562
Approved by: bertinatto",26,14,0,1
"containers/buildah","3eef1ed0bd12bcccf68f1ddfbf8387b3fdd3b0ae","rhatdan","2019-01-11 17:13:10","false","Revendor everything

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1277
Approved by: giuseppe",51,23,0,1
"containers/buildah","ac7458e70d02c10f78e09d4e6aaaacdd14e7ae92","flouthoc","2023-01-18 10:21:31","true","stage_executor: while mounting stages use freshly built stage

When using `--mount=` in RUN instruction and source is a stage make sure
that freshly built stage is used if the stage selected in source was
just rebuilt.

Closes: https://github.com/containers/buildah/issues/4522

Signed-off-by: Aditya R <arajan@redhat.com>",22,72,1,1
"containers/buildah","aad1e994a0b2e8a9dd4ffef079d62fe092200916","NotBobTheBuilder","2023-03-26 16:21:47","false","code review

Signed-off-by: Jack Wearden <jack@jackwearden.co.uk>",13,74,1,0
"containers/buildah","ed56830e21525ae7816c4aff52aded946e10a5eb","TomSweeneyRedHat","2019-07-02 15:44:18","false","Add gomod instructions and mailing list links

Added instructions for how to use go mod to vendor
in the contributing.md file.

Also add a few links to the Buildah mailing list.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1703
Approved by: rhatdan",45,29,0,1
"containers/buildah","03f62479b34ec5461c1b28cfb6f5ec75886f021e","TomSweeneyRedHat","2019-01-29 19:26:39","false","Note configuration file requirements

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

We've had a couple of comments that the required configuration
files are not as documented as they should be.  Adding a note to
the install and troubleshooting guides to hopefully help.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>

Closes: #1306
Approved by: rhatdan",54,24,0,1
"containers/buildah","9c57af8d1459c4a0c5804e893eb44073831156df","flouthoc","2023-10-05 09:17:54","true","mkcw: remove entrypoint binaries

Remove generated binaries

[NO NEW TESTS NEEDED]

Signed-off-by: Aditya R <arajan@redhat.com>",6,80,1,1
"containers/buildah","0c0ce48c77e8d0c97ed3a9fddb008364097550d6","openshift-merge-robot","2021-03-25 09:43:24","true","Merge pull request #3102 from rhatdan/VENDOR

vendor in containers/storage v1.28.1",52,50,0,1
"containers/buildah","a8f3d20ad8e22ac251d2e62a02204c66f3da00f3","openshift-merge-robot","2022-02-07 06:30:16","true","Merge pull request #3772 from nalind/more-conformance-tests

conformance: add a few ""replace-directory-with-symlink"" tests",33,60,1,1
"containers/buildah","d9ecc3d14d7533d1fa1809180be5dede9326d11e","openshift-merge-robot","2023-06-08 10:58:20","true","Merge pull request #4856 from cevich/dont_mess_with_test_files

[CI:DOCS] Renovate: Don't touch fragile test stuffs",15,76,1,1
"containers/buildah","4c9fc47f0a62ff03a8f49f3b88f2ec5ce6011439","flouthoc","2022-09-19 09:08:50","true","run,build: conflict --isolation=chroot and --network

Conflict --isolation=chroot and --network, since internally --chroot
will always configure network ns equivalent to host.

Closes: https://github.com/containers/buildah/issues/4255

Signed-off-by: Aditya R <arajan@redhat.com>",19,68,1,1
"containers/buildah","6d6f384dbff482418296505d23cd45a97b8e7ada","EricHripko","2019-05-10 21:53:24","false","Apply custom SHELL during build time

Signed-off-by: Eric Hripko <ehripko@bloomberg.net>

Closes: #1588
Approved by: TomSweeneyRedHat",56,27,0,0
"containers/buildah","8a3ccb53c425cb46f9611d6fa76e90764ac8708b","nalind","2017-07-25 14:33:31","false","rmi: handle truncated image IDs

Have storageImageID() use a lower-level image lookup to let it handle
truncated IDs correctly.  Wrap errors in getImage().  When reporting
that an image is in use, report its ID correctly.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #211
Approved by: rhatdan",18,6,0,1
"containers/buildah","94550b862baa70f6c083ee0ba5a63d0931cb6521","TomSweeneyRedHat","2020-03-03 19:01:56","false","Add Pull Request Template

Add a pull request template.  Modeled after CRI-O (Thanks @saschagrunert!) and
Dockers.

Signed-off-by: TomSweeneyRedHat <tsweeney@redhat.com>",99,37,0,1
"containers/buildah","b7f737d1690183bcaa8a3fd01b59d903fdba8dee","nalind","2020-01-17 15:47:58","false","manifests: unit test fix

The unit tests need to use the policy and registries configurations from
the source tree, so point the SystemContext that we use in our tests to
those files.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #2103
Approved by: rhatdan",101,36,0,1
"containers/buildah","ec6065cc6c64fdd0c3af5a53a0739dcb54cb9eff","vrothberg","2019-10-01 08:21:10","true","Merge pull request #1877 from vrothberg/update-storage

update c/storage to v1.13.4",66,32,0,1
"containers/buildah","579f1d526fab0b07c4808112dacc19e94ab6e136","rhatdan","2019-01-02 14:01:50","false","We should only warn if user actually requests Hostname be set in image

When we set the Hostname to match the container id, we don't want to print
the warning, since the user did not request the hostname being set.

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #1253
Approved by: vrothberg",54,23,0,1
"containers/buildah","4bbe6e7cc0986f07c23f9939ceebb466b2210c70","umohnani8","2018-02-22 17:41:22","false","Implement --volume and --shm-size for bud and from

Add the remaining --volume and --shm-size flags to buildah bud and from
--volume supports the following options: rw, ro, z, Z, private, slave, shared

Signed-off-by: umohnani8 <umohnani@redhat.com>

Closes: #491
Approved by: rhatdan",18,13,0,1
"containers/buildah","c32eb8b0c0c45a25213367122893098057a05b3f","openshift-merge-robot","2022-01-26 20:50:15","true","Merge pull request #3751 from rhatdan/VENDOR

Update vendor of containers/common",34,60,1,1
"containers/buildah","ad6b9902cc8260b5a41212dec6d53dc46d6c6034","openshift-merge-robot","2021-04-22 17:40:29","true","Merge pull request #3161 from rhatdan/copier

Fix copier when using globs",49,51,0,1
"containers/buildah","bf4722aa6e6bfa21c959b71227ccdc079bcb271a","openshift-merge-robot","2022-01-11 19:12:13","true","Merge pull request #3701 from nalind/git-protocol

bud.bats: use a local git daemon for the git protocol test",28,59,1,1
"containers/buildah","09effa16bb8e0c36630f16e46f1759b135acd749","openshift-merge-robot","2022-09-26 14:11:45","true","Merge pull request #4267 from Luap99/comp-test

pkg/cli: improve completion test",21,68,1,1
"containers/buildah","5d93f6a4140ab1c4771ae8c8070861a53a281024","openshift-merge-robot","2022-02-11 11:59:00","true","Merge pull request #3779 from containers/dependabot/go_modules/github.com/fsouza/go-dockerclient-1.7.8

build(deps): bump github.com/fsouza/go-dockerclient from 1.7.7 to 1.7.8",29,61,1,1
"containers/buildah","009c8c7c86fed692243dca080511e5d5ef529121","openshift-merge-robot","2021-04-21 10:02:34","true","Merge pull request #3151 from hshiina/help-test

Add system test of 'buildah help' with a tiny fix",49,51,0,1
"containers/buildah","92cb93aeeb4ea7553e048c70826a3993db64c4c4","openshift-merge-robot","2022-09-06 19:10:16","true","Merge pull request #4220 from flouthoc/manifest-exists

manifest: add support for `buildah manifest exists`",20,67,1,1
"containers/buildah","94f0840d7ce48ca456238bfc3117905929229e1c","openshift-merge-robot","2021-04-14 13:16:50","true","Merge pull request #3145 from alvistack/master-linux-amd64

Update nix pin with `make nixpkgs`",52,51,0,1
"containers/buildah","376e52ee01429586fccbd7ae12b576248a1e5258","saschagrunert","2019-08-21 09:23:55","false","Remove outdated deps Makefile target

We don’t use vendor any more so we can remove the `deps` Makefile
target.

Signed-off-by: Sascha Grunert <sgrunert@suse.com>

Closes: #1809
Approved by: vrothberg",54,31,0,1
"containers/buildah","15bdd2aadb825582d327252d1d32a07f12ab4fed","vrothberg","2023-01-18 14:39:39","false","fix bud-multiple-platform-with-base-as-default-arg flake

By vendoring c/common (see containers/common/pull/1299).

Fixes: #4520
Signed-off-by: Valentin Rothberg <vrothberg@redhat.com>",21,72,1,1
"containers/buildah","4b133d8f22452a31a4a8275c6b15c28c89b71307","rhatdan","2022-10-12 11:23:55","true","Merge pull request #4327 from flouthoc/warn-stage-wise

imagebuildah: `warnOnUnsetBuildArgs` while processing `stages` from `executor`",28,68,1,1
"containers/buildah","e1f3468afe3467ce45eb8b0d53fdd525089b40e3","cevich","2022-07-13 18:22:37","true","GHA: Fix dynamic script filename

When re-using this github-actions workflow from other repositories, the yaml
filename (with extension) or a manually specified workflow name may be passed
in.  This may not match the script filename from the podman repository.  Since
the script will never have a different filename, fix this by hard-coding it.

This resolves errors like:

```
Run
./_podman/.github/actions/.github/workflows/check_cirrus_cron.yml/cron_failures.sh
  ./_podman/.github/actions/.github/workflows/check_cirrus_cron.yml/cron_failures.sh
  shell: /usr/bin/bash -e {0}
  env:
    RCPTCSV: rh.container.bot@gmail.com,podman-monitor@lists.podman.io
    NAME_ID_FILEPATH: ./artifacts/name_id.txt
/home/runner/work/_temp/a4b017c4-7dac-473e-8b3d-a7373ed0156b.sh: line 1:
./_podman/.github/actions/.github/workflows/check_cirrus_cron.yml/cron_failures.sh:
No such file or directory
Error: Process completed with exit code 127.
```

i.e. `${{ github.workflow }}` resolved to `check_cirrus_cron.yml`
instead of the expected `check_cirrus_cron` by the workflow.

Signed-off-by: Chris Evich <cevich@redhat.com>",23,66,1,1
"containers/buildah","4d904fdfc195bd1f476c001505479e113db7fb1e","nalind","2021-08-03 18:05:40","false","make vendor-in-container

It looks like there's some behavior difference between the 1.13 that CI
uses and the 1.16 on my system.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",36,54,1,1
"containers/buildah","38b6e3019ab9210f1a2678fddbef79fec58b6a82","stevegt","2021-07-05 17:58:00","false","Remove specific kernel version number requirement from install.md

Existing specific version number requirement is misleading; discussion
in https://github.com/containers/podman/issues/10100.  Consensus there
and in #3295 is to avoid specific version numbers.

Signed-off-by: Steve Traugott <stevegt@t7a.org>",38,53,1,0
"containers/buildah","d5bd97c557299c438637c50b3dc2d39c2ca6dc59","vrothberg","2021-01-25 12:22:53","false","local image lookup by digest

Detect local-image lookups by digest.  Those clearly refer to local
images only, so we must not proceed to remote lookups.

Note that the specifed digest refers to an image ID and not to the
digest of an image's manifest.

Fixes: #2836
Signed-off-by: Valentin Rothberg <rothberg@redhat.com>",95,48,0,1
"containers/buildah","e83c7c383b692fcd6056b9c349a02eab3e80b95b","nalind","2020-10-09 15:24:23","false","CI: run gating tasks with a lot more memory

Try running the gating test with a lot more memory (12Gb, just shy of
the maximum of 13 allowed for our default 2 vcpu configuration, instead
of the default of 4Gb that we use elsewhere).  We're seeing the linting
process getting killed frequently without any additional explanation,
and our current best guess is that it's the OOM killer.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",62,44,0,1
"containers/buildah","ecb40a48b44bc63b5df7eed5955b83d11a0cd46c","nalind","2020-09-23 21:44:29","false","chroot: fix handling of errno seccomp rules

When converting seccomp rules from the runtime spec to the structure
that we can feed to libseccomp, combine the prescribed errno value with
the action when we're mapping the ""return an errno"" action from one to
the other.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",89,44,0,1
"containers/buildah","beae5647c075353365a4cc25c81dbd6784186f16","flouthoc","2023-05-26 16:26:16","true","remove registry.centos.org

registry.centos.org is now decommissioned

Ref: https://lists.centos.org/pipermail/centos-devel/2023-May/142956.html

Signed-off-by: Aditya R <arajan@redhat.com>",17,76,1,1
"containers/buildah","2d822034f880e802e6f7021c5e8d3a8dd157e180","Fodoj","2021-08-24 18:03:02","false","Rename bud to build, while keeping an alias for to bud.

Signed-off-by: Kirill Shirinkin <kirill@hey.com>",39,55,1,0
"containers/buildah","76a0c821315dbba0d398bfc1125fc3afdd090f13","dfr","2022-06-15 10:19:10","false","Sync call signature for RunUsingChroot with chroot/run.go

Signed-off-by: Doug Rabson <dfr@rabson.org>",22,65,1,0
"containers/buildah","f4ebdc160fa1be04f3aafb9fb4253907d981af85","Luap99","2022-03-31 11:37:02","true","fix hang when oci runtime fails

When the run child process exits early the parent still tries to read
from the ready pipe. Reading from the pipe should end when all writers
are closed. The problem is that the parent kept the writer open as well.
To fix the hang we just need to close the writer before we try to read
and after we gave it to the child.

To prevent closing the fd twice with defer I added a new fileCloser type
to store if the file was already closed.

This problem was noticed in the podman CI:
https://storage.googleapis.com/cirrus-ci-6707778565701632-fcae48/artifacts/containers/podman/6624611893772288/html/sys-podman-fedora-35-root-host-netavark.log.html

Signed-off-by: Paul Holzinger <pholzing@redhat.com>",26,62,1,0
"containers/buildah","9ab3b526db6a367774cd0da9a7bc32bafe2dde04","lsm5","2023-08-09 14:08:21","true","[CI:BUILD] Packit: add fedora-eln targets

`fedora-all` doesn't include eln targets. We need to add them
explicitly.

[NO NEW TESTS NEEDED]

Signed-off-by: Lokesh Mandvekar <lsm5@fedoraproject.org>",10,78,1,1
"containers/buildah","ea0736184d2c5c43076dbe11bd26cd26461be936","giuseppe","2021-02-12 09:34:57","true","vendor: update containers/storage

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",67,49,0,1
"containers/buildah","5354e9e04f0ad490f788a65f460324a0571f5b7e","nalind","2017-03-23 17:48:23","false","Mount the container for Copy

In Copy(), instead of flagging a container not being mounted as an
error, do what we do in Run(), which is to mount it first and then
unmount when we're done.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",12,2,0,1
"containers/buildah","ccfa6a8bd40afb9b2d9c4e5274fa24d9f7649f20","nalind","2017-04-04 22:36:55","false","Make Run() use a terminal only if it has one

Make Run() default to running the command with a PTY if we're being run
with stdout connected to terminal, and provide options to force the
decision one way or the other.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #64
Approved by: rhatdan",14,2,0,1
"containers/buildah","14965cde13f90f063fdfefbd7dae7d08304b1bc2","nalind","2021-07-20 20:23:25","false","imagebuildah.stageExecutor.prepare(): remove pseudonym check

In prepare(), don't check if the image name that it's passed is a
pseudonym for the result of a stage in the Dockerfile.  Its callers
already did that.

When execute() knows that the image it's told to use as a base is a
pseudonym for the result of another stage in the Dockerfile, force the
pull policy to ""never"" to prevent an error when --pull-always=true.

Make imagebuildah.Mount a type alias instead of its own type, since we
never needed it to be a distinct type.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>",42,54,1,1
"containers/buildah","263199ec255d5d3d9d0b53bfb01f68c483fcdc25","rhatdan","2022-12-12 19:42:28","true","Merge branch 'main' into dependabot/go_modules/golang.org/x/term-0.3.0",16,70,1,1
"containers/buildah","7eaedae80e83a76238f819855dcb74f84d0a7b23","rhatdan","2023-03-30 10:42:01","true","Merge pull request #4690 from copyrights/install-ubuntu-jammy

update build instruction for Ubuntu",12,74,1,1
"containers/buildah","cb3bdd8c138b54a7637240562e044de39903b1fa","rhatdan","2022-04-28 10:42:20","true","Merge pull request #3938 from dfr/freebsd

Fix docs build on FreeBSD",25,63,1,1
"containers/buildah","70518e70938fc6050c1998706ab6b7c718cb791b","TomasTomecek","2017-07-10 05:50:12","false","clarify --runtime-flag of run command

Signed-off-by: Tomas Tomecek <ttomecek@redhat.com>

Fixes #178

Closes: #182
Approved by: rhatdan",18,5,0,0
"containers/buildah","e5f75394207cf2511f574b388baff39391378ee0","rhatdan","2018-07-24 19:33:43","false","Remove default dev/pts

This allows us to run buildah without being root

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #883
Approved by: giuseppe",31,18,0,1
"containers/buildah","e7e1728b4629a1bb36b4f6ea22037d01c04489e3","cevich","2021-01-21 14:41:07","true","Cirrus: Two minor cleanup items

Signed-off-by: Chris Evich <cevich@redhat.com>",96,48,0,1
"containers/buildah","16a4eee270d40705d5e915607694e5fd11237dd3","giuseppe","2022-09-21 09:48:25","true","vendor: update c/image

Signed-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",21,68,1,1
"containers/buildah","d0c958d65eb287afbabb93369412634d37735bf8","openshift-merge-robot","2020-11-13 13:56:31","true","Merge pull request #2695 from vrothberg/shortnames

short-name aliasing",72,45,0,1
"containers/buildah","146c18544ed70a757996915ecc0e547d1e9a175d","rhatdan","2018-06-26 14:51:55","false","Vendor in latest selinux-go code

This should make building on non linux systems easier

Signed-off-by: Daniel J Walsh <dwalsh@redhat.com>

Closes: #826
Approved by: rhatdan",28,17,0,1
"containers/buildah","1e7fa1976689f261d2022915a00a4856b9b748b9","rhatdan","2022-07-27 21:07:33","true","Merge pull request #4143 from nalind/is-exist-is-not-exist

Use errors.Is() instead of os.Is{Not,}Exist",17,66,1,1
"containers/buildah","5f1031f9d54ce7f1c7a72ceb631ca2c3a181b1ef","openshift-merge-robot","2020-12-21 22:46:11","true","Merge pull request #2861 from rhatdan/run

Switch references of /var/run -> /run",84,47,0,1
"containers/buildah","5f42d8b2c9a9697a3db4c0ca4214e961a872f175","openshift-merge-robot","2023-04-12 08:26:37","true","Merge pull request #4731 from cevich/tweak_renovate

[CI:DOCS] Renovate: Ensure test/tools/go.mod is managed",11,75,1,1
"containers/buildah","f466086dfa2c2f2875081faa8695f40666548adb","openshift-merge-robot","2021-02-05 17:03:25","true","Merge pull request #2968 from rhatdan/docker

Stop testing directory permissions with latest docker",96,48,0,1
"containers/buildah","36a37402d0c89b19cd5135f6a95e80a83a19fb9a","openshift-merge-robot","2021-04-02 14:44:08","true","Merge pull request #3121 from nalind/copyempty

Add conformance tests for COPY """"",49,50,0,1
"containers/buildah","0a38651dc19a3b20efa1f863034007e1792f3010","openshift-merge-robot","2021-03-11 11:01:57","true","Merge pull request #3047 from hshiina/system-tests

Add some system tests",59,50,0,1
"containers/buildah","4a562690707ffd43613f503767fd82336ca8b230","nalind","2019-02-25 19:22:43","false","imagebuildah: add empty layers for instructions

When we're not building with multiple layers, add empty layer items in
the image's history so that the instructions from the Dockerfile don't
get lost.

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1473
Approved by: rhatdan",59,25,0,1
"containers/buildah","c0388272b301e75260f93b5977ca6af640ad3bc0","nalind","2019-11-22 19:52:25","false","overlay.bats typo: fuse-overlays should be fuse-overlayfs

Signed-off-by: Nalin Dahyabhai <nalin@redhat.com>

Closes: #1996
Approved by: rhatdan",83,34,0,1
